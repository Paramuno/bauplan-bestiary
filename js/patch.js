var CABLES;(()=>{"use strict";var __webpack_modules__={122:()=>{let GLOB_EXP=/(?:^|[^\\])\*/,NOT_LINE_ENDING=/[^\r\n]/g;const Preprocessor=function(t,e,i){this.source=""+t,this.baseDir="string"==typeof e?e:".",this.includes="object"==typeof e?e:{},this.preserveLineNumbers="boolean"==typeof i&&i,this.isNode=!("undefined"!=typeof window&&window.window),this.errorSourceAhead=50,this.defines=[]};Preprocessor.EXPR=/([ ]*)\/\/[ ]+#(include_once|include|ifn?def|if|endif|else|elif|put|define)/g,Preprocessor.ALL=/([^\r\n]*)\r?(?:\n|$)/,Preprocessor.INCLUDE=/(include_once|include)[ ]+"([^"\\]*(\\.[^"\\]*)*)"[ ]*\r?(?:\n|$)/g,Preprocessor.IF=/(ifdef|ifndef|if)[ ]*([^\r\n]+)\r?\n/g,Preprocessor.ENDIF=/(endif|else|elif)([ ]+[^\r\n]+)?\r?(?:\n|$)/g,Preprocessor.PUT=/put[ ]+([^\n]+)[ ]*/g,Preprocessor.DEFINE=/define[ ]+([^\n\r]+)\r?(?:\n|$)/g,Preprocessor.VAR=/define[ ]+var[ ]+([a-zA-Z_][a-zA-Z0-9_]*)[ ]*=[ ]*(.+)/g,Preprocessor.BOOLVAR=/define[ ]+([a-zA-Z_][a-zA-Z0-9_]*)[ ]*/g,Preprocessor.FUNCTION=/define[ ]+function[ ]+([a-zA-Z_][a-zA-Z0-9_]*)[ ]*(.+)/g,Preprocessor.stripSlashes=function(t){return(t+"").replace(/\\(.?)/g,(function(t,e){switch(e){case"\\":return"\\";case"0":return"\0";case"":return"";default:return e}}))},Preprocessor.addSlashes=function(t){return(t+"").replace(/([\\"'])/g,"\\$1").replace(/\0/g,"\\0")},Preprocessor.indent=function(t,e){let i=t.split("\n");for(let t=0;t<i.length;t++)i[t]=e+i[t];return i.join("\n")},Preprocessor.nlToStr=function(t){return"["+t.replace(/\r/g,"").replace(/\n/g,"\\n")+"]"},Preprocessor.evaluate=function(defines,expr){let evalFunction=function(){for(let key in defines)defines.hasOwnProperty(key)&&("var"===defines[key].type?eval("var "+key+" = "+defines[key].value+";"):eval("function "+key+defines[key].value));return eval(expr)};return evalFunction()},Preprocessor.prototype.process=function(t,e){t=t||{},(e="function"==typeof e?e:function(){})("Defines: "+JSON.stringify(t));let i,s,r,n,o,a,h=[],l=!1;for(;null!==(i=Preprocessor.EXPR.exec(this.source));){e(i[2]+" @ "+i.index+"-"+Preprocessor.EXPR.lastIndex);let g=i[1];if(l&&h.length>0&&"endif"!==i[2]&&"else"!==i[2]&&"elif"!==i[2]){if(a=h.pop(),e("  pop ("+h.length+"): "+JSON.stringify(a)),Preprocessor.ALL.lastIndex=i.index,null===(s=Preprocessor.ALL.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");h.push(o={include:a.include,index:a.index,lastIndex:Preprocessor.ALL.lastIndex}),e("  push ("+h.length+"): "+JSON.stringify(o))}else switch(i[2]){case"ifdef":case"ifndef":case"if":if(Preprocessor.IF.lastIndex=i.index,null===(s=Preprocessor.IF.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");e("  test: "+s[2]),e("  defines  "+JSON.stringify(t)),n="ifdef"===s[1]?void 0!==t[s[2]]:"ifndef"===s[1]?void 0===t[s[2]]:Preprocessor.evaluate(t,s[2]),l=!n,e("  value: "+n+", isSkip: "+l),h.push(o={include:n,index:i.index,lastIndex:Preprocessor.IF.lastIndex}),e("  push ("+h.length+"): "+JSON.stringify(o));break;case"endif":case"else":case"elif":if(Preprocessor.ENDIF.lastIndex=i.index,null===(s=Preprocessor.ENDIF.exec(this.source)))throw new Error("Illegal #"+i[2]+': "'+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");if(0===h.length)throw new Error("Unexpected #"+s[1]+': "'+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");a=h.pop(),e("  pop ("+h.length+"): "+JSON.stringify(a)),n=this.preserveLineNumbers?this.source.substring(a.index,a.lastIndex).replace(NOT_LINE_ENDING,"")+this.source.substring(a.lastIndex,i.index)+this.source.substring(i.index,Preprocessor.ENDIF.lastIndex).replace(NOT_LINE_ENDING,""):this.source.substring(a.lastIndex,i.index),a.include?(e("  incl: "+Preprocessor.nlToStr(n)+", 0-"+a.index+" + "+n.length+" bytes + "+Preprocessor.ENDIF.lastIndex+"-"+this.source.length),this.source=this.source.substring(0,a.index)+n+this.source.substring(Preprocessor.ENDIF.lastIndex)):this.preserveLineNumbers?(e("  excl(\\n): "+Preprocessor.nlToStr(n)+", 0-"+a.index+" + "+Preprocessor.ENDIF.lastIndex+"-"+this.source.length),n=n.replace(NOT_LINE_ENDING,""),this.source=this.source.substring(0,a.index)+n+this.source.substring(Preprocessor.ENDIF.lastIndex)):(e("  excl: "+Preprocessor.nlToStr(n)+", 0-"+a.index+" + "+Preprocessor.ENDIF.lastIndex+"-"+this.source.length),n="",this.source=this.source.substring(0,a.index)+this.source.substring(Preprocessor.ENDIF.lastIndex)),""===this.source&&e("  result empty"),l=!1,Preprocessor.EXPR.lastIndex=a.index+n.length,e("  continue at "+Preprocessor.EXPR.lastIndex),"else"!==s[1]&&"elif"!==s[1]||(n="else"===s[1]?!a.include:Preprocessor.evaluate(t,s[2]),l=!n,e("  isSkip: "+l),h.push(o={include:n,index:Preprocessor.EXPR.lastIndex,lastIndex:Preprocessor.EXPR.lastIndex}),e("  push ("+h.length+"): "+JSON.stringify(o)));break;case"define":if(Preprocessor.DEFINE.lastIndex=i.index,Preprocessor.VAR.lastIndex=i.index,Preprocessor.FUNCTION.lastIndex=i.index,Preprocessor.BOOLVAR.lastIndex=i.index,null===(s=Preprocessor.DEFINE.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");var c,u,p;if(e('  def: "'+s[1]+'"'),null!==(r=Preprocessor.VAR.exec(this.source)))p="var",c=r[1],u=r[2],e(" match3(var): "+JSON.stringify(r));else if(null!==(r=Preprocessor.FUNCTION.exec(this.source)))p="function",c=r[1],u=r[2],e(" match3(function): "+JSON.stringify(r));else{if(null===(r=Preprocessor.BOOLVAR.exec(this.source)))throw new Error("Illegal #"+i[2]+": "+this.source.substring(i.index,i.index+this.errorSourceAhead)+"...");p="var",c=r[1],u=!0,e(" match3(boolvar): "+JSON.stringify(r))}e("  type: "+p),e("  identifier: "+c),e("  value: "+u),t[c]={type:p,value:u},e("  defines  "+JSON.stringify(t));var _="";this.preserveLineNumbers&&(_=this.source.substring(i.index,Preprocessor.DEFINE.lastIndex).replace(NOT_LINE_ENDING,"")),this.source=this.source.substring(0,i.index)+g+_+this.source.substring(Preprocessor.DEFINE.lastIndex),Preprocessor.EXPR.lastIndex=i.index,e("  continue at "+Preprocessor.EXPR.lastIndex)}}return h.length>0&&e("Still on stack ("+h.length+"): "+JSON.stringify(h.pop())),this.source};var __WEBPACK_DEFAULT_EXPORT__=Preprocessor}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](i,i.exports,__webpack_require__),i.exports}__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{__webpack_require__.d(__webpack_exports__,{default:()=>jt});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{UTILS:()=>l,ajax:()=>O,ajaxSync:()=>F,basename:()=>P,cacheBust:()=>R,clamp:()=>y,cleanJson:()=>E,copyArray:()=>S,generateUUID:()=>m,getShortOpName:()=>c,keyCodeToName:()=>C,map:()=>I,prefixedHash:()=>T,request:()=>N,shortId:()=>g,shuffleArray:()=>u,simpleId:()=>b,smoothStep:()=>x,smootherStep:()=>v,uuid:()=>f});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{b64decTypedArray:()=>D,b64encTypesArray:()=>k,base64Chars:()=>U,base64lookup:()=>L});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{ANIM:()=>Y,Anim:()=>W});var s={};__webpack_require__.r(s),__webpack_require__.d(s,{PatchConnectionReceiver:()=>Bt,PatchConnectionSender:()=>Lt,PatchConnectorBroadcastChannel:()=>kt});class r{constructor(t){this._logs=[],this.initiator=t}stack(t){console.info("["+this.initiator+"] ",t),console.log((new Error).stack)}groupCollapsed(t){console.groupCollapsed("["+this.initiator+"] "+t)}table(t){console.table(t)}groupEnd(){console.groupEnd()}error(t){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"error",arguments)}info(t){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"info",arguments)}warn(t){console.warn("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"warn",arguments)}verbose(){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"verbose",arguments)}log(t){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"log",arguments)}userInteraction(t){}}const n={EASINGS:["linear","absolute","smoothstep","smootherstep","Cubic In","Cubic Out","Cubic In Out","Expo In","Expo Out","Expo In Out","Sin In","Sin Out","Sin In Out","Quart In","Quart Out","Quart In Out","Quint In","Quint Out","Quint In Out","Back In","Back Out","Back In Out","Elastic In","Elastic Out","Bounce In","Bounce Out"],EASING_LINEAR:0,EASING_ABSOLUTE:1,EASING_SMOOTHSTEP:2,EASING_SMOOTHERSTEP:3,EASING_CUBICSPLINE:4,EASING_CUBIC_IN:5,EASING_CUBIC_OUT:6,EASING_CUBIC_INOUT:7,EASING_EXPO_IN:8,EASING_EXPO_OUT:9,EASING_EXPO_INOUT:10,EASING_SIN_IN:11,EASING_SIN_OUT:12,EASING_SIN_INOUT:13,EASING_BACK_IN:14,EASING_BACK_OUT:15,EASING_BACK_INOUT:16,EASING_ELASTIC_IN:17,EASING_ELASTIC_OUT:18,EASING_BOUNCE_IN:19,EASING_BOUNCE_OUT:21,EASING_QUART_IN:22,EASING_QUART_OUT:23,EASING_QUART_INOUT:24,EASING_QUINT_IN:25,EASING_QUINT_OUT:26,EASING_QUINT_INOUT:27},o={OP_PORT_TYPE_VALUE:0,OP_PORT_TYPE_FUNCTION:1,OP_PORT_TYPE_TRIGGER:1,OP_PORT_TYPE_OBJECT:2,OP_PORT_TYPE_TEXTURE:2,OP_PORT_TYPE_ARRAY:3,OP_PORT_TYPE_DYNAMIC:4,OP_PORT_TYPE_STRING:5,OP_VERSION_PREFIX:"_v"},a={PORT_DIR_IN:0,PORT_DIR_OUT:1},h={PACO_CLEAR:0,PACO_VALUECHANGE:1,PACO_OP_DELETE:2,PACO_UNLINK:3,PACO_LINK:4,PACO_LOAD:5,PACO_OP_CREATE:6,PACO_OP_ENABLE:7,PACO_OP_DISABLE:8,PACO_UIATTRIBS:9,PACO_VARIABLES:10,PACO_TRIGGERS:11,PACO_PORT_SETVARIABLE:12,PACO_PORT_SETANIMATED:13,PACO_PORT_ANIM_UPDATED:14,PACO_DESERIALIZE:15},l={float32Concat:function(t,e){t instanceof Float32Array||(t=new Float32Array(t)),e instanceof Float32Array||(e=new Float32Array(e));const i=new Float32Array(t.length+e.length);return i.set(t),i.set(e,t.length),i}},c=function(t){let e=t.split(".")[t.split(".").length-1];if(e.indexOf(o.OP_VERSION_PREFIX)>0){const t=e.split(o.OP_VERSION_PREFIX)[1];e=e.substring(0,e.length-(o.OP_VERSION_PREFIX+t).length)}return e},u=function(t){for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.seededRandom()*(e+1)),s=t[e];t[e]=t[i],t[i]=s}return t},p={},_=function(){let t=Math.random().toString(36).substr(2,9);return p.hasOwnProperty(t)&&(t=_()),p[t]=!0,t},g=_,d=function(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)}))},f=d,m=d;function E(t){for(const e in t)t[e]&&"object"==typeof objValue&&t[e].constructor===Object&&(t[e]=E(t[e])),(null===t[e]||void 0===t[e]||Array.isArray(t[e])&&0==t[e].length)&&delete t[e];return t}const T=function(t,e="id"){let i=0;if(Array.prototype.reduce)i=t.split("").reduce(((t,e)=>(t=(t<<5)-t+e.charCodeAt(0))&t),0);else if(t.length>0)for(let e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i&=i;return e+""+i};let A=0;const b=function(){return A++,A},x=function(t){const e=Math.max(0,Math.min(1,(t-0)/1));return e*e*(3-2*e)},v=function(t){const e=Math.max(0,Math.min(1,(t-0)/1));return e*e*e*(e*(6*e-15)+10)},y=function(t,e,i){return Math.min(Math.max(t,e),i)},I=function(t,e,i,s,r,n){if(t>=i)return r;if(t<=e)return s;let o=!1;const a=Math.min(e,i),h=Math.max(e,i);a!=e&&(o=!0);let l=!1;const c=Math.min(s,r),u=Math.max(s,r);c!=s&&(l=!0);let p=0,_=0;return p=o?(h-t)*(u-c)/(h-a):(t-a)*(u-c)/(h-a),_=l?u-p:p+c,n?1==n?s+(t=Math.max(0,Math.min(1,(_-s)/(r-s))))*t*(3-2*t)*(r-s):2==n?s+(t=Math.max(0,Math.min(1,(_-s)/(r-s))))*t*t*(t*(6*t-15)+10)*(r-s):_:_};Math.randomSeed=1,Math.seededRandom=function(t,e){return 0===Math.randomSeed&&(Math.randomSeed=999*Math.random()),t=t||1,e=e||0,Math.randomSeed=(9301*Math.randomSeed+49297)%233280,e+Math.randomSeed/233280*(t-e)},l.arrayWriteToEnd=function(t,e){for(let e=1;e<t.length;e++)t[e-1]=t[e];t[t.length-1]=e},l.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},l.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},String.prototype.endl=function(){return this+"\n"},String.prototype.startsWith=function(t){return 0===this.indexOf(t)},String.prototype.endsWith=String.prototype.endsWith||function(t){return this.match(t+"$")==t};const R=function(t){return t.indexOf("?")>-1?t+="&":t+="?",t+"cb="+CABLES.uuid()},S=function(t,e){if(!t)return null;(e=e||[]).length=t.length;for(let i=0;i<t.length;i++)e[i]=t[i];return e},P=function(t){let e="";if(!t)return"";const i=(t+"").split("/");if(i.length>0){let t=i[i.length-1].split("?");e=t[0],t=e.split("."),e=t[0]}return e},F=function(t,e,i,s,r){N({url:t,cb:e,method:i,data:s,contenttype:r,sync:!0})},O=function(t,e,i,s,r,n,o={}){N({url:t,cb:e,method:i,data:s,contenttype:r,sync:!1,jsonP:n,headers:o})},N=function(t){let e;t.hasOwnProperty("asynch")||(t.asynch=!0);try{e=new XMLHttpRequest}catch(t){}e.onreadystatechange=function(){4==e.readyState&&t.cb&&(200==e.status||0==e.status?t.cb(!1,e.responseText,e):t.cb(!0,e.responseText,e))},e.addEventListener("progress",(t=>{}));try{e.open(t.method?t.method.toUpperCase():"GET",t.url,!t.sync)}catch(i){t.cb&&t.cb(!0,i.msg,e)}if("object"==typeof t.headers){const i=Object.keys(t.headers);for(let s=0;s<i.length;s++){const r=i[s],n=t.headers[r];e.setRequestHeader(r,n)}}try{t.post||t.data?(e.setRequestHeader("Content-type",t.contenttype?t.contenttype:"application/x-www-form-urlencoded"),e.send(t.data||t.post)):e.send()}catch(i){t.cb&&t.cb(!0,i.msg,e)}},C=function(t){if(!t&&0!==t)return"Unidentified";const e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};return e[t]?e[t]:String.fromCharCode(t)};window.performance=window.performance||{offset:Date.now(),now:function(){return Date.now()-this.offset}};const w=function(t,e={}){if(!t)throw new Error("no cgl");this._log=new r("cgl_texture"),this._cgl=t,this.pixelFormat=e.pixelFormat||w.PFORMATSTR_RGBA8UB,this.tex=this._cgl.gl.createTexture(),this.id=CABLES.uuid(),this.width=0,this.height=0,this.loading=!1,this.flip=!0,this.flipped=!1,this.shadowMap=!1,this.deleted=!1,this.image=null,this.anisotropic=0,this.filter=w.FILTER_NEAREST,this.wrap=w.WRAP_CLAMP_TO_EDGE,this.texTarget=this._cgl.gl.TEXTURE_2D,e&&e.type&&(this.texTarget=e.type),this.textureType=w.TYPE_DEFAULT,this.unpackAlpha=!0,this._fromData=!0,this.name="unknown",this._glDataType=-1,this._glInternalFormat=-1,this._glDataFormat=-1,e?(this.name=e.name||this.name,e.isDepthTexture&&(this.textureType=w.TYPE_DEPTH),!0===e.isFloatingPointTexture&&(this.textureType=w.TYPE_FLOAT),"textureType"in e&&(this.textureType=e.textureType),"filter"in e&&(this.filter=e.filter),"wrap"in e&&(this.wrap=e.wrap),"unpackAlpha"in e&&(this.unpackAlpha=e.unpackAlpha),"flip"in e&&(this.flip=e.flip),"shadowMap"in e&&(this.shadowMap=e.shadowMap),"anisotropic"in e&&(this.anisotropic=e.anisotropic)):e={},!e.pixelFormat&&e.isFloatingPointTexture&&(this.pixelFormat=w.PFORMATSTR_RGBA32F),this.textureType==w.TYPE_DEPTH&&(this.pixelFormat=w.PFORMATSTR_DEPTH),e.width||(e.width=8),e.height||(e.height=8),this._cgl.profileData.profileTextureNew++,this.setFormat(w.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this._cgl.profileData.addHeavyEvent("texture created",this.name,e.width+"x"+e.height),this.setSize(e.width,e.height),this.getInfoOneLine()};w.prototype.isFloatingPoint=function(){w.isPixelFormatFloat(this.pixelFormat)},w.prototype.compareSettings=function(t){return!!t&&t.width==this.width&&t.height==this.height&&t.filter==this.filter&&t.wrap==this.wrap&&t.textureType==this.textureType&&t.unpackAlpha==this.unpackAlpha&&t.anisotropic==this.anisotropic&&t.shadowMap==this.shadowMap&&t.texTarget==this.texTarget&&t.flip==this.flip},w.prototype.clone=function(){const t=new w(this._cgl,{name:this.name,filter:this.filter,wrap:this.wrap,textureType:this.textureType,pixelFormat:this.pixelFormat,unpackAlpha:this.unpackAlpha,flip:this.flip,width:this.width,height:this.height});return this._cgl.profileData.addHeavyEvent("texture created",this.name,this.width+"x"+this.height),this.compareSettings(t)||(this._log.error("Cloned texture settings do not compare!"),this._log.error(this),this._log.error(t)),t},w.prototype.setFormat=function(t){this.pixelFormat=t.pixelFormat,this._glDataFormat=t.glDataFormat,this._glInternalFormat=t.glInternalFormat,this._glDataType=t.glDataType},w.setUpGlPixelFormat=function(t,e){const i={};e||(console.log("no pixelformatstr!"),console.log((new Error).stack),e=w.PFORMATSTR_RGBA8UB),i.pixelFormatBase=e,t.glUseHalfFloatTex&&(e==w.PFORMATSTR_RGBA32F&&(e=w.PFORMATSTR_RGBA16F),e==w.PFORMATSTR_RG32F&&(e=w.PFORMATSTR_RG16F),e==w.PFORMATSTR_R32F&&(e=w.PFORMATSTR_R16F)),i.pixelFormat=e,i.glDataType=t.gl.UNSIGNED_BYTE,i.glInternalFormat=t.gl.RGBA8,i.glDataFormat=t.gl.RGBA;let s=t.gl.FLOAT;if(1==t.glVersion&&(i.glInternalFormat=t.gl.RGBA,e==w.PFORMATSTR_RGBA16F||e==w.PFORMATSTR_RG16F||e==w.PFORMATSTR_R16F)){const e=t.enableExtension("OES_texture_half_float");if(!e)throw new Error("no half float texture extension");s=e.HALF_FLOAT_OES}return e==w.PFORMATSTR_RGBA8UB||(e==w.PFORMATSTR_RGB565?(i.glInternalFormat=t.gl.RGB565,i.glDataFormat=t.gl.RGB):e==w.PFORMATSTR_R8UB?(i.glInternalFormat=t.gl.R8,i.glDataFormat=t.gl.RED):e==w.PFORMATSTR_RG8UB?(i.glInternalFormat=t.gl.RG8,i.glDataFormat=t.gl.RG):e==w.PFORMATSTR_RGB8UB?(i.glInternalFormat=t.gl.RGB8,i.glDataFormat=t.gl.RGB):e==w.PFORMATSTR_R32F?(i.glInternalFormat=t.gl.R32F,i.glDataFormat=t.gl.RED,i.glDataType=s):e==w.PFORMATSTR_R16F?(i.glInternalFormat=t.gl.R16F,i.glDataType=s,i.glDataFormat=t.gl.RED):e==w.PFORMATSTR_RG16F?(i.glInternalFormat=t.gl.RG16F,i.glDataType=s,i.glDataFormat=t.gl.RG):e==w.PFORMATSTR_RGBA16F?(1==t.glVersion?i.glInternalFormat=t.gl.RGBA:i.glInternalFormat=t.gl.RGBA16F,i.glDataType=s):e==w.PFORMATSTR_R11FG11FB10F?(i.glInternalFormat=t.gl.R11F_G11F_B10F,i.glDataType=s,i.glDataFormat=t.gl.RGB):e==w.PFORMATSTR_RGBA32F?(1==t.glVersion?i.glInternalFormat=t.gl.RGBA:i.glInternalFormat=t.gl.RGBA32F,i.glDataType=s):e==w.PFORMATSTR_DEPTH?1==t.glVersion?(i.glInternalFormat=t.gl.DEPTH_COMPONENT,i.glDataType=t.gl.UNSIGNED_SHORT,i.glDataFormat=t.gl.DEPTH_COMPONENT):(i.glInternalFormat=t.gl.DEPTH_COMPONENT32F,i.glDataType=t.gl.FLOAT,i.glDataFormat=t.gl.DEPTH_COMPONENT):console.log("unknown pixelformat ",e)),(e.indexOf("32bit")||e==w.PFORMATSTR_R11FG11FB10F)&&(2==t.glVersion&&t.enableExtension("EXT_color_buffer_float"),2==t.glVersion&&t.enableExtension("EXT_float_blend"),t.enableExtension("OES_texture_float_linear")),e.indexOf("16bit")&&(t.enableExtension("EXT_color_buffer_half_float"),t.enableExtension("OES_texture_float_linear")),i.glDataType&&i.glInternalFormat&&i.glDataFormat||console.log("pixelformat wrong ?!",e,i.glDataType,i.glInternalFormat,i.glDataFormat,this),i},w.prototype.setSize=function(t,e){this._cgl.aborted||((t!=t||t<=0||!t)&&(t=8),(e!=e||e<=0||!e)&&(e=8),(t>this._cgl.maxTexSize||e>this._cgl.maxTexSize)&&this._log.error("texture size too big! "+t+"x"+e+" / max: "+this._cgl.maxTexSize),t=Math.min(t,this._cgl.maxTexSize),e=Math.min(e,this._cgl.maxTexSize),t=Math.floor(t),e=Math.floor(e),(this.width!=t||this.height!=e)&&(this.width=t,this.height=e,this.deleted=!1,this.setFormat(w.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this.shortInfoString=this.getInfoOneLine(),this._cgl.gl.bindTexture(this.texTarget,this.tex),this._cgl.profileData.profileTextureResize++,this._cgl.gl.texImage2D(this.texTarget,0,this._glInternalFormat,t,e,0,this._glDataFormat,this._glDataType,null),this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null)))},w.prototype.initFromData=function(t,e,i,s,r){if(this.filter=s,this.wrap=r,null==s&&(this.filter=w.FILTER_LINEAR),null==r&&(this.wrap=w.WRAP_CLAMP_TO_EDGE),this.width=e,this.height=i,this._fromData=!0,this.deleted=!1,this.height>this._cgl.maxTexSize||this.width>this._cgl.maxTexSize){const t=CGL.Texture.getTempTexture(this._cgl);return this.width=t.width,this.height=t.height,this.tex=t.tex,void this._log.error("[cgl_texture] texture size to big!!!",this.width,this.height,this._cgl.maxTexSize)}this.flip&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,this.flip),this._cgl.gl.bindTexture(this.texTarget,this.tex),this.setFormat(w.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this._cgl.gl.texImage2D(this.texTarget,0,this._glInternalFormat,e,i,0,this._glDataFormat,this._glDataType,t),this._setFilter(),this.updateMipMap(),this.flip&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,!1),this._cgl.gl.bindTexture(this.texTarget,null)},w.prototype.updateMipMap=function(){2!=this._cgl.glVersion&&!this.isPowerOfTwo()||this.filter!=w.FILTER_MIPMAP||(this._cgl.gl.generateMipmap(this.texTarget),this._cgl.profileData.profileGenMipMap++)},w.prototype.initTexture=function(t,e){if(this._cgl.printError("before initTexture"),this._cgl.checkFrameStarted("texture inittexture"),this._fromData=!1,this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),t.width&&(this.width=t.width),t.height&&(this.height=t.height),e&&(this.filter=e),t.height>this._cgl.maxTexSize||t.width>this._cgl.maxTexSize){const e=CGL.Texture.getTempTexture(this._cgl);return this.width=e.width,this.height=e.height,this.tex=e.tex,void this._log.error("[cgl_texture] texture size to big!!!",t.width,t.height,this._cgl.maxTexSize)}this._cgl.gl.bindTexture(this.texTarget,this.tex),this.deleted=!1,this.flipped=!this.flip,this.flipped&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,this.flipped),this.setFormat(w.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this._cgl.gl.texImage2D(this.texTarget,0,this._glInternalFormat,this._glDataFormat,this._glDataType,t),this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null),this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.flipped&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,!1),this.getInfoOneLine(),this._cgl.printError("initTexture")},w.prototype.delete=function(){this.loading||(this.deleted=!0,this.width=0,this.height=0,this._cgl.profileData.profileTextureDelete++,this._cgl.gl.deleteTexture(this.tex),this.image=null,this.tex=null)},w.prototype.isPowerOfTwo=function(){return w.isPowerOfTwo(this.width)&&w.isPowerOfTwo(this.height)},w.prototype.printInfo=function(){console.log(this.getInfo())},w.prototype.getInfoReadable=function(){const t=this.getInfo();let e="";t.name=t.name.substr(0,t.name.indexOf("?rnd="));for(const i in t)e+="* "+i+":  **"+t[i]+"**\n";return e},w.prototype.getInfoOneLine=function(){let t=this.width+"x"+this.height;return t+=" ",t+=this.pixelFormat,this.filter===CGL.Texture.FILTER_NEAREST&&(t+=" nearest"),this.filter===CGL.Texture.FILTER_LINEAR&&(t+=" linear"),this.filter===CGL.Texture.FILTER_MIPMAP&&(t+=" mipmap"),this.wrap===CGL.Texture.WRAP_CLAMP_TO_EDGE&&(t+=" clamp"),this.wrap===CGL.Texture.WRAP_REPEAT&&(t+=" repeat"),this.wrap===CGL.Texture.WRAP_MIRRORED_REPEAT&&(t+=" repeatmir"),this.shortInfoString=t,t},w.prototype.getInfoOneLineShort=function(){let t=this.width+"x"+this.height;return t+=" ",t+=this.pixelFormat,this.shortInfoString=t,t},w.prototype.getInfo=function(){return w.getTexInfo(this)},w.prototype._setFilter=function(){if(this._cgl.printError("before _setFilter"),this._fromData||this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),this.shadowMap&&(this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D,this._cgl.gl.TEXTURE_COMPARE_MODE,this._cgl.gl.COMPARE_REF_TO_TEXTURE),this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D,this._cgl.gl.TEXTURE_COMPARE_FUNC,this._cgl.gl.LEQUAL)),this.textureType==w.TYPE_FLOAT&&this.filter==w.FILTER_MIPMAP&&(this.filter=w.FILTER_LINEAR,this._log.stack("texture: HDR and mipmap filtering at the same time is not possible")),1!=this._cgl.glVersion||this.isPowerOfTwo()){if(this.wrap==w.WRAP_CLAMP_TO_EDGE?(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE)):this.wrap==w.WRAP_REPEAT?(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.REPEAT)):this.wrap==w.WRAP_MIRRORED_REPEAT&&(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.MIRRORED_REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.MIRRORED_REPEAT)),this.filter==w.FILTER_NEAREST)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST);else if(this.filter==w.FILTER_LINEAR)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR);else{if(this.filter!=w.FILTER_MIPMAP)throw this._log.log("unknown texture filter!",this.filter),new Error("unknown texture filter!"+this.filter);this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR_MIPMAP_LINEAR)}if(this.anisotropic){const t=this._cgl.enableExtension("EXT_texture_filter_anisotropic");if(t){const e=this._cgl.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this._cgl.gl.texParameterf(this._cgl.gl.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e,this.anisotropic))}}}else this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE),this.filter=w.FILTER_NEAREST,this.wrap=w.WRAP_CLAMP_TO_EDGE;this.getInfoOneLine(),this._cgl.printError("_setFilter")},w.load=function(t,e,i,s){if(!e)return i({error:!0});let r=null;t.patch.loading.existByName(e)||(r=t.patch.loading.start("texture",e));const n=new w(t);return n.name=e,t.patch.isEditorMode()&&gui.jobs().start({id:"loadtexture"+r,title:"loading texture "+CABLES.basename(e)}),n.image=new Image,n.image.crossOrigin="anonymous",n.loading=!0,s&&s.hasOwnProperty("filter")&&(n.filter=s.filter),s&&s.hasOwnProperty("flip")&&(n.flip=s.flip),s&&s.hasOwnProperty("wrap")&&(n.wrap=s.wrap),s&&s.hasOwnProperty("anisotropic")&&(n.anisotropic=s.anisotropic),s&&s.hasOwnProperty("unpackAlpha")&&(n.unpackAlpha=s.unpackAlpha),s&&s.hasOwnProperty("pixelFormat")&&(n.pixelFormat=s.pixelFormat),n.image.onabort=n.image.onerror=s=>{console.warn("[cgl.texture.load] error loading texture",e,s),n.loading=!1,r&&t.patch.loading.finished(r),i&&i({error:!0},n),t.patch.isEditorMode()&&gui.jobs().finish("loadtexture"+r)},n.image.onload=function(e){t.addNextFrameOnceCallback((()=>{n.initTexture(n.image),r&&t.patch.loading.finished(r),n.loading=!1,t.patch.isEditorMode()&&gui.jobs().finish("loadtexture"+r),i&&i(null,n)}))},n.image.src=e,n},w.getTempTexture=function(t){return t||console.error("[getTempTexture] no cgl!"),t.tempTexture||(t.tempTexture=w.getTemporaryTexture(t,256,w.FILTER_LINEAR,w.REPEAT)),t.tempTexture},w.getErrorTexture=function(t){return t||console.error("[getTempTexture] no cgl!"),t.errorTexture||(t.errorTexture=w.getTemporaryTexture(t,256,w.FILTER_LINEAR,w.REPEAT,1,.2,.2)),t.errorTexture},w.getEmptyTexture=function(t,e){if(e)return w.getEmptyTextureFloat(t);if(t||console.error("[getEmptyTexture] no cgl!"),t.tempTextureEmpty)return t.tempTextureEmpty;t.tempTextureEmpty=new w(t,{name:"emptyTexture"});const i=new Uint8Array(256).fill(0);for(let t=0;t<256;t+=4)i[t+3]=0;return t.tempTextureEmpty.initFromData(i,8,8,w.FILTER_NEAREST,w.WRAP_REPEAT),t.tempTextureEmpty},w.getEmptyTextureFloat=function(t){if(t||console.error("[getEmptyTextureFloat] no cgl!"),t.tempTextureEmptyFloat)return t.tempTextureEmptyFloat;t.tempTextureEmptyFloat=new w(t,{name:"emptyTexture",isFloatingPointTexture:!0});const e=new Float32Array(256).fill(1);for(let t=0;t<256;t+=4)e[t+3]=0;return t.tempTextureEmptyFloat.initFromData(e,8,8,w.FILTER_NEAREST,w.WRAP_REPEAT),t.tempTextureEmptyFloat},w.getRandomTexture=function(t){if(t||console.error("[getRandomTexture] no cgl!"),t.randomTexture)return t.randomTexture;const e=new Uint8Array(262144);for(let t=0;t<65536;t++)e[4*t+0]=255*Math.random(),e[4*t+1]=255*Math.random(),e[4*t+2]=255*Math.random(),e[4*t+3]=255;return t.randomTexture=new w(t),t.randomTexture.initFromData(e,256,256,w.FILTER_NEAREST,w.WRAP_REPEAT),t.randomTexture},w.getRandomFloatTexture=function(t){if(t||console.error("[getRandomTexture] no cgl!"),t.getRandomFloatTexture)return t.getRandomFloatTexture;const e=new Float32Array(262144);for(let t=0;t<65536;t++)e[4*t+0]=2*(Math.random()-.5),e[4*t+1]=2*(Math.random()-.5),e[4*t+2]=2*(Math.random()-.5),e[4*t+3]=1;return t.getRandomFloatTexture=new w(t,{isFloatingPointTexture:!0}),t.getRandomFloatTexture.initFromData(e,256,256,w.FILTER_NEAREST,w.WRAP_REPEAT),t.getRandomFloatTexture},w.getBlackTexture=function(t){if(t||this._log.error("[getBlackTexture] no cgl!"),t.blackTexture)return t.blackTexture;const e=new Uint8Array(256);for(let t=0;t<64;t++)e[4*t+0]=e[4*t+1]=e[4*t+2]=0,e[4*t+3]=255;return t.blackTexture=new w(t),t.blackTexture.initFromData(e,8,8,w.FILTER_NEAREST,w.WRAP_REPEAT),t.blackTexture},w.getEmptyCubemapTexture=function(t){const e=[t.gl.TEXTURE_CUBE_MAP_POSITIVE_X,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,t.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z],i=t.gl.createTexture(),s=t.gl.TEXTURE_CUBE_MAP,r=w.FILTER_NEAREST,n=w.WRAP_CLAMP_TO_EDGE;t.profileData.profileTextureNew++,t.gl.bindTexture(s,i),t.profileData.profileTextureResize++;for(let i=0;i<6;i+=1){const r=new Uint8Array(256);t.gl.texImage2D(e[i],0,t.gl.RGBA,8,8,0,t.gl.RGBA,t.gl.UNSIGNED_BYTE,r),t.gl.texParameteri(s,t.gl.TEXTURE_MAG_FILTER,t.gl.NEAREST),t.gl.texParameteri(s,t.gl.TEXTURE_MIN_FILTER,t.gl.NEAREST),t.gl.texParameteri(s,t.gl.TEXTURE_WRAP_S,t.gl.CLAMP_TO_EDGE),t.gl.texParameteri(s,t.gl.TEXTURE_WRAP_T,t.gl.CLAMP_TO_EDGE)}return t.gl.bindTexture(s,null),{id:CABLES.uuid(),tex:i,cubemap:i,width:8,height:8,filter:r,wrap:n,unpackAlpha:!0,flip:!0,_fromData:!0,name:"emptyCubemapTexture",anisotropic:0}},w.getTempGradientTexture=function(t){if(t||console.error("[getTempGradientTexture] no cgl!"),t.tempTextureGradient)return t.tempTextureGradient;const e=new w(t),i=256,s=new Uint8Array(262144);for(let t=0;t<i;t++)for(let e=0;e<i;e++)s[4*(e+t*i)+0]=s[4*(e+t*i)+1]=s[4*(e+t*i)+2]=255-t,s[4*(e+t*i)+3]=255;return e.initFromData(s,i,i,w.FILTER_NEAREST,w.WRAP_REPEAT),t.tempTextureGradient=e,e},w.getTemporaryTexture=function(t,e,i,s,r,n,o){void 0===r&&(r=1),void 0===n&&(n=1),void 0===o&&(o=1);const a=new w(t),h=[];for(let t=0;t<e;t++)for(let i=0;i<e;i++)(i+t)%64<32?(h.push((200+t/e*25+i/e*25)*r),h.push((200+t/e*25+i/e*25)*n),h.push((200+t/e*25+i/e*25)*o)):(h.push((40+t/e*25+i/e*25)*r),h.push((40+t/e*25+i/e*25)*n),h.push((40+t/e*25+i/e*25)*o)),h.push(255);const l=new Uint8Array(h);return a.initFromData(l,e,e,i,s),a},w.createFromImage=function(t,e,i){const s=new w(t,i=i||{});return s.flip=!1,s.image=e,s.width=e.width,s.height=e.height,i.hasOwnProperty("wrap")&&(s.wrap=i.wrap),s.initTexture(e,i.filter),s},w.fromImage=function(t,e,i,s){console.error("deprecated texture from image...");const r=new w(t);return r.flip=!1,i&&(r.filter=i),s&&(r.wrap=s),r.image=e,r.initTexture(e),r},w.isPowerOfTwo=function(t){return 1==t||2==t||4==t||8==t||16==t||32==t||64==t||128==t||256==t||512==t||1024==t||2048==t||4096==t||8192==t||16384==t},w.getTexInfo=function(t){const e={};e.name=t.name,e["power of two"]=t.isPowerOfTwo(),e.size=t.width+" x "+t.height;let i=t.texTarget;return t.texTarget==t._cgl.gl.TEXTURE_2D&&(i="TEXTURE_2D"),e.target=i,e.unpackAlpha=t.unpackAlpha,t.cubemap&&(e.cubemap=!0),t.textureType==w.TYPE_FLOAT&&(e.textureType="TYPE_FLOAT"),t.textureType==w.TYPE_HALF_FLOAT?e.textureType="TYPE_HALF_FLOAT":t.textureType==w.TYPE_DEPTH?e.textureType="TYPE_DEPTH":t.textureType==w.TYPE_DEFAULT?e.textureType="TYPE_DEFAULT":e.textureType="UNKNOWN "+this.textureType,t.wrap==w.WRAP_CLAMP_TO_EDGE?e.wrap="CLAMP_TO_EDGE":t.wrap==w.WRAP_REPEAT?e.wrap="WRAP_REPEAT":t.wrap==w.WRAP_MIRRORED_REPEAT?e.wrap="WRAP_MIRRORED_REPEAT":e.wrap="UNKNOWN",t.filter==w.FILTER_NEAREST?e.filter="FILTER_NEAREST":t.filter==w.FILTER_LINEAR?e.filter="FILTER_LINEAR":t.filter==w.FILTER_MIPMAP?e.filter="FILTER_MIPMAP":e.filter="UNKNOWN",e.pixelFormat=t.pixelFormat||"unknown",e},w.FILTER_NEAREST=0,w.FILTER_LINEAR=1,w.FILTER_MIPMAP=2,w.WRAP_REPEAT=0,w.WRAP_MIRRORED_REPEAT=1,w.WRAP_CLAMP_TO_EDGE=2,w.TYPE_DEFAULT=0,w.TYPE_DEPTH=1,w.TYPE_FLOAT=2,w.PFORMATSTR_RGB565="RGB 5/6/5bit ubyte",w.PFORMATSTR_R8UB="R 8bit ubyte",w.PFORMATSTR_RG8UB="RG 8bit ubyte",w.PFORMATSTR_RGB8UB="RGB 8bit ubyte",w.PFORMATSTR_RGBA8UB="RGBA 8bit ubyte",w.PFORMATSTR_R11FG11FB10F="RGB 11/11/10bit float",w.PFORMATSTR_R16F="R 16bit float",w.PFORMATSTR_RG16F="RG 16bit float",w.PFORMATSTR_RGB16F="RGB 16bit float",w.PFORMATSTR_RGBA16F="RGBA 16bit float",w.PFORMATSTR_R32F="R 32bit float",w.PFORMATSTR_RGBA32F="RGBA 32bit float",w.PFORMATSTR_DEPTH="DEPTH",w.PIXELFORMATS=[w.PFORMATSTR_RGB565,w.PFORMATSTR_R8UB,w.PFORMATSTR_RG8UB,w.PFORMATSTR_RGB8UB,w.PFORMATSTR_RGBA8UB,w.PFORMATSTR_R11FG11FB10F,w.PFORMATSTR_R16F,w.PFORMATSTR_RG16F,w.PFORMATSTR_RGBA16F,w.PFORMATSTR_R32F,w.PFORMATSTR_RGBA32F],w.isPixelFormatFloat=t=>(t||"").indexOf("float")>-1,w.isPixelFormatHalfFloat=t=>(t||"").indexOf("float")>-1&&(t||"").indexOf("16bit")>-1;const M=function(t,e,i,s){if(1==t.glVersion)return console.log("framebuffer2 used on webgl1");this._log=new r("cgl_framebuffer2"),this.Framebuffer2DrawTargetsDefault=null,this.Framebuffer2BlittingFramebuffer=null,this.Framebuffer2FinalFramebuffer=null,this._cgl=t,this._cgl.printError("before framebuffer2 constructor"),this._width=0,this._height=0,this.valid=!0,this._depthRenderbuffer=null,this._frameBuffer=null,this._textureFrameBuffer=null,this._colorRenderbuffers=[],this._drawTargetArray=[],this._disposed=!1,this.Framebuffer2BlittingFramebuffer||(this.Framebuffer2BlittingFramebuffer=t.gl.createFramebuffer()),this.Framebuffer2FinalFramebuffer||(this.Framebuffer2FinalFramebuffer=t.gl.createFramebuffer()),this.Framebuffer2DrawTargetsDefault||(this.Framebuffer2DrawTargetsDefault=[t.gl.COLOR_ATTACHMENT0]),this._options=s||{isFloatingPointTexture:!1},this.name=this._options.name||"unknown",this._cgl.profileData.addHeavyEvent("framebuffer create",this.name),this._options.hasOwnProperty("numRenderBuffers")||(this._options.numRenderBuffers=1),this._options.hasOwnProperty("depth")||(this._options.depth=!0),this._options.hasOwnProperty("clear")||(this._options.clear=!0),this._options.hasOwnProperty("multisampling")||(this._options.multisampling=!1,this._options.multisamplingSamples=0),this._options.multisamplingSamples&&(this._cgl.glSlowRenderer&&(this._options.multisamplingSamples=0),this._cgl.gl.MAX_SAMPLES?this._options.multisamplingSamples=Math.min(this._cgl.maxSamples,this._options.multisamplingSamples):this._options.multisamplingSamples=0),this._options.hasOwnProperty("filter")||(this._options.filter=w.FILTER_LINEAR),this._options.hasOwnProperty("wrap")||(this._options.wrap=w.WRAP_REPEAT),this._numRenderBuffers=this._options.numRenderBuffers,this._colorTextures=[],s.pixelFormat||(s.isFloatingPointTexture?this._options.pixelFormat=w.PFORMATSTR_RGBA32F:this._options.pixelFormat=w.PFORMATSTR_RGBA8UB);for(let e=0;e<this._numRenderBuffers;e++)this._colorTextures[e]=new w(t,{name:"fb2 "+this.name+" "+e,isFloatingPointTexture:this._options.isFloatingPointTexture,pixelFormat:this._options.pixelFormat,filter:this._options.filter,wrap:this._options.wrap});let n=w.FILTER_NEAREST;this._options.shadowMap&&(n=w.FILTER_LINEAR);const o=512;this._options.depth&&(this._textureDepth=new w(t,{name:"fb2 depth "+this.name,isDepthTexture:!0,filter:n,shadowMap:this._options.shadowMap||!1,width:e||o,height:i||o})),t.aborted||(this.setSize(e||o,i||o),this._cgl.printError("framebuffer2 constructor"))};M.prototype.getWidth=function(){return this._width},M.prototype.getHeight=function(){return this._height},M.prototype.getGlFrameBuffer=function(){return this._frameBuffer},M.prototype.getDepthRenderBuffer=function(){return this._depthRenderbuffer},M.prototype.getTextureColor=function(){return this._colorTextures[0]},M.prototype.getTextureColorNum=function(t){return this._colorTextures[t]},M.prototype.getTextureDepth=function(){return this._textureDepth},M.prototype.setFilter=function(t){for(let e=0;e<this._numRenderBuffers;e++)this._colorTextures[e].filter=t,this._colorTextures[e].setSize(this._width,this._height)},M.prototype.delete=M.prototype.dispose=function(){this._disposed=!0;let t=0;for(t=0;t<this._numRenderBuffers;t++)this._colorTextures[t].delete();for(this._textureDepth&&this._textureDepth.delete(),t=0;t<this._numRenderBuffers;t++)this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffers[t]);this._cgl.gl.deleteRenderbuffer(this._depthRenderbuffer),this._cgl.gl.deleteFramebuffer(this._frameBuffer),this._cgl.gl.deleteFramebuffer(this._textureFrameBuffer)},M.prototype.setSize=function(t,e){if(this._disposed)return this._log.warn("disposed framebuffer setsize...");this._cgl.profileData.addHeavyEvent("framebuffer resize",this.name);let i=0;if(this._width=Math.floor(t),this._height=Math.floor(e),this._width=Math.min(this._width,this._cgl.maxTexSize),this._height=Math.min(this._height,this._cgl.maxTexSize),this._cgl.profileData.profileFrameBuffercreate++,this._frameBuffer){for(i=0;i<this._numRenderBuffers;i++)this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffers[i]);this._cgl.gl.deleteRenderbuffer(this._depthRenderbuffer),this._cgl.gl.deleteFramebuffer(this._frameBuffer),this._cgl.gl.deleteFramebuffer(this._textureFrameBuffer)}this._frameBuffer=this._cgl.gl.createFramebuffer(),this._textureFrameBuffer=this._cgl.gl.createFramebuffer();const s=this._options.depth;for(i=0;i<this._numRenderBuffers;i++)this._colorTextures[i].setSize(this._width,this._height);for(i=0;i<this._numRenderBuffers;i++){const t=this._cgl.gl.createRenderbuffer();this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,t);const e=w.setUpGlPixelFormat(this._cgl,this._options.pixelFormat);let s=e.glInternalFormat;CGL.Texture.isPixelFormatHalfFloat(e.pixelFormat)?(this._cgl.enableExtension("EXT_color_buffer_half_float"),this._cgl.enableExtension("OES_texture_float_linear")||(this._options.filter=w.FILTER_NEAREST,this.setFilter(this._options.filter))):CGL.Texture.isPixelFormatFloat(e.pixelFormat)&&(this._cgl.enableExtension("OES_texture_float_linear")||(console.log("no linear pixelformat,using nearest"),this._options.filter=w.FILTER_NEAREST,this.setFilter(this._options.filter))),this._options.multisampling&&this._options.multisamplingSamples?this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER,this._options.multisamplingSamples,s,this._width,this._height):this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,s,this._width,this._height),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0+i,this._cgl.gl.RENDERBUFFER,t),this._colorRenderbuffers[i]=t}for(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._textureFrameBuffer),i=0;i<this._numRenderBuffers;i++)this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0+i,this._cgl.gl.TEXTURE_2D,this._colorTextures[i].tex,0);this._options.depth&&this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.TEXTURE_2D,this._textureDepth.tex,0),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer);let r=this._cgl.gl.DEPTH_COMPONENT32F;for(this._cgl.glSlowRenderer&&(r=this._cgl.gl.DEPTH_COMPONENT16),s&&(this._textureDepth.setSize(this._width,this._height),this._depthRenderbuffer=this._cgl.gl.createRenderbuffer(),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._depthRenderbuffer),this._options.isFloatingPointTexture,this._options.multisampling?this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER,this._options.multisamplingSamples,r,this._width,this._height):this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,r,this._width,this._height),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthRenderbuffer)),this._drawTargetArray.length=0,i=0;i<this._numRenderBuffers;i++)this._drawTargetArray.push(this._cgl.gl.COLOR_ATTACHMENT0+i);this._cgl.gl.isFramebuffer(this._textureFrameBuffer)||this._log.warn("invalid framebuffer");const n=this._cgl.gl.checkFramebufferStatus(this._cgl.gl.FRAMEBUFFER);if(n!=this._cgl.gl.FRAMEBUFFER_COMPLETE)switch(this._log.error("framebuffer incomplete: "+this.name,this),n){case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT...",this),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");case this._cgl.gl.FRAMEBUFFER_UNSUPPORTED:throw this._log.warn("FRAMEBUFFER_UNSUPPORTED"),new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");default:throw this.valid=!1,this._log.warn("incomplete framebuffer",n,this._frameBuffer),this._cgl.printError(),this._cgl.exitError("Framebuffer incomplete..."),this._frameBuffer=null,new Error("Incomplete framebuffer: "+n)}this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null)},M.prototype.renderStart=function(){if(this._disposed)return this._log.warn("disposed framebuffer renderStart...");this._cgl.checkFrameStarted("fb2 renderstart"),this._cgl.pushModelMatrix(),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer),this._cgl.pushGlFrameBuffer(this._frameBuffer),this._cgl.pushFrameBuffer(this),this._cgl.pushPMatrix(),this._cgl.pushViewPort(0,0,this._width,this._height),this._cgl.gl.drawBuffers(this._drawTargetArray),this._options.clear&&(this._cgl.gl.clearColor(0,0,0,0),this._cgl.gl.clear(this._cgl.gl.COLOR_BUFFER_BIT|this._cgl.gl.DEPTH_BUFFER_BIT))},M.prototype.clear=function(){this._numRenderBuffers<=1?(this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER,this._frameBuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER,this._textureFrameBuffer)):this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuffer),this._cgl.gl.drawBuffers(this._drawTargetArray);for(let t=0;t<this._numRenderBuffers;t++)this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0+t,this._cgl.gl.TEXTURE_2D,this._colorTextures[t].tex,0),this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR,t,[0,0,0,0]);this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null)},M.prototype.renderEnd=function(){if(this._disposed)return this._log.warn("disposed framebuffer renderEnd...");if(this._cgl.popPMatrix(),this._cgl.profileData.profileFramebuffer++,this._numRenderBuffers<=1)this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER,this._frameBuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER,this._textureFrameBuffer),this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR,0,[0,0,0,1]),this._cgl.gl.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,this._cgl.gl.COLOR_BUFFER_BIT|this._cgl.gl.DEPTH_BUFFER_BIT,this._cgl.gl.NEAREST);else{this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2BlittingFramebuffer),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthRenderbuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2FinalFramebuffer),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.TEXTURE_2D,this._textureDepth.tex,0);for(let t=0;t<this._numRenderBuffers;t++){this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2BlittingFramebuffer),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.RENDERBUFFER,this._colorRenderbuffers[t]),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this.Framebuffer2FinalFramebuffer),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.TEXTURE_2D,this._colorTextures[t].tex,0),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER,this.Framebuffer2BlittingFramebuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER,this.Framebuffer2FinalFramebuffer);let e=this._cgl.gl.COLOR_BUFFER_BIT;0==t&&(e|=this._cgl.gl.DEPTH_BUFFER_BIT),this._cgl.gl.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,e,this._cgl.gl.NEAREST)}}if(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.popGlFrameBuffer()),this._cgl.popFrameBuffer(),this._cgl.popModelMatrix(),this._cgl.popViewPort(),this._colorTextures[0].filter==w.FILTER_MIPMAP)for(let t=0;t<this._numRenderBuffers;t++)this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,this._colorTextures[t].tex),this._colorTextures[t].updateMipMap(),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null)};const U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=new Uint8Array(256);for(let t=0;t<U.length;t++)B[U.charCodeAt(t)]=t;const L=B,k=function(t){t.buffer&&(t=t.buffer);let e,i=new Uint8Array(t),s=i.length,r="";for(e=0;e<s;e+=3)r+=U[i[e]>>2],r+=U[(3&i[e])<<4|i[e+1]>>4],r+=U[(15&i[e+1])<<2|i[e+2]>>6],r+=U[63&i[e+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},D=function(t){let e,i,s,r,n,o=.75*t.length,a=t.length,h=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);let l=new ArrayBuffer(o),c=new Uint8Array(l);for(e=0;e<a;e+=4)i=L[t.charCodeAt(e)],s=L[t.charCodeAt(e+1)],r=L[t.charCodeAt(e+2)],n=L[t.charCodeAt(e+3)],c[h++]=i<<2|s>>4,c[h++]=(15&s)<<4|r>>2,c[h++]=(3&r)<<6|63&n;return l};class V{constructor(t){this._init(),this._first=!0,this._wireMesh=null,t&&this.apply(t)}_init(){this._max=[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE],this._min=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this._center=[0,0,0],this._size=[0,0,0],this._maxAxis=0,this._first=!0}get maxAxis(){return this._maxAxis||1}get size(){return this._size}get center(){return this._center}get x(){return this._center[0]}get y(){return this._center[1]}get z(){return this._center[2]}get minX(){return this._min[0]}get minY(){return this._min[1]}get minZ(){return this._min[2]}get maxX(){return this._max[0]}get maxY(){return this._max[1]}get maxZ(){return this._max[2]}apply(t,e){if(t){if(t instanceof V){const e=t;this.applyPos(e.maxX,e.maxY,e.maxZ),this.applyPos(e.minX,e.minY,e.minZ)}else for(let e=0;e<t.vertices.length;e+=3)this.applyPos(t.vertices[e],t.vertices[e+1],t.vertices[e+2]);this.calcCenterSize()}}copy(){return new V(this)}get changed(){return!(this._max[0]==-Number.MAX_VALUE&&this._max[1]==-Number.MAX_VALUE&&this._max[2]==-Number.MAX_VALUE)}applyPos(t,e,i){if(t!=Number.MAX_VALUE&&t!=-Number.MAX_VALUE&&e!=Number.MAX_VALUE&&e!=-Number.MAX_VALUE&&i!=Number.MAX_VALUE&&i!=-Number.MAX_VALUE&&CABLES.UTILS.isNumeric(t)&&CABLES.UTILS.isNumeric(e)&&CABLES.UTILS.isNumeric(i)){if(this._first)return this._max[0]=t,this._max[1]=e,this._max[2]=i,this._min[0]=t,this._min[1]=e,this._min[2]=i,void(this._first=!1);this._max[0]=Math.max(this._max[0],t),this._max[1]=Math.max(this._max[1],e),this._max[2]=Math.max(this._max[2],i),this._min[0]=Math.min(this._min[0],t),this._min[1]=Math.min(this._min[1],e),this._min[2]=Math.min(this._min[2],i)}}calcCenterSize(){this._first||(this._size[0]=this._max[0]-this._min[0],this._size[1]=this._max[1]-this._min[1],this._size[2]=this._max[2]-this._min[2],this._center[0]=(this._min[0]+this._max[0])/2,this._center[1]=(this._min[1]+this._max[1])/2,this._center[2]=(this._min[2]+this._max[2])/2,this._maxAxis=Math.max(this._size[2],Math.max(this._size[0],this._size[1])))}mulMat4(t){this._first&&(this._max[0]=0,this._max[1]=0,this._max[2]=0,this._min[0]=0,this._min[1]=0,this._min[2]=0,this._first=!1),vec3.transformMat4(this._max,this._max,t),vec3.transformMat4(this._min,this._min,t),this.calcCenterSize()}render(t,e){this._wireMesh||(this._wireMesh=new CGL.WireCube(t)),t.pushModelMatrix(),mat4.translate(t.mMatrix,t.mMatrix,this._center),this._wireMesh.render(t,this._size[0]/2,this._size[1]/2,this._size[2]/2),t.popModelMatrix()}}const G=function(t){this.name=t||"unknown",this._log=new r("cgl_geometry"),this.faceVertCount=3,this.glPrimitive=null,this._attributes={},this._vertices=[],this.verticesIndices=[],this.isGeometry=!0,this.morphTargets=[],Object.defineProperty(this,"vertices",{get(){return this._vertices},set(t){this.setVertices(t)}}),Object.defineProperty(this,"texCoords",{get(){const t=this.getAttribute("texCoords");return t?t.data:[]},set(t){this.setAttribute("texCoords",t,2)}}),Object.defineProperty(this,"vertexNormals",{get(){const t=this.getAttribute("vertexNormals");return t?t.data:[]},set(t){this.setAttribute("vertexNormals",t,3)}}),Object.defineProperty(this,"tangents",{get(){const t=this.getAttribute("tangents");return t?t.data:[]},set(t){this.setAttribute("tangents",t,3)}}),Object.defineProperty(this,"biTangents",{get(){const t=this.getAttribute("biTangents");return t?t.data:[]},set(t){this.setAttribute("biTangents",t,3)}}),Object.defineProperty(this,"vertexColors",{get(){const t=this.getAttribute("vertexColors");return t?t.data:[]},set(t){this.setAttribute("vertexColors",t,4)}})};G.prototype.clear=function(){this._vertices=new Float32Array([]),this.verticesIndices=[],this.texCoords=new Float32Array([]),this.vertexNormals=new Float32Array([]),this.tangents=[],this.biTangents=[],this._attributes={}},G.prototype.getAttributes=function(){return this._attributes},G.prototype.getAttribute=function(t){for(const e in this._attributes)if(this._attributes[e].name==t)return this._attributes[e];return null},G.prototype.setAttribute=function(t,e,i){let s="";(!i||i>4)&&(console.log("itemsize wrong?",i,t),this._log.stack("itemsize"),i=3),1==i?s="float":2==i?s="vec2":3==i?s="vec3":4==i&&(s="vec4");const r={name:t,data:e,itemSize:i,type:s};this._attributes[t]=r},G.prototype.copyAttribute=function(t,e){const i=this.getAttribute(t);e.setAttribute(t,new Float32Array(i.data),i.itemSize)},G.prototype.setVertices=function(t){t instanceof Float32Array?this._vertices=t:this._vertices=new Float32Array(t)},G.prototype.setTexCoords=function(t){t instanceof Float32Array?this.texCoords=t:this.texCoords=new Float32Array(t)},G.prototype.calcNormals=function(t){const e={smooth:t};this.calculateNormals(e)},G.prototype.flipNormals=function(t,e,i){let s=vec3.create();null==t&&(t=1),null==e&&(e=1),null==i&&(i=1);for(let r=0;r<this.vertexNormals.length;r+=3)vec3.set(s,this.vertexNormals[r+0],this.vertexNormals[r+1],this.vertexNormals[r+2]),s[0]*=-t,s[1]*=-e,s[2]*=-i,vec3.normalize(s,s),this.vertexNormals[r+0]=s[0],this.vertexNormals[r+1]=s[1],this.vertexNormals[r+2]=s[2]},G.prototype.getNumTriangles=function(){return this.verticesIndices&&this.verticesIndices.length?this.verticesIndices.length/3:this.vertices.length/3},G.prototype.flipVertDir=function(){const t=[];t.length=this.verticesIndices.length;for(let e=0;e<this.verticesIndices.length;e+=3)t[e]=this.verticesIndices[e+2],t[e+1]=this.verticesIndices[e+1],t[e+2]=this.verticesIndices[e];this.verticesIndices=t},G.prototype.setPointVertices=function(t){if(t.length%3==0){t instanceof Float32Array?this.vertices=t:this.vertices=new Float32Array(t),this.texCoords instanceof Float32Array||(this.texCoords=new Float32Array(t.length/3*2)),this.verticesIndices.length=t.length/3;for(let e=0;e<t.length/3;e++)this.verticesIndices[e]=e,this.texCoords[2*e]=0,this.texCoords[2*e+1]=0}else this._log.error("SetPointVertices: Array must be multiple of three.")},G.prototype.merge=function(t){if(!t)return;if(this.isIndexed()!=t.isIndexed()&&(this.isIndexed()&&this.unIndex(!1,!0),t.isIndexed())){const e=t.copy();e.unIndex(!1,!0),t=e}const e=this.verticesIndices.length,i=this._vertices.length/3;this.verticesIndices.length=this.verticesIndices.length+t.verticesIndices.length;for(let s=0;s<t.verticesIndices.length;s++)this.verticesIndices[e+s]=t.verticesIndices[s]+i;this.vertices=l.float32Concat(this._vertices,t.vertices),this.texCoords=l.float32Concat(this.texCoords,t.texCoords),this.vertexNormals=l.float32Concat(this.vertexNormals,t.vertexNormals),this.tangents=l.float32Concat(this.tangents,t.tangents),this.biTangents=l.float32Concat(this.biTangents,t.biTangents)},G.prototype.copy=function(){const t=new G(this.name+" copy");if(t.faceVertCount=this.faceVertCount,t.glPrimitive=this.glPrimitive,t.setVertices(this._vertices.slice(0)),this.verticesIndices){t.verticesIndices.length=this.verticesIndices.length;for(let e=0;e<this.verticesIndices.length;e++)t.verticesIndices[e]=this.verticesIndices[e]}for(let e in this._attributes)this.copyAttribute(e,t);t.morphTargets.length=this.morphTargets.length;for(let e=0;e<this.morphTargets.length;e++)t.morphTargets[e]=this.morphTargets[e];return t},G.prototype.calculateNormals=function(t){!1===(t=t||{}).smooth&&this.unIndex();const e=vec3.create(),i=vec3.create(),s=vec3.create();function r(r){return vec3.subtract(e,r[0],r[1]),vec3.subtract(i,r[0],r[2]),vec3.cross(s,e,i),vec3.normalize(s,s),t&&t.forceZUp&&s[2]<0&&(s[0]*=-1,s[1]*=-1,s[2]*=-1),s}this.getVertexVec=function(t){const e=[0,0,0];return e[0]=this.vertices[3*t+0],e[1]=this.vertices[3*t+1],e[2]=this.vertices[3*t+2],e},this.vertexNormals instanceof Float32Array&&this.vertexNormals.length==this.vertices.length||(this.vertexNormals=new Float32Array(this.vertices.length));for(let t=0;t<this.vertices.length;t++)this.vertexNormals[t]=0;if(this.isIndexed()){const t=[];t.length=Math.floor(this.verticesIndices.length/3);for(let e=0;e<this.verticesIndices.length;e+=3){const i=[this.getVertexVec(this.verticesIndices[e+0]),this.getVertexVec(this.verticesIndices[e+1]),this.getVertexVec(this.verticesIndices[e+2])];t[e/3]=r(i),this.vertexNormals[3*this.verticesIndices[e+0]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+0]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+0]+2]+=t[e/3][2],this.vertexNormals[3*this.verticesIndices[e+1]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+1]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+1]+2]+=t[e/3][2],this.vertexNormals[3*this.verticesIndices[e+2]+0]+=t[e/3][0],this.vertexNormals[3*this.verticesIndices[e+2]+1]+=t[e/3][1],this.vertexNormals[3*this.verticesIndices[e+2]+2]+=t[e/3][2]}for(let t=0;t<this.verticesIndices.length;t+=3)for(let e=0;e<3;e++){const i=[this.vertexNormals[3*this.verticesIndices[t+e]+0],this.vertexNormals[3*this.verticesIndices[t+e]+1],this.vertexNormals[3*this.verticesIndices[t+e]+2]];vec3.normalize(i,i),this.vertexNormals[3*this.verticesIndices[t+e]+0]=i[0],this.vertexNormals[3*this.verticesIndices[t+e]+1]=i[1],this.vertexNormals[3*this.verticesIndices[t+e]+2]=i[2]}}else{const t=[];for(let e=0;e<this.vertices.length;e+=9){const i=r([[this.vertices[e+0],this.vertices[e+1],this.vertices[e+2]],[this.vertices[e+3],this.vertices[e+4],this.vertices[e+5]],[this.vertices[e+6],this.vertices[e+7],this.vertices[e+8]]]);t.push(i[0],i[1],i[2],i[0],i[1],i[2],i[0],i[1],i[2])}this.vertexNormals=t}},G.prototype.calcTangentsBitangents=function(){if(!this.vertices.length)return;if(!this.vertexNormals.length)return;if(!this.texCoords.length){const t=this.vertices.length/3*2;this.texCoords=new Float32Array(t);for(let e=0;e<t;e+=1)this.texCoords[e]=0}if(!this.verticesIndices||!this.verticesIndices.length)return;if(this.verticesIndices.length%3!=0)return void this._log.error("Vertex indices mismatch!");const t=this.verticesIndices.length/3,e=this.vertices.length/3;this.tangents=new Float32Array(this.vertexNormals.length),this.biTangents=new Float32Array(this.vertexNormals.length);const i=[];i.length=2*e;const s=vec3.create(),r=vec3.create(),n=vec3.create(),o=vec2.create(),a=vec2.create(),h=vec2.create(),l=vec3.create(),c=vec3.create();for(let u=0;u<t;u+=1){const t=this.verticesIndices[3*u],p=this.verticesIndices[3*u+1],_=this.verticesIndices[3*u+2];vec3.set(s,this.vertices[3*t],this.vertices[3*t+1],this.vertices[3*t+2]),vec3.set(r,this.vertices[3*p],this.vertices[3*p+1],this.vertices[3*p+2]),vec3.set(n,this.vertices[3*_],this.vertices[3*_+1],this.vertices[3*_+2]),vec2.set(o,this.texCoords[2*t],this.texCoords[2*t+1]),vec2.set(a,this.texCoords[2*p],this.texCoords[2*p+1]),vec2.set(h,this.texCoords[2*_],this.texCoords[2*_+1]);const g=r[0]-s[0],d=n[0]-s[0],f=r[1]-s[1],m=n[1]-s[1],E=r[2]-s[2],T=n[2]-s[2],A=a[0]-o[0],b=h[0]-o[0],x=a[1]-o[1],v=h[1]-o[1],y=1/(A*v-b*x);vec3.set(l,(v*g-x*d)*y,(v*f-x*m)*y,(v*E-x*T)*y),vec3.set(c,(A*d-b*g)*y,(A*m-b*f)*y,(A*T-b*E)*y),i[t]=l,i[p]=l,i[_]=l,i[t+e]=c,i[p+e]=c,i[_+e]=c}const u=vec3.create(),p=vec3.create(),_=vec3.create(),g=vec3.create(),d=vec3.create(),f=vec3.create(),m=vec3.create(),E=vec3.create();for(let t=0;t<e;t+=1){if(!i[t])continue;vec3.set(u,this.vertexNormals[3*t],this.vertexNormals[3*t+1],this.vertexNormals[3*t+2]),vec3.set(p,i[t][0],i[t][1],i[t][2]);const s=vec3.dot(u,p);vec3.scale(d,u,s),vec3.subtract(f,p,d),vec3.normalize(E,f),vec3.cross(m,u,p),vec3.dot(m,i[t+e]);const r=1;vec3.scale(_,E,1/r),vec3.cross(g,u,_),this.tangents[3*t+0]=_[0],this.tangents[3*t+1]=_[1],this.tangents[3*t+2]=_[2],this.biTangents[3*t+0]=g[0],this.biTangents[3*t+1]=g[1],this.biTangents[3*t+2]=g[2]}},G.prototype.isIndexed=function(){return 0==this._vertices.length||0!=this.verticesIndices.length},G.prototype.unIndex=function(t,e){const i=[],s=[];let r=0;for(let t in this._attributes){const e=this._attributes[t];let i=[];for(let t=0;t<this.verticesIndices.length;t+=3)for(let s=0;s<3;s++)3==e.itemSize?i.push(e.data[3*this.verticesIndices[t+s]+0],e.data[3*this.verticesIndices[t+s]+1],e.data[3*this.verticesIndices[t+s]+2]):4==e.itemSize?i.push(e.data[4*this.verticesIndices[t+s]+0],e.data[4*this.verticesIndices[t+s]+1],e.data[4*this.verticesIndices[t+s]+2],e.data[4*this.verticesIndices[t+s]+3]):2==e.itemSize?i.push(e.data[2*this.verticesIndices[t+s]+0],e.data[2*this.verticesIndices[t+s]+1]):1==e.itemSize?i.push(e.data[this.verticesIndices[t+s]]):console.log("unknown attr",e);this.setAttribute(e.name,i,e.itemSize)}for(let t=0;t<this.verticesIndices.length;t+=3)i.push(this.vertices[3*this.verticesIndices[t+0]+0],this.vertices[3*this.verticesIndices[t+0]+1],this.vertices[3*this.verticesIndices[t+0]+2]),s.push(r),r++,i.push(this.vertices[3*this.verticesIndices[t+1]+0],this.vertices[3*this.verticesIndices[t+1]+1],this.vertices[3*this.verticesIndices[t+1]+2]),s.push(r),r++,i.push(this.vertices[3*this.verticesIndices[t+2]+0],this.vertices[3*this.verticesIndices[t+2]+1],this.vertices[3*this.verticesIndices[t+2]+2]),s.push(r),r++;this.vertices=i,this.verticesIndices=[],t&&(this.verticesIndices=s),e||this.calculateNormals()},G.prototype.calcBarycentric=function(){let t=[];t.length=this.vertices.length;for(let e=0;e<this.vertices.length;e++)t[e]=0;let e=0;for(let i=0;i<this.vertices.length;i+=3)t[i+e]=1,e++,3==e&&(e=0);this.setAttribute("attrBarycentric",t,3)},G.prototype.getBounds=function(){return new V(this)},G.prototype.center=function(t,e,i){void 0===t&&(t=!0,e=!0,i=!0);let s=0;const r=this.getBounds(),n=[r.minX+(r.maxX-r.minX)/2,r.minY+(r.maxY-r.minY)/2,r.minZ+(r.maxZ-r.minZ)/2];for(s=0;s<this.vertices.length;s+=3)this.vertices[s+0]==this.vertices[s+0]&&(t&&(this.vertices[s+0]-=n[0]),e&&(this.vertices[s+1]-=n[1]),i&&(this.vertices[s+2]-=n[2]));return n},G.prototype.mapTexCoords2d=function(){const t=this.getBounds(),e=this.vertices.length/3;this.texCoords=new Float32Array(2*e);for(let i=0;i<e;i++){const e=this.vertices[3*i+0],s=this.vertices[3*i+1];this.texCoords[2*i+0]=e/(t.maxX-t.minX)+.5,this.texCoords[2*i+1]=1-s/(t.maxY-t.minY)+.5}},G.prototype.getInfoOneLine=function(){let t="";return 3==this.faceVertCount&&this.verticesIndices?t+=this.verticesIndices.length/3:t+=0,t+=" tris ",this.vertices?t+=this.vertices.length/3:t+=0,t+=" verts",t},G.prototype.getInfo=function(){const t={};return 3==this.faceVertCount&&this.verticesIndices?t.numFaces=this.verticesIndices.length/3:t.numFaces=0,this.verticesIndices&&this.verticesIndices.length&&(t.indices=this.verticesIndices.length),this.vertices?t.numVerts=this.vertices.length/3:t.numVerts=0,this.vertexNormals?t.numNormals=this.vertexNormals.length/3:t.numNormals=0,this.texCoords?t.numTexCoords=this.texCoords.length/2:t.numTexCoords=0,this.tangents?t.numTangents=this.tangents.length/3:t.numTangents=0,this.biTangents?t.numBiTangents=this.biTangents.length/3:t.numBiTangents=0,this.biTangents?t.numBiTangents=this.biTangents.length/3:t.numBiTangents=0,this.vertexColors?t.numVertexColors=this.vertexColors.length/4:t.numVertexColors=0,this.getAttributes()?t.numAttribs=Object.keys(this.getAttributes()).length:t.numAttribs=0,t.isIndexed=this.isIndexed(),t},G.buildFromFaces=function(t,e,i){const s=[],r=[];for(let e=0;e<t.length;e+=3){const n=t[e+0],o=t[e+1],a=t[e+2],h=[-1,-1,-1];if(i)for(let t=0;t<s.length;t+=3)s[t+0]==n[0]&&s[t+1]==n[1]&&s[t+2]==n[2]&&(h[0]=t/3),s[t+0]==o[0]&&s[t+1]==o[1]&&s[t+2]==o[2]&&(h[1]=t/3),s[t+0]==a[0]&&s[t+1]==a[1]&&s[t+2]==a[2]&&(h[2]=t/3);-1==h[0]&&(s.push(n[0],n[1],n[2]),h[0]=(s.length-1)/3),-1==h[1]&&(s.push(o[0],o[1],o[2]),h[1]=(s.length-1)/3),-1==h[2]&&(s.push(a[0],a[1],a[2]),h[2]=(s.length-1)/3),r.push(parseInt(h[0],10)),r.push(parseInt(h[1],10)),r.push(parseInt(h[2],10))}const n=new G(e);return n.name=e,n.vertices=s,n.verticesIndices=r,n},G.json2geom=function(t){const e=new G("jsonMeshGeom");if(e.verticesIndices=[],e.vertices=t.vertices||[],e.vertexNormals=t.normals||[],e.vertexColors=t.colors||[],e.tangents=t.tangents||[],e.biTangents=t.bitangents||[],t.texturecoords&&e.setTexCoords(t.texturecoords[0]),t.vertices_b64&&(e.vertices=new Float32Array(D(t.vertices_b64))),t.normals_b64&&(e.vertexNormals=new Float32Array(D(t.normals_b64))),t.tangents_b64&&(e.tangents=new Float32Array(D(t.tangents_b64))),t.bitangents_b64&&(e.biTangents=new Float32Array(D(t.bitangents_b64))),t.texturecoords_b64&&e.setTexCoords(new Float32Array(D(t.texturecoords_b64[0]))),t.faces_b64)e.verticesIndices=new Uint32Array(D(t.faces_b64));else{e.verticesIndices.length=3*t.faces.length;for(let i=0;i<t.faces.length;i++)e.verticesIndices[3*i]=t.faces[i][0],e.verticesIndices[3*i+1]=t.faces[i][1],e.verticesIndices[3*i+2]=t.faces[i][2]}return e};const H=function(){this._log=new r("eventtaget"),this._eventCallbacks={},this._logName="",this._logEvents=!1,this._listeners={},CABLES.eventTargetProfile=CABLES.eventTargetProfile||{},this.addEventListener=this.on=function(t,e,i){const s={id:(i||"")+CABLES.simpleId(),name:t,cb:e};return this._eventCallbacks[t]?this._eventCallbacks[t].push(s):this._eventCallbacks[t]=[s],this._listeners[s.id]=s,s.id},this.hasEventListener=function(t,e){return t&&!e?!!this._listeners[t]:(this._log.warn("old eventtarget function haseventlistener!"),t&&e&&this._eventCallbacks[t]?-1!=this._eventCallbacks[t].indexOf(e):void 0)},this.removeEventListener=this.off=function(t,e){if(null==t)return;if(!e){const e=this._listeners[t];if(!e)return void console.log("could not find event...");let i=!0;for(;i;){i=!1;let s=-1;for(let r=0;r<this._eventCallbacks[e.name].length;r++)0===this._eventCallbacks[e.name][r].id.indexOf(t)&&(i=!0,s=r);-1!==s&&(this._eventCallbacks[e.name].splice(s,1),delete this._listeners[t])}return}this._log.stack(" old function signature: removeEventListener! use listener id");let i=null;for(let s=0;s<this._eventCallbacks[t].length;s++)this._eventCallbacks[t][s].cb==e&&(i=s);null!==i?delete this._eventCallbacks[i]:this._log.warn("removeEventListener not found "+t)},this.logEvents=function(t,e){this._logEvents=t,this._logName=e},this.emitEvent=function(t,e,i,s,r,n,o){if(this._logEvents&&console.log("[event] ",this._logName,t,this._eventCallbacks),this._eventCallbacks[t]){const a=[];for(let e=0;e<this._eventCallbacks[t].length;e++)a[t]||(a[t]=[]),a[t].push(this._eventCallbacks[t][e]);if(a[t])for(let h=0;h<a[t].length;h++)if(a[t][h]){const l=this.constructor.name+" "+t;CABLES.eventTargetProfile[l]=CABLES.eventTargetProfile[l]||{name:this.constructor.name,event:t,count:0},CABLES.eventTargetProfile[l].active=this._eventCallbacks[t].length,CABLES.eventTargetProfile[l].count++,a[t][h].cb(e,i,s,r,n,o)}}else this._logEvents&&console.log("[event] has no event callback",t,this._eventCallbacks)}},z=function(t){this.time=0,this.value=0,this.onChange=null,this._easing=0,this.cb=null,this.cbTriggered=!1,this.setEasing(n.EASING_LINEAR),this.set(t)};z.cubicSpline=function(t,e,i){let s=t*t,r=s*t;return(2*r-3*s+1)*e.value+(r-2*s+t)*e.bezTangOut+(-2*r+3*s)*i.value+(r-s)*i.bezTangIn},z.easeCubicSpline=function(t,e){return z.cubicSpline(t,this,e)},z.linear=function(t,e,i){return parseFloat(e.value)+parseFloat(i.value-e.value)*t},z.easeLinear=function(t,e){return z.linear(t,this,e)},z.easeAbsolute=function(t,e){return this.value},z.easeExpoIn=function(t,e){return t=function(t){return 2**(10*(t-1))}(t),z.linear(t,this,e)},z.easeExpoOut=function(t,e){return t=function(t){return 1-2**(-10*t)}(t),z.linear(t,this,e)},z.easeExpoInOut=function(t,e){return t=function(t){return(t*=2)<1?.5*2**(10*(t-1)):.5*(2-2**(-10*--t))}(t),z.linear(t,this,e)},z.easeSinIn=function(t,e){return t=-1*Math.cos(t*Math.PI/2)+1,z.linear(t,this,e)},z.easeSinOut=function(t,e){return t=Math.sin(t*Math.PI/2),z.linear(t,this,e)},z.easeSinInOut=function(t,e){return t=-.5*(Math.cos(Math.PI*t)-1),z.linear(t,this,e)},z.easeCubicIn=function(t,e){return t=function(t){return t*(t*t)}(t),z.linear(t,this,e)},z.easeInQuint=function(t,e){return z.linear(t*=t*t*t*t,this,e)},z.easeOutQuint=function(t,e){return t=(t-=1)*t*t*t*t+1,z.linear(t,this,e)},z.easeInOutQuint=function(t,e){return(t/=.5)<1?t*=.5*t*t*t*t:t=.5*((t-=2)*t*t*t*t+2),z.linear(t,this,e)},z.easeInQuart=function(t,e){return z.linear(t*=t*t*t,this,e)},z.easeOutQuart=function(t,e){return t=-1*((t-=1)*t*t*t-1),z.linear(t,this,e)},z.easeInOutQuart=function(t,e){return(t/=.5)<1?t*=.5*t*t*t:t=-.5*((t-=2)*t*t*t-2),z.linear(t,this,e)},z.bounce=function(t){return(t/=1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,t},z.easeInBounce=function(t,e){return z.linear(z.bounce(t),this,e)},z.easeOutBounce=function(t,e){return z.linear(z.bounce(t),this,e)},z.easeInElastic=function(t,e){let i=1.70158,s=0,r=1;return 0===t?t=0:1==(t/=1)?t=1:(s||(s=.3),r<Math.abs(1)?(r=1,i=s/4):i=s/(2*Math.PI)*Math.asin(1/r),t=-r*2**(10*(t-=1))*Math.sin((1*t-i)*(2*Math.PI)/s)+0),z.linear(t,this,e)},z.easeOutElastic=function(t,e){let i=1.70158,s=0,r=1;return 0===t?t=0:1==(t/=1)?t=1:(s||(s=.3),r<Math.abs(1)?(r=1,i=s/4):i=s/(2*Math.PI)*Math.asin(1/r),t=r*2**(-10*t)*Math.sin((1*t-i)*(2*Math.PI)/s)+1+0),z.linear(t,this,e)},z.easeInBack=function(t,e){const i=1.70158;return z.linear(t=t*t*((i+1)*t-i),this,e)},z.easeOutBack=function(t,e){const i=1.70158;return t=(t=t/1-1)*t*((i+1)*t+i)+1,z.linear(t,this,e)},z.easeInOutBack=function(t,e){let i=1.70158;return t=(t/=.5)<1?t*t*((1+(i*=1.525))*t-i)*.5:.5*((t-=2)*t*((1+(i*=1.525))*t+i)+2),z.linear(t,this,e)},z.easeCubicOut=function(t,e){return t=function(t){return--t*t*t+1}(t),z.linear(t,this,e)},z.easeCubicInOut=function(t,e){return t=function(t){return(t*=2)<1?t*=.5*t*t:t=.5*((t-=2)*t*t+2),t}(t),z.linear(t,this,e)},z.easeSmoothStep=function(t,e){const i=Math.max(0,Math.min(1,t));return z.linear(t=i*i*(3-2*i),this,e)},z.easeSmootherStep=function(t,e){const i=Math.max(0,Math.min(1,(t-0)/1));return z.linear(t=i*i*i*(i*(6*i-15)+10),this,e)},z.prototype.setEasing=function(t){this._easing=t,this._easing==n.EASING_LINEAR?this.ease=z.easeLinear:this._easing==n.EASING_ABSOLUTE?this.ease=z.easeAbsolute:this._easing==n.EASING_SMOOTHSTEP?this.ease=z.easeSmoothStep:this._easing==n.EASING_SMOOTHERSTEP?this.ease=z.easeSmootherStep:this._easing==n.EASING_CUBIC_IN?this.ease=z.easeCubicIn:this._easing==n.EASING_CUBIC_OUT?this.ease=z.easeCubicOut:this._easing==n.EASING_CUBIC_INOUT?this.ease=z.easeCubicInOut:this._easing==n.EASING_EXPO_IN?this.ease=z.easeExpoIn:this._easing==n.EASING_EXPO_OUT?this.ease=z.easeExpoOut:this._easing==n.EASING_EXPO_INOUT?this.ease=z.easeExpoInOut:this._easing==n.EASING_SIN_IN?this.ease=z.easeSinIn:this._easing==n.EASING_SIN_OUT?this.ease=z.easeSinOut:this._easing==n.EASING_SIN_INOUT?this.ease=z.easeSinInOut:this._easing==n.EASING_BACK_OUT?this.ease=z.easeOutBack:this._easing==n.EASING_BACK_IN?this.ease=z.easeInBack:this._easing==n.EASING_BACK_INOUT?this.ease=z.easeInOutBack:this._easing==n.EASING_ELASTIC_IN?this.ease=z.easeInElastic:this._easing==n.EASING_ELASTIC_OUT?this.ease=z.easeOutElastic:this._easing==n.EASING_ELASTIC_INOUT?this.ease=z.easeElasticInOut:this._easing==n.EASING_BOUNCE_IN?this.ease=z.easeInBounce:this._easing==n.EASING_BOUNCE_OUT?this.ease=z.easeOutBounce:this._easing==n.EASING_QUART_OUT?this.ease=z.easeOutQuart:this._easing==n.EASING_QUART_IN?this.ease=z.easeInQuart:this._easing==n.EASING_QUART_INOUT?this.ease=z.easeInOutQuart:this._easing==n.EASING_QUINT_OUT?this.ease=z.easeOutQuint:this._easing==n.EASING_QUINT_IN?this.ease=z.easeInQuint:this._easing==n.EASING_QUINT_INOUT?this.ease=z.easeInOutQuint:this._easing==n.EASING_CUBICSPLINE?this.ease=z.easeCubicSpline:(this._easing=n.EASING_LINEAR,this.ease=z.easeLinear)},z.prototype.trigger=function(){this.cb(),this.cbTriggered=!0},z.prototype.setValue=function(t){this.value=t,null!==this.onChange&&this.onChange()},z.prototype.set=function(t){t&&(t.e&&this.setEasing(t.e),t.cb&&(this.cb=t.cb,this.cbTriggered=!1),t.b,t.hasOwnProperty("t")&&(this.time=t.t),t.hasOwnProperty("time")&&(this.time=t.time),t.hasOwnProperty("v")?this.value=t.v:t.hasOwnProperty("value")&&(this.value=t.value)),null!==this.onChange&&this.onChange()},z.prototype.getSerialized=function(){const t={};return t.t=this.time,t.v=this.value,t.e=this._easing,t},z.prototype.getEasing=function(){return this._easing};const W=function(t){H.apply(this),t=t||{},this.keys=[],this.onChange=null,this.stayInTimeline=!1,this.loop=!1,this._log=new r("Anim"),this._lastKeyIndex=0,this._cachedIndex=0,this.name=t.name||null,this.defaultEasing=t.defaultEasing||n.EASING_LINEAR,this.onLooped=null,this._timesLooped=0,this._needsSort=!1};W.prototype.forceChangeCallback=function(){null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)},W.prototype.getLoop=function(){return this.loop},W.prototype.setLoop=function(t){this.loop=t,this.emitEvent("onChange",this)},W.prototype.hasEnded=function(t){return 0===this.keys.length||this.keys[this._lastKeyIndex].time<=t},W.prototype.isRising=function(t){if(this.hasEnded(t))return!1;const e=this.getKeyIndex(t);return this.keys[e].value<this.keys[e+1].value},W.prototype.clearBefore=function(t){const e=this.getValue(t),i=this.getKeyIndex(t);this.setValue(t,e),i>1&&this.keys.splice(0,i),this._updateLastIndex()},W.prototype.clear=function(t){let e=0;t&&(e=this.getValue(t)),this.keys.length=0,this._updateLastIndex(),t&&this.setValue(t,e),null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)},W.prototype.sortKeys=function(){this.keys.sort(((t,e)=>parseFloat(t.time)-parseFloat(e.time))),this._updateLastIndex(),this._needsSort=!1,this.keys.length%1e3==0&&console.log(this.name,this.keys.length)},W.prototype.getLength=function(){return 0===this.keys.length?0:this.keys[this.keys.length-1].time},W.prototype.getKeyIndex=function(t){let e=0,i=0;this._cachedIndex&&this.keys.length>this._cachedIndex&&t>=this.keys[this._cachedIndex].time&&(i=this._cachedIndex);for(let s=i;s<this.keys.length;s++)if(t>=this.keys[s].time&&(e=s),this.keys[s].time>t)return 0!=t&&(this._cachedIndex=e),e;return e},W.prototype.setValue=function(t,e,i){let s=null;if(0==this.keys.length||t<=this.keys[this.keys.length-1].time)for(let r=0;r<this.keys.length;r++)if(this.keys[r].time==t){s=this.keys[r],this.keys[r].setValue(e),this.keys[r].cb=i;break}return s||(s=new z({time:t,value:e,e:this.defaultEasing,cb:i}),this.keys.push(s),this.keys.length%1e3==0&&console.log(this.name,this.keys.length),this._updateLastIndex()),this.onChange&&this.onChange(),this.emitEvent("onChange",this),this._needsSort=!0,s},W.prototype.setKeyEasing=function(t,e){this.keys[t]&&(this.keys[t].setEasing(e),this.emitEvent("onChange",this))},W.prototype.getSerialized=function(){const t={keys:[]};t.loop=this.loop;for(let e=0;e<this.keys.length;e++)t.keys.push(this.keys[e].getSerialized());return t},W.prototype.getKey=function(t){const e=this.getKeyIndex(t);return this.keys[e]},W.prototype.getNextKey=function(t){let e=this.getKeyIndex(t)+1;return e>=this.keys.length&&(e=this.keys.length-1),this.keys[e]},W.prototype.isFinished=function(t){return this.keys.length<=0||t>this.keys[this.keys.length-1].time},W.prototype.isStarted=function(t){return!(this.keys.length<=0)&&t>=this.keys[0].time},W.prototype.getValue=function(t){if(0===this.keys.length)return 0;if(this._needsSort&&this.sortKeys(),!this.loop&&t>this.keys[this._lastKeyIndex].time)return this.keys[this._lastKeyIndex].value;if(t<this.keys[0].time)return this.keys[0].value;this.loop&&t>this.keys[this._lastKeyIndex].time&&(t/this.keys[this._lastKeyIndex].time>this._timesLooped&&(this._timesLooped++,this.onLooped&&this.onLooped()),t=(t-this.keys[0].time)%(this.keys[this._lastKeyIndex].time-this.keys[0].time),t+=this.keys[0].time);const e=this.getKeyIndex(t);if(e>=this._lastKeyIndex)return this.keys[this._lastKeyIndex].cb&&!this.keys[this._lastKeyIndex].cbTriggered&&this.keys[this._lastKeyIndex].trigger(),this.keys[this._lastKeyIndex].value;const i=e+1,s=this.keys[e],r=this.keys[i];if(s.cb&&!s.cbTriggered&&s.trigger(),!r)return-1;const n=(t-s.time)/(r.time-s.time);return s.ease||this.log._warn("has no ease",s,r),s.ease(n,r)},W.prototype._updateLastIndex=function(){this._lastKeyIndex=this.keys.length-1},W.prototype.addKey=function(t){void 0===t.time?this.log.warn("key time undefined, ignoring!"):(this.keys.push(t),null!==this.onChange&&this.onChange(),this.emitEvent("onChange",this)),this._updateLastIndex()},W.prototype.easingFromString=function(t){return"linear"==t?n.EASING_LINEAR:"absolute"==t?n.EASING_ABSOLUTE:"smoothstep"==t?n.EASING_SMOOTHSTEP:"smootherstep"==t?n.EASING_SMOOTHERSTEP:"Cubic In"==t?n.EASING_CUBIC_IN:"Cubic Out"==t?n.EASING_CUBIC_OUT:"Cubic In Out"==t?n.EASING_CUBIC_INOUT:"Expo In"==t?n.EASING_EXPO_IN:"Expo Out"==t?n.EASING_EXPO_OUT:"Expo In Out"==t?n.EASING_EXPO_INOUT:"Sin In"==t?n.EASING_SIN_IN:"Sin Out"==t?n.EASING_SIN_OUT:"Sin In Out"==t?n.EASING_SIN_INOUT:"Back In"==t?n.EASING_BACK_IN:"Back Out"==t?n.EASING_BACK_OUT:"Back In Out"==t?n.EASING_BACK_INOUT:"Elastic In"==t?n.EASING_ELASTIC_IN:"Elastic Out"==t?n.EASING_ELASTIC_OUT:"Bounce In"==t?n.EASING_BOUNCE_IN:"Bounce Out"==t?n.EASING_BOUNCE_OUT:"Quart Out"==t?n.EASING_QUART_OUT:"Quart In"==t?n.EASING_QUART_IN:"Quart In Out"==t?n.EASING_QUART_INOUT:"Quint Out"==t?n.EASING_QUINT_OUT:"Quint In"==t?n.EASING_QUINT_IN:"Quint In Out"==t?n.EASING_QUINT_INOUT:void 0},W.prototype.createPort=function(t,e,i){const s=t.inDropDown(e,n.EASINGS);return s.set("linear"),s.defaultValue="linear",s.onChange=function(){this.defaultEasing=this.easingFromString(s.get()),this.emitEvent("onChangeDefaultEasing",this),i&&i()}.bind(this),s},W.slerpQuaternion=function(t,e,i,s,r,n){W.slerpQuaternion.q1||(W.slerpQuaternion.q1=quat.create(),W.slerpQuaternion.q2=quat.create());const o=i.getKeyIndex(t);let a=o+1;if(a>=i.keys.length&&(a=i.keys.length-1),o==a)quat.set(e,i.keys[o].value,s.keys[o].value,r.keys[o].value,n.keys[o].value);else{const h=i.keys[o].time,l=(t-h)/(i.keys[a].time-h);quat.set(W.slerpQuaternion.q1,i.keys[o].value,s.keys[o].value,r.keys[o].value,n.keys[o].value),quat.set(W.slerpQuaternion.q2,i.keys[a].value,s.keys[a].value,r.keys[a].value,n.keys[a].value),quat.slerp(e,W.slerpQuaternion.q1,W.slerpQuaternion.q2,l)}return e};const Y={Key:z},j=function(t,e,i,s){H.apply(this),this.data={},this._log=new r("core_port"),this.direction=a.PORT_DIR_IN,this.id=String(CABLES.simpleId()),this._op=t,this.links=[],this.value=0,this.name=e,this.type=i||o.OP_PORT_TYPE_VALUE,this.uiAttribs=s||{},this.anim=null,this._oldAnimVal=-5711,this.defaultValue=null,this._uiActiveState=!0,this.ignoreValueSerialize=!1,this.onLinkChanged=null,this.crashed=!1,this._valueBeforeLink=null,this._lastAnimFrame=-1,this._animated=!1,this.onValueChanged=null,this.onTriggered=null,this.onUiActiveStateChange=null,this.changeAlways=!1,this.forceRefChange=!1,this._useVariableName=null,this.activityCounter=0,this.apf=0,this.activityCounterStartFrame=0,this._tempLastUiValue=null,Object.defineProperty(this,"title",{get(){return this.uiAttribs.title||this.name}}),Object.defineProperty(this,"parent",{get(){return this._log.stack("use port.op, not .parent"),this._op}}),Object.defineProperty(this,"op",{get(){return this._op}}),Object.defineProperty(this,"val",{get(){return this._log.warn("val getter deprecated!",this),this._log.stack("val getter deprecated"),this.get()},set(t){this._log.warn("val setter deprecated!",this),this._log.stack("val setter deprecated"),this.setValue(t)}})};j.prototype.copyLinkedUiAttrib=function(t,e){if(!CABLES.UI)return;if(!this.isLinked())return;const i={};i[t]=this.links[0].getOtherPort(this).getUiAttrib(t),e.setUiAttribs(i)},j.prototype.getValueForDisplay=function(){let t=this.value;return"string"==typeof this.value||this.value instanceof String?(t.length>1e3&&(t=t.substring(0,999),t+="..."),this.uiAttribs&&"boolnum"==this.uiAttribs.display&&(t+=" - ",this.value?t+="true":t+="false"),t=t.replace(/[\u00A0-\u9999<>\&]/g,(function(t){return"&#"+t.charCodeAt(0)+";"})),t.length>100&&(t=t.substring(0,100))):t=this.value,t},j.prototype.onAnimToggle=function(){},j.prototype._onAnimToggle=function(){this.onAnimToggle()},j.prototype.remove=function(){this.removeLinks(),this._op.removePort(this)},j.prototype.setUiAttribs=function(t){let e=!1;this.uiAttribs||(this.uiAttribs={});for(const i in t)this.uiAttribs[i]!=t[i]&&(e=!0),this.uiAttribs[i]=t[i],"group"==i&&this.indexPort&&this.indexPort.setUiAttribs({group:t[i]});t.hasOwnProperty("expose")&&this._op.patch.emitEvent("subpatchExpose",this._op.uiAttribs.subPatch),e&&this.emitEvent("onUiAttrChange",t,this)},j.prototype.getUiAttribs=function(){return this.uiAttribs},j.prototype.getUiAttrib=function(t){return this.uiAttribs&&this.uiAttribs.hasOwnProperty(t)?this.uiAttribs[t]:null},j.prototype.get=function(){return this._animated&&this._lastAnimFrame!=this._op.patch.getFrameNum()&&(this._lastAnimFrame=this._op.patch.getFrameNum(),this.value=this.anim.getValue(this._op.patch.timer.getTime()),this._oldAnimVal=this.value,this.forceChange()),this.value},j.prototype.setRef=function(t){this.forceRefChange=!0,this.set(t)},j.prototype.set=j.prototype.setValue=function(t){if(void 0===t&&(t=null),this._op.enabled&&!this.crashed&&(t!==this.value||this.changeAlways||this.type==o.OP_PORT_TYPE_TEXTURE||this.type==o.OP_PORT_TYPE_ARRAY)){if(this._animated)this.anim.setValue(this._op.patch.timer.getTime(),t);else{try{this.value=t,this.forceChange()}catch(t){this.crashed=!0,this.setValue=function(t){},this.onTriggered=function(){},this._log.error("onvaluechanged exception cought",t),this._log.error(t.stack),this._log.warn("exception in: "+this._op.name),this._op.patch.isEditorMode()&&gui.showOpCrash(this._op),this._op.patch.emitEvent("exception",t,this._op),this._op.onError&&this._op.onError(t)}this._op&&this._op.patch&&this._op.patch.isEditorMode()&&this.type==o.OP_PORT_TYPE_TEXTURE&&gui.texturePreview().updateTexturePort(this)}if(this.direction==a.PORT_DIR_OUT)for(let t=0;t<this.links.length;++t)this.links[t].setValue()}},j.prototype.updateAnim=function(){this._animated&&(this.value=this.get(),(this._oldAnimVal!=this.value||this.changeAlways)&&(this._oldAnimVal=this.value,this.forceChange()),this._oldAnimVal=this.value)},j.args=function(t){return(t+"").replace(/[/][/].*$/gm,"").replace(/\s+/g,"").replace(/[/][*][^/*]*[*][/]/g,"").split("){",1)[0].replace(/^[^(]*[(]/,"").replace(/=[^,]+/g,"").split(",").filter(Boolean)},j.prototype.forceChange=function(){this.onValueChanged||this.onChange,this._activity(),this.emitEvent("change",this.value,this),this.onChange?this.onChange(this,this.value):this.onValueChanged&&this.onValueChanged(this,this.value)},j.prototype.getTypeString=function(){return this.type==o.OP_PORT_TYPE_VALUE?"Number":this.type==o.OP_PORT_TYPE_FUNCTION?"Trigger":this.type==o.OP_PORT_TYPE_OBJECT?"Object":this.type==o.OP_PORT_TYPE_DYNAMIC?"Dynamic":this.type==o.OP_PORT_TYPE_ARRAY?"Array":this.type==o.OP_PORT_TYPE_STRING?"String":"Unknown"},j.prototype.deSerializeSettings=function(t){if(t&&(t.animated&&this.setAnimated(t.animated),t.useVariable&&this.setVariableName(t.useVariable),t.title&&this.setUiAttribs({title:t.title}),t.expose&&this.setUiAttribs({expose:!0}),t.order&&this.setUiAttribs({order:t.order}),t.anim)){this.anim||(this.anim=new W({name:"port "+this.name})),this._op._hasAnimPort=!0,this.anim.addEventListener("onChange",(()=>{this._op.patch.emitEvent("portAnimUpdated",this._op,this,this.anim)})),t.anim.loop&&(this.anim.loop=t.anim.loop);for(const e in t.anim.keys)this.anim.keys.push(new Y.Key(t.anim.keys[e]));this.anim.sortKeys()}},j.prototype.getSerialized=function(){let t={};if(t.name=this.getName(),this.ignoreValueSerialize||0!==this.links.length||this.type==o.OP_PORT_TYPE_OBJECT&&this.value&&this.value.tex||(t.value=this.value),this._useVariableName&&(t.useVariable=this._useVariableName),this._animated&&(t.animated=!0),this.anim&&(t.anim=this.anim.getSerialized()),"file"==this.uiAttribs.display&&(t.display=this.uiAttribs.display),this.uiAttribs.expose&&(t.expose=!0,this.uiAttribs.hasOwnProperty("order")&&(t.order=this.uiAttribs.order)),this.uiAttribs.title&&(t.title=this.uiAttribs.title),this.direction==a.PORT_DIR_OUT&&this.links.length>0){t.links=[];for(const e in this.links)!this.links[e].ignoreInSerialize&&this.links[e].portIn&&this.links[e].portOut&&t.links.push(this.links[e].getSerialized())}if(this.direction==a.PORT_DIR_IN&&this.links.length>0)for(const e in this.links)this.links[e].portIn&&this.links[e].portOut&&this.links[e].getOtherPort(this).op.isInBlueprint2()&&!this.op.isInBlueprint2()&&(t.links=t.links||[],t.links.push(this.links[e].getSerialized()));return t.links&&0==t.links.length&&delete t.links,this.type===o.OP_PORT_TYPE_FUNCTION&&delete t.value,this.type===o.OP_PORT_TYPE_FUNCTION&&0==this.links.length&&(t=null),t&&1==Object.keys(t).length&&t.name&&(t=null),E(t),t},j.prototype.shouldLink=function(){return!0},j.prototype.removeLinks=function(){let t=0;for(;this.links.length>0;){if(t++,t>5e3){this._log.warn("could not delete links... / infinite loop"),this.links.length=0;break}this.links[0].remove()}},j.prototype.removeLink=function(t){for(const e in this.links)this.links[e]==t&&this.links.splice(e,1);this.direction==a.PORT_DIR_IN&&(this.type==o.OP_PORT_TYPE_VALUE?this.setValue(this._valueBeforeLink||0):this.setValue(this._valueBeforeLink||null)),CABLES.UI&&this._op.checkLinkTimeWarnings&&this._op.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),this.emitEvent("onLinkChanged"),this._op.emitEvent("onLinkChanged")},j.prototype.getName=function(){return this.name},j.prototype.addLink=function(t){this._valueBeforeLink=this.value,this.links.push(t),CABLES.UI&&this._op.checkLinkTimeWarnings&&this._op.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),this.emitEvent("onLinkChanged"),this._op.emitEvent("onLinkChanged")},j.prototype.getLinkTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return this.links[e]},j.prototype.removeLinkTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return this.links[e].remove(),CABLES.UI&&this._op.checkLinkTimeWarnings&&this._op.checkLinkTimeWarnings(),this.onLinkChanged&&this.onLinkChanged(),void this.emitEvent("onLinkChanged")},j.prototype.isLinkedTo=function(t){for(const e in this.links)if(this.links[e].portIn==t||this.links[e].portOut==t)return!0;return!1},j.prototype._activity=function(){this.activityCounter++},j.prototype.trigger=function(){const t=this.links.length;if(this._activity(),0===t)return;if(!this._op.enabled)return;let e=null;try{for(let i=0;i<t;++i)this.links[i].portIn&&(e=this.links[i].portIn,e.op.patch.pushTriggerStack(e),e._onTriggered(),e.op.patch.popTriggerStack()),this.links[i]&&this.links[i].activity()}catch(t){this._op.enabled=!1,this._op.patch.isEditorMode()&&(this._op.patch.emitEvent("exception",t,e.op),this._op.patch.emitEvent("opcrash",e),e.op.onError&&e.op.onError(t)),this._log.warn("exception!"),this._log.error("ontriggered exception caught",t),this._log.error(t.stack),this._log.warn("exception in: "+e.op.name)}},j.prototype.call=function(){this._log.warn("call deprecated - use trigger() "),this.trigger()},j.prototype.execute=function(){this._log.warn("### execute port: "+this.getName(),this.goals.length)},j.prototype.setVariableName=function(t){this._useVariableName=t,this._op.patch.on("variableRename",((t,e)=>{t==this._useVariableName&&(this._useVariableName=e)}))},j.prototype.getVariableName=function(){return this._useVariableName},j.prototype.setVariable=function(t){this.setAnimated(!1);const e={useVariable:!1};this._variableIn&&this._varChangeListenerId&&(this._variableIn.off(this._varChangeListenerId),this._variableIn=null),t?(this._variableIn=this._op.patch.getVar(t),this._variableIn?(this.type==o.OP_PORT_TYPE_OBJECT?this._varChangeListenerId=this._variableIn.on("change",(()=>{this.set(null),this.set(this._variableIn.getValue())})):this._varChangeListenerId=this._variableIn.on("change",this.set.bind(this)),this.set(this._variableIn.getValue())):this._log.warn("PORT VAR NOT FOUND!!!",t),this._useVariableName=t,e.useVariable=!0,e.variableName=this._useVariableName):(e.variableName=this._useVariableName=null,e.useVariable=!1),this.setUiAttribs(e),this._op.patch.emitEvent("portSetVariable",this._op,this,t)},j.prototype._handleNoTriggerOpAnimUpdates=function(t){let e=!1;for(let t=0;t<this._op.portsIn.length;t++)if(this._op.portsIn.type==o.OP_PORT_TYPE_FUNCTION){e=!0;break}e||(t?this._notriggerAnimUpdate=this._op.patch.on("onRenderFrame",(()=>{this.updateAnim()})):this._op.patch.removeEventListener(this._notriggerAnimUpdate))},j.prototype.setAnimated=function(t){this._animated!=t&&(this._animated=t,this._op._hasAnimPort=!0,this._animated&&!this.anim&&(this.anim=new W({name:"port "+this.name}),this.anim.addEventListener("onChange",(()=>{this._op.patch.emitEvent("portAnimUpdated",this._op,this,this.anim)}))),this._onAnimToggle()),this._handleNoTriggerOpAnimUpdates(t),t||(this.anim=null),this.setUiAttribs({isAnimated:this._animated})},j.prototype.toggleAnim=function(){this._animated=!this._animated,this._animated&&!this.anim&&(this.anim=new W({name:"port "+this.name}),this.anim.addEventListener("onChange",(()=>{this._op.patch.emitEvent("portAnimUpdated",this._op,this,this.anim)}))),this.setAnimated(this._animated),this._onAnimToggle(),this.setUiAttribs({isAnimated:this._animated})},j.prototype.getType=function(){return this.type},j.prototype.isLinked=function(){return this.links.length>0||this._animated||null!=this._useVariableName},j.prototype.isBoundToVar=function(){const t=null!=this._useVariableName;return this.uiAttribs.boundToVar=t,t},j.prototype.isAnimated=function(){return this._animated},j.prototype.isHidden=function(){return this.uiAttribs.hidePort},j.prototype._onTriggered=function(t){this._activity(),this._op.updateAnims(),this._op.enabled&&this.onTriggered&&this.onTriggered(t)},j.prototype._onSetProfiling=function(t){this._op.patch.profiler.add("port",this),this.setValue(t),this._op.patch.profiler.add("port",null)},j.prototype._onTriggeredProfiling=function(){this._op.enabled&&this.onTriggered&&(this._op.patch.profiler.add("port",this),this.onTriggered(),this._op.patch.profiler.add("port",null))},j.prototype.onValueChange=function(t){this.onChange=t},j.prototype.getUiActiveState=function(){return this._uiActiveState},j.prototype.setUiActiveState=function(t){this._uiActiveState=t,this.onUiActiveStateChange&&this.onUiActiveStateChange()},j.prototype.hidePort=function(){this._log.warn("op.hideport() is deprecated, do not use it!")},j.portTypeNumberToString=function(t){return t==o.OP_PORT_TYPE_VALUE?"value":t==o.OP_PORT_TYPE_FUNCTION?"function":t==o.OP_PORT_TYPE_OBJECT?"object":t==o.OP_PORT_TYPE_ARRAY?"array":t==o.OP_PORT_TYPE_STRING?"string":t==o.OP_PORT_TYPE_DYNAMIC?"dynamic":"unknown"};const X=class{constructor(t,e,i,s,n,o,a,h,l,c){if(this._log=new r("cg_uniform"),this._type=e,this._name=i,this._shader=t,this._value=1e-5,this._oldValue=null,this._port=null,this._structName=l,this._structUniformName=h,this._propertyName=c,this._shader._addUniform(this),this.needsUpdate=!0,this.shaderType=null,this.comment=null,"f"==e)this.set=this.setValue=this.setValueF.bind(this),this.updateValue=this.updateValueF.bind(this);else if("f[]"==e)this.set=this.setValue=this.setValueArrayF.bind(this),this.updateValue=this.updateValueArrayF.bind(this);else if("2f[]"==e)this.set=this.setValue=this.setValueArray2F.bind(this),this.updateValue=this.updateValueArray2F.bind(this);else if("3f[]"==e)this.set=this.setValue=this.setValueArray3F.bind(this),this.updateValue=this.updateValueArray3F.bind(this);else if("4f[]"==e)this.set=this.setValue=this.setValueArray4F.bind(this),this.updateValue=this.updateValueArray4F.bind(this);else if("i"==e)this.set=this.setValue=this.setValueI.bind(this),this.updateValue=this.updateValueI.bind(this);else if("2i"==e)this.set=this.setValue=this.setValue2I.bind(this),this.updateValue=this.updateValue2I.bind(this);else if("3i"==e)this.set=this.setValue=this.setValue3I.bind(this),this.updateValue=this.updateValue3I.bind(this);else if("4i"==e)this.set=this.setValue=this.setValue4I.bind(this),this.updateValue=this.updateValue4I.bind(this);else if("b"==e)this.set=this.setValue=this.setValueBool.bind(this),this.updateValue=this.updateValueBool.bind(this);else if("4f"==e)this.set=this.setValue=this.setValue4F.bind(this),this.updateValue=this.updateValue4F.bind(this);else if("3f"==e)this.set=this.setValue=this.setValue3F.bind(this),this.updateValue=this.updateValue3F.bind(this);else if("2f"==e)this.set=this.setValue=this.setValue2F.bind(this),this.updateValue=this.updateValue2F.bind(this);else if("t"==e)this.set=this.setValue=this.setValueT.bind(this),this.updateValue=this.updateValueT.bind(this);else if("tc"==e)this.set=this.setValue=this.setValueT.bind(this),this.updateValue=this.updateValueT.bind(this);else if("t[]"==e)this.set=this.setValue=this.setValueArrayT.bind(this),this.updateValue=this.updateValueArrayT.bind(this);else{if("m4"!=e&&"m4[]"!=e)throw new Error("Unknown uniform type");this.set=this.setValue=this.setValueM4.bind(this),this.updateValue=this.updateValueM4.bind(this)}"object"==typeof s&&s instanceof j?(this._port=s,this._value=this._port.get(),n&&o&&a?(n instanceof j&&o instanceof j&&a instanceof j||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0,0,0],this._port2=n,this._port3=o,this._port4=a,this._port.on("change",this.updateFromPort4f.bind(this)),this._port2.on("change",this.updateFromPort4f.bind(this)),this._port3.on("change",this.updateFromPort4f.bind(this)),this._port4.on("change",this.updateFromPort4f.bind(this)),this.updateFromPort4f()):n&&o?(n instanceof j&&o instanceof j||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0,0],this._port2=n,this._port3=o,this._port.on("change",this.updateFromPort3f.bind(this)),this._port2.on("change",this.updateFromPort3f.bind(this)),this._port3.on("change",this.updateFromPort3f.bind(this)),this.updateFromPort3f()):n?(n instanceof j||this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ",this._name),this._value=[0,0],this._port2=n,this._port.on("change",this.updateFromPort2f.bind(this)),this._port2.on("change",this.updateFromPort2f.bind(this)),this.updateFromPort2f()):this._port.on("change",this.updateFromPort.bind(this))):this._value=s,this.setValue(this._value),this.needsUpdate=!0}getType(){return this._type}getName(){return this._name}getValue(){return this._value}getShaderType(){return this.shaderType}isStructMember(){return!!this._structName}updateFromPort4f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this._value[3]=this._port4.get(),this.setValue(this._value)}updateFromPort3f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this.setValue(this._value)}updateFromPort2f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this.setValue(this._value)}updateFromPort(){this.setValue(this._port.get())}};class Q extends X{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this._loc=-1,this._cgl=t._cgl}get name(){return this._name}copy(t){const e=new Q(t,this._type,this._name,this._value,this._port2,this._port3,this._port4,this._structUniformName,this._structName,this._propertyName);return e.shaderType=this.shaderType,e}getGlslTypeString(){return Q.glslTypeString(this._type)}_isValidLoc(){return-1!=this._loc}resetLoc(){this._loc=-1,this.needsUpdate=!0}bindTextures(){}getLoc(){return this._loc}updateFromPort4f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this._value[3]=this._port4.get(),this.setValue(this._value)}updateFromPort3f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this._value[2]=this._port3.get(),this.setValue(this._value)}updateFromPort2f(){this._value[0]=this._port.get(),this._value[1]=this._port2.get(),this.setValue(this._value)}updateFromPort(){this.setValue(this._port.get())}updateValueF(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1f(this._loc,this._value),this._cgl.profileData.profileUniformCount++}setValueF(t){t!=this._value&&(this.needsUpdate=!0,this._value=t)}updateValueI(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1i(this._loc,this._value),this._cgl.profileData.profileUniformCount++}updateValue2I(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform2i(this._loc,this._value[0],this._value[1]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}updateValue3I(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform3i(this._loc,this._value[0],this._value[1],this._value[2]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}updateValue4I(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform4i(this._loc,this._value[0],this._value[1],this._value[2],this._value[3]),this._cgl.profileData.profileUniformCount++}setValueI(t){t!=this._value&&(this.needsUpdate=!0,this._value=t)}setValue2I(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1],this.needsUpdate=!0),this._value=t)}setValue3I(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]&&t[2]==this._oldValue[2]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this._oldValue[2]=t[2],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1,2],this.needsUpdate=!0),this._value=t)}setValue4I(t){this.needsUpdate=!0,this._value=t||vec4.create()}updateValueBool(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._shader.getCgl().gl.uniform1i(this._loc,this._value?1:0),this._cgl.profileData.profileUniformCount++}setValueBool(t){t!=this._value&&(this.needsUpdate=!0,this._value=t)}setValueArray4F(t){this.needsUpdate=!0,this._value=t}updateValueArray4F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform4fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArray3F(t){this.needsUpdate=!0,this._value=t}updateValueArray3F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform3fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArray2F(t){this.needsUpdate=!0,this._value=t}updateValueArray2F(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform2fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArrayF(t){this.needsUpdate=!0,this._value=t}updateValueArrayF(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform1fv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}setValueArrayT(t){this.needsUpdate=!0,this._value=t}updateValue3F(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform3f(this._loc,this._value[0],this._value[1],this._value[2]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}setValue3F(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]&&t[2]==this._oldValue[2]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this._oldValue[2]=t[2],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1,2],this.needsUpdate=!0),this._value=t)}updateValue2F(){this._value&&(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._shader.getCgl().gl.uniform2f(this._loc,this._value[0],this._value[1]),this.needsUpdate=!1,this._cgl.profileData.profileUniformCount++)}setValue2F(t){t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1],this.needsUpdate=!0),this._value=t)}updateValue4F(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._value||(this._log.warn("no value for uniform",this._name,this),this._value=[0,0,0,0]),this.needsUpdate=!1,this._shader.getCgl().gl.uniform4f(this._loc,this._value[0],this._value[1],this._value[2],this._value[3]),this._cgl.profileData.profileUniformCount++}setValue4F(t){"number"==typeof this.value&&(this.value=vec4.create()),t&&(this._oldValue?t[0]==this._oldValue[0]&&t[1]==this._oldValue[1]&&t[2]==this._oldValue[2]&&t[3]==this._oldValue[3]||(this._oldValue[0]=t[0],this._oldValue[1]=t[1],this._oldValue[2]=t[2],this.needsUpdate=!0):(this._oldValue=[t[0]-1,1,2,3],this.needsUpdate=!0),this._value=t)}updateValueM4(){if(this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),!this._value||this._value.length%16!=0)return console.log("this.name",this._name,this._value);this._shader.getCgl().gl.uniformMatrix4fv(this._loc,!1,this._value),this._cgl.profileData.profileUniformCount++}setValueM4(t){this.needsUpdate=!0,this._value=t||mat4.create()}updateValueArrayT(){this._isValidLoc()?this.needsUpdate=!1:this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._value&&(this._shader.getCgl().gl.uniform1iv(this._loc,this._value),this._cgl.profileData.profileUniformCount++)}updateValueT(){this._isValidLoc()||(this._loc=this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(),this._name),this._cgl.profileData.profileShaderGetUniform++,this._cgl.profileData.profileShaderGetUniformName=this._name),this._cgl.profileData.profileUniformCount++,this._shader.getCgl().gl.uniform1i(this._loc,this._value),this.needsUpdate=!1}setValueT(t){this.needsUpdate=!0,this._value=t}}Q.glslTypeString=t=>"f"==t?"float":"b"==t?"bool":"i"==t?"int":"2i"==t?"ivec2":"2f"==t?"vec2":"3f"==t?"vec3":"4f"==t?"vec4":"m4"==t?"mat4":"t"==t?"sampler2D":"tc"==t?"samplerCube":"3f[]"==t||"m4[]"==t||"f[]"==t?null:void console.warn("[CGL UNIFORM] unknown glsl type string ",t);const q=180/Math.PI,K={DEG2RAD:Math.PI/180,RAD2DEG:q},J={SHADERVAR_VERTEX_POSITION:"vPosition",SHADERVAR_VERTEX_NUMBER:"attrVertIndex",SHADERVAR_VERTEX_NORMAL:"attrVertNormal",SHADERVAR_VERTEX_TEXCOORD:"attrTexCoord",SHADERVAR_INSTANCE_MMATRIX:"instMat",SHADERVAR_VERTEX_COLOR:"attrVertColor",SHADERVAR_INSTANCE_INDEX:"instanceIndex",SHADERVAR_UNI_PROJMAT:"projMatrix",SHADERVAR_UNI_VIEWMAT:"viewMatrix",SHADERVAR_UNI_MODELMAT:"modelMatrix",SHADERVAR_UNI_NORMALMAT:"normalMatrix",SHADERVAR_UNI_INVVIEWMAT:"inverseViewMatrix",SHADERVAR_UNI_INVPROJMAT:"invProjMatrix",SHADERVAR_UNI_MATERIALID:"materialId",SHADERVAR_UNI_OBJECTID:"objectId",SHADERVAR_UNI_VIEWPOS:"camPos"},Z={BLEND_NONE:0,BLEND_NORMAL:1,BLEND_ADD:2,BLEND_SUB:3,BLEND_MUL:4},$={lastMesh:null},tt=function(t,e,i){this._cgl=t,this._log=new r("cgl_mesh"),this._bufVertexAttrib=null,this._bufVerticesIndizes=this._cgl.gl.createBuffer(),this._indexType=this._cgl.gl.UNSIGNED_SHORT,this._attributes=[],this._attribLocs={},this._geom=null,this._lastShader=null,this._numInstances=0,this._glPrimitive=i,this._preWireframeGeom=null,this.addVertexNumbers=!1,this._name="unknown",this.feedBackAttributes=[],this.setGeom(e),this._feedBacks=[],this._feedBacksChanged=!1,this._transformFeedBackLoc=-1,this._lastAttrUpdate=0,this.memFreed=!1,this._cgl.profileData.addHeavyEvent("mesh constructed",this._name),this._queryExt=null,Object.defineProperty(this,"numInstances",{get(){return this._numInstances},set(t){this.setNumInstances(t)}})};tt.prototype.freeMem=function(){this.memFreed=!0;for(let t=0;t<this._attributes.length;t++)this._attributes[t].floatArray=null},tt.prototype.updateVertices=function(t){this.setAttribute(J.SHADERVAR_VERTEX_POSITION,t.vertices,3),this._numVerts=t.vertices.length/3},tt.prototype.setAttributePointer=function(t,e,i,s){for(let r=0;r<this._attributes.length;r++)this._attributes[r].name==t&&(this._attributes[r].pointer||(this._attributes[r].pointer=[]),this._attributes[r].pointer.push({loc:-1,name:e,stride:i,offset:s,instanced:t==J.SHADERVAR_INSTANCE_MMATRIX}))},tt.prototype.getAttribute=function(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t)return this._attributes[e]},tt.prototype.setAttributeRange=function(t,e,i,s){t&&(i||s)&&(t.name||this._log.stack("no attrname?!"),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,t.buffer),this._cgl.profileData.profileMeshAttributes+=s-i||0,this._cgl.profileData.profileSingleMeshAttribute[this._name]=this._cgl.profileData.profileSingleMeshAttribute[this._name]||0,this._cgl.profileData.profileSingleMeshAttribute[this._name]+=s-i||0,t.numItems<e.length/t.itemSize&&this._resizeAttr(e,t),s>=e.length-1&&this._log.log(this._cgl.canvas.id+" "+t.name+" buffersubdata out of bounds ?",e.length,s,i,t),1==this._cgl.glVersion?this._cgl.gl.bufferSubData(this._cgl.gl.ARRAY_BUFFER,0,e):this._cgl.gl.bufferSubData(this._cgl.gl.ARRAY_BUFFER,4*i,e,i,s-i))},tt.prototype._resizeAttr=function(t,e){e.buffer&&this._cgl.gl.deleteBuffer(e.buffer),e.buffer=this._cgl.gl.createBuffer(),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,e.buffer),this._bufferArray(t,e),e.numItems=t.length/e.itemSize},tt.prototype._bufferArray=function(t,e){let i=e.floatArray||null;t&&(this._cgl.debugOneFrame&&console.log("_bufferArray",t.length,e.name),t instanceof Float32Array?i=t:e&&i&&i.length==t.length?i.set(t):(i=new Float32Array(t),this._cgl.debugOneFrame&&console.log("_bufferArray create new float32array",t.length,e.name),t.length>1e4&&(this._cgl.profileData.profileNonTypedAttrib++,this._cgl.profileData.profileNonTypedAttribNames="("+this._name+":"+e.name+")")),e.arrayLength=i.length,e.floatArray=null,this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,i,this._cgl.gl.DYNAMIC_DRAW))},tt.prototype.addAttribute=tt.prototype.updateAttribute=tt.prototype.setAttribute=function(t,e,i,s){if(!e)throw this._log.error("mesh addAttribute - no array given! "+t),new Error;let r=null,n=!1,o=0;const a=e.length/i;for(this._cgl.profileData.profileMeshAttributes+=a||0,"function"==typeof s&&(r=s),"object"==typeof s&&(s.cb&&(r=s.cb),s.instanced&&(n=s.instanced)),t==J.SHADERVAR_INSTANCE_MMATRIX&&(n=!0),o=0;o<this._attributes.length;o++){const i=this._attributes[o];if(i.name==t)return i.numItems===a||this._resizeAttr(e,i),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,i.buffer),this._bufferArray(e,i),i}const h=this._cgl.gl.createBuffer();this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,h);let l=this._cgl.gl.FLOAT;s&&s.type&&(l=s.type);const c={buffer:h,name:t,cb:r,itemSize:i,numItems:a,startItem:0,instanced:n,type:l};return this._bufferArray(e,c),t==J.SHADERVAR_VERTEX_POSITION&&(this._bufVertexAttrib=c),this._attributes.push(c),this._attribLocs={},c},tt.prototype.getAttributes=function(){return this._attributes},tt.prototype.updateTexCoords=function(t){if(t.texCoords&&t.texCoords.length>0)this.setAttribute(J.SHADERVAR_VERTEX_TEXCOORD,t.texCoords,2);else{const e=new Float32Array(Math.round(t.vertices.length/3*2));this.setAttribute(J.SHADERVAR_VERTEX_TEXCOORD,e,2)}},tt.prototype.updateNormals=function(t){if(t.vertexNormals&&t.vertexNormals.length>0)this.setAttribute(J.SHADERVAR_VERTEX_NORMAL,t.vertexNormals,3);else{const e=new Float32Array(Math.round(t.vertices.length));this.setAttribute(J.SHADERVAR_VERTEX_NORMAL,e,3)}},tt.prototype._setVertexNumbers=function(t){if(!this._verticesNumbers||this._verticesNumbers.length!=this._numVerts||t){if(t)this._verticesNumbers=t;else{this._verticesNumbers=new Float32Array(this._numVerts);for(let t=0;t<this._numVerts;t++)this._verticesNumbers[t]=t}this.setAttribute(J.SHADERVAR_VERTEX_NUMBER,this._verticesNumbers,1,((t,e,i)=>{i.uniformNumVertices||(i.uniformNumVertices=new Q(i,"f","numVertices",this._numVerts)),i.uniformNumVertices.setValue(this._numVerts)}))}},tt.prototype.setVertexIndices=function(t){if(this._bufVerticesIndizes)if(t.length>0){t instanceof Float32Array&&this._log.warn("vertIndices float32Array: "+this._name);for(let e=0;e<t.length;e++)if(t[e]>=this._numVerts)return void this._log.warn("invalid index in "+this._name,e,t[e]);this._cgl.gl.bindBuffer(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this._bufVerticesIndizes),t.length>65535?(this.vertIndicesTyped=new Uint32Array(t),this._indexType=this._cgl.gl.UNSIGNED_INT):t instanceof Uint32Array?(this.vertIndicesTyped=t,this._indexType=this._cgl.gl.UNSIGNED_INT):t instanceof Uint16Array?this.vertIndicesTyped=t:(this.vertIndicesTyped=new Uint16Array(t),this._indexType=this._cgl.gl.UNSIGNED_SHORT),this._cgl.gl.bufferData(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this.vertIndicesTyped,this._cgl.gl.DYNAMIC_DRAW),this._bufVerticesIndizes.itemSize=1,this._bufVerticesIndizes.numItems=t.length}else this._bufVerticesIndizes.numItems=0;else this._log.warn("no bufVerticesIndizes: "+this._name)},tt.prototype.setGeom=function(t,e){this._geom=t,null!=t.glPrimitive&&(this._glPrimitive=t.glPrimitive),this._geom&&this._geom.name&&(this._name="mesh "+this._geom.name),$.lastMesh=null,this._cgl.profileData.profileMeshSetGeom++,this._disposeAttributes(),this.updateVertices(this._geom),this.setVertexIndices(this._geom.verticesIndices),this.addVertexNumbers&&this._setVertexNumbers();const i=this._geom.getAttributes(),s={texCoords:J.SHADERVAR_VERTEX_TEXCOORD,vertexNormals:J.SHADERVAR_VERTEX_NORMAL,vertexColors:J.SHADERVAR_VERTEX_COLOR,tangents:"attrTangent",biTangents:"attrBiTangent"};for(const t in i)i[t].data&&i[t].data.length&&this.setAttribute(s[t]||t,i[t].data,i[t].itemSize);e&&(this._geom=null)},tt.prototype._preBind=function(t){for(let e=0;e<this._attributes.length;e++)this._attributes[e].cb&&this._attributes[e].cb(this._attributes[e],this._geom,t)},tt.prototype._checkAttrLengths=function(){if(!this.memFreed)for(let t=0;t<this._attributes.length;t++)if(this._attributes[t].arrayLength/this._attributes[t].itemSize<this._attributes[0].arrayLength/this._attributes[0].itemSize){let t="unknown";this._geom&&(t=this._geom.name)}},tt.prototype._bind=function(t){if(!t.isValid())return;let e=[];if(this._attribLocs[t.id]?e=this._attribLocs[t.id]:this._attribLocs[t.id]=e,this._lastShader=t,t.lastCompile>this._lastAttrUpdate||e.length!=this._attributes.length){this._lastAttrUpdate=t.lastCompile;for(let t=0;t<this._attributes.length;t++)e[t]=-1}for(let i=0;i<this._attributes.length;i++){const s=this._attributes[i];if(-1==e[i]&&s._attrLocationLastShaderTime!=t.lastCompile&&(s._attrLocationLastShaderTime=t.lastCompile,e[i]=this._cgl.glGetAttribLocation(t.getProgram(),s.name),this._cgl.profileData.profileAttrLoc++),-1!=e[i])if(this._cgl.gl.enableVertexAttribArray(e[i]),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,s.buffer),s.instanced)if(s.itemSize<=4)s.itemSize&&0!=s.itemSize||this._log.warn("instanced attrib itemsize error",this._geom.name,s),this._cgl.gl.vertexAttribPointer(e[i],s.itemSize,s.type,!1,4*s.itemSize,0),this._cgl.gl.vertexAttribDivisor(e[i],1);else if(16==s.itemSize){const t=64;this._cgl.gl.vertexAttribPointer(e[i],4,s.type,!1,t,0),this._cgl.gl.enableVertexAttribArray(e[i]+1),this._cgl.gl.vertexAttribPointer(e[i]+1,4,s.type,!1,t,16),this._cgl.gl.enableVertexAttribArray(e[i]+2),this._cgl.gl.vertexAttribPointer(e[i]+2,4,s.type,!1,t,32),this._cgl.gl.enableVertexAttribArray(e[i]+3),this._cgl.gl.vertexAttribPointer(e[i]+3,4,s.type,!1,t,48),this._cgl.gl.vertexAttribDivisor(e[i],1),this._cgl.gl.vertexAttribDivisor(e[i]+1,1),this._cgl.gl.vertexAttribDivisor(e[i]+2,1),this._cgl.gl.vertexAttribDivisor(e[i]+3,1)}else this._log.warn("unknown instance attrib size",s.name);else{if(s.itemSize&&0!=s.itemSize||this._log.warn("attrib itemsize error",this._name,s),this._cgl.gl.vertexAttribPointer(e[i],s.itemSize,s.type,!1,4*s.itemSize,0),s.pointer)for(let e=0;e<s.pointer.length;e++){const i=s.pointer[e];-1==i.loc&&(i.loc=this._cgl.glGetAttribLocation(t.getProgram(),i.name)),this._cgl.profileData.profileAttrLoc++,this._cgl.gl.enableVertexAttribArray(i.loc),this._cgl.gl.vertexAttribPointer(i.loc,s.itemSize,s.type,!1,i.stride,i.offset)}this.bindFeedback(s)}}this._bufVerticesIndizes&&0!==this._bufVerticesIndizes.numItems&&this._cgl.gl.bindBuffer(this._cgl.gl.ELEMENT_ARRAY_BUFFER,this._bufVerticesIndizes)},tt.prototype.unBind=function(){const t=this._lastShader;if(this._lastShader=null,!t)return;let e=[];this._attribLocs[t.id]?e=this._attribLocs[t.id]:this._attribLocs[t.id]=e,$.lastMesh=null;for(let t=0;t<this._attributes.length;t++)this._attributes[t].instanced&&(this._attributes[t].itemSize<=4?(-1!=e[t]&&this._cgl.gl.vertexAttribDivisor(e[t],0),e[t]>=0&&this._cgl.gl.disableVertexAttribArray(e[t])):(this._cgl.gl.vertexAttribDivisor(e[t],0),this._cgl.gl.vertexAttribDivisor(e[t]+1,0),this._cgl.gl.vertexAttribDivisor(e[t]+2,0),this._cgl.gl.vertexAttribDivisor(e[t]+3,0),this._cgl.gl.disableVertexAttribArray(e[t]+1),this._cgl.gl.disableVertexAttribArray(e[t]+2),this._cgl.gl.disableVertexAttribArray(e[t]+3))),-1!=e[t]&&this._cgl.gl.disableVertexAttribArray(e[t])},tt.prototype.meshChanged=function(){return this._cgl.lastMesh&&this._cgl.lastMesh!=this},tt.prototype.printDebug=function(t){console.log("--attributes");for(let t=0;t<this._attributes.length;t++)console.log("attribute "+t+" "+this._attributes[t].name)},tt.prototype.setNumVertices=function(t){this._bufVertexAttrib.numItems=t},tt.prototype.getNumVertices=function(){return this._bufVertexAttrib.numItems},tt.prototype.render=function(t){if(!t||!t.isValid()||this._cgl.aborted)return;if(this._checkAttrLengths(),this._geom&&(!this._preWireframeGeom||t.wireframe||this._geom.isIndexed()||(this.setGeom(this._preWireframeGeom),this._preWireframeGeom=null),t.wireframe)){let t=!1;this._geom.isIndexed()&&(this._preWireframeGeom||(this._preWireframeGeom=this._geom,this._geom=this._geom.copy()),this._geom.unIndex(),t=!0),this._geom.getAttribute("attrBarycentric")||(this._preWireframeGeom||(this._preWireframeGeom=this._geom,this._geom=this._geom.copy()),t=!0,this._geom.calcBarycentric()),t&&this.setGeom(this._geom)}let e=!1;if($.lastMesh!=this&&($.lastMesh&&$.lastMesh.unBind(),e=!0),e&&this._preBind(t),!t.bind())return;this._bind(t),this.addVertexNumbers&&this._setVertexNumbers(),$.lastMesh=this;let i=this._cgl.gl.TRIANGLES;void 0!==this._glPrimitive&&(i=this._glPrimitive),null!==t.glPrimitive&&(i=t.glPrimitive);let s=1,r=this._cgl.profileData.doProfileGlQuery,n=!1;if(r){let e=this._name+" - "+t.getName()+" #"+t.id;this._numInstances&&(e+=" instanced "+this._numInstances+"x");let i=this._cgl.profileData.glQueryData[e];if(i||(i={id:e,num:0}),this._cgl.profileData.glQueryData[e]=i,this._queryExt||!1===this._queryExt||(this._queryExt=this._cgl.enableExtension("EXT_disjoint_timer_query_webgl2")||!1),this._queryExt){if(i._drawQuery&&this._cgl.gl.getQueryParameter(i._drawQuery,this._cgl.gl.QUERY_RESULT_AVAILABLE)){const t=this._cgl.gl.getQueryParameter(i._drawQuery,this._cgl.gl.QUERY_RESULT)/1e6;i._times=i._times||0,i._times+=t,i._numcount++,i.when=performance.now(),i._drawQuery=null,i.queryStarted=!1}i.queryStarted||(i._drawQuery=this._cgl.gl.createQuery(),this._cgl.gl.beginQuery(this._queryExt.TIME_ELAPSED_EXT,i._drawQuery),n=i.queryStarted=!0)}}if(this.hasFeedbacks()?this.drawFeedbacks(t,i):this._bufVerticesIndizes&&0!==this._bufVerticesIndizes.numItems?(i==this._cgl.gl.TRIANGLES&&(s=3),0===this._numInstances?this._cgl.gl.drawElements(i,this._bufVerticesIndizes.numItems,this._indexType,0):this._cgl.gl.drawElementsInstanced(i,this._bufVerticesIndizes.numItems,this._indexType,0,this._numInstances)):(i==this._cgl.gl.TRIANGLES&&(s=3),0===this._numInstances?this._cgl.gl.drawArrays(i,this._bufVertexAttrib.startItem,this._bufVertexAttrib.numItems-this._bufVertexAttrib.startItem):this._cgl.gl.drawArraysInstanced(i,this._bufVertexAttrib.startItem,this._bufVertexAttrib.numItems,this._numInstances)),this._cgl.debugOneFrame&&this._cgl.gl.getError()!=this._cgl.gl.NO_ERROR){this._log.error("mesh draw gl error"),this._log.error("mesh",this),this._log.error("shader",t);for(let e=0;e<this._cgl.gl.getProgramParameter(t.getProgram(),this._cgl.gl.ACTIVE_ATTRIBUTES);e++){const i=this._cgl.gl.getActiveAttrib(t.getProgram(),e).name;this._log.error("attrib ",i)}}this._cgl.profileData.profileMeshNumElements+=this._bufVertexAttrib.numItems/s*(this._numInstances||1),this._cgl.profileData.profileMeshDraw++,r&&n&&this._cgl.gl.endQuery(this._queryExt.TIME_ELAPSED_EXT),this._cgl.printError("mesh render "+this._name),this.unBind()},tt.prototype.setNumInstances=function(t){if(t=Math.max(0,t),this._numInstances!=t){this._numInstances=t;const e=new Float32Array(t);for(let i=0;i<t;i++)e[i]=i;this.setAttribute(J.SHADERVAR_INSTANCE_INDEX,e,1,{instanced:!0})}},tt.prototype._disposeAttributes=function(){if(this._attributes){for(let t=0;t<this._attributes.length;t++)this._attributes[t].buffer&&(this._cgl.gl.deleteBuffer(this._attributes[t].buffer),this._attributes[t].buffer=null);this._attributes.length=0}},tt.prototype.dispose=function(){this._bufVertexAttrib&&this._bufVertexAttrib.buffer&&this._cgl.gl.deleteBuffer(this._bufVertexAttrib.buffer),this._bufVerticesIndizes&&this._cgl.gl.deleteBuffer(this._bufVerticesIndizes),this._bufVerticesIndizes=null,this._disposeAttributes()},function(t){t.prototype.hasFeedbacks=function(){return this._feedBacks.length>0},t.prototype.removeFeedbacks=function(t){this._feedbacks&&(this._feedbacks.length=0,this._feedBacksChanged=!0)},t.prototype.setAttributeFeedback=function(){},t.prototype.setFeedback=function(t,e,i){let s={nameOut:e},r=!1;this.unBindFeedbacks();for(let t=0;t<this._feedBacks.length;t++)this._feedBacks[t].nameOut==e&&(s=this._feedBacks[t],r=!0);return r||(this._feedBacksChanged=!0),s.initialArr=i,s.attrib=t,s.outBuffer&&this._cgl.gl.deleteBuffer(s.outBuffer),s.outBuffer=this._cgl.gl.createBuffer(),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,s.outBuffer),this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,s.initialArr,this._cgl.gl.STATIC_DRAW),this._cgl.gl.bindBuffer(this._cgl.gl.ARRAY_BUFFER,s.attrib.buffer),this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER,s.initialArr,this._cgl.gl.STATIC_DRAW),r||this._feedBacks.push(s),s},t.prototype.bindFeedback=function(t){if(!this._feedBacks||0===this._feedBacks.length)return;-1==this._transformFeedBackLoc&&(this._transformFeedBackLoc=this._cgl.gl.createTransformFeedback()),this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,this._transformFeedBackLoc);let e=!1;for(let i=0;i<this._feedBacks.length;i++){const s=this._feedBacks[i];s.attrib==t&&(e=!0,this._cgl.gl.bindBufferBase(this._cgl.gl.TRANSFORM_FEEDBACK_BUFFER,i,s.outBuffer))}},t.prototype.drawFeedbacks=function(t,e){let i=0;if(this._feedBacksChanged){const e=[];for(this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,this._transformFeedBackLoc),i=0;i<this._feedBacks.length;i++)e.push(this._feedBacks[i].nameOut);return t.setFeedbackNames(e),console.log("feedbacknames",e),t.compile(),this._feedBacksChanged=!1,this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,null),void console.log("changed finished")}this._cgl.gl.beginTransformFeedback(this.glPrimitive),this._cgl.gl.drawArrays(e,0,this._feedBacks[0].attrib.numItems),this._cgl.gl.endTransformFeedback(),this.unBindFeedbacks(),this.feedBacksSwapBuffers()},t.prototype.unBindFeedbacks=function(){for(let t=0;t<this._feedBacks.length;t++)this._cgl.gl.bindBufferBase(this._cgl.gl.TRANSFORM_FEEDBACK_BUFFER,t,null);this._cgl.gl.bindTransformFeedback(this._cgl.gl.TRANSFORM_FEEDBACK,null)},t.prototype.feedBacksSwapBuffers=function(){for(let t=0;t<this._feedBacks.length;t++){const e=this._feedBacks[t].attrib.buffer;this._feedBacks[t].attrib.buffer=this._feedBacks[t].outBuffer,this._feedBacks[t].outBuffer=e}}}(tt);const et={getSimpleRect:function(t,e){const i=new G(e);return i.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],i.texCoords=[1,1,0,1,1,0,0,0],i.verticesIndices=[0,1,2,2,1,3],i.vertexNormals=[0,0,0,0,0,0,0,0,0,0,0,0],new tt(t,i)},getSimpleCube:function(t,e){const i=new G(e);return i.vertices=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1],i.setTexCoords([0,1,1,1,1,0,0,0,1,1,1,0,0,0,0,1,0,0,0,1,1,1,1,0,1,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,0,0,0]),i.verticesIndices=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],i.vertexNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),i.tangents=new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1]),i.biTangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1]),new tt(t,i)}},it=function(t,e){this._cgl=t,this._log=new r("cgl_TextureEffect"),t.TextureEffectMesh||this.createMesh(),this._textureSource=null,this._options=e,this.imgCompVer=0,this.aspectRatio=1,this._textureTarget=null,this._frameBuf=this._cgl.gl.createFramebuffer(),this._frameBuf2=this._cgl.gl.createFramebuffer(),this._renderbuffer=this._cgl.gl.createRenderbuffer(),this._renderbuffer2=this._cgl.gl.createRenderbuffer(),this.switched=!1,this.depth=!1};it.prototype.getWidth=function(){return this._textureSource.width},it.prototype.getHeight=function(){return this._textureSource.height},it.prototype.setSourceTexture=function(t){null===t?(this._textureSource=new w(this._cgl),this._textureSource.setSize(16,16)):this._textureSource=t,this._textureSource.compareSettings(this._textureTarget)||(this._textureTarget&&this._textureTarget.delete(),this._textureTarget=this._textureSource.clone(),this._cgl.profileData.profileEffectBuffercreate++,this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._renderbuffer),this.depth&&this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.DEPTH_COMPONENT16,this._textureSource.width,this._textureSource.height),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.TEXTURE_2D,this._textureTarget.tex,0),this.depth&&this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._renderbuffer),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf2),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._renderbuffer2),this.depth&&this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.DEPTH_COMPONENT16,this._textureSource.width,this._textureSource.height),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cgl.gl.TEXTURE_2D,this._textureSource.tex,0),this.depth&&this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._renderbuffer2),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null)),this.aspectRatio=this._textureSource.width/this._textureSource.height},it.prototype.continueEffect=function(){this._cgl.pushDepthTest(!1),this._cgl.pushModelMatrix(),this._cgl.pushPMatrix(),this._cgl.pushViewPort(0,0,this.getCurrentTargetTexture().width,this.getCurrentTargetTexture().height),mat4.perspective(this._cgl.pMatrix,45,this.getCurrentTargetTexture().width/this.getCurrentTargetTexture().height,.1,1100),this._cgl.pushPMatrix(),mat4.identity(this._cgl.pMatrix),this._cgl.pushViewMatrix(),mat4.identity(this._cgl.vMatrix),this._cgl.pushModelMatrix(),mat4.identity(this._cgl.mMatrix)},it.prototype.startEffect=function(t){this._textureTarget?(this.switched=!1,this.continueEffect(),t&&(this._bgTex=t),this._countEffects=0):this._log.warn("effect has no target")},it.prototype.endEffect=function(){this._cgl.popDepthTest(),this._cgl.popModelMatrix(),this._cgl.popPMatrix(),this._cgl.popModelMatrix(),this._cgl.popViewMatrix(),this._cgl.popPMatrix(),this._cgl.popViewPort()},it.prototype.bind=function(){null!==this._textureSource?this.switched?(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf2),this._cgl.pushGlFrameBuffer(this._frameBuf2)):(this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._frameBuf),this._cgl.pushGlFrameBuffer(this._frameBuf)):this._log.warn("no base texture set!")},it.prototype.finish=function(){null!==this._textureSource?(this._cgl.TextureEffectMesh.render(this._cgl.getShader()),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.popGlFrameBuffer()),this._cgl.profileData.profileTextureEffect++,this._textureTarget.filter==w.FILTER_MIPMAP&&(this.switched?(this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,this._textureSource.tex),this._textureSource.updateMipMap()):(this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,this._textureTarget.tex),this._textureTarget.updateMipMap()),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D,null)),this.switched=!this.switched,this._countEffects++):this._log.warn("no base texture set!")},it.prototype.getCurrentTargetTexture=function(){return this.switched?this._textureSource:this._textureTarget},it.prototype.getCurrentSourceTexture=function(){return 0==this._countEffects&&this._bgTex?this._bgTex:this.switched?this._textureTarget:this._textureSource},it.prototype.delete=function(){this._textureTarget&&this._textureTarget.delete(),this._textureSource&&this._textureSource.delete(),this._cgl.gl.deleteRenderbuffer(this._renderbuffer),this._cgl.gl.deleteFramebuffer(this._frameBuf)},it.prototype.createMesh=function(){this._cgl.TextureEffectMesh=et.getSimpleRect(this._cgl,"texEffectRect")},it.checkOpNotInTextureEffect=function(t){return!(t.patch.cgl&&(t.uiAttribs.error&&!t.patch.cgl.currentTextureEffect?(t.setUiError("textureeffect",null),0):t.patch.cgl.currentTextureEffect&&(t.patch.cgl.currentTextureEffect&&!t.uiAttribs.error?(t.setUiError("textureeffect","This op can not be a child of a ImageCompose/texture effect! imagecompose should only have textureeffect childs.",0),1):t.patch.cgl.currentTextureEffect)))},it.checkOpInEffect=function(t,e){if(e=e||0,t.patch.cgl.currentTextureEffect){if(t.uiAttribs.uierrors&&t.patch.cgl.currentTextureEffect.imgCompVer>=e)return t.setUiError("texeffect",null),!0;e&&t.patch.cgl.currentTextureEffect.imgCompVer<e&&t.setUiError("texeffect","This op must be a child of an ImageCompose op with version >="+e+' <span class="button-small" onclick="gui.patchView.downGradeOp(\''+t.id+"','"+t.name+"')\">Downgrade</span> to previous version",1)}return!!t.patch.cgl.currentTextureEffect||(t.patch.cgl.currentTextureEffect||t.uiAttribs.uierrors&&0!=t.uiAttribs.uierrors.length?!!t.patch.cgl.currentTextureEffect:(t.setUiError("texeffect",'This op must be a child of an ImageCompose op! More infos <a href="https://docs.cables.gl/image_composition/image_composition.html" target="_blank">here</a>. ',1),!1))},it.getBlendCode=function(t){let e="".endl()+"vec3 _blend(vec3 base,vec3 blend)".endl()+"{".endl()+"   vec3 colNew=blend;".endl()+"   #ifdef BM_MULTIPLY".endl()+"       colNew=base*blend;".endl()+"   #endif".endl()+"   #ifdef BM_MULTIPLY_INV".endl()+"       colNew=base* vec3(1.0)-blend;".endl()+"   #endif".endl()+"   #ifdef BM_AVERAGE".endl()+"       colNew=((base + blend) / 2.0);".endl()+"   #endif".endl()+"   #ifdef BM_ADD".endl()+"       colNew=min(base + blend, vec3(1.0));".endl()+"   #endif".endl()+"   #ifdef BM_SUBTRACT_ONE".endl()+"       colNew=max(base + blend - vec3(1.0), vec3(0.0));".endl()+"   #endif".endl()+"   #ifdef BM_SUBTRACT".endl()+"       colNew=base - blend;".endl()+"   #endif".endl()+"   #ifdef BM_DIFFERENCE".endl()+"       colNew=abs(base - blend);".endl()+"   #endif".endl()+"   #ifdef BM_NEGATION".endl()+"       colNew=(vec3(1.0) - abs(vec3(1.0) - base - blend));".endl()+"   #endif".endl()+"   #ifdef BM_EXCLUSION".endl()+"       colNew=(base + blend - 2.0 * base * blend);".endl()+"   #endif".endl()+"   #ifdef BM_LIGHTEN".endl()+"       colNew=max(blend, base);".endl()+"   #endif".endl()+"   #ifdef BM_DARKEN".endl()+"       colNew=min(blend, base);".endl()+"   #endif".endl()+"   #ifdef BM_OVERLAY".endl()+"      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_SCREEN".endl()+"      #define BlendScreenf(base, blend)       (1.0 - ((1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendScreenf(base.r, blend.r),BlendScreenf(base.g, blend.g),BlendScreenf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_SOFTLIGHT".endl()+"      #define BlendSoftLightf(base, blend)    ((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))".endl()+"      colNew=vec3(BlendSoftLightf(base.r, blend.r),BlendSoftLightf(base.g, blend.g),BlendSoftLightf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_HARDLIGHT".endl()+"      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_COLORDODGE".endl()+"      #define BlendColorDodgef(base, blend)   ((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))".endl()+"      colNew=vec3(BlendColorDodgef(base.r, blend.r),BlendColorDodgef(base.g, blend.g),BlendColorDodgef(base.b, blend.b));".endl()+"   #endif".endl()+"   #ifdef BM_COLORBURN".endl()+"      #define BlendColorBurnf(base, blend)    ((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))".endl()+"      colNew=vec3(BlendColorBurnf(base.r, blend.r),BlendColorBurnf(base.g, blend.g),BlendColorBurnf(base.b, blend.b));".endl()+"   #endif".endl()+"   return colNew;".endl()+"}".endl();return t||(e+="vec4 cgl_blend(vec4 oldColor,vec4 newColor,float amount)".endl()+"{".endl()+"vec4 col=vec4( _blend(oldColor.rgb,newColor.rgb) ,1.0);".endl()+"col=vec4( mix( col.rgb, oldColor.rgb ,1.0-oldColor.a*amount),1.0);".endl()+"return col;".endl()+"}".endl()),t>=3&&(e+="vec4 cgl_blendPixel(vec4 base,vec4 col,float amount)".endl()+"{".endl()+"#ifdef BM_MATH_ADD".endl()+"   return vec4(base.rgb+col.rgb*amount,1.0);".endl()+"#endif".endl()+"#ifdef BM_MATH_SUB".endl()+"   return vec4(base.rgb-col.rgb*amount,1.0);".endl()+"#endif".endl()+"#ifdef BM_MATH_MUL".endl()+"   return vec4(base.rgb*col.rgb*amount,1.0);".endl()+"#endif".endl()+"#ifdef BM_MATH_DIV".endl()+"   return vec4(base.rgb/col.rgb*amount,1.0);".endl()+"#endif".endl()+"#ifndef BM_MATH".endl()+"vec3 colNew=_blend(base.rgb,col.rgb);".endl()+"float newA=clamp(base.a+(col.a*amount),0.,1.);".endl()+"#ifdef BM_ALPHAMASKED".endl()+"newA=base.a;".endl()+"#endif".endl()+"return vec4(".endl()+"mix(colNew,base.rgb,1.0-(amount*col.a)),".endl()+"newA);".endl()+"#endif".endl()+"}".endl()),e},it.onChangeBlendSelect=function(t,e,i=!1){e=String(e),t.toggleDefine("BM_NORMAL","normal"==e),t.toggleDefine("BM_MULTIPLY","multiply"==e),t.toggleDefine("BM_MULTIPLY_INV","multiply invert"==e),t.toggleDefine("BM_AVERAGE","average"==e),t.toggleDefine("BM_ADD","add"==e),t.toggleDefine("BM_SUBTRACT_ONE","subtract one"==e),t.toggleDefine("BM_SUBTRACT","subtract"==e),t.toggleDefine("BM_DIFFERENCE","difference"==e),t.toggleDefine("BM_NEGATION","negation"==e),t.toggleDefine("BM_EXCLUSION","exclusion"==e),t.toggleDefine("BM_LIGHTEN","lighten"==e),t.toggleDefine("BM_DARKEN","darken"==e),t.toggleDefine("BM_OVERLAY","overlay"==e),t.toggleDefine("BM_SCREEN","screen"==e),t.toggleDefine("BM_SOFTLIGHT","softlight"==e),t.toggleDefine("BM_HARDLIGHT","hardlight"==e),t.toggleDefine("BM_COLORDODGE","color dodge"==e),t.toggleDefine("BM_COLORBURN","color burn"==e),t.toggleDefine("BM_MATH_ADD","Math Add"==e),t.toggleDefine("BM_MATH_SUB","Math Subtract"==e),t.toggleDefine("BM_MATH_MUL","Math Multiply"==e),t.toggleDefine("BM_MATH_DIV","Math Divide"==e),t.toggleDefine("BM_MATH",0==e.indexOf("Math ")),t.toggleDefine("BM_ALPHAMASKED",i)},it.AddBlendSelect=function(t,e,i){return t.inValueSelect(e||"Blend Mode",["normal","lighten","darken","multiply","multiply invert","average","add","subtract","difference","negation","exclusion","overlay","screen","color dodge","color burn","softlight","hardlight","subtract one","Math Add","Math Subtract","Math Multiply","Math Divide"],i||"normal")},it.AddBlendAlphaMask=function(t,e,i){return t.inSwitch(e||"Alpha Mask",["Off","On"],i||"Off")},it.setupBlending=function(t,e,i,s,r){const n=()=>{let s=!1;r&&(s="On"==r.get()),it.onChangeBlendSelect(e,i.get(),s);let n=i.get();"normal"==n?n=null:"multiply"==n?n="mul":"multiply invert"==n?n="mulinv":"lighten"==n?n="light":"darken"==n?n="darken":"average"==n?n="avg":"subtract one"==n?n="sub one":"subtract"==n?n="sub":"difference"==n?n="diff":"negation"==n?n="neg":"exclusion"==n?n="exc":"overlay"==n?n="ovl":"color dodge"==n?n="dodge":"color burn"==n?n="burn":"softlight"==n?n="soft":"hardlight"==n?n="hard":"Math Add"==n?n="+":"Math Subtract"==n?n="-":"Math Multiply"==n?n="*":"Math Divide"==n&&(n="/"),t.setUiAttrib({extendTitle:n})};t.setPortGroup("Blending",[i,s,r]);let o=!1;i.onChange=n,r&&(r.onChange=n,o="On"==r.get()),it.onChangeBlendSelect(e,i.get(),o)};const st={"CGL.BLENDMODES":function(){this.name="blendmodes",this.srcHeadFrag=it.getBlendCode()},"CGL.BLENDMODES3":function(){this.name="blendmodes3",this.srcHeadFrag=it.getBlendCode(3)},"CGL.LUMINANCE":function(){this.name="luminance",this.srcHeadFrag="".endl()+"float cgl_luminance(vec3 c)".endl()+"{".endl()+"    return dot(vec3(0.2126,0.7152,0.0722),c);".endl()+"}".endl()},"CGL.RANDOM_OLD":function(){this.name="randomNumber",this.srcHeadFrag="".endl()+"float cgl_random(vec2 co)".endl()+"{".endl()+"    return fract(sin(dot(co.xy ,vec2(12.9898,4.1414))) * 432758.5453);".endl()+"}".endl()+"vec3 cgl_random3(vec2 co)".endl()+"{".endl()+"    return vec3( cgl_random(co),cgl_random(co+0.5711),cgl_random(co+1.5711));".endl()+"}"},"CGL.RANDOM_LOW":function(){this.name="randomNumber",this.srcHeadFrag="".endl()+"float cgl_random(vec2 co)".endl()+"{".endl()+"    return fract(sin(dot(co.xy ,vec2(12.9898,4.1414))) * 358.5453);".endl()+"}".endl()+"vec3 cgl_random3(vec2 co)".endl()+"{".endl()+"    return vec3( cgl_random(co),cgl_random(co+0.5711),cgl_random(co+1.5711));".endl()+"}"},"CGL.RANDOM_TEX":function(){this.name="randomNumbertex",this.srcHeadFrag="".endl()+"UNI sampler2D CGLRNDTEX;".endl()+"float cgl_random(vec2 co)".endl()+"{".endl()+"    return texture(CGLRNDTEX,co*5711.0).r;".endl()+"}".endl()+"vec3 cgl_random3(vec2 co)".endl()+"{".endl()+"    return texture(CGLRNDTEX,co*5711.0).rgb;".endl()+"}",this.initUniforms=function(t){return[new Q(t,"t","CGLRNDTEX",7)]},this.onBind=function(t,e){w.getRandomTexture(t),t.setTexture(7,w.getRandomTexture(t).tex)}}},rt=function(){return window.performance.now()},nt=function(){return rt()},ot=function(){CABLES.EventTarget.apply(this),this._timeStart=rt(),this._timeOffset=0,this._currentTime=0,this._lastTime=0,this._paused=!0,this._delay=0,this.overwriteTime=-1};ot.prototype._getTime=function(){return this._lastTime=(rt()-this._timeStart)/1e3,this._lastTime+this._timeOffset},ot.prototype.setDelay=function(t){this._delay=t,this.emitEvent("timeChange")},ot.prototype.isPlaying=function(){return!this._paused},ot.prototype.update=function(){if(!this._paused)return this._currentTime=this._getTime(),this._currentTime},ot.prototype.getMillis=function(){return 1e3*this.get()},ot.prototype.get=ot.prototype.getTime=function(){return this.overwriteTime>=0?this.overwriteTime-this._delay:this._currentTime-this._delay},ot.prototype.togglePlay=function(){this._paused?this.play():this.pause()},ot.prototype.setTime=function(t){(isNaN(t)||t<0)&&(t=0),this._timeStart=rt(),this._timeOffset=t,this._currentTime=t,this.emitEvent("timeChange")},ot.prototype.setOffset=function(t){this._currentTime+t<0?(this._timeStart=rt(),this._timeOffset=0,this._currentTime=0):(this._timeOffset+=t,this._currentTime=this._lastTime+this._timeOffset),this.emitEvent("timeChange")},ot.prototype.play=function(){this._timeStart=rt(),this._paused=!1,this.emitEvent("playPause")},ot.prototype.pause=function(){this._timeOffset=this._currentTime,this._paused=!0,this.emitEvent("playPause")};const at=Math.PI/180,ht=(Math.PI,-1!=window.navigator.userAgent.indexOf("Windows")),lt=function(t){let e;if(t.wheelDelta)e=t.wheelDelta%120-0==-0?t.wheelDelta/120:t.wheelDelta/30,e*=-1.5,ht&&(e*=2);else{let i=t.deltaY;t.shiftKey&&(i=t.deltaX);const s=i||t.detail;e=-(s%3?10*s:s/3),e*=-3}return e>20&&(e=20),e<-20&&(e=-20),e},ct=lt,ut=lt,pt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_t=/[&<>"']/g,gt=RegExp(_t.source);let dt=0;const ft=function(t,e){if(!t)throw new Error("shader constructed without cgl "+e);this._log=new r("cgl_shader"),this._cgl=t,e||this._log.stack("no shader name given"),this._name=e||"unknown",this.glslVersion=0,t.glVersion>1&&(this.glslVersion=300),this._materialId=++dt,this.id=b(),this._isValid=!0,this._program=null,this._uniforms=[],this._drawBuffers=[!0],this._defines=[],this._needsRecompile=!0,this._compileReason="initial",this.ignoreMissingUniforms=!1,this._projMatrixUniform=null,this._mvMatrixUniform=null,this._mMatrixUniform=null,this._vMatrixUniform=null,this._camPosUniform=null,this._normalMatrixUniform=null,this._inverseViewMatrixUniform=null,this._attrVertexPos=-1,this.precision=t.patch.config.glslPrecision||"highp",this._pMatrixState=-1,this._vMatrixState=-1,this._countMissingUniforms=0,this._modGroupCount=0,this._feedBackNames=[],this._attributes=[],this.glPrimitive=null,this.offScreenPass=!1,this._extensions=[],this.srcVert=this.getDefaultVertexShader(),this.srcFrag=this.getDefaultFragmentShader(),this.lastCompile=0,this._moduleNames=[],this._modules=[],this._moduleNumId=0,this._libs=[],this._structNames=[],this._structUniformNames=[],this._textureStackUni=[],this._textureStackTex=[],this._textureStackType=[],this._textureStackTexCgl=[],this._tempNormalMatrix=mat4.create(),this._tempCamPosMatrix=mat4.create(),this._tempInverseViewMatrix=mat4.create(),this._tempInverseProjMatrix=mat4.create(),this.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"])};ft.prototype.isValid=function(){return this._isValid},ft.prototype.getCgl=function(){return this._cgl},ft.prototype.getName=function(){return this._name},ft.prototype.enableExtension=function(t){this.setWhyCompile("enable extension "+t),this._needsRecompile=!0,this._extensions.push(t)},ft.prototype.getAttrVertexPos=function(){return this._attrVertexPos},ft.prototype.hasTextureUniforms=function(){for(let t=0;t<this._uniforms.length;t++)if("t"==this._uniforms[t].getType())return!0;return!1},ft.prototype.setWhyCompile=function(t){this._compileReason=t},ft.prototype.copyUniformValues=function(t){for(let e=0;e<t._uniforms.length;e++)this._uniforms[e]?(-1!=t._uniforms[e].getName().indexOf("pathPoints")&&console.log("copyUniformValues",t._uniforms[e].getName(),t._uniforms[e].getValue()),this.getUniform(t._uniforms[e].getName()).set(t._uniforms[e].getValue())):this._log.log("unknown uniform?!");this.popTextures();for(let e=0;e<t._textureStackUni.length;e++)this._textureStackUni[e]=t._textureStackUni[e],this._textureStackTex[e]=t._textureStackTex[e],this._textureStackType[e]=t._textureStackType[e],this._textureStackTexCgl[e]=t._textureStackTexCgl[e]},ft.prototype.copy=function(){const t=new ft(this._cgl,this._name+" copy");t.setSource(this.srcVert,this.srcFrag),t._modules=JSON.parse(JSON.stringify(this._modules)),t._defines=JSON.parse(JSON.stringify(this._defines)),t._modGroupCount=this._modGroupCount,t._moduleNames=this._moduleNames,t.glPrimitive=this.glPrimitive,t.offScreenPass=this.offScreenPass,t._extensions=this._extensions,t.wireframe=this.wireframe,t._attributes=this._attributes;for(let e=0;e<this._uniforms.length;e++)this._uniforms[e].copy(t).resetLoc();return this.setWhyCompile("copy"),t._needsRecompile=!0,t},ft.prototype.setSource=function(t,e){this.srcVert=t,this.srcFrag=e,this.setWhyCompile("Source changed"),this._needsRecompile=!0,this._isValid=!0},ft.prototype._addLibs=function(t){for(const e in st)if(t.indexOf(e)>-1){const i=new st[e];t=t.replace("{{"+e+"}}",i.srcHeadFrag),this._libs.push(i),i.initUniforms&&i.initUniforms(this)}return t},ft.prototype.createStructUniforms=function(){let t="",e="";this._structNames=[],this._injectedStringsFrag={},this._injectedStringsVert={},this._structUniformNamesIndicesFrag=[],this._structUniformNamesIndicesVert=[];for(let i=0;i<this._uniforms.length;i++)if(this._uniforms[i].isStructMember()){const s="{{INJECTION_POINT_STRUCT_"+this._uniforms[i]._structName+"}}";if(-1===this._structNames.indexOf(this._uniforms[i]._structName)){const r="struct "+this._uniforms[i]._structName+" {".endl()+s+"};".endl().endl();"both"!==this._uniforms[i].getShaderType()&&"frag"!==this._uniforms[i].getShaderType()||(t=t.concat(r)),"both"!==this._uniforms[i].getShaderType()&&"vert"!==this._uniforms[i].getShaderType()||(e=e.concat(r)),this._structNames.push(this._uniforms[i]._structName),this._injectedStringsFrag[this._uniforms[i]._structName]=[],this._injectedStringsVert[this._uniforms[i]._structName]=[]}let r="";this._uniforms[i].comment&&(r=" // "+this._uniforms[i].comment);let n="";if(null==this._uniforms[i].getGlslTypeString()&&(n+="//"),n+="  "+this._uniforms[i].getGlslTypeString()+" "+this._uniforms[i]._propertyName+";"+r,"both"===this._uniforms[i].getShaderType()){if(-1===this._injectedStringsFrag[this._uniforms[i]._structName].indexOf(n)&&-1===this._injectedStringsVert[this._uniforms[i]._structName].indexOf(n)){const r=t.lastIndexOf(s),o=e.lastIndexOf(s);t=t.slice(0,r)+n+t.slice(r-1),e=e.slice(0,o)+n+e.slice(o-1),this._injectedStringsFrag[this._uniforms[i]._structName].push(n),this._injectedStringsVert[this._uniforms[i]._structName].push(n)}-1===this._structUniformNamesIndicesFrag.indexOf(i)&&this._structUniformNamesIndicesFrag.push(i),-1===this._structUniformNamesIndicesVert.indexOf(i)&&this._structUniformNamesIndicesVert.push(i)}else if("frag"===this._uniforms[i].getShaderType()){if(-1===this._injectedStringsFrag[this._uniforms[i]._structName].indexOf(n)){const e=t.lastIndexOf(s);t=t.slice(0,e)+n+t.slice(e-1),this._injectedStringsFrag[this._uniforms[i]._structName].push(n)}-1===this._structUniformNamesIndicesFrag.indexOf(i)&&this._structUniformNamesIndicesFrag.push(i)}else if("vert"===this._uniforms[i].getShaderType()){if(-1===this._injectedStringsVert[this._uniforms[i]._structName].indexOf(n)){const t=e.lastIndexOf(s);e=e.slice(0,t)+n+e.slice(t-1),this._injectedStringsVert[this._uniforms[i]._structName].push(n)}-1===this._structUniformNamesIndicesVert.indexOf(i)&&this._structUniformNamesIndicesVert.push(i)}}this._uniDeclarationsFrag=[],this._uniDeclarationsVert=[];for(let e=0;e<this._structUniformNamesIndicesFrag.length;e+=1){const i=this._structUniformNamesIndicesFrag[e],s="UNI "+this._uniforms[i]._structName+" "+this._uniforms[i]._structUniformName+";".endl();if(-1===this._uniDeclarationsFrag.indexOf(s)){const e="{{INJECTION_POINT_STRUCT_"+this._uniforms[i]._structName+"}}";t=t.replace(e,""),t+=s,this._uniDeclarationsFrag.push(s)}}for(let t=0;t<this._structUniformNamesIndicesVert.length;t+=1){const i=this._structUniformNamesIndicesVert[t],s="UNI "+this._uniforms[i]._structName+" "+this._uniforms[i]._structUniformName+";".endl();if(-1===this._uniDeclarationsVert.indexOf(s)){const t="{{INJECTION_POINT_STRUCT_"+this._uniforms[i]._structName+"}}";e=e.replace(t,""),e+=s,this._uniDeclarationsVert.push(s)}}return[e,t]},ft.prototype._getAttrSrc=function(t,e){const i={};return t.name&&t.type&&(i.srcHeadVert="",e||(i.srcHeadVert+="#ifndef ATTRIB_"+t.name.endl()),i.srcHeadVert+="#define ATTRIB_"+t.name.endl(),i.srcHeadVert+="IN "+t.type+" "+t.name+";".endl(),e||(i.srcHeadVert+="#endif".endl()),t.nameFrag&&(i.srcHeadVert+="",e||(i.srcHeadVert+="#ifndef ATTRIB_"+t.nameFrag.endl()),i.srcHeadVert+="#define ATTRIB_"+t.nameFrag.endl(),i.srcHeadVert+="OUT "+t.type+" "+t.nameFrag+";".endl(),e||(i.srcHeadVert+="#endif".endl()),i.srcVert="".endl()+t.nameFrag+"="+t.name+";",i.srcHeadFrag="",e||(i.srcHeadFrag+="#ifndef ATTRIB_"+t.nameFrag.endl()),i.srcHeadFrag+="#define ATTRIB_"+t.nameFrag.endl(),i.srcHeadFrag+="IN "+t.type+" "+t.nameFrag+";".endl(),e||(i.srcHeadFrag+="#endif".endl()))),i},ft.prototype.compile=function(){if(this._cgl.aborted)return;const t=performance.now();this._cgl.profileData.profileShaderCompiles++,this._cgl.profileData.profileShaderCompileName=this._name+" ["+this._compileReason+"]";let e="";if(this._extensions)for(let t=0;t<this._extensions.length;t++)e+="#extension "+this._extensions[t]+" : enable".endl();let i="";this._defines.length&&(i="\n// cgl generated".endl());for(let t=0;t<this._defines.length;t++)i+="#define "+this._defines[t][0]+" "+this._defines[t][1]+"".endl();const s=this.createStructUniforms();if(this._cgl.profileData.addHeavyEvent("shader compile",this._name+" ["+this._compileReason+"]"),this._compileReason="",this._uniforms){const t=this._uniforms.map((t=>t._name)),e=[];for(let i=0;i<this._uniforms.length;i++){const s=this._uniforms[i];t.indexOf(s._name,i+1)>-1&&e.push(i)}for(let t=this._uniforms.length-1;t>=0;t-=1)e.indexOf(t)>-1?this._uniforms.splice(t,1):this._uniforms[t].resetLoc()}this._cgl.printError("uniform resets"),this.hasTextureUniforms()&&(i+="#define HAS_TEXTURES".endl());let r="",n="";this.srcFrag||(this._log.error("[cgl shader] has no fragment source!",this),this.srcVert=this.getDefaultVertexShader(),this.srcFrag=this.getDefaultFragmentShader()),300==this.glslVersion?(r="#version 300 es".endl()+"// ".endl()+"// vertex shader "+this._name.endl()+"// ".endl()+"precision "+this.precision+" float;".endl()+"precision "+this.precision+" sampler2D;".endl()+"".endl()+"#define WEBGL2".endl()+"#define texture2D texture".endl()+"#define UNI uniform".endl()+"#define IN in".endl()+"#define OUT out".endl(),n="#version 300 es".endl()+"// ".endl()+"// fragment shader "+this._name.endl()+"// ".endl()+"precision "+this.precision+" float;".endl()+"precision "+this.precision+" sampler2D;".endl()+"".endl()+"#define WEBGL2".endl()+"#define texture2D texture".endl()+"#define IN in".endl()+"#define OUT out".endl()+"#define UNI uniform".endl()+"{{DRAWBUFFER}}".endl()):(n="".endl()+"// ".endl()+"// fragment shader "+this._name.endl()+"// ".endl()+"#define WEBGL1".endl()+"#define texture texture2D".endl()+"#define outColor gl_FragColor".endl()+"#define IN varying".endl()+"#define UNI uniform".endl(),r="".endl()+"// ".endl()+"// vertex shader "+this._name.endl()+"// ".endl()+"#define WEBGL1".endl()+"#define texture texture2D".endl()+"#define OUT varying".endl()+"#define IN attribute".endl()+"#define UNI uniform".endl());let o="\n// cgl generated".endl(),a="\n// cgl generated".endl();n+="\n// active mods: --------------- ",r+="\n// active mods: --------------- ";let h=!1,l=!1;for(let t=0;t<this._moduleNames.length;t++)for(let e=0;e<this._modules.length;e++)this._modules[e].name==this._moduleNames[t]&&((this._modules[e].srcBodyFrag||this._modules[e].srcHeadFrag)&&(h=!0,n+="\n// "+t+"."+e+". "+this._modules[e].title+" ("+this._modules[e].name+")"),(this._modules[e].srcBodyVert||this._modules[e].srcHeadVert)&&(r+="\n// "+t+"."+e+". "+this._modules[e].title+" ("+this._modules[e].name+")",l=!0));l||(n+="\n// no mods used..."),h||(n+="\n// no mods used..."),n+="\n",r+="\n";for(let t=0;t<this._uniforms.length;t++)if(this._uniforms[t].shaderType&&!this._uniforms[t].isStructMember()){let e="";this._uniforms[t].getGlslTypeString()||(e+="// "),e+="UNI "+this._uniforms[t].getGlslTypeString()+" "+this._uniforms[t].getName();let i="";this._uniforms[t].comment&&(i=" // "+this._uniforms[t].comment),"vert"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||-1==this.srcVert.indexOf(e)&&-1==this.srcVert.indexOf("uniform "+this._uniforms[t].getGlslTypeString()+" "+this._uniforms[t].getName())&&(o+=e+";"+i.endl()),"frag"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||-1==this.srcFrag.indexOf(e)&&-1==this.srcFrag.indexOf("uniform "+this._uniforms[t].getGlslTypeString()+" "+this._uniforms[t].getName())&&(a+=e+";"+i.endl())}let c=0,u=0;for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].shaderType&&!this._uniforms[t].isStructMember()&&("vert"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||u++,"frag"!=this._uniforms[t].shaderType&&"both"!=this._uniforms[t].shaderType||c++);c>=this._cgl.maxUniformsFrag&&this._log.warn("[cgl_shader] num uniforms frag: "+c+" / "+this._cgl.maxUniformsFrag),u>=this._cgl.maxUniformsVert&&this._log.warn("[cgl_shader] num uniforms vert: "+u+" / "+this._cgl.maxUniformsVert),-1==n.indexOf("precision")&&(n="precision "+this.precision+" float;".endl()+n),-1==r.indexOf("precision")&&(r="precision "+this.precision+" float;".endl()+r),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(n+="#define MOBILE".endl(),r+="#define MOBILE".endl()),r=e+r+i+s[0]+o+"\n// -- \n"+this.srcVert,n=e+n+i+s[1]+a+"\n// -- \n"+this.srcFrag;let p="",_="";this._modules.sort((function(t,e){return t.group-e.group})),this._modules.sort((function(t,e){return t.priority||0-e.priority||0}));let g=!1;for(let t=0;t<this._moduleNames.length;t++){let e="",i="";if(!g){g=!0;for(let t=0;t<this._attributes.length;t++){const i=this._getAttrSrc(this._attributes[t],!0);i.srcHeadVert&&(p+=i.srcHeadVert),i.srcVert&&(e+=i.srcVert),i.srcHeadFrag&&(_+=i.srcHeadFrag)}}for(let s=0;s<this._modules.length;s++){const r=this._modules[s];if(r.name==this._moduleNames[t]){if(p+="\n//---- MOD: group:"+r.group+": idx:"+s+" - prfx:"+r.prefix+" - "+r.title+" ------\n",_+="\n//---- MOD: group:"+r.group+": idx:"+s+" - prfx:"+r.prefix+" - "+r.title+" ------\n",e+="\n\n//---- MOD: "+r.title+" / "+r.priority+" ------\n",i+="\n\n//---- MOD: "+r.title+" / "+r.priority+" ------\n",r.attributes)for(let t=0;t<r.attributes.length;t++){const i=this._getAttrSrc(r.attributes[t],!1);i.srcHeadVert&&(p+=i.srcHeadVert),i.srcVert&&(e+=i.srcVert),i.srcHeadFrag&&(_+=i.srcHeadFrag)}p+=r.srcHeadVert||"",_+=r.srcHeadFrag||"",e+=r.srcBodyVert||"",i+=r.srcBodyFrag||"",p+="\n//---- end mod ------\n",_+="\n//---- end mod ------\n",e+="\n//---- end mod ------\n",i+="\n//---- end mod ------\n",e=e.replace(/{{mod}}/g,r.prefix),i=i.replace(/{{mod}}/g,r.prefix),p=p.replace(/{{mod}}/g,r.prefix),_=_.replace(/{{mod}}/g,r.prefix),e=e.replace(/MOD_/g,r.prefix),i=i.replace(/MOD_/g,r.prefix),p=p.replace(/MOD_/g,r.prefix),_=_.replace(/MOD_/g,r.prefix)}}r=r.replace("{{"+this._moduleNames[t]+"}}",e),n=n.replace("{{"+this._moduleNames[t]+"}}",i)}r=r.replace("{{MODULES_HEAD}}",p),n=n.replace("{{MODULES_HEAD}}",_),r=this._addLibs(r),n=this._addLibs(n);let d="";for(let t=0;t<16;t++)n.indexOf("outColor"+t)>-1&&(this._drawBuffers[t]=!0);if(1==this._drawBuffers.length)d="out vec4 outColor;".endl(),d+="#define gl_FragColor outColor".endl();else{d+="#define MULTI_COLORTARGETS".endl(),d+="vec4 outColor;".endl();let t=0;for(let e=0;e<this._drawBuffers.length;e++)0==t&&(d+="#define gl_FragColor outColor"+e+"".endl()),d+="layout(location = "+e+") out vec4 outColor"+e+";".endl(),t++}if(n=n.replace("{{DRAWBUFFER}}",d),this._program){this._program=this._createProgram(r,n),this._projMatrixUniform=null;for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].resetLoc()}else this._program=this._createProgram(r,n);this.finalShaderFrag=n,this.finalShaderVert=r,$.lastMesh=null,$.lastShader=null,this._countMissingUniforms=0,this._needsRecompile=!1,this.lastCompile=nt(),this._cgl.profileData.shaderCompileTime+=performance.now()-t},ft.hasChanged=function(){return this._needsRecompile},ft.prototype.bind=function(){if(this._isValid&&!this._cgl.aborted&&($.lastShader=this,this._program&&!this._needsRecompile||this.compile(),this._isValid)){if(!this._projMatrixUniform&&!this.ignoreMissingUniforms&&(this._countMissingUniforms++,this._countMissingUniforms<10)){this._projMatrixUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_PROJMAT),this._attrVertexPos=this._cgl.glGetAttribLocation(this._program,J.SHADERVAR_VERTEX_POSITION),this._mvMatrixUniform=this._cgl.gl.getUniformLocation(this._program,"mvMatrix"),this._vMatrixUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_VIEWMAT),this._mMatrixUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_MODELMAT),this._camPosUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_VIEWPOS),this._normalMatrixUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_NORMALMAT),this._inverseViewMatrixUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_INVVIEWMAT),this._inverseProjMatrixUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_INVPROJMAT),this._materialIdUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_MATERIALID),this._objectIdUniform=this._cgl.gl.getUniformLocation(this._program,J.SHADERVAR_UNI_OBJECTID);for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].needsUpdate=!0}this._cgl.currentProgram!=this._program&&(this._cgl.profileData.profileShaderBinds++,this._cgl.gl.useProgram(this._program),this._cgl.currentProgram=this._program);for(let t=0;t<this._uniforms.length;t++)this._uniforms[t].needsUpdate&&this._uniforms[t].updateValue();if(this._pMatrixState!=this._cgl.getProjectionMatrixStateCount()&&(this._pMatrixState=this._cgl.getProjectionMatrixStateCount(),this._cgl.gl.uniformMatrix4fv(this._projMatrixUniform,!1,this._cgl.pMatrix),this._cgl.profileData.profileMVPMatrixCount++),this._objectIdUniform&&this._cgl.gl.uniform1f(this._objectIdUniform,++this._cgl.frameStore.objectIdCounter),this._materialIdUniform&&this._cgl.gl.uniform1f(this._materialIdUniform,this._materialId),this._vMatrixUniform)this._vMatrixState!=this._cgl.getViewMatrixStateCount()&&(this._cgl.gl.uniformMatrix4fv(this._vMatrixUniform,!1,this._cgl.vMatrix),this._cgl.profileData.profileMVPMatrixCount++,this._vMatrixState=this._cgl.getViewMatrixStateCount(),this._inverseViewMatrixUniform&&(mat4.invert(this._tempInverseViewMatrix,this._cgl.vMatrix),this._cgl.gl.uniformMatrix4fv(this._inverseViewMatrixUniform,!1,this._tempInverseViewMatrix),this._cgl.profileData.profileMVPMatrixCount++),this._inverseProjMatrixUniform&&(mat4.invert(this._tempInverseProjMatrix,this._cgl.pMatrix),this._cgl.gl.uniformMatrix4fv(this._inverseProjMatrixUniform,!1,this._tempInverseProjMatrix),this._cgl.profileData.profileMVPMatrixCount++)),this._cgl.gl.uniformMatrix4fv(this._mMatrixUniform,!1,this._cgl.mMatrix),this._cgl.profileData.profileMVPMatrixCount++,this._camPosUniform&&(mat4.invert(this._tempCamPosMatrix,this._cgl.vMatrix),this._cgl.gl.uniform3f(this._camPosUniform,this._tempCamPosMatrix[12],this._tempCamPosMatrix[13],this._tempCamPosMatrix[14]),this._cgl.profileData.profileMVPMatrixCount++);else{const t=mat4.create();mat4.mul(t,this._cgl.vMatrix,this._cgl.mMatrix),this._cgl.gl.uniformMatrix4fv(this._mvMatrixUniform,!1,t),this._cgl.profileData.profileMVPMatrixCount++}this._normalMatrixUniform&&(mat4.invert(this._tempNormalMatrix,this._cgl.mMatrix),mat4.transpose(this._tempNormalMatrix,this._tempNormalMatrix),this._cgl.gl.uniformMatrix4fv(this._normalMatrixUniform,!1,this._tempNormalMatrix),this._cgl.profileData.profileMVPMatrixCount++);for(let t=0;t<this._libs.length;t++)this._libs[t].onBind&&this._libs[t].onBind.bind(this._libs[t])(this._cgl,this);return this._bindTextures(),this._isValid}},ft.prototype.unBind=function(){},ft.prototype.toggleDefine=function(t,e){e&&"object"==typeof e&&e.addEventListener&&(e.changeListener&&e.removeEventListener(e.changeListener),e.onToggleDefine=e=>{this.toggleDefine(t,e)},e.changeListener=e.on("change",e.onToggleDefine),e=e.get()),e?this.define(t):this.removeDefine(t)},ft.prototype.define=function(t,e){null==e&&(e=""),"object"==typeof e&&(e.removeEventListener("change",e.onDefineChange),e.onDefineChange=e=>{this.define(t,e)},e.on("change",e.onDefineChange),e=e.get());for(let i=0;i<this._defines.length;i++){if(this._defines[i][0]==t&&this._defines[i][1]==e)return;if(this._defines[i][0]==t)return this._defines[i][1]=e,this.setWhyCompile("define "+t+" "+e),void(this._needsRecompile=!0)}this.setWhyCompile("define "+t+" "+e),this._needsRecompile=!0,this._defines.push([t,e])},ft.prototype.getDefines=function(){return this._defines},ft.prototype.getDefine=function(t){for(let e=0;e<this._defines.length;e++)if(this._defines[e][0]==t)return this._defines[e][1];return null},ft.prototype.hasDefine=function(t){for(let e=0;e<this._defines.length;e++)if(this._defines[e][0]==t)return!0},ft.prototype.removeDefine=function(t){for(let e=0;e<this._defines.length;e++)if(this._defines[e][0]==t)return this._defines.splice(e,1),this._needsRecompile=!0,void this.setWhyCompile("define removed:"+t)},ft.prototype.removeModule=function(t){for(let e=0;e<this._modules.length;e++)if(t&&t.id&&(this._modules[e].id==t.id||!this._modules[e])){let i=!0;for(;i;){i=!1;for(let e=0;e<this._uniforms.length;e++)0!=this._uniforms[e].getName().indexOf(t.prefix)||(this._uniforms.splice(e,1),i=!0)}this._needsRecompile=!0,this.setWhyCompile("remove module "+t.title),this._modules.splice(e,1);break}},ft.prototype.getNumModules=function(){return this._modules.length},ft.prototype.getCurrentModules=function(){return this._modules},ft.prototype.addModule=function(t,e){if(!this.hasModule(t.id))return t.id||(t.id=CABLES.simpleId()),t.numId||(t.numId=this._moduleNumId),t.num||(t.num=this._modules.length),e&&!e.group&&(e.group=b()),t.group||(t.group=e?e.group:b()),t.prefix="mod"+t.group+"_",this._modules.push(t),this._needsRecompile=!0,this.setWhyCompile("add module "+t.title),this._moduleNumId++,t},ft.prototype.hasModule=function(t){for(let e=0;e<this._modules.length;e++)if(this._modules[e].id==t)return!0;return!1},ft.prototype.setModules=function(t){this._moduleNames=t},ft.prototype.dispose=function(){this._cgl.gl.deleteProgram(this._program)},ft.prototype.needsRecompile=function(){return this._needsRecompile},ft.prototype.setDrawBuffers=function(t){console.log("useless drawbuffers...?!")},ft.prototype.getUniforms=function(){return this._uniforms},ft.prototype.getUniform=function(t){for(let e=0;e<this._uniforms.length;e++)if(this._uniforms[e].getName()==t)return this._uniforms[e];return null},ft.prototype.removeAllUniforms=function(){this._uniforms=[]},ft.prototype.removeUniform=function(t){for(let e=0;e<this._uniforms.length;e++)this._uniforms[e].getName()==t&&this._uniforms.splice(e,1);this._needsRecompile=!0,this.setWhyCompile("remove uniform "+t)},ft.prototype._addUniform=function(t){this._uniforms.push(t),this.setWhyCompile("add uniform "+name),this._needsRecompile=!0},ft.prototype.addUniformFrag=function(t,e,i,s,r,n){const o=new CGL.Uniform(this,t,e,i,s,r,n);return o.shaderType="frag",o},ft.prototype.addUniformVert=function(t,e,i,s,r,n){const o=new CGL.Uniform(this,t,e,i,s,r,n);return o.shaderType="vert",o},ft.prototype.addUniformBoth=function(t,e,i,s,r,n){const o=new CGL.Uniform(this,t,e,i,s,r,n);return o.shaderType="both",o},ft.prototype.addUniformStructFrag=function(t,e,i){const s={};if(!i)return s;for(let r=0;r<i.length;r+=1){const n=i[r];if(!this.hasUniform(e+"."+n.name)){const i=new CGL.Uniform(this,n.type,e+"."+n.name,n.v1,n.v2,n.v3,n.v4,e,t,n.name);i.shaderType="frag",s[e+"."+n.name]=i}}return s},ft.prototype.addUniformStructVert=function(t,e,i){const s={};if(!i)return s;for(let r=0;r<i.length;r+=1){const n=i[r];if(!this.hasUniform(e+"."+n.name)){const i=new CGL.Uniform(this,n.type,e+"."+n.name,n.v1,n.v2,n.v3,n.v4,e,t,n.name);i.shaderType="vert",s[e+"."+n.name]=i}}return s},ft.prototype.addUniformStructBoth=function(t,e,i){const s={};if(!i)return s;for(let r=0;r<i.length;r+=1){const n=i[r];if("2i"!==n.type&&"i"!==n.type&&"3i"!==n.type||this._log.error("Adding an integer struct member to both shaders can potentially error. Please use different structs for each shader. Error occured in struct:",t," with member:",n.name," of type:",n.type,"."),!this.hasUniform(e+"."+n.name)){const i=new CGL.Uniform(this,n.type,e+"."+n.name,n.v1,n.v2,n.v3,n.v4,e,t,n.name);i.shaderType="both",s[e+"."+n.name]=i}}return s},ft.prototype.hasUniform=function(t){for(let e=0;e<this._uniforms.length;e++)if(this._uniforms[e].getName()==t)return!0;return!1},ft.prototype._createProgram=function(t,e){this._cgl.printError("before _createprogram");const i=this._cgl.gl.createProgram();return this.vshader=ft.createShader(this._cgl,t,this._cgl.gl.VERTEX_SHADER,this),this.fshader=ft.createShader(this._cgl,e,this._cgl.gl.FRAGMENT_SHADER,this),this.vshader&&this.fshader?(this._cgl.gl.attachShader(i,this.vshader),this._cgl.gl.attachShader(i,this.fshader),this._linkProgram(i,t,e),this._cgl.printError("shader _createProgram"),i):(this._isValid=!1,this._cgl.printError("shader _createProgram"),console.log("could not link shaderprogram"),null)},ft.prototype.hasErrors=function(){return this._hasErrors},ft.prototype._linkProgram=function(t,e,i){this._cgl.printError("before _linkprogram"),this._feedBackNames.length>0&&this._cgl.gl.transformFeedbackVaryings(t,this._feedBackNames,this._cgl.gl.SEPARATE_ATTRIBS),this._cgl.gl.linkProgram(t),this._cgl.printError("gl.linkprogram"),this._isValid=!0,this._hasErrors=!1,!1!==this._cgl.patch.config.glValidateShader&&(this._cgl.gl.validateProgram(t),this._cgl.gl.getProgramParameter(t,this._cgl.gl.VALIDATE_STATUS)||(console.log("shaderprogram validation failed..."),console.log(this._name+" programinfo: ",this._cgl.gl.getProgramInfoLog(t))),this._cgl.gl.getProgramParameter(t,this._cgl.gl.LINK_STATUS)||(this._hasErrors=!0,this._log.warn(this._cgl.gl.getShaderInfoLog(this.fshader)||"empty shader infolog"),this._log.warn(this._cgl.gl.getShaderInfoLog(this.vshader)||"empty shader infolog"),this._log.error(this._name+" shader linking fail..."),console.log(this._name+" programinfo: ",this._cgl.gl.getProgramInfoLog(t)),console.log("--------------------------------------"),console.log(this),console.log("--------------------------------------"),this._isValid=!1,this._name="errorshader",this.setSource(ft.getDefaultVertexShader(),ft.getErrorFragmentShader()),this._cgl.printError("shader link err")))},ft.prototype.getProgram=function(){return this._program},ft.prototype.setFeedbackNames=function(t){this.setWhyCompile("setFeedbackNames"),this._needsRecompile=!0,this._feedBackNames=t},ft.prototype.getDefaultVertexShader=ft.getDefaultVertexShader=function(){return"{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    gl_PointSize=10.0;\n\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}\n"},ft.prototype.getDefaultFragmentShader=ft.getDefaultFragmentShader=function(t,e,i){return null==t&&(t=.5,e=.5,i=.5),"".endl()+"IN vec2 texCoord;".endl()+"{{MODULES_HEAD}}".endl()+"void main()".endl()+"{".endl()+"    vec4 col=vec4("+t+","+e+","+i+",1.0);".endl()+"    {{MODULE_COLOR}}".endl()+"    outColor = col;".endl()+"}"},ft.prototype.addAttribute=function(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t.name&&this._attributes[e].nameFrag==t.nameFrag)return;this._attributes.push(t),this._needsRecompile=!0,this.setWhyCompile("addAttribute")},ft.prototype.bindTextures=ft.prototype._bindTextures=function(){this._textureStackTex.length>this._cgl.maxTextureUnits&&this._log.warn("[shader._bindTextures] too many textures bound",this._textureStackTex.length+"/"+this._cgl.maxTextureUnits);for(let t=0;t<this._textureStackTex.length;t++)if(this._textureStackTex[t]||this._textureStackTexCgl[t]){let e=this._textureStackTex[t];this._textureStackTexCgl[t]&&(e=this._textureStackTexCgl[t].tex||CGL.Texture.getEmptyTexture(this._cgl).tex);let i=!0;this._textureStackUni[t]?(this._textureStackUni[t].setValue(t),i=this._cgl.setTexture(t,e,this._textureStackType[t])):(this._log.warn("no uniform for pushtexture",this._name),i=this._cgl.setTexture(t,e,this._textureStackType[t])),i||console.warn("tex bind failed",this.getName(),this._textureStackUni[t])}else this._log.warn("no texture for pushtexture",this._name)},ft.prototype.setUniformTexture=function(t,e){e=e||CGL.Texture.getTempTexture(this._cgl);for(let i=0;i<this._textureStackUni.length;i++)if(this._textureStackUni[i]==t){const t=this._textureStackTex[i]||this._textureStackTexCgl[i];return e.hasOwnProperty("tex")?(this._textureStackTexCgl[i]=e,this._textureStackTex[i]=null):(this._textureStackTexCgl[i]=null,this._textureStackTex[i]=e),t}return null},ft.prototype.pushTexture=function(t,e,i){if(!t)throw new Error("no uniform given to texturestack");if(e){if(!(e.hasOwnProperty("tex")||e instanceof WebGLTexture))return this._log.warn(new Error("invalid texture").stack),void this._log.warn("[cgl_shader] invalid texture...",e);this._textureStackUni.push(t),e.hasOwnProperty("tex")?(this._textureStackTexCgl.push(e),this._textureStackTex.push(null)):(this._textureStackTexCgl.push(null),this._textureStackTex.push(e)),this._textureStackType.push(i)}},ft.prototype.popTexture=function(){this._textureStackUni.pop(),this._textureStackTex.pop(),this._textureStackTexCgl.pop(),this._textureStackType.pop()},ft.prototype.popTextures=function(){this._textureStackTex.length=this._textureStackTexCgl.length=this._textureStackType.length=this._textureStackUni.length=0},ft.prototype.getMaterialId=function(){return this._materialId},ft.prototype.getInfo=function(){const t={};return t.name=this._name,t.defines=this.getDefines(),t.hasErrors=this.hasErrors(),t},ft.getErrorFragmentShader=function(){return"".endl()+"void main()".endl()+"{".endl()+"   float g=mod((gl_FragCoord.y+gl_FragCoord.x),50.0)/50.0;".endl()+"   g= step(0.1,g);".endl()+"   outColor = vec4( g+0.5, 0.0, 0.0, 1.0);".endl()+"}"},ft.createShader=function(t,e,i,s){if(t.aborted)return;const r=t.gl.createShader(i);if(t.gl.shaderSource(r,e),t.gl.compileShader(r),!t.gl.getShaderParameter(r,t.gl.COMPILE_STATUS)){let o=t.gl.getShaderInfoLog(r);if(!o)return void console.warn("empty shader info log",this._name);console.log("compile status: ");const a=function(t){const e=[],i=t.split("\n");for(const t in i){const s=i[t].split(":");parseInt(s[2],10)&&e.push(parseInt(s[2],10))}return e}(o);let h='<pre style="margin-bottom:0px;"><code class="shaderErrorCode language-glsl" style="padding-bottom:0px;max-height: initial;max-width: initial;">';const l=e.match(/^.*((\r\n|\n|\r)|$)/gm);if(!t.aborted&&o){i==t.gl.VERTEX_SHADER&&console.log("VERTEX_SHADER"),i==t.gl.FRAGMENT_SHADER&&console.log("FRAGMENT_SHADER");for(const t in l){const e=parseInt(t,10)+1,i=e+": "+l[t];console.log(i);let s=!1;for(const t in a)a[t]==e&&(s=!0);s&&(h+="</code></pre>",h+='<pre style="margin:0"><code class="language-glsl" style="background-color:#660000;padding-top:0px;padding-bottom:0px">'),h+=(n=i)&&gt.test(n)?n.replace(_t,(function(t){return pt[t]})):n||"",s&&(h+="</code></pre>",h+='<pre style="margin:0"><code class="language-glsl" style=";padding-top:0px;padding-bottom:0px">')}}console.warn(o),o=o.replace(/\n/g,"<br/>"),t.patch.isEditorMode()&&console.log("Shader error ",s._name,o,this),h=o+"<br/>"+h+"<br/><br/>",h+="</code></pre>",t.patch.emitEvent("criticalError",{title:"Shader error "+s._name,text:h,exception:{message:o}}),s.setSource(ft.getDefaultVertexShader(),ft.getErrorFragmentShader())}var n;return r};class mt{constructor(t){this._cgl=t,this._lastTime=0,this.pause=!1,this.profileUniformCount=0,this.profileShaderBinds=0,this.profileUniformCount=0,this.profileShaderCompiles=0,this.profileVideosPlaying=0,this.profileMVPMatrixCount=0,this.profileEffectBuffercreate=0,this.profileShaderGetUniform=0,this.profileFrameBuffercreate=0,this.profileMeshSetGeom=0,this.profileTextureNew=0,this.profileGenMipMap=0,this.profileOnAnimFrameOps=0,this.profileFencedPixelRead=0,this.profileMainloopMs=0,this.profileMeshDraw=0,this.profileTextureEffect=0,this.profileTexPreviews=0,this.shaderCompileTime=0,this.profileMeshNumElements=0,this.profileMeshAttributes=0,this.profileSingleMeshAttribute=[],this.heavyEvents=[],this.doProfileGlQuery=!1,this.glQueryData={}}clear(){this.profileSingleMeshAttribute={},this.profileMeshAttributes=0,this.profileUniformCount=0,this.profileShaderGetUniform=0,this.profileShaderCompiles=0,this.profileShaderBinds=0,this.profileTextureResize=0,this.profileFrameBuffercreate=0,this.profileEffectBuffercreate=0,this.profileTextureDelete=0,this.profileMeshSetGeom=0,this.profileVideosPlaying=0,this.profileMVPMatrixCount=0,this.profileNonTypedAttrib=0,this.profileNonTypedAttribNames="",this.profileTextureNew=0,this.profileGenMipMap=0,this.profileFramebuffer=0,this.profileMeshDraw=0,this.profileTextureEffect=0,this.profileTexPreviews=0,this.profileMeshNumElements=0,this.profileFencedPixelRead=0}clearGlQuery(){for(let t in this.glQueryData)(!this.glQueryData[t].lastClear||performance.now()-this.glQueryData[t].lastClear>1e3)&&(this.glQueryData[t].time=this.glQueryData[t]._times/this.glQueryData[t]._numcount,this.glQueryData[t].num=this.glQueryData[t]._numcount,this.glQueryData[t]._times=0,this.glQueryData[t]._numcount=0,this.glQueryData[t].lastClear=performance.now())}addHeavyEvent(t,e,i){const s={event:t,name:e,info:i,date:performance.now()};this.heavyEvents.push(s),this._cgl.emitEvent("heavyEvent",s)}}class Et{constructor(t){t?this._canvasEle=t.canvasEle:console.error("CgCanvas no options"),t.cg||console.error("CgCanvas options has no cg"),t.canvasEle||console.error("CgCanvas options has no canvasEle"),this._cg=t.cg,this.pixelDensity=1,this.canvasWidth=this.canvasEle.clientWidth,this.canvasHeight=this.canvasEle.clientHeight,this._oldWidthRp=-1,this._oldHeightRp=-1,this.setSize(this.canvasWidth,this.canvasHeight)}get canvasEle(){return this._canvasEle}setSize(t,e,i){this._oldWidthRp==t*this.pixelDensity&&this._oldHeightRp==e*this.pixelDensity||(this._oldWidthRp=this.canvasEle.width=t*this.pixelDensity,this._oldHeightRp=this.canvasEle.height=e*this.pixelDensity,i||(this.canvasEle.style.width=t+"px",this.canvasEle.style.height=e+"px"),this.updateSize(),this._cg.emitEvent("resize"))}updateSize(){this.canvasEle.width=this.canvasWidth=this.canvasEle.clientWidth*this.pixelDensity,this.canvasEle.height=this.canvasHeight=this.canvasEle.clientHeight*this.pixelDensity}dispose(){this._canvasEle.remove(),this._canvasEle=null}}const Tt={GAPI_WEBGL:0,GAPI_WEBGPU:1,DEPTH_COMPARE_NEVER:0,DEPTH_COMPARE_LESS:1,DEPTH_COMPARE_EQUAL:2,DEPTH_COMPARE_LESSEQUAL:3,DEPTH_COMPARE_GREATER:4,DEPTH_COMPARE_NOTEQUAL:5,DEPTH_COMPARE_GREATEREQUAL:6,DEPTH_COMPARE_ALWAYS:7,CULL_NONE:0,CULL_BACK:1,CULL_FRONT:2,CULL_BOTH:3,Geometry:G,BoundingBox:V,FpsCounter:class extends H{constructor(){super(),this._timeStartFrame=0,this._timeStartSecond=0,this._fpsCounter=0,this._msCounter=0,this._frameCount=0,this.stats={ms:0,fps:0}}get frameCount(){return this._frameCount}startFrame(){this._timeStartFrame=CABLES.now()}endFrame(){this._frameCount++,this._fpsCounter++;const t=CABLES.now()-this._timeStartFrame;this._msCounter+=t,CABLES.now()-this._timeStartSecond>1e3&&this.endSecond()}endSecond(){this.stats.fps=this._fpsCounter,this.stats.ms=Math.round(this._msCounter/this._fpsCounter*100)/100,this.emitEvent("performance",this.stats),this._fpsCounter=0,this._msCounter=0,this._timeStartSecond=CABLES.now()}},CgCanvas:Et},At=function(){this._arr=[mat4.create()],this._index=0,this.stateCounter=0};At.prototype.push=function(t){if(this._index++,this.stateCounter++,this._index==this._arr.length){const t=mat4.create();this._arr.push(t)}return mat4.copy(this._arr[this._index],t||this._arr[this._index-1]),this._arr[this._index]},At.prototype.pop=function(){return this.stateCounter++,this._index--,this._index<0&&(this._index=0),this._arr[this._index]},At.prototype.length=function(){return this._index},__webpack_require__(122);class bt extends H{constructor(t){super(),this.fpsCounter=new CABLES.CG.FpsCounter,this._identView=vec3.create(),this._ident=vec3.create(),vec3.set(this._identView,0,0,-2),vec3.set(this._ident,0,0,0),this.patch=t,this.DEPTH_COMPARE_FUNC_NEVER=0,this.DEPTH_COMPARE_FUNC_LESS=1,this.DEPTH_COMPARE_FUNC_EQUAL=2,this.DEPTH_COMPARE_FUNC_LESSEQUAL=3,this.DEPTH_COMPARE_FUNC_GREATER=4,this.DEPTH_COMPARE_FUNC_NOTEQUAL=5,this.DEPTH_COMPARE_FUNC_GREATEREQUAL=6,this.DEPTH_COMPARE_FUNC_ALWAYS=7,this.pMatrix=mat4.create(),this.mMatrix=mat4.create(),this.vMatrix=mat4.create(),this._textureslots=[],this._pMatrixStack=new At,this._mMatrixStack=new At,this._vMatrixStack=new At,this.canvasScale=1,mat4.identity(this.mMatrix),mat4.identity(this.vMatrix)}get canvasWidth(){return this.cgCanvas.canvasWidth}get canvasHeight(){return this.cgCanvas.canvasHeight}set pixelDensity(t){this.cgCanvas.pixelDensity=t}get pixelDensity(){return this.cgCanvas.pixelDensity}getGApiName(){return["WebGL","WebGPU"][this.gApi]}get canvas(){return this.cgCanvas.canvasEle}setCanvas(t){"string"==typeof t&&(t=document.getElementById(t)),this.cgCanvas=new Et({canvasEle:t,cg:this}),this._setCanvas&&this._setCanvas(t),this.updateSize()}updateSize(){this.cgCanvas.updateSize()}setSize(t,e,i){this.cgCanvas.setSize(t,e,i)}_resizeToWindowSize(){this.setSize(window.innerWidth,window.innerHeight),this.updateSize()}_resizeToParentSize(){const t=this.canvas.parentElement;t?(this.setSize(t.clientWidth,t.clientHeight),this.updateSize()):this._log.error("cables: can not resize to container element")}setAutoResize(t){window.removeEventListener("resize",this._resizeToWindowSize.bind(this)),window.removeEventListener("resize",this._resizeToParentSize.bind(this)),"window"==t&&(window.addEventListener("resize",this._resizeToWindowSize.bind(this)),window.addEventListener("orientationchange",this._resizeToWindowSize.bind(this)),this._resizeToWindowSize()),"parent"==t&&(window.addEventListener("resize",this._resizeToParentSize.bind(this)),this._resizeToParentSize())}pushPMatrix(){this.pMatrix=this._pMatrixStack.push(this.pMatrix)}popPMatrix(){return this.pMatrix=this._pMatrixStack.pop(),this.pMatrix}getProjectionMatrixStateCount(){return this._pMatrixStack.stateCounter}pushModelMatrix(){this.mMatrix=this._mMatrixStack.push(this.mMatrix)}popModelMatrix(){return this.mMatrix=this._mMatrixStack.pop(),this.mMatrix}modelMatrix(){return this.mMatrix}pushViewMatrix(){this.vMatrix=this._vMatrixStack.push(this.vMatrix)}popViewMatrix(){this.vMatrix=this._vMatrixStack.pop()}getViewMatrixStateCount(){return this._vMatrixStack.stateCounter}_startMatrixStacks(t,e){t=t||this._ident,e=e||this._identView,mat4.perspective(this.pMatrix,45,this.canvasWidth/this.canvasHeight,.1,1e3),mat4.identity(this.mMatrix),mat4.identity(this.vMatrix),mat4.translate(this.mMatrix,this.mMatrix,t),mat4.translate(this.vMatrix,this.vMatrix,e),this.pushPMatrix(),this.pushModelMatrix(),this.pushViewMatrix()}_endMatrixStacks(){this.popViewMatrix(),this.popModelMatrix(),this.popPMatrix()}dispose(){this.aborted=!0,this.cgCanvas&&this.cgCanvas.dispose(),this._dispose&&this._dispose()}}class xt extends bt{constructor(t){super(t),this.gApi=Tt.GAPI_WEBGL,this.aborted=!1,this.pushMvMatrix=this.pushModelMatrix,this.popMvMatrix=this.popmMatrix=this.popModelMatrix,this.profileData=new mt(this),this._log=new r("cgl_context"),this._viewPort=[0,0,0,0],this.glVersion=0,this.glUseHalfFloatTex=!1,this.clearCanvasTransparent=!0,this.clearCanvasDepth=!0,this.debugOneFrame=!1,this.checkGlErrors=!1,this.maxTextureUnits=0,this.maxVaryingVectors=0,this.currentProgram=null,this._hadStackError=!1,this.glSlowRenderer=!1,this._isSafariCrap=!1,this.temporaryTexture=null,this.frameStore={},this._onetimeCallbacks=[],this.gl=null,this._cursor="auto",this._currentCursor="",this._viewPortStack=[],this._glFrameBufferStack=[],this._frameBufferStack=[],this._shaderStack=[],this._stackDepthTest=[],this._simpleShader=new ft(this,"simpleshader"),this._simpleShader.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]),this._simpleShader.setSource(ft.getDefaultVertexShader(),ft.getDefaultFragmentShader()),this._currentShader=this._simpleShader,this._oldCanvasWidth=-1,this._oldCanvasHeight=-1,this._enabledExtensions={}}get viewPort(){if(this._viewPortStack.length>3){const t=this._viewPortStack.length;return[this._viewPortStack[t-4],this._viewPortStack[t-3],this._viewPortStack[t-2],this._viewPortStack[t-1]]}return this._viewPort}get mvMatrix(){return this.mMatrix}set mvMatrix(t){this.mMatrix=t}exitError(t,e){console.log(t,e),this.patch.exitError(t,e),this.aborted=!0}_setCanvas(t){if(t||this._log.stack("_setCanvas undef"),this.patch.config.canvas||(this.patch.config.canvas={}),this.patch.config.canvas.hasOwnProperty("preserveDrawingBuffer")||(this.patch.config.canvas.preserveDrawingBuffer=!1),this.patch.config.canvas.hasOwnProperty("premultipliedAlpha")||(this.patch.config.canvas.premultipliedAlpha=!1),this.patch.config.canvas.hasOwnProperty("alpha")||(this.patch.config.canvas.alpha=!1),this.patch.config.canvas.stencil=!0,this.patch.config.hasOwnProperty("clearCanvasColor")&&(this.clearCanvasTransparent=this.patch.config.clearCanvasColor),this.patch.config.hasOwnProperty("clearCanvasDepth")&&(this.clearCanvasDepth=this.patch.config.clearCanvasDepth),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&navigator.userAgent.match(/iPhone/i)&&(this._isSafariCrap=!0,this.glUseHalfFloatTex=!0),this.patch.config.canvas.forceWebGl1||(this.gl=t.getContext("webgl2",this.patch.config.canvas)),this.gl&&"WebGL 1.0"!=this.gl.getParameter(this.gl.VERSION))this.glVersion=2;else{this.gl=t.getContext("webgl",this.patch.config.canvas)||t.getContext("experimental-webgl",this.patch.config.canvas),this.glVersion=1,/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&(this.patch.config.canvas.hasOwnProperty("powerPreference")||(this.patch.config.canvas.powerPreference="high-performance")),this.enableExtension("OES_standard_derivatives");const e=this.enableExtension("ANGLE_instanced_arrays")||this.gl;e.vertexAttribDivisorANGLE&&(this.gl.vertexAttribDivisor=e.vertexAttribDivisorANGLE.bind(e),this.gl.drawElementsInstanced=e.drawElementsInstancedANGLE.bind(e))}if(!this.gl||this.gl.isContextLost())return this.aborted=!0,void this.exitError("NO_WEBGL","sorry, could not initialize WebGL. Please check if your Browser supports WebGL or try to restart your browser.");const e=this.enableExtension("WEBGL_debug_renderer_info");if(e&&(this.glRenderer=this.gl.getParameter(e.UNMASKED_RENDERER_WEBGL),"Google SwiftShader"===this.glRenderer&&(this.glSlowRenderer=!0)),this.canvas.addEventListener("webglcontextlost",(t=>{if(this.aborted)return console.log("[cgl_state] aborted context lost... can be ignored...");this._log.error("canvas lost...",t),this.emitEvent("webglcontextlost"),this.aborted=!0})),this.maxVaryingVectors=this.gl.getParameter(this.gl.MAX_VARYING_VECTORS),this.maxTextureUnits=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.maxTexSize=this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),this.maxUniformsFrag=this.gl.getParameter(this.gl.MAX_FRAGMENT_UNIFORM_VECTORS),this.maxUniformsVert=this.gl.getParameter(this.gl.MAX_VERTEX_UNIFORM_VECTORS),this.maxSamples=0,this.gl.MAX_SAMPLES&&(this.maxSamples=this.gl.getParameter(this.gl.MAX_SAMPLES)),1==this.glVersion){this.enableExtension("OES_standard_derivatives");const t=this.enableExtension("ANGLE_instanced_arrays")||this.gl;t.vertexAttribDivisorANGLE&&(this.gl.vertexAttribDivisor=t.vertexAttribDivisorANGLE.bind(t),this.gl.drawElementsInstanced=t.drawElementsInstancedANGLE.bind(t))}this.DEPTH_FUNCS=[this.gl.NEVER,this.gl.ALWAYS,this.gl.LESS,this.gl.LEQUAL,this.gl.GREATER,this.gl.GEQUAL,this.gl.EQUAL,this.gl.NOTEQUAL],this.CULL_MODES=[null,this.gl.BACK,this.gl.FRONT,this.gl.FRONT_AND_BACK]}getInfo(){return{glVersion:this.glVersion,glRenderer:this.glRenderer,glUseHalfFloatTex:this.glUseHalfFloatTex,maxVaryingVectors:this.maxVaryingVectors,maxTextureUnits:this.maxTextureUnits,maxTexSize:this.maxTexSize,maxUniformsFrag:this.maxUniformsFrag,maxUniformsVert:this.maxUniformsVert,maxSamples:this.maxSamples}}popViewPort(){this._viewPortStack.pop(),this._viewPortStack.pop(),this._viewPortStack.pop(),this._viewPortStack.pop(),0==this._viewPortStack.length?this.setViewPort(0,0,this.canvasWidth,this.canvasHeight):this.setViewPort(this._viewPortStack[this._viewPort.length-4],this._viewPortStack[this._viewPort.length-3],this._viewPortStack[this._viewPort.length-2],this._viewPortStack[this._viewPort.length-1])}pushViewPort(t,e,i,s){this._viewPortStack.push(t,e,i,s),this.setViewPort(t,e,i,s)}getViewPort(){return this._viewPort}resetViewPort(){this.gl.viewport(this._viewPort[0],this._viewPort[1],this._viewPort[2],this._viewPort[3])}setViewPort(t,e,i,s){this._viewPort[0]=Math.round(t),this._viewPort[1]=Math.round(e),this._viewPort[2]=Math.round(i),this._viewPort[3]=Math.round(s),this.gl.viewport(this._viewPort[0],this._viewPort[1],this._viewPort[2],this._viewPort[3])}screenShot(t,e,i,s){e&&(this.gl.clearColor(1,1,1,1),this.gl.colorMask(!1,!1,!1,!0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.colorMask(!0,!0,!0,!0)),this.canvas&&this.canvas.toBlob&&this.canvas.toBlob((e=>{t?t(e):this._log.log("no screenshot callback...")}),i,s)}endFrame(){this.patch.isEditorMode()&&CABLES.GL_MARKER.drawMarkerLayer(this),this.setPreviousShader(),this._vMatrixStack.length()>0&&this.logStackError("view matrix stack length !=0 at end of rendering..."),this._mMatrixStack.length()>0&&this.logStackError("mvmatrix stack length !=0 at end of rendering..."),this._pMatrixStack.length()>0&&this.logStackError("pmatrix stack length !=0 at end of rendering..."),this._glFrameBufferStack.length>0&&this.logStackError("glFrameBuffer stack length !=0 at end of rendering..."),this._stackDepthTest.length>0&&this.logStackError("depthtest stack length !=0 at end of rendering..."),this._stackDepthWrite.length>0&&this.logStackError("depthwrite stack length !=0 at end of rendering..."),this._stackDepthFunc.length>0&&this.logStackError("depthfunc stack length !=0 at end of rendering..."),this._stackBlend.length>0&&this.logStackError("blend stack length !=0 at end of rendering..."),this._stackBlendMode.length>0&&this.logStackError("blendMode stack length !=0 at end of rendering..."),this._shaderStack.length>0&&this.logStackError("this._shaderStack length !=0 at end of rendering..."),this._stackCullFace.length>0&&this.logStackError("this._stackCullFace length !=0 at end of rendering..."),this._stackCullFaceFacing.length>0&&this.logStackError("this._stackCullFaceFacing length !=0 at end of rendering..."),this._viewPortStack.length>0&&this.logStackError("viewport stack length !=0 at end of rendering..."),this._frameStarted=!1,this._oldCanvasWidth==this.canvasWidth&&this._oldCanvasHeight==this.canvasHeight||(this._oldCanvasWidth=this.canvasWidth,this._oldCanvasHeight=this.canvasHeight,this.emitEvent("resize")),this._cursor!=this._currentCursor&&(this._currentCursor=this.canvas.style.cursor=this._cursor),this.emitEvent("endframe"),this.fpsCounter.endFrame()}logStackError(t){this._hadStackError||(this._hadStackError=!0,this._log.warn("["+this.canvas.id+"]: ",t))}getShader(){if(this._currentShader&&(!this.frameStore||!0===this.frameStore.renderOffscreen==this._currentShader.offScreenPass==1))return this._currentShader;for(let t=this._shaderStack.length-1;t>=0;t--)if(this._shaderStack[t]&&this.frameStore.renderOffscreen==this._shaderStack[t].offScreenPass)return this._shaderStack[t]}getDefaultShader(){return this._simpleShader}pushShader(t){if(this.frameStore.forceShaderMods)for(let e=0;e<this.frameStore.forceShaderMods.length;e++)t=this.frameStore.forceShaderMods[e].bind(t,!1);this._shaderStack.push(t),this._currentShader=t}setPreviousShader(){if(this.frameStore.forceShaderMods)for(let t=0;t<this.frameStore.forceShaderMods.length;t++)this.frameStore.forceShaderMods[t].unbind(!1);if(0===this._shaderStack.length)throw new Error("Invalid shader stack pop!");this._shaderStack.pop(),this._currentShader=this._shaderStack[this._shaderStack.length-1]}pushGlFrameBuffer(t){this._glFrameBufferStack.push(t)}popGlFrameBuffer(){return 0==this._glFrameBufferStack.length?null:(this._glFrameBufferStack.pop(),this._glFrameBufferStack[this._glFrameBufferStack.length-1])}getCurrentGlFrameBuffer(){return 0===this._glFrameBufferStack.length?null:this._glFrameBufferStack[this._glFrameBufferStack.length-1]}pushFrameBuffer(t){this._frameBufferStack.push(t)}popFrameBuffer(){return 0==this._frameBufferStack.length?null:(this._frameBufferStack.pop(),this._frameBufferStack[this._frameBufferStack.length-1])}getCurrentFrameBuffer(){return 0===this._frameBufferStack.length?null:this._frameBufferStack[this._frameBufferStack.length-1]}renderStart(t,e,i){this.fpsCounter.startFrame(),this.pushDepthTest(!0),this.pushDepthWrite(!0),this.pushDepthFunc(t.gl.LEQUAL),this.pushCullFaceFacing(t.gl.BACK),this.pushCullFace(!1),this.clearCanvasTransparent&&(t.gl.clearColor(0,0,0,0),t.gl.clear(t.gl.COLOR_BUFFER_BIT)),this.clearCanvasDepth&&t.gl.clear(t.gl.DEPTH_BUFFER_BIT),t.setViewPort(0,0,t.canvasWidth,t.canvasHeight),this._startMatrixStacks(e,i),t.pushBlendMode(Z.BLEND_NORMAL,!1);for(let t=0;t<this._textureslots.length;t++)this._textureslots[t]=null;if(this.pushShader(this._simpleShader),this._frameStarted=!0,this._onetimeCallbacks.length>0){for(let t=0;t<this._onetimeCallbacks.length;t++)this._onetimeCallbacks[t]();this._onetimeCallbacks.length=0}this.emitEvent("beginFrame")}renderEnd(t){this._endMatrixStacks(),this.popDepthTest(),this.popDepthWrite(),this.popDepthFunc(),this.popCullFaceFacing(),this.popCullFace(),this.popBlend(),this.popBlendMode(),t.endFrame(),this.emitEvent("endFrame")}getTexture(t){return this._textureslots[t]}hasFrameStarted(){return this._frameStarted}checkFrameStarted(t){this._frameStarted||(this._log.warn("frame not started "+t),this.patch.printTriggerStack())}setTexture(t,e,i){return this.checkFrameStarted("cgl setTexture"),null===e&&(e=CGL.Texture.getEmptyTexture(this).tex),this._textureslots[t]!=e&&(this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(i||this.gl.TEXTURE_2D,e),this._textureslots[t]=e),!0}fullScreen(){this.canvas.requestFullscreen?this.canvas.requestFullscreen():this.canvas.mozRequestFullScreen?this.canvas.mozRequestFullScreen():this.canvas.webkitRequestFullscreen?this.canvas.webkitRequestFullscreen():this.canvas.msRequestFullscreen&&this.canvas.msRequestFullscreen()}printError(t){if(!this.checkGlErrors)return;let e=!1,i=this.gl.getError();if(i!=this.gl.NO_ERROR){let s="";i==this.gl.OUT_OF_MEMORY&&(s="OUT_OF_MEMORY"),i==this.gl.INVALID_ENUM&&(s="INVALID_ENUM"),i==this.gl.INVALID_OPERATION&&(s="INVALID_OPERATION"),i==this.gl.INVALID_FRAMEBUFFER_OPERATION&&(s="INVALID_FRAMEBUFFER_OPERATION"),i==this.gl.INVALID_VALUE&&(s="INVALID_VALUE"),i==this.gl.CONTEXT_LOST_WEBGL&&(this.aborted=!0,s="CONTEXT_LOST_WEBGL"),i==this.gl.NO_ERROR&&(s="NO_ERROR"),e=!0,this._log.warn("gl error ["+this.canvas.id+"]: ",t,i,s),-1==this.canvas.id.indexOf("glGuiCanvas")&&(this._loggedGlError||(this.patch.printTriggerStack(),this._log.stack("glerror"),this._loggedGlError=!0))}return i=this.gl.getError(),e}saveScreenshot(t,e,i,s,r){this.patch.renderOneFrame();let n=this.canvas.clientWidth*this.pixelDensity,o=this.canvas.clientHeight*this.pixelDensity;function a(t,e,i){return Array(e-String(t).length+1).join(i||"0")+t}i&&(this.canvas.width=i,n=i),s&&(this.canvas.height=s,o=s);const h=new Date,l="".concat(String(h.getFullYear())+String(h.getMonth()+1)+String(h.getDate()),"_").concat(a(h.getHours(),2)).concat(a(h.getMinutes(),2)).concat(a(h.getSeconds(),2));t?t+=".png":t="cables_"+l+".png",this.patch.cgl.screenShot(function(i){if(this.canvas.width=n,this.canvas.height=o,i){const s=document.createElement("a");s.download=t,s.href=URL.createObjectURL(i),setTimeout((function(){s.click(),e&&e(i)}),100)}else this._log.log("screenshot: no blob")}.bind(this),r)}_dispose(){this._simpleShader.dispose(),this.gl=null}}xt.prototype.popShader=xt.prototype.setPreviousShader,xt.prototype.setShader=xt.prototype.pushShader,xt.prototype.addNextFrameOnceCallback=function(t){t&&this._onetimeCallbacks.push(t)},xt.prototype._stackDepthTest=[],xt.prototype.pushDepthTest=function(t){this._stackDepthTest.push(t),t?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)},xt.prototype.stateDepthTest=function(){return this._stackDepthTest[this._stackDepthTest.length-1]},xt.prototype.popDepthTest=function(){this._stackDepthTest.pop(),this._stackDepthTest[this._stackDepthTest.length-1]?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST)},xt.prototype._stackDepthWrite=[],xt.prototype.pushDepthWrite=function(t){t=t||!1,this._stackDepthWrite.push(t),this.gl.depthMask(t)},xt.prototype.stateDepthWrite=function(){return this._stackDepthWrite[this._stackDepthWrite.length-1]},xt.prototype.popDepthWrite=function(){this._stackDepthWrite.pop(),this.gl.depthMask(this._stackDepthWrite[this._stackDepthWrite.length-1]||!1)},xt.prototype._stackCullFace=[],xt.prototype.pushCullFace=function(t){this._stackCullFace.push(t),t?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE)},xt.prototype.stateCullFace=function(){return this._stackCullFace[this._stackCullFace.length-1]},xt.prototype.popCullFace=function(){this._stackCullFace.pop(),this._stackCullFace[this._stackCullFace.length-1]?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE)},xt.prototype._stackCullFaceFacing=[],xt.prototype.pushCullFaceFacing=function(t){this._stackCullFaceFacing.push(t),this.gl.cullFace(this._stackCullFaceFacing[this._stackCullFaceFacing.length-1])},xt.prototype.stateCullFaceFacing=function(){return this._stackCullFaceFacing[this._stackCullFaceFacing.length-1]},xt.prototype.popCullFaceFacing=function(){this._stackCullFaceFacing.pop(),this._stackCullFaceFacing.length>0&&this.gl.cullFace(this._stackCullFaceFacing[this._stackCullFaceFacing.length-1])},xt.prototype._stackDepthFunc=[],xt.prototype.pushDepthFunc=function(t){this._stackDepthFunc.push(t),this.gl.depthFunc(t)},xt.prototype.stateDepthFunc=function(){return this._stackDepthFunc.length>0&&this._stackDepthFunc[this._stackDepthFunc.length-1]},xt.prototype.popDepthFunc=function(){this._stackDepthFunc.pop(),this._stackDepthFunc.length>0&&this.gl.depthFunc(this._stackDepthFunc[this._stackDepthFunc.length-1])},xt.prototype._stackBlend=[],xt.prototype.pushBlend=function(t){this._stackBlend.push(t),t?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)},xt.prototype.popBlend=function(){this._stackBlend.pop(),this._stackBlend[this._stackBlend.length-1]?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND)},xt.prototype.stateBlend=function(){return this._stackBlend[this._stackBlend.length-1]},xt.prototype._stackBlendMode=[],xt.prototype._stackBlendModePremul=[],xt.prototype.pushBlendMode=function(t,e){this._stackBlendMode.push(t),this._stackBlendModePremul.push(e);const i=this._stackBlendMode.length-1;this.pushBlend(this._stackBlendMode[i]!==Z.BLEND_NONE),this._setBlendMode(this._stackBlendMode[i],this._stackBlendModePremul[i])},xt.prototype.popBlendMode=function(){this._stackBlendMode.pop(),this._stackBlendModePremul.pop();const t=this._stackBlendMode.length-1;this.popBlend(this._stackBlendMode[t]!==Z.BLEND_NONE),t>=0&&this._setBlendMode(this._stackBlendMode[t],this._stackBlendModePremul[t])},xt.prototype._stackStencil=[],xt.prototype.pushStencil=function(t){this._stackStencil.push(t),t?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST)},xt.prototype.popStencil=function(){this._stackStencil.pop(),this._stackStencil[this._stackStencil.length-1]?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST)},xt.prototype.glGetAttribLocation=function(t,e){return this.gl.getAttribLocation(t,e)},xt.prototype.shouldDrawHelpers=function(t){if(this.frameStore.shadowPass)return!1;if(!t.patch.isEditorMode())return!1;const e=this.getCurrentFrameBuffer();return(!e||!e.getWidth||this.canvasWidth/this.canvasHeight==e.getWidth()/e.getHeight())&&(CABLES.UI.renderHelper||CABLES.UI.renderHelperCurrent&&t.isCurrentUiOp())},xt.prototype._setBlendMode=function(t,e){const i=this.gl;t==Z.BLEND_NONE||(t==Z.BLEND_ADD?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ONE,i.ONE,i.ONE,i.ONE)):(i.blendEquation(i.FUNC_ADD),i.blendFunc(i.SRC_ALPHA,i.ONE)):t==Z.BLEND_SUB?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ZERO,i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ONE_MINUS_SRC_ALPHA)):(i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ZERO,i.ONE_MINUS_SRC_COLOR)):t==Z.BLEND_MUL?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA)):(i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ZERO,i.SRC_COLOR)):t==Z.BLEND_NORMAL?e?(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)):(i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)):this._log.log("setblendmode: unknown blendmode"))},xt.prototype.createMesh=function(t,e){return new CGL.Mesh(this,t,e)},xt.prototype.setCursor=function(t){this._cursor=t},xt.prototype.enableExtension=function(t){if(this._enabledExtensions.hasOwnProperty(t))return this._enabledExtensions[t];const e=this.gl.getExtension(t);return this._enabledExtensions[t]=e,e?this._log.log("enabled extension",t):this._log.warn("[cgl_state] extension not available "+t),e};const vt={Framebuffer:function(t,e,i,s){const n=t;this._log=new r("Framebuffer"),this.valid=!0;let o=n.gl.DEPTH_TEXTURE;o||(o=n.enableExtension("WEBGL_depth_texture")),o||(o=n.enableExtension("WEBKIT_WEBGL_depth_texture")),o||(o=n.enableExtension("MOZ_WEBGL_depth_texture")),o||n.exitError("NO_DEPTH_TEXTURE","no depth texture support");let a=e||512,h=i||512;(s=s||{isFloatingPointTexture:!1}).hasOwnProperty("clear")||(s.clear=!0),s.hasOwnProperty("filter")||(s.filter=w.FILTER_LINEAR);const l=new w(n,{isFloatingPointTexture:s.isFloatingPointTexture,filter:s.filter,wrap:s.wrap||w.CLAMP_TO_EDGE});let c=null;o&&(c=new w(n,{isDepthTexture:!0})),this._options=s;const u=n.gl.createFramebuffer(),p=n.gl.createRenderbuffer();this.getWidth=function(){return a},this.getHeight=function(){return h},this.getGlFrameBuffer=function(){return u},this.getDepthRenderBuffer=function(){return p},this.getTextureColor=function(){return l},this.getTextureDepth=function(){return c},this.setFilter=function(t){l.filter=t,l.setSize(a,h)},this.setSize=function(t,e){if(t<2&&(t=2),e<2&&(e=2),a=Math.ceil(t),h=Math.ceil(e),n.profileData.profileFrameBuffercreate++,n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,u),n.gl.bindRenderbuffer(n.gl.RENDERBUFFER,p),l.setSize(a,h),c&&c.setSize(a,h),o&&n.gl.renderbufferStorage(n.gl.RENDERBUFFER,n.gl.DEPTH_COMPONENT16,a,h),n.gl.framebufferTexture2D(n.gl.FRAMEBUFFER,n.gl.COLOR_ATTACHMENT0,n.gl.TEXTURE_2D,l.tex,0),o&&(n.gl.framebufferRenderbuffer(n.gl.FRAMEBUFFER,n.gl.DEPTH_ATTACHMENT,n.gl.RENDERBUFFER,p),n.gl.framebufferTexture2D(n.gl.FRAMEBUFFER,n.gl.DEPTH_ATTACHMENT,n.gl.TEXTURE_2D,c.tex,0)),!n.gl.isFramebuffer(u))throw new Error("Invalid framebuffer");const i=n.gl.checkFramebufferStatus(n.gl.FRAMEBUFFER);switch(i){case n.gl.FRAMEBUFFER_COMPLETE:break;case n.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT...",a,h,l.tex,p),this.valid=!1,new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");case n.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),this.valid=!1,new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");case n.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw this._log.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),this.valid=!1,new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");case n.gl.FRAMEBUFFER_UNSUPPORTED:throw this._log.warn("FRAMEBUFFER_UNSUPPORTED"),this.valid=!1,new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");case 36059:this._log.warn("Incomplete: FRAMEBUFFER_INCOMPLETE_DRAW_BUFFER from ext. Or Safari/iOS undefined behaviour."),this.valid=!1;break;default:throw this._log.warn("incomplete framebuffer",i),this.valid=!1,new Error("Incomplete framebuffer: "+i)}n.gl.bindTexture(n.gl.TEXTURE_2D,null),n.gl.bindRenderbuffer(n.gl.RENDERBUFFER,null),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,null)},this.renderStart=function(){n.pushModelMatrix(),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,u),n.pushGlFrameBuffer(u),n.pushFrameBuffer(this),n.pushPMatrix(),n.gl.viewport(0,0,a,h),this._options.clear&&(n.gl.clearColor(0,0,0,0),n.gl.clear(n.gl.COLOR_BUFFER_BIT|n.gl.DEPTH_BUFFER_BIT))},this.renderEnd=function(){n.popPMatrix(),n.gl.bindFramebuffer(n.gl.FRAMEBUFFER,n.popGlFrameBuffer()),n.popFrameBuffer(),n.popModelMatrix(),n.resetViewPort()},this.delete=function(){l.delete(),this.valid=!1,c&&c.delete(),n.gl.deleteRenderbuffer(p),n.gl.deleteFramebuffer(u)},this.dispose=this.delete,this.setSize(a,h)},Framebuffer2:M,Geometry:G,BoundingBox:V,Marker:function(t){const e=new G("marker");e.setPointVertices([1e-5,0,0,1,0,0,0,1e-5,0,0,1,0,0,0,1e-5,0,0,1]);const i=new tt(t,e,t.gl.LINES);i.setGeom(e);const s=new ft(t,"markermaterial"),r="".endl()+"precision highp float;".endl()+"IN vec3 axisColor;".endl()+"void main()".endl()+"{".endl()+"    vec4 col=vec4(axisColor,1.0);".endl()+"    outColor = col;".endl()+"}",n="".endl()+"IN vec3 vPosition;".endl()+"UNI mat4 projMatrix;".endl()+"UNI mat4 mvMatrix;".endl()+"OUT vec3 axisColor;".endl()+"void main()".endl()+"{".endl()+"   vec4 pos=vec4(vPosition, 1.0);".endl()+"   if(pos.x!=0.0)axisColor=vec3(1.0,0.3,0.0);".endl()+"   if(pos.y!=0.0)axisColor=vec3(0.0,1.0,0.2);".endl()+"   if(pos.z!=0.0)axisColor=vec3(0.0,0.5,1.0);".endl()+"   gl_Position = projMatrix * mvMatrix * pos;".endl()+"}";s.setSource(n,r),this._vScale=vec3.create(),this.draw=function(t,e,r){const n=e||2;t.pushModelMatrix(),t.pushShader(s),vec3.set(this._vScale,n,n,n),mat4.scale(t.mvMatrix,t.mvMatrix,this._vScale),t.pushDepthTest(1==r),i.render(t.getShader()),t.popDepthTest(),t.popShader(),t.popModelMatrix()}},WirePoint:function(t){const e=t.gl.createBuffer(),i=vec3.create();this.render=function(t,s){t.pushModelMatrix(),vec3.set(i,s,s,s),mat4.scale(t.mvMatrix,t.mvMatrix,i);const r=t.getShader();r&&(r.bind(),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.vertexAttribPointer(r.getAttrVertexPos(),e.itemSize,t.gl.FLOAT,!1,0,0),t.gl.enableVertexAttribArray(r.getAttrVertexPos()),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.drawArrays(t.gl.LINE_STRIP,0,e.numItems)),t.popModelMatrix()},function(){const i=[],s=24;let r=0,n=0;const o=.5;for(r=0;r<=Math.round(s);r++)n=360/Math.round(s)*r*at,i.push(Math.cos(n)*o),i.push(0),i.push(Math.sin(n)*o);for(r=0;r<=Math.round(s);r++)n=360/Math.round(s)*r*at,i.push(Math.cos(n)*o),i.push(Math.sin(n)*o),i.push(0);for(r=0;r<=Math.round(s);r++)n=360/Math.round(s)*r*at,i.push(0),i.push(Math.cos(n)*o),i.push(Math.sin(n)*o);t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.bufferData(t.gl.ARRAY_BUFFER,new Float32Array(i),t.gl.STATIC_DRAW),e.itemSize=3,e.numItems=i.length/e.itemSize}()},WireCube:function(t){const e=t.gl.createBuffer(),i=vec3.create();this.render=function(t,s,r,n){t.pushModelMatrix(),vec3.set(i,s||1,r||1,n||1),mat4.scale(t.mvMatrix,t.mvMatrix,i);const o=t.getShader();o&&(o.bind(),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.vertexAttribPointer(o.getAttrVertexPos(),e.itemSize,t.gl.FLOAT,!1,0,0),t.gl.enableVertexAttribArray(o.getAttrVertexPos()),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.drawArrays(t.gl.LINE_STRIP,0,e.numItems)),t.popModelMatrix()},function(){const i=[];i.push(-1,-1,1),i.push(1,-1,1),i.push(1,1,1),i.push(-1,1,1),i.push(-1,-1,1),i.push(-1,-1,-1),i.push(1,-1,-1),i.push(1,1,-1),i.push(-1,1,-1),i.push(-1,-1,-1),i.push(-1,-1,-1),i.push(-1,1,-1),i.push(-1,1,1),i.push(-1,-1,1),i.push(-1,-1,-1),i.push(1,-1,-1),i.push(1,1,-1),i.push(1,1,1),i.push(1,-1,1),i.push(1,-1,-1),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,e),t.gl.bufferData(t.gl.ARRAY_BUFFER,new Float32Array(i),t.gl.STATIC_DRAW),e.itemSize=3,e.numItems=i.length/e.itemSize}()},MatrixStack:At,Mesh:tt,MESH:$,ShaderLibMods:st,Shader:ft,Uniform:Q,MESHES:et,Context:xt,Texture:w,TextureEffect:it,isWindows:ht,getWheelSpeed:ct,getWheelDelta:ut,onLoadingAssetsFinished:null,ProfileData:mt,UniColorShader:class{constructor(t){this.shader=new CGL.Shader(t,"markermaterial");const e="".endl()+"void main()".endl()+"{".endl()+"    outColor = vec4(color.rgb,1.0);".endl()+"}",i="".endl()+"IN vec3 vPosition;".endl()+"UNI mat4 projMatrix;".endl()+"UNI mat4 mvMatrix;".endl()+"void main()".endl()+"{".endl()+"   gl_Position = projMatrix * mvMatrix * vec4(vPosition,1.0);".endl()+"}";this.shader.setSource(i,e),this.coloruni=this.shader.addUniformFrag("4f","color",[1,.777,1,1])}setColor(t,e,i,s){this.coloruni.set(t,e,i,s)}},...Z,...J,...K,...Z};window.CGL=vt;const yt=function(t){H.apply(this),this.id=CABLES.simpleId(),this.portIn=null,this.portOut=null,this.scene=t,this.activityCounter=0,this.ignoreInSerialize=!1};yt.prototype.setValue=function(t){void 0===t?this._setValue():this.portIn.set(t)},yt.prototype.activity=function(){this.activityCounter++},yt.prototype._setValue=function(){if(!this.portOut)return void this.remove();const t=this.portOut.get();t==t&&(this.portIn.type!=o.OP_PORT_TYPE_FUNCTION&&this.activity(),this.portIn.get()!==t?this.portIn.set(t):(this.portIn.changeAlways&&this.portIn.set(t),this.portOut.forceRefChange&&this.portIn.forceChange()))},yt.prototype.getOtherPort=function(t){return t==this.portIn?this.portOut:this.portIn},yt.prototype.remove=function(){this.portIn&&this.portIn.removeLink(this),this.portOut&&this.portOut.removeLink(this),this.scene&&this.scene.emitEvent("onUnLink",this.portIn,this.portOut,this),!this.portIn||this.portIn.type!=o.OP_PORT_TYPE_OBJECT&&this.portIn.type!=o.OP_PORT_TYPE_ARRAY||(this.portIn.set(null),this.portIn.links.length>0&&this.portIn.set(this.portIn.links[0].getOtherPort(this.portIn).get())),this.portIn&&this.portIn.op._checkLinksNeededToWork(),this.portOut&&this.portOut.op._checkLinksNeededToWork(),this.portIn=null,this.portOut=null,this.scene=null},yt.prototype.link=function(t,e){if(!yt.canLink(t,e))return console.warn("[core_link] cannot link ports!",t,e),!1;t.direction==a.PORT_DIR_IN?(this.portIn=t,this.portOut=e):(this.portIn=e,this.portOut=t),t.addLink(this),e.addLink(this),this.setValue(),t.onLink&&t.onLink(this),e.onLink&&e.onLink(this),t.op._checkLinksNeededToWork(),e.op._checkLinksNeededToWork()},yt.prototype.getSerialized=function(){const t={};return t.portIn=this.portIn.getName(),t.portOut=this.portOut.getName(),t.objIn=this.portIn.op.id,t.objOut=this.portOut.op.id,t},yt.canLinkText=function(t,e){if(t.direction==e.direction){let t="(out)";return e.direction==a.PORT_DIR_IN&&(t="(in)"),"can not link: same direction "+t}return t.op==e.op?"can not link: same op":t.type!=o.OP_PORT_TYPE_DYNAMIC&&e.type!=o.OP_PORT_TYPE_DYNAMIC&&t.type!=e.type?"can not link: different type":CABLES.UI&&t.type==o.OP_PORT_TYPE_OBJECT&&e.type==o.OP_PORT_TYPE_OBJECT&&t.uiAttribs.objType&&e.uiAttribs.objType&&t.uiAttribs.objType!=e.uiAttribs.objType?"incompatible objects":t?e?t.direction==a.PORT_DIR_IN&&t.isAnimated()||e.direction==a.PORT_DIR_IN&&e.isAnimated()?"can not link: is animated":t.isLinkedTo(e)?"ports already linked":t.canLink&&!t.canLink(e)||e.canLink&&!e.canLink(t)?"Incompatible":"can link":"can not link: port 2 invalid":"can not link: port 1 invalid"},yt.canLink=function(t,e){if(!t)return!1;if(!e)return!1;if(t.direction==a.PORT_DIR_IN&&t.isAnimated())return!1;if(e.direction==a.PORT_DIR_IN&&e.isAnimated())return!1;if(t.isHidden()||e.isHidden())return!1;if(t.isLinkedTo(e))return!1;if(t.direction==e.direction)return!1;if(CABLES.UI&&t.type==o.OP_PORT_TYPE_OBJECT&&e.type==o.OP_PORT_TYPE_OBJECT&&t.uiAttribs.objType&&e.uiAttribs.objType){if(0==t.uiAttribs.objType.indexOf("sg_")&&0==e.uiAttribs.objType.indexOf("sg_"))return!0;if(t.uiAttribs.objType!=e.uiAttribs.objType)return!1}return!(t.type!=e.type&&t.type!=o.OP_PORT_TYPE_DYNAMIC&&e.type!=o.OP_PORT_TYPE_DYNAMIC||t.type!=o.OP_PORT_TYPE_DYNAMIC&&e.type!=o.OP_PORT_TYPE_DYNAMIC&&(t.op==e.op||t.canLink&&!t.canLink(e)||e.canLink&&!e.canLink(t)))};class It extends j{constructor(t,e,i,s,r){super(t,e,i,s),this.get=()=>{let t=super.get();return CABLES.UI&&(""===t||null==t||s.values&&-1===s.values.indexOf(String(t))?this.op.setUiError("invalidswitch","Invalid Value ["+this.name+']: "'+t+'"'):this.op.setUiError("invalidswitch",null)),null==t&&(t=""),t},this.indexPort=r,this.indexPort.set=t=>{const e=s.values;if(!e)return;let i=Math.floor(t);i=Math.min(i,e.length-1),i=Math.max(i,0),this.indexPort.setValue(i),this.set(e[i]),this.op.patch.isEditorMode()&&window.gui&&gui.patchView.isCurrentOp(this.op)&&gui.opParams.show(this.op)}}setUiAttribs(t){const e=t.hidePort;t.hidePort=!0,super.setUiAttribs(t),void 0!==e&&this.indexPort.setUiAttribs({hidePort:e})}}class Rt extends It{setUiAttribs(t){if(this.indexPort.isLinked())for(const e in t)"greyout"!=e||t[e]||(t[e]="true");super.setUiAttribs(t)}}const St=function(){H.apply(this),this._log=new r("core_op"),this.data={},this.storage={},this._objName="",this.portsOut=[],this.portsIn=[],this.portsInData=[],this.opId="",this.uiAttribs={},this.enabled=!0,this.patch=arguments[0],this.name=arguments[1],this._linkTimeRules={needsLinkedToWork:[],needsParentOp:null},this.shouldWork={},this.hasUiErrors=!1,this._uiErrors={},this._hasAnimPort=!1,arguments[1]&&(this._shortOpName=CABLES.getShortOpName(arguments[1]),this.getTitle()),this.id=arguments[2]||f(),this.onAddPort=null,this.onCreate=null,this.onResize=null,this.onLoaded=null,this.onDelete=null,this.onUiAttrChange=null,this.onError=null,this._instances=null,this.preRender=null,this.init=null,Object.defineProperty(this,"objName",{get(){return this._objName}}),Object.defineProperty(this,"shortName",{get(){return this._shortOpName}})};{St.prototype.clearUiAttrib=function(t){this.uiAttrib({name:null})},St.prototype.getTitle=function(){return this.uiAttribs?(void 0!==this.uiAttribs.title&&""!==this.uiAttribs.title||-1!=this.objName.indexOf("Ops.Ui.")||(this.uiAttribs.title=this._shortOpName),void 0===this.uiAttribs.title&&(this.uiAttribs.title=this._shortOpName),this.uiAttribs.title):"nouiattribs"+this.name},St.prototype.setTitle=function(t){const e=this.name!=t;this.name=t,this.uiAttribs.title!=t&&this.uiAttr({title:t}),e&&this.emitEvent("onTitleChange",t)},St.prototype.setStorage=function(t){if(!t)return;this.storage=this.storage||{};let e=!1;for(const i in t)this.storage[i]!=t[i]&&(e=!0),this.storage[i]=t[i];e&&this.emitEvent("onStorageChange",t)},St.prototype.isSubPatchOp=function(){if(this.storage)return this.storage.subPatchVer||0};const t=function(t){if(!t)return;(t.error||t.warning||t.hint)&&this._log.warn("old ui error/warning attribute in "+this.name+", use op.setUiError !",t),"object"!=typeof t&&this._log.error("op.uiAttrib attribs are not of type object"),this.uiAttribs||(this.uiAttribs={});let e=!1;!CABLES.UI||!t.hasOwnProperty("translate")||this.uiAttribs.translate&&this.uiAttribs.translate.x==t.translate.x&&this.uiAttribs.translate.y==t.translate.y||(e=!0);let i=!1;for(const e in t)this.uiAttribs[e]!=t[e]&&(i=!0),this.uiAttribs[e]=t[e];this.uiAttribs.hasOwnProperty("selected")&&0==this.uiAttribs.selected&&delete this.uiAttribs.selected,t.title&&t.title!=this.name&&this.setTitle(t.title),i&&(this.emitEvent("onUiAttribsChange",t),this.patch.emitEvent("onUiAttribsChange",this,t)),e&&this.emitEvent("move")};St.prototype.setUiAttribs=St.prototype.setUiAttrib=St.prototype.uiAttr=t,St.prototype.getName=function(){return this.uiAttribs.name?this.uiAttribs.name:this.name},St.prototype.addOutPort=function(t){return t.direction=a.PORT_DIR_OUT,t._op=this,this.portsOut.push(t),this.emitEvent("onPortAdd",t),t},St.prototype.hasDynamicPort=function(){let t=0;for(t=0;t<this.portsIn.length;t++){if(this.portsIn[t].type==o.OP_PORT_TYPE_DYNAMIC)return!0;if("dyn"==this.portsIn[t].getName())return!0}for(t=0;t<this.portsOut.length;t++){if(this.portsOut[t].type==o.OP_PORT_TYPE_DYNAMIC)return!0;if("dyn"==this.portsOut[t].getName())return!0}return!1},St.prototype.addInPort=function(t){if(!(t instanceof j))throw new Error("parameter is not a port!");return t.direction=a.PORT_DIR_IN,t._op=this,this.portsIn.push(t),this.emitEvent("onPortAdd",t),t},St.prototype.inFunction=St.prototype.inTrigger=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_FUNCTION));return void 0!==e&&i.set(e),i},St.prototype.inFunctionButton=St.prototype.inTriggerButton=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_FUNCTION,{display:"button"}));return void 0!==e&&i.set(e),i},St.prototype.inFunctionButton=St.prototype.inUiTriggerButtons=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_FUNCTION,{display:"buttons"}));return void 0!==e&&i.set(e),i},St.prototype.inValueFloat=St.prototype.inValue=St.prototype.inFloat=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE));return void 0!==e&&(i.set(e),i.defaultValue=e),i},St.prototype.inValueBool=St.prototype.inBool=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{display:"bool"}));return void 0!==e&&(i.set(e),i.defaultValue=i.get()),i},St.prototype.inValueString=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{type:"string"}));return i.value="",void 0!==e&&(i.set(e),i.defaultValue=e),i},St.prototype.inString=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_STRING,{type:"string"}));return e=e||"",i.value=e,i.set(e),i.defaultValue=e,i},St.prototype.inValueText=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{type:"string",display:"text"}));return i.value="",void 0!==e&&(i.set(e),i.defaultValue=e),i},St.prototype.inTextarea=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_STRING,{type:"string",display:"text"}));return i.value="",void 0!==e&&(i.set(e),i.defaultValue=e),i},St.prototype.inStringEditor=function(t,e,i,s=!0){const r=this.addInPort(new j(this,t,o.OP_PORT_TYPE_STRING,{type:"string",display:"editor",editShortcut:!0,editorSyntax:i,hideFormatButton:s}));return r.value="",void 0!==e&&(r.set(e),r.defaultValue=e),r},St.prototype.inValueEditor=function(t,e,i,s=!0){const r=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{type:"string",display:"editor",editorSyntax:i,hideFormatButton:s}));return r.value="",void 0!==e&&(r.set(e),r.defaultValue=e),r},St.prototype.inValueSelect=St.prototype.inDropDown=function(t,e,i,s){let r=null;if(s){const i=new j(this,t,o.OP_PORT_TYPE_VALUE,{display:"dropdown",hidePort:!0,type:"string",values:e});r=this.addInPort(i)}else{const s=new j(this,t+" index",o.OP_PORT_TYPE_VALUE,{increment:"integer",hideParam:!0}),n=this.addInPort(s);if(e)for(let t=0;t<e.length;t++)e[t]=String(e[t]);const a=new Rt(this,t,o.OP_PORT_TYPE_VALUE,{display:"dropdown",hidePort:!0,type:"string",values:e},n);if(a.indexPort=s,s.onLinkChanged=function(){a.setUiAttribs({greyout:s.isLinked()})},r=this.addInPort(a),void 0!==i){r.set(i);const t=e.findIndex((t=>t==i));n.setValue(t),r.defaultValue=i,n.defaultValue=t}}return r},St.prototype.inSwitch=function(t,e,i,s){let r=null;if(s){const i=new j(this,t,o.OP_PORT_TYPE_STRING,{display:"switch",hidePort:!0,type:"string",values:e});r=this.addInPort(i)}else{i||(i=e[0]);const s=new j(this,t+" index",o.OP_PORT_TYPE_VALUE,{increment:"integer",hideParam:!0}),n=this.addInPort(s);if(e)for(let t=0;t<e.length;t++)e[t]=String(e[t]);const a=new It(this,t,o.OP_PORT_TYPE_STRING,{display:"switch",hidePort:!0,type:"string",values:e},n);if(s.onLinkChanged=function(){a.setUiAttribs({greyout:s.isLinked()})},r=this.addInPort(a),void 0!==i){r.set(i);const t=e.findIndex((t=>t==i));n.setValue(t),r.defaultValue=i,n.defaultValue=t}}return r},St.prototype.inValueInt=St.prototype.inInt=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{increment:"integer"}));return void 0!==e&&(i.set(e),i.defaultValue=e),i},St.prototype.inFile=function(t,e,i){const s=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{display:"file",type:"string",filter:e}));return void 0!==i&&(s.set(i),s.defaultValue=i),s},St.prototype.inUrl=function(t,e,i){const s=this.addInPort(new j(this,t,o.OP_PORT_TYPE_STRING,{display:"file",type:"string",filter:e}));return void 0!==i&&(s.set(i),s.defaultValue=i),s},St.prototype.inTexture=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_OBJECT,{display:"texture",objType:"texture",preview:!0}));return i.ignoreValueSerialize=!0,void 0!==e&&i.set(e),i},St.prototype.inObject=function(t,e,i){const s=this.addInPort(new j(this,t,o.OP_PORT_TYPE_OBJECT,{objType:i}));return s.ignoreValueSerialize=!0,void 0!==e&&s.set(e),s},St.prototype.inGradient=function(t,e){const i=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{display:"gradient",hidePort:!0}));return void 0!==e&&i.set(e),i},St.prototype.inArray=function(t,e,i){!i&&CABLES.UTILS.isNumeric(e)&&(i=e);const s=this.addInPort(new j(this,t,o.OP_PORT_TYPE_ARRAY,{stride:i}));return void 0===e||!Array.isArray(e)&&null!=e||s.set(e),s},St.prototype.inValueSlider=St.prototype.inFloatSlider=function(t,e,i,s){const r={display:"range"};null!=i&&null!=s&&(r.min=i,r.max=s);const n=this.addInPort(new j(this,t,o.OP_PORT_TYPE_VALUE,r));return void 0!==e&&(n.set(e),n.defaultValue=e),n},St.prototype.outFunction=St.prototype.outTrigger=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_FUNCTION));return void 0!==e&&i.set(e),i},St.prototype.outValue=St.prototype.outNumber=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_VALUE));return void 0!==e&&i.set(e),i},St.prototype.outValueBool=St.prototype.outBool=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{display:"bool"}));return void 0!==e?i.set(e):i.set(0),i},St.prototype.outBoolNum=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{display:"boolnum"}));return i.set=function(t){this.setValue(t?1:0)}.bind(i),void 0!==e?i.set(e):i.set(0),i},St.prototype.outValueString=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_VALUE,{type:"string"}));return void 0!==e&&i.set(e),i},St.prototype.outString=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_STRING,{type:"string"}));return void 0!==e?i.set(e):i.set(""),i},St.prototype.outObject=function(t,e,i){const s=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_OBJECT,{objType:i||null}));return s.set(e||null),s.ignoreValueSerialize=!0,s},St.prototype.outArray=function(t,e,i){!i&&CABLES.UTILS.isNumeric(e)&&(i=e);const s=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_ARRAY,{stride:i}));return void 0===e||!Array.isArray(e)&&null!=e||s.set(e),s.ignoreValueSerialize=!0,s},St.prototype.outTexture=function(t,e){const i=this.addOutPort(new j(this,t,o.OP_PORT_TYPE_OBJECT,{preview:!0,objType:"texture"}));return void 0!==e&&i.set(e||CGL.Texture.getEmptyTexture(this.patch.cgl)),i.ignoreValueSerialize=!0,i},St.prototype.inDynamic=function(t,e,i,s){const r=new j(this,t,o.OP_PORT_TYPE_DYNAMIC,i);return r.shouldLink=function(t,i){if(e&&l.isArray(e)){for(let s=0;s<e.length;s++){if(t==this&&i.type===e[s])return!0;if(i==this&&t.type===e[s])return!0}return!1}return!0},this.addInPort(r),void 0!==s&&(r.set(s),r.defaultValue=s),r},St.prototype.removeLinks=function(){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].removeLinks();for(let t=0;t<this.portsOut.length;t++)this.portsOut[t].removeLinks()},St.prototype.getSerialized=function(){const t={};this.opId&&(t.opId=this.opId),this.patch.storeObjNames&&(t.objName=this.objName),t.id=this.id,t.uiAttribs=JSON.parse(JSON.stringify(this.uiAttribs))||{},this.storage&&Object.keys(this.storage).length>0&&(t.storage=JSON.parse(JSON.stringify(this.storage))),this.uiAttribs.hasOwnProperty("working")&&1==this.uiAttribs.working&&delete this.uiAttribs.working,t.uiAttribs.hasOwnProperty("uierrors")&&delete t.uiAttribs.uierrors,t.portsIn=[],t.portsOut=[];for(let e=0;e<this.portsIn.length;e++){const i=this.portsIn[e].getSerialized();i&&t.portsIn.push(i)}for(const e in this.portsOut){const i=this.portsOut[e].getSerialized();i&&t.portsOut.push(i)}return 0==t.portsIn.length&&delete t.portsIn,0==t.portsOut.length&&delete t.portsOut,E(t),t},St.prototype.getFirstOutPortByType=function(t){for(const e in this.portsOut)if(this.portsOut[e].type==t)return this.portsOut[e]},St.prototype.getFirstInPortByType=function(t){for(const e in this.portsIn)if(this.portsIn[e].type==t)return this.portsIn[e]},St.prototype.getPort=St.prototype.getPortByName=function(t,e){if(e){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].getName().toLowerCase()==t||this.portsIn[e].id.toLowerCase()==t)return this.portsIn[e];for(let e=0;e<this.portsOut.length;e++)if(this.portsOut[e].getName().toLowerCase()==t||this.portsOut[e].id.toLowerCase()==t)return this.portsOut[e]}else{for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].getName()==t||this.portsIn[e].id==t)return this.portsIn[e];for(let e=0;e<this.portsOut.length;e++)if(this.portsOut[e].getName()==t||this.portsOut[e].id==t)return this.portsOut[e]}},St.prototype.getPortById=function(t){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].id==t)return this.portsIn[e];for(let e=0;e<this.portsOut.length;e++)if(this.portsOut[e].id==t)return this.portsOut[e]},St.prototype.updateAnims=function(){if(this._hasAnimPort)for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].updateAnim()},St.prototype.log=function(){const t="op "+this.objName;if(CABLES.UI&&!CABLES.UI.logFilter.shouldPrint(t,...arguments))return;if(!CABLES.UI&&this.patch.silent)return;const e=["[op "+CABLES.getShortOpName(this.objName)+"]"];e.push.apply(e,arguments),Function.prototype.apply.apply(console.log,[console,e])},St.prototype.error=St.prototype.logError=function(){if(!this)return void console.log("no this...!!!");const t=["[op "+CABLES.getShortOpName(this.objName)+"]"];t.push.apply(t,arguments),Function.prototype.apply.apply(console.error,[console,t]),window.gui&&window.gui.emitEvent("opLogEvent",this.objName,"error",arguments)},St.prototype.warn=St.prototype.logWarn=function(){const t=["[op "+CABLES.getShortOpName(this.objName)+"]"];t.push.apply(t,arguments),Function.prototype.apply.apply(console.warn,[console,t])},St.prototype.verbose=St.prototype.logVerbose=function(){const t="op "+CABLES.getShortOpName(this.objName);if(CABLES.UI&&!CABLES.UI.logFilter.shouldPrint(t,...arguments))return;if(!CABLES.UI&&this.patch.silent)return;const e=["["+t+"]"];e.push.apply(e,arguments),Function.prototype.apply.apply(console.info,[console,e])},St.prototype.profile=function(t){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t]._onTriggered=this.portsIn[t]._onTriggeredProfiling,this.portsIn[t].set=this.portsIn[t]._onSetProfiling},St.prototype.findParent=function(t){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e].isLinked()){if(this.portsIn[e].links[0].portOut.parent.objName==t)return this.portsIn[e].links[0].portOut.parent;let i=null;if(i=this.portsIn[e].links[0].portOut.parent.findParent(t),i)return i}return null},St.prototype.cleanUp=function(){if(this._instances){for(let t=0;t<this._instances.length;t++)this._instances[t].onDelete&&this._instances[t].onDelete();this._instances.length=0}for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].setAnimated(!1);this.onAnimFrame&&this.patch.removeOnAnimFrame(this)},St.prototype.instanced=function(t){if(console.log("instanced",this.patch.instancing.numCycles()),0===this.patch.instancing.numCycles())return!1;let e=0,i=0;if(!this._instances||this._instances.length!=this.patch.instancing.numCycles()){for(this._instances||(this._instances=[]),this._.log("creating instances of ",this.objName,this.patch.instancing.numCycles(),this._instances.length),this._instances.length=this.patch.instancing.numCycles(),e=0;e<this._instances.length;e++){this._instances[e]=this.patch.createOp(this.objName,!0),this._instances[e].instanced=function(){return!1},this._instances[e].uiAttr(this.uiAttribs);for(let t=0;t<this.portsOut.length;t++)this.portsOut[t].type==o.OP_PORT_TYPE_FUNCTION&&(this._instances[e].getPortByName(this.portsOut[t].name).trigger=this.portsOut[t].trigger.bind(this.portsOut[t]))}for(i=0;i<this.portsIn.length;i++)this.portsIn[i].onChange=null,this.portsIn[i].onValueChanged=null}for(i=0;i<this.portsIn.length;i++)this.portsIn[i].type!=o.OP_PORT_TYPE_VALUE&&this.portsIn[i].type!=o.OP_PORT_TYPE_ARRAY||this._instances[this.patch.instancing.index()].portsIn[i].set(this.portsIn[i].get()),this.portsIn[i].type;for(i=0;i<this.portsOut.length;i++)this.portsOut[i].type==o.OP_PORT_TYPE_VALUE&&this.portsOut[i].set(this._instances[this.patch.instancing.index()].portsOut[i].get());return!0},St.prototype.initInstancable=function(){},St.prototype.setValues=function(t){for(const e in t){const i=this.getPortByName(e);i?i.set(t[e]):this._log.warn("op.setValues: port not found:",e)}},St.prototype.hasUiError=function(t){return this._uiErrors.hasOwnProperty(t)&&this._uiErrors[t]},St.prototype.setUiError=function(t,e,i){if(!e&&!this.hasUiErrors)return;if(!e&&!this._uiErrors.hasOwnProperty(t))return;if(this._uiErrors.hasOwnProperty(t)&&this._uiErrors[t].txt==e)return;t.indexOf(" ")>-1&&this._log.warn("setuierror id cant have spaces! ",t),t=t.replaceAll(" ","_"),!e&&this._uiErrors.hasOwnProperty(t)?delete this._uiErrors[t]:!e||this._uiErrors.hasOwnProperty(t)&&this._uiErrors[t].txt==e||(null==i&&(i=2),this._uiErrors[t]={txt:e,level:i,id:t});const s=[];for(const t in this._uiErrors)s.push(this._uiErrors[t]);this.uiAttr({uierrors:s}),this.hasUiErrors=Object.keys(this._uiErrors).length,this.emitEvent("uiErrorChange")},St.prototype.setError=function(t,e){this._log.warn("old error message op.error() - use op.setUiError()")},St.prototype.setEnabled=function(t){this.enabled=t,this.emitEvent("onEnabledChange",t)},St.prototype.setPortGroup=function(t,e){for(let i=0;i<e.length;i++)e[i]&&(e[i].setUiAttribs?e[i].setUiAttribs({group:t}):this._log.error("setPortGroup: invalid port!"))},St.prototype.setUiAxisPorts=function(t,e,i){t&&t.setUiAttribs({axis:"X"}),e&&e.setUiAttribs({axis:"Y"}),i&&i.setUiAttribs({axis:"Z"})},St.prototype.removePort=function(t){for(let e=0;e<this.portsIn.length;e++)if(this.portsIn[e]==t)return this.portsIn.splice(e,1),this.emitEvent("onUiAttribsChange",{}),void this.emitEvent("onPortRemoved",{})},St.prototype._checkLinksNeededToWork=function(){},St.prototype.toWorkNeedsParent=function(t){this.patch.isEditorMode()&&(this._linkTimeRules.needsParentOp=t)},St.prototype.toWorkShouldNotBeChild=function(t,e){this.patch.isEditorMode()&&(this._linkTimeRules.forbiddenParent=t,null!=e&&(this._linkTimeRules.forbiddenParentType=e))},St.prototype.toWorkPortsNeedToBeLinked=function(){if(this.patch.isEditorMode())for(let t=0;t<arguments.length;t++)-1==this._linkTimeRules.needsLinkedToWork.indexOf(arguments[t])&&this._linkTimeRules.needsLinkedToWork.push(arguments[t])},St.prototype.toWorkPortsNeedToBeLinkedReset=function(){this.patch.isEditorMode()&&(this._linkTimeRules.needsLinkedToWork.length=0,this.checkLinkTimeWarnings&&this.checkLinkTimeWarnings())},St.prototype.initVarPorts=function(){for(let t=0;t<this.portsIn.length;t++)this.portsIn[t].getVariableName()&&this.portsIn[t].setVariable(this.portsIn[t].getVariableName())},St.prototype.refreshParams=function(){this.patch&&this.patch.isEditorMode()&&this.isCurrentUiOp()&&gui.opParams.show(this)},St.prototype.isCurrentUiOp=function(){if(this.patch.isEditorMode())return gui.patchView.isCurrentOp(this)},St.prototype.renderVizLayer=null}const Pt=function(t){CABLES.EventTarget.apply(this),this._log=new r("LoadingStatus"),this._loadingAssets={},this._cbFinished=[],this._assetTasks=[],this._percent=0,this._count=0,this._countFinished=0,this._order=0,this._startTime=0,this._patch=t,this._wasFinishedPrinted=!1,this._loadingAssetTaskCb=!1};Pt.prototype.setOnFinishedLoading=function(t){this._cbFinished.push(t)},Pt.prototype.getNumAssets=function(){return this._countFinished},Pt.prototype.getProgress=function(){return this._percent},Pt.prototype.checkStatus=function(){this._countFinished=0,this._count=0;for(const t in this._loadingAssets)this._count++,this._loadingAssets[t].finished||this._countFinished++;if(this._percent=(this._count-this._countFinished)/this._count,0===this._countFinished){for(let t=0;t<this._cbFinished.length;t++)if(this._cbFinished[t]){const e=this._cbFinished[t];setTimeout((()=>{e(this._patch),this.emitEvent("finishedAll")}),100)}this._wasFinishedPrinted||(this._wasFinishedPrinted=!0,this.print()),this.emitEvent("finishedAll")}},Pt.prototype.getList=function(){let t=[];for(const e in this._loadingAssets)t.push(this._loadingAssets[e]);return t},Pt.prototype.getListJobs=function(){let t=[];for(const e in this._loadingAssets)this._loadingAssets[e].finished||t.push(this._loadingAssets[e].name);return t},Pt.prototype.print=function(){if(this._patch.config.silent)return;const t=[];for(const e in this._loadingAssets)t.push([this._loadingAssets[e].order,this._loadingAssets[e].type,this._loadingAssets[e].name,(this._loadingAssets[e].timeEnd-this._loadingAssets[e].timeStart)/1e3+"s"]);this._log.groupCollapsed("finished loading "+this._order+" assets in "+(Date.now()-this._startTime)/1e3+"s"),this._log.table(t),this._log.groupEnd()},Pt.prototype.finished=function(t){const e=this._loadingAssets[t];e&&(e.finished&&this._log.warn("loading job was already finished",e),e.op&&e.op.setUiAttribs({loading:!1}),e.finished=!0,e.timeEnd=Date.now()),this.checkStatus(),this.emitEvent("finishedTask")},Pt.prototype._startAssetTasks=function(){for(let t=0;t<this._assetTasks.length;t++)this._assetTasks[t]();this._assetTasks.length=0},Pt.prototype.addAssetLoadingTask=function(t){this._patch.isEditorMode()&&!CABLES.UI.loaded?(this._assetTasks.push(t),this._loadingAssetTaskCb||window.gui.addEventListener("uiloaded",this._startAssetTasks.bind(this)),this._loadingAssetTaskCb=!0):t(),this.emitEvent("addAssetTask")},Pt.prototype.existByName=function(t){for(let e in this._loadingAssets)if(this._loadingAssets[e].name==t&&!this._loadingAssets[e].finished)return!0},Pt.prototype.start=function(t,e,i){0==this._startTime&&(this._startTime=Date.now());const s=m();return i&&i.setUiAttribs({loading:!0}),this._loadingAssets[s]={id:s,op:i,type:t,name:e,finished:!1,timeStart:Date.now(),order:this._order},this._order++,this.emitEvent("startTask"),s};const Ft=function(){this._loops=[],this._indizes=[],this._index=0};Ft.prototype.pushLoop=function(t){this._loops.push(Math.abs(Math.floor(t))),this._indizes.push(this._index)},Ft.prototype.popLoop=function(){this._loops.pop(),this._index=this._indizes.pop(),0===this._loops.length&&(this._index=0)},Ft.prototype.numLoops=function(){return this._loops.length},Ft.prototype.numCycles=function(){if(0===this._loops.length)return 0;let t=this._loops[0];for(let e=1;e<this._loops.length;e++)t*=this._loops[e];return t},Ft.prototype.inLoop=function(){return this._loops.length>0},Ft.prototype.increment=function(){this._index++},Ft.prototype.index=function(){return this._index};class Ot{constructor(t){this.startFrame=t.getFrameNum(),this.items={},this.currentId=null,this.currentStart=0,this._patch=t}getItems(){return this.items}clear(){this.paused||(this.items={})}togglePause(){this.paused=!this.paused,this.paused||(this.items={},this.currentStart=performance.now())}add(t,e){this.paused||(null!==this.currentId&&(e&&e.id==this.currentId||this.items[this.currentId]&&(this.items[this.currentId].timeUsed+=performance.now()-this.currentStart,(!this.items[this.currentId].peakTime||nt()-this.items[this.currentId].peakTime>5e3)&&(this.items[this.currentId].peak=0,this.items[this.currentId].peakTime=nt()),this.items[this.currentId].peak=Math.max(this.items[this.currentId].peak,performance.now()-this.currentStart))),null!==e?(this.items[e.id]||(this.items[e.id]={numTriggers:0,timeUsed:0}),this.items[e.id].lastFrame!=this._patch.getFrameNum()&&(this.items[e.id].numTriggers=0),this.items[e.id].lastFrame=this._patch.getFrameNum(),this.items[e.id].numTriggers++,this.items[e.id].opid=e.op.id,this.items[e.id].title=e.op.name+"."+e.name,this.items[e.id].subPatch=e.op.uiAttribs.subPatch,this.currentId=e.id,this.currentStart=performance.now()):this.currentId=null)}print(){console.log("--------");for(const t in this.items)console.log(this.items[t].title+": "+this.items[t].numTriggers+" / "+this.items[t].timeUsed)}}const Nt=class extends H{constructor(t,e,i){super(),this._name=t,this.type=i,this.setValue(e)}addListener(t){this.on("change",t,"var")}getValue(){return this._v}getName(){return this._name}setValue(t){this._v=t,this.emitEvent("change",t,this)}},Ct=function(t){H.apply(this),this._log=new r("core_patch"),this.ops=[],this.settings={},this.config=t||{glCanvasResizeToWindow:!1,prefixAssetPath:"",prefixJsPath:"",silent:!0,onError:null,onFinishedLoading:null,onFirstFrameRendered:null,onPatchLoaded:null,fpsLimit:0},this.timer=new ot,this.freeTimer=new ot,this.animFrameOps=[],this.animFrameCallbacks=[],this.gui=!1,CABLES.logSilent=this.silent=!0,this.profiler=null,this.aborted=!1,this._crashedOps=[],this._renderOneFrame=!1,this._animReq=null,this._opIdCache={},this._triggerStack=[],this.storeObjNames=!1,this.loading=new Pt(this),this._volumeListeners=[],this._paused=!1,this._frameNum=0,this.instancing=new Ft,this.onOneFrameRendered=null,this.namedTriggers={},this._origData=null,this._frameNext=0,this._frameInterval=0,this._lastFrameTime=0,this._frameWasdelayed=!0,this.frameStore={},this.deSerialized=!1,this._lastReqAnimTimeStamp=0,this.cgCanvas=null,function(){return!this}()||console.log("not in strict mode: core patch"),this._isLocal=0===document.location.href.indexOf("file:"),this.config.hasOwnProperty("silent")&&(this.silent=CABLES.logSilent=this.config.silent),this.config.hasOwnProperty("doRequestAnimation")||(this.config.doRequestAnimation=!0),this.config.prefixAssetPath||(this.config.prefixAssetPath=""),this.config.prefixJsPath||(this.config.prefixJsPath=""),this.config.masterVolume||(this.config.masterVolume=1),this._variables={},this._variableListeners=[],this.vars={},t&&t.vars&&(this.vars=t.vars),this.cgl=new xt(this),this.cgp=null,this.cgl.setCanvas(this.config.glCanvasId||this.config.glCanvas||"glcanvas"),!0===this.config.glCanvasResizeToWindow&&this.cgl.setAutoResize("window"),!0===this.config.glCanvasResizeToParent&&this.cgl.setAutoResize("parent"),this.loading.setOnFinishedLoading(this.config.onFinishedLoading),this.cgl.aborted&&(this.aborted=!0),this.cgl.silent&&(this.silent=!0),this.freeTimer.play(),this.exec(),this.aborted||(this.config.patch?this.deSerialize(this.config.patch):this.config.patchFile&&O(this.config.patchFile,((t,e)=>{const i=JSON.parse(e);if(t)return this._log.error("err",t),this._log.error("data",i),void this._log.error("data",i.msg);this.deSerialize(i)})),this.timer.play()),console.log("made with https://cables.gl")};Ct.prototype.isPlaying=function(){return!this._paused},Ct.prototype.isRenderingOneFrame=function(){return this._renderOneFrame},Ct.prototype.renderOneFrame=function(){this._paused=!0,this._renderOneFrame=!0,this.exec(),this._renderOneFrame=!1},Ct.prototype.getFPS=function(){return console.log("deprecated getfps"),0},Ct.prototype.isEditorMode=function(){return!0===this.config.editorMode},Ct.prototype.pause=function(){cancelAnimationFrame(this._animReq),this.emitEvent("pause"),this._animReq=null,this._paused=!0,this.freeTimer.pause()},Ct.prototype.resume=function(){this._paused&&(cancelAnimationFrame(this._animReq),this._paused=!1,this.freeTimer.play(),this.emitEvent("resume"),this.exec())},Ct.prototype.setVolume=function(t){this.config.masterVolume=t;for(let e=0;e<this._volumeListeners.length;e++)this._volumeListeners[e].onMasterVolumeChanged(t)},Ct.prototype.getAssetPath=function(t=null){if(this.isEditorMode())return"/assets/"+(t||gui.project()._id)+"/";if(document.location.href.indexOf("cables.gl")>0||document.location.href.indexOf("cables.local")>0){const e=document.location.pathname.split("/");return"/assets/"+(t||e[e.length-1])+"/"}return this.config.hasOwnProperty("assetPath")?this.config.assetPath:"assets/"},Ct.prototype.getJsPath=function(){return this.config.hasOwnProperty("jsPath")?this.config.jsPath:"js/"},Ct.prototype.getFilePath=function(t){return t?0===(t=String(t)).indexOf("https:")||0===t.indexOf("http:")||0===t.indexOf("data:")?t:(t=t.replace("//","/"),this.config.prefixAssetPath+t+(this.config.suffixAssetPath||"")):t},Ct.prototype.clear=function(){for(this.emitEvent("patchClearStart"),this.cgl.TextureEffectMesh=null,this.animFrameOps.length=0,this.timer=new ot;this.ops.length>0;)this.deleteOp(this.ops[0].id);this.emitEvent("patchClearEnd")},Ct.getOpClass=function(t){const e=t.split(".");let i=null;try{return 2==e.length?i=window[e[0]][e[1]]:3==e.length?i=window[e[0]][e[1]][e[2]]:4==e.length?i=window[e[0]][e[1]][e[2]][e[3]]:5==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]]:6==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]]:7==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]]:8==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]][e[7]]:9==e.length?i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]][e[7]][e[8]]:10==e.length&&(i=window[e[0]][e[1]][e[2]][e[3]][e[4]][e[5]][e[6]][e[7]][e[8]][e[9]]),i}catch(t){return null}},Ct.prototype.createOp=function(t,e,i=null){let s=null,r="";try{if(-1===t.indexOf("Ops.")){const n=t;if(CABLES.OPS[n])r=CABLES.OPS[n].objName,s=new CABLES.OPS[n].f(this,r,e,n),s.opId=n;else{if(!i)throw new Error("could not find op by id: "+n);t=i,console.log("could not find op by id: "+n)}}if(!s){r=t;const i=t.split(".");if(!Ct.getOpClass(r))throw this.emitEvent("criticalError",{title:"unknown op",text:"unknown op: "+r}),this._log.error("unknown op: "+r),new Error("unknown op: "+r);if(2==i.length?s=new window[i[0]][i[1]](this,r,e):3==i.length?s=new window[i[0]][i[1]][i[2]](this,r,e):4==i.length?s=new window[i[0]][i[1]][i[2]][i[3]](this,r,e):5==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]](this,r,e):6==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]](this,r,e):7==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]](this,r,e):8==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]][i[7]](this,r,e):9==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]][i[7]][i[8]](this,r,e):10==i.length?s=new window[i[0]][i[1]][i[2]][i[3]][i[4]][i[5]][i[6]][i[7]][i[8]][i[9]](this,r,e):console.log("parts.length",i.length),s){s.opId=null;for(const t in CABLES.OPS)CABLES.OPS[t].objName==r&&(s.opId=t)}}}catch(t){if(this._crashedOps.push(r),this.emitEvent("exceptionOp",t,r,s),!this.isEditorMode())throw this._log.error(t),this._log.error("[instancing error] "+r,t),CABLES.api&&CABLES.api.sendErrorReport(t),this.exitError("INSTANCE_ERR","Instancing Error 1"+r,t),new Error("instancing error 1"+r)}return s?(s._objName=r,s.patch=this):this._log.log("no op was created!?",t,e),s},Ct.prototype.addOp=function(t,e,i,s,r){const n=this.createOp(t,i,r);if(n){if((e=e||{}).hasOwnProperty("errors")&&delete e.errors,e.hasOwnProperty("error")&&delete e.error,e.subPatch=e.subPatch||0,n.uiAttr(e),n.onCreate&&n.onCreate(),n.hasOwnProperty("onAnimFrame")&&this.addOnAnimFrame(n),n.hasOwnProperty("onMasterVolumeChanged")&&this._volumeListeners.push(n),this._opIdCache[n.id])return void console.log("opid with id "+n.id+" already exists in patch!");this.ops.push(n),this._opIdCache[n.id]=n,this.emitEvent("onOpAdd",n,s),n.init&&n.init(),n.emitEvent("init",s)}else this._log.error("addop: no op.....");return n},Ct.prototype.addOnAnimFrame=function(t){for(let e=0;e<this.animFrameOps.length;e++)if(this.animFrameOps[e]==t)return;this.animFrameOps.push(t)},Ct.prototype.removeOnAnimFrame=function(t){for(let e=0;e<this.animFrameOps.length;e++)if(this.animFrameOps[e]==t)return void this.animFrameOps.splice(e,1)},Ct.prototype.addOnAnimFrameCallback=function(t){this.animFrameCallbacks.push(t)},Ct.prototype.removeOnAnimCallback=function(t){for(let e=0;e<this.animFrameCallbacks.length;e++)if(this.animFrameCallbacks[e]==t)return void this.animFrameCallbacks.splice(e,1)},Ct.prototype.deleteOp=function(t,e,i){let s=!1;for(const r in this.ops)if(this.ops[r].id==t){const n=this.ops[r];let o=null,a=null;if(n){s=!0,e&&n.portsIn.length>0&&n.portsIn[0].isLinked()&&n.portsOut.length>0&&n.portsOut[0].isLinked()&&n.portsIn[0].getType()==n.portsOut[0].getType()&&n.portsIn[0].links[0]&&(o=n.portsIn[0].links[0].getOtherPort(n.portsIn[0]),a=n.portsOut[0].links[0].getOtherPort(n.portsOut[0]));const h=this.ops[r];h.removeLinks(),this.onDelete&&(console.log("deprecated this.onDelete",this.onDelete),this.onDelete(h)),this.ops.splice(r,1),h.emitEvent("delete",this.ops[r]),this.emitEvent("onOpDelete",h,i),h.onDelete&&h.onDelete(i),h.cleanUp(),null!==o&&null!==a&&this.link(o.op,o.getName(),a.op,a.getName()),delete this._opIdCache[t];break}}s||console.log("core patch deleteop: not found...",t)},Ct.prototype.getFrameNum=function(){return this._frameNum},Ct.prototype.emitOnAnimFrameEvent=function(t,e){t=t||this.timer.getTime();for(let i=0;i<this.animFrameCallbacks.length;++i)this.animFrameCallbacks[i]&&this.animFrameCallbacks[i](t,this._frameNum,e);for(let i=0;i<this.animFrameOps.length;++i)this.animFrameOps[i].onAnimFrame&&this.animFrameOps[i].onAnimFrame(t,this._frameNum,e)},Ct.prototype.renderFrame=function(t){this.timer.update(),this.freeTimer.update();const e=this.timer.getTime(),i=performance.now();this.cgl.frameStartTime=this.timer.getTime();const s=t-this._lastReqAnimTimeStamp||t;this.emitOnAnimFrameEvent(null,s),this.cgl.profileData.profileFrameDelta=s,this._lastReqAnimTimeStamp=t,this.cgl.profileData.profileOnAnimFrameOps=performance.now()-i,this.emitEvent("onRenderFrame",e),this._frameNum++,1==this._frameNum&&this.config.onFirstFrameRendered&&this.config.onFirstFrameRendered()},Ct.prototype.exec=function(t){if(!this._renderOneFrame&&(this._paused||this.aborted))return;this.emitEvent("reqAnimFrame"),cancelAnimationFrame(this._animReq),this.config.fpsLimit=this.config.fpsLimit||0,this.config.fpsLimit&&(this._frameInterval=1e3/this.config.fpsLimit);const e=CABLES.now(),i=e-this._frameNext;if(this.isEditorMode()&&!this._renderOneFrame&&e-this._lastFrameTime>=500&&0!==this._lastFrameTime&&!this._frameWasdelayed)return this._lastFrameTime=0,setTimeout(this.exec.bind(this),500),this.emitEvent("renderDelayStart"),void(this._frameWasdelayed=!0);(this._renderOneFrame||0===this.config.fpsLimit||i>this._frameInterval||this._frameWasdelayed)&&(this.renderFrame(t),this._frameInterval&&(this._frameNext=e-i%this._frameInterval)),this._frameWasdelayed&&(this.emitEvent("renderDelayEnd"),this._frameWasdelayed=!1),this._renderOneFrame&&(this.onOneFrameRendered&&this.onOneFrameRendered(),this.emitEvent("renderedOneFrame"),this._renderOneFrame=!1),this.config.doRequestAnimation&&(this._animReq=this.cgl.canvas.ownerDocument.defaultView.requestAnimationFrame(this.exec.bind(this)))},Ct.prototype.link=function(t,e,i,s,r,n){if(!t)return void console.log("link: op1 is null ");if(!i)return void console.log("link: op2 is null");const o=t.getPort(e,r),a=i.getPort(s,r);if(o)if(a){if(!o.shouldLink(o,a)||!a.shouldLink(o,a))return!1;if(yt.canLink(o,a)){const t=new yt(this);return t.link(o,a),this.emitEvent("onLink",o,a,t,n),t}}else console.log("port not found! "+s+" of "+i.name+"("+i.objName+")");else console.log("port not found! "+e+"("+t.objName+")")},Ct.prototype.serialize=function(t){const e={};t=t||{},e.ops=[],e.settings=this.settings;for(const t in this.ops){const i=this.ops[t];e.ops.push(i.getSerialized())}return E(e),t.asObject?e:JSON.stringify(e)},Ct.prototype.getOpById=function(t){return this._opIdCache[t]},Ct.prototype.getOpsByName=function(t){const e=[];for(const i in this.ops)this.ops[i].name==t&&e.push(this.ops[i]);return e},Ct.prototype.getOpsByObjName=function(t){const e=[];for(const i in this.ops)this.ops[i].objName==t&&e.push(this.ops[i]);return e},Ct.prototype.loadLib=function(t){F("/ui/libs/"+t+".js",((t,e)=>{const i=document.createElement("script");i.type="text/javascript",i.text=e,document.getElementsByTagName("head")[0].appendChild(i)}),"GET")},Ct.prototype.reloadOp=function(t,e){let i=0;const s=[],r=[];for(const e in this.ops)this.ops[e].objName==t&&r.push(this.ops[e]);for(let e=0;e<r.length;e++){i++;const n=r[e];n.deleted=!0;const o=this.addOp(t,n.uiAttribs);if(!o)continue;let a;n&&n.storage&&o.setStorage(JSON.parse(JSON.stringify(n.storage))),s.push(o);for(let t in n.portsIn)if(0===n.portsIn[t].links.length){const e=o.getPort(n.portsIn[t].name);e?(e.set(n.portsIn[t].get()),n.portsIn[t].getVariableName()&&e.setVariable(n.portsIn[t].getVariableName())):this._log.error("[reloadOp] could not set port "+n.portsIn[t].name+", propably renamed port ?")}else for(;n.portsIn[t].links.length;){const e=n.portsIn[t].links[0].portIn.name,i=n.portsIn[t].links[0].portOut.name,s=n.portsIn[t].links[0].portOut.op;n.portsIn[t].links[0].remove(),a=this.link(o,e,s,i),a?a.setValue():console.log("[reloadOp] relink after op reload not successfull for port "+i)}for(let t in n.portsOut)for(;n.portsOut[t].links.length;){const e=n.portsOut[t].links[0].portOut.name,i=n.portsOut[t].links[0].portIn.name,s=n.portsOut[t].links[0].portIn.op;n.portsOut[t].links[0].remove(),a=this.link(o,e,s,i),a?a.setValue():console.log("relink after op reload not successfull for port "+i)}this.deleteOp(n.id,!1,!0)}e(i,s)},Ct.prototype.getSubPatchOps=function(t,e=!1){let i=[];for(const e in this.ops)this.ops[e].uiAttribs&&this.ops[e].uiAttribs.subPatch==t&&i.push(this.ops[e]);if(e)for(const t in i)if(i[t].storage&&i[t].storage.subPatchVer){const e=i[t].portsIn.find((t=>"patchId"===t.name));e&&(i=i.concat(this.getSubPatchOps(e.value,!0)))}return i},Ct.prototype.getSubPatchOp=function(t,e){for(const i in this.ops)if(this.ops[i].uiAttribs&&this.ops[i].uiAttribs.subPatch==t&&this.ops[i].objName==e)return this.ops[i];return!1},Ct.prototype.getSubPatchOuterOp=function(t){const e=this.ops;for(let i=0;i<e.length;i++){const s=e[i];if(s.isSubPatchOp()&&s.patchId.get()==t)return s}},Ct.prototype._addLink=function(t,e,i,s){this.link(this.getOpById(t),i,this.getOpById(e),s,!1,!0)},Ct.prototype.deSerialize=function(t,e){if(e=e||{genIds:!1,createRef:!1},this.aborted)return;const i=[],s=this.loading.start("core","deserialize");this.namespace=t.namespace||"",this.name=t.name||"","string"==typeof t&&(t=JSON.parse(t)),this.settings=t.settings,this.emitEvent("patchLoadStart"),window.logStartup&&logStartup("add "+t.ops.length+" ops... ");for(let s=0;s<t.ops.length;s++){const r=CABLES.now(),n=t.ops[s];let a=null;try{a=n.opId?this.addOp(n.opId,n.uiAttribs,n.id,!0,n.objName):this.addOp(n.objName,n.uiAttribs,n.id,!0)}catch(t){throw console.log("[instancing error] op data:",n,t),new Error("could not create op by id: <b>"+(n.objName||n.opId)+"</b> ("+n.id+")")}if(a){e.genIds&&(a.id=f()),a.portsInData=n.portsIn,a._origData=JSON.parse(JSON.stringify(n)),a.storage=n.storage;for(const t in n.portsIn){const e=n.portsIn[t];if(e&&e.hasOwnProperty("name")){const t=a.getPort(e.name);!t||"bool"!=t.uiAttribs.display&&"bool"!=t.uiAttribs.type||isNaN(e.value)||(e.value=!0===e.value),t&&void 0!==e.value&&t.type!=o.OP_PORT_TYPE_TEXTURE&&t.set(e.value),t&&t.deSerializeSettings(e)}}for(const e in n.portsOut){const i=n.portsOut[e];if(i&&i.hasOwnProperty("name")){const r=a.getPort(i.name);r&&r.type!=o.OP_PORT_TYPE_TEXTURE&&i.hasOwnProperty("value")&&r.set(t.ops[s].portsOut[e].value),r&&i.expose&&r.setUiAttribs({expose:!0})}}i.push(a)}const h=Math.round(100*(CABLES.now()-r))/100;!this.silent&&h>5&&console.log("long op init ",t.ops[s].objName,h)}window.logStartup&&logStartup("add ops done");for(const t in this.ops)this.ops[t].onLoadedValueSet&&(this.ops[t].onLoadedValueSet(this.ops[t]._origData),this.ops[t].onLoadedValueSet=null,this.ops[t]._origData=null),this.ops[t].emitEvent("loadedValueSet");if(window.logStartup&&logStartup("creating links"),t.ops)for(let e=0;e<t.ops.length;e++){if(t.ops[e].portsIn)for(let i=0;i<t.ops[e].portsIn.length;i++)if(t.ops[e].portsIn[i]&&t.ops[e].portsIn[i].links)for(let s=0;s<t.ops[e].portsIn[i].links.length;s++)this._addLink(t.ops[e].portsIn[i].links[s].objIn,t.ops[e].portsIn[i].links[s].objOut,t.ops[e].portsIn[i].links[s].portIn,t.ops[e].portsIn[i].links[s].portOut);if(t.ops[e].portsOut)for(let i=0;i<t.ops[e].portsOut.length;i++)if(t.ops[e].portsOut[i]&&t.ops[e].portsOut[i].links)for(let s=0;s<t.ops[e].portsOut[i].links.length;s++)if(t.ops[e].portsOut[i].links[s])if(t.ops[e].portsOut[i].links[s].subOpRef){const r=this.getOpById(t.ops[e].portsOut[i].links[s].objOut);let n=null,o=0;for(let n=0;n<this.ops.length;n++)if(this.ops[n].storage&&this.ops[n].storage.ref==t.ops[e].portsOut[i].links[s].subOpRef&&r.uiAttribs.subPatch==this.ops[n].uiAttribs.subPatch){o=this.ops[n].patchId.get();break}for(let r=0;r<this.ops.length;r++)if(this.ops[r].storage&&this.ops[r].storage.ref==t.ops[e].portsOut[i].links[s].refOp&&this.ops[r].uiAttribs.subPatch==o){n=this.ops[r];break}n?this._addLink(n.id,t.ops[e].portsOut[i].links[s].objOut,t.ops[e].portsOut[i].links[s].portIn,t.ops[e].portsOut[i].links[s].portOut):this._log.warn("could not find op for lost link")}else this._addLink(t.ops[e].portsOut[i].links[s].objIn,t.ops[e].portsOut[i].links[s].objOut,t.ops[e].portsOut[i].links[s].portIn,t.ops[e].portsOut[i].links[s].portOut)}window.logStartup&&logStartup("calling ops onloaded");for(const t in this.ops)this.ops[t].onLoaded&&(this.ops[t].onLoaded(),this.ops[t].onLoaded=null);window.logStartup&&logStartup("initializing ops...");for(const t in this.ops)this.ops[t].init&&(this.ops[t].init(),this.ops[t].init=null);if(window.logStartup&&logStartup("initializing vars..."),this.config.variables)for(const t in this.config.variables)this.setVarValue(t,this.config.variables[t]);window.logStartup&&logStartup("initializing var ports");for(const t in this.ops)this.ops[t].initVarPorts(),delete this.ops[t].uiAttribs.pasted;setTimeout((()=>{this.loading.finished(s)}),100),window.logStartup&&logStartup("calling onPatchLoaded/patchLoadEnd"),this.config.onPatchLoaded&&this.config.onPatchLoaded(this),this.deSerialized=!0,this.emitEvent("patchLoadEnd",i,t,e.genIds)},Ct.prototype.profile=function(t){this.profiler=new Ot(this);for(const e in this.ops)this.ops[e].profile(t)},Ct.prototype.setVariable=function(t,e){void 0!==this._variables[t]?this._variables[t].setValue(e):console.log("variable "+t+" not found!")},Ct.prototype._sortVars=function(){if(!this.isEditorMode())return;const t={};Object.keys(this._variables).sort(((t,e)=>t.localeCompare(e,"en",{sensitivity:"base"}))).forEach((e=>{t[e]=this._variables[e]})),this._variables=t},Ct.prototype.hasVar=function(t){return void 0!==this._variables[t]},Ct.prototype.setVarValue=function(t,e,i){return this.hasVar(t)?this._variables[t].setValue(e):(this._variables[t]=new Nt(t,e,i),this._sortVars(),this.emitEvent("variablesChanged")),this._variables[t]},Ct.prototype.getVarValue=function(t,e){if(this._variables.hasOwnProperty(t))return this._variables[t].getValue()},Ct.prototype.getVar=function(t){if(this._variables.hasOwnProperty(t))return this._variables[t]},Ct.prototype.deleteVar=function(t){for(let e=0;e<this.ops.length;e++)for(let i=0;i<this.ops[e].portsIn.length;i++)this.ops[e].portsIn[i].getVariableName()==t&&this.ops[e].portsIn[i].setVariable(null);delete this._variables[t],this.emitEvent("variableDeleted",t),this.emitEvent("variablesChanged")},Ct.prototype.getVars=function(t){if(void 0===t)return this._variables;const e=[];t==CABLES.OP_PORT_TYPE_STRING&&(t="string"),t==CABLES.OP_PORT_TYPE_VALUE&&(t="number"),t==CABLES.OP_PORT_TYPE_ARRAY&&(t="array"),t==CABLES.OP_PORT_TYPE_OBJECT&&(t="object");for(const i in this._variables)this._variables[i].type&&this._variables[i].type!=t||e.push(this._variables[i]);return e},Ct.prototype.exitError=function(t,e,i){if(this.aborted=!0,this&&this.config&&this.config.onError)this.config.onError(t,e);else if(!this.isEditorMode()){const s=document.createElement("div"),r=this.cgl.canvas.getBoundingClientRect();s.setAttribute("style","position:absolute;border:5px solid red;padding:15px;background-color:black;color:white;font-family:monospace;"),s.style.top=r.top+"px",s.style.left=r.left+"px";let n="cables - An error occured:<br/>";n+="["+t+"] - "+e,i&&(n+="<br/>Exception: "+i.message),s.innerHTML=n;const o=this.cgl.canvas.parentElement;for(;o.hasChildNodes();)o.removeChild(o.lastChild);document.body.appendChild(s)}},Ct.prototype.preRenderOps=function(){this._log.log("prerendering...");for(let t=0;t<this.ops.length;t++)this.ops[t].preRender&&(this.ops[t].preRender(),this._log.log("prerender "+this.ops[t].objName))},Ct.prototype.dispose=function(){this.pause(),this.clear(),this.cgl.dispose()},Ct.prototype.pushTriggerStack=function(t){this._triggerStack.push(t)},Ct.prototype.popTriggerStack=function(){this._triggerStack.pop()},Ct.prototype.printTriggerStack=function(){if(0==this._triggerStack.length)return;console.groupCollapsed("trigger port stack "+this._triggerStack[this._triggerStack.length-1].op.name+"."+this._triggerStack[this._triggerStack.length-1].name);const t=[];for(let e=0;e<this._triggerStack.length;e++)t.push(e+". "+this._triggerStack[e].op.name+" "+this._triggerStack[e].name);console.table(t),console.groupEnd()},Ct.prototype.getDocument=function(){return this.cgl.canvas.ownerDocument},Ct.replaceOpIds=function(t,e){const i={};for(const e in t.ops)i[t.ops[e].id]=t.ops[e];for(const s in t.ops)for(const r in t.ops[s].portsOut){const n=t.ops[s].portsOut[r].links;if(n){let t=n.length;for(;t--;)if(n[t]&&(!i[n[t].objIn]||!i[n[t].objOut]))if(e.doNotUnlinkLostLinks){if(e.fixLostLinks){const e=gui.corePatch().getOpById(n[t].objIn);if(e){const i=gui.patchView.getSubPatchOuterOp(e.uiAttribs.subPatch);i&&(e.storage=e.storage||{},e.storage.ref=e.storage.ref||CABLES.shortId(),n[t].refOp=e.storage.ref,n[t].subOpRef=i.storage.ref)}else console.log("op not found!")}}else n.splice(t,1)}}for(const i in t.ops){const s=t.ops[i],r=s.id;let n=CABLES.shortId();e.prefixHash?n=T(e.prefixHash+r):e.prefixId?n=e.prefixId+r:e.refAsId&&(s.storage&&s.storage.ref?(n=s.storage.ref,delete s.storage.ref):(s.storage=s.storage||{},s.storage.ref=n=CABLES.shortId()));const o=s.id=n;e.oldIdAsRef&&(s.storage=s.storage||{},s.storage.ref=r);for(const e in t.ops){if(t.ops[e].portsIn)for(const i in t.ops[e].portsIn)if(t.ops[e].portsIn[i].links){let s=t.ops[e].portsIn[i].links.length;for(;s--;)null===t.ops[e].portsIn[i].links[s]&&t.ops[e].portsIn[i].links.splice(s,1);for(s in t.ops[e].portsIn[i].links)t.ops[e].portsIn[i].links[s].objIn===r&&(t.ops[e].portsIn[i].links[s].objIn=o),t.ops[e].portsIn[i].links[s].objOut===r&&(t.ops[e].portsIn[i].links[s].objOut=o)}if(t.ops[e].portsOut)for(const i in t.ops[e].portsOut)if(t.ops[e].portsOut[i].links){let s=t.ops[e].portsOut[i].links.length;for(;s--;)null===t.ops[e].portsOut[i].links[s]&&t.ops[e].portsOut[i].links.splice(s,1);for(s in t.ops[e].portsOut[i].links)t.ops[e].portsOut[i].links[s].objIn===r&&(t.ops[e].portsOut[i].links[s].objIn=o),t.ops[e].portsOut[i].links[s].objOut===r&&(t.ops[e].portsOut[i].links[s].objOut=o)}}}const s=[],r=[];for(let i=0;i<t.ops.length;i++)if(t.ops[i].storage&&t.ops[i].storage.subPatchVer)for(const n in t.ops[i].portsIn)if("patchId"===t.ops[i].portsIn[n].name){let o=f();e.prefixHash&&(o=T(e.prefixHash+t.ops[i].portsIn[n].value));const a=t.ops[i].portsIn[n].value,h=t.ops[i].portsIn[n].value=o;s.push(h);for(let e=0;e<t.ops.length;e++)t.ops[e].uiAttribs&&t.ops[e].uiAttribs.subPatch===a&&(t.ops[e].uiAttribs.subPatch=h,r.push(t.ops[e].id))}for(const i in t.ops){let s=!1;for(let e=0;e<r.length;e++)if(t.ops[i].id===r[e]){s=!0;break}!s&&t.ops[i].uiAttribs&&null!=e.parentSubPatchId&&(t.ops[i].uiAttribs.subPatch=e.parentSubPatchId)}return t};const wt=Ct,Mt={addPatch:function(t,e){let i=t,s=m();if("string"==typeof t&&(s=t,i=document.getElementById(s),!i))return void console.error(s+" Polyshape Container Element not found!");const r=document.createElement("canvas");return r.id="glcanvas_"+s,r.width=i.clientWidth,r.height=i.clientHeight,window.addEventListener("resize",function(){this.setAttribute("width",i.clientWidth),this.height=i.clientHeight}.bind(r)),i.appendChild(r),(e=e||{}).glCanvasId=r.id,e.onError||(e.onError=function(t){console.error(t)}),CABLES.patch=new wt(e),r}},Ut={toneJsInitialized:!1,createAudioContext:function(t){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)return window.audioContext||(window.audioContext=new AudioContext),window.Tone&&!Ut.toneJsInitialized&&(Tone.setContext(window.audioContext),Ut.toneJsInitialized=!0),window.audioContext;t.patch.config.onError("NO_WEBAUDIO","Web Audio is not supported in this browser.")},getAudioContext:function(){return window.audioContext},createAudioInPort:function(t,e,i,s){if(!t||!e||!i){const e="ERROR: createAudioInPort needs three parameters, op, portName and audioNode";throw t.log(e),new Error(e)}s||(s=0),t.webAudio=t.webAudio||{},t.webAudio.audioInPorts=t.webAudio.audioInPorts||[];const r=t.inObject(e);return r.webAudio={},r.webAudio.previousAudioInNode=null,r.webAudio.audioNode=i,t.webAudio.audioInPorts[e]=r,r.onChange=function(){const e=r.get();if(e)try{e.connect?(e.connect(r.webAudio.audioNode,0,s),t.setUiError("audioCtx",null)):t.setUiError("audioCtx","The passed input is not an audio context. Please make sure you connect an audio context to the input.",2)}catch(i){throw t.log("Error: Failed to connect web audio node!",i),t.log("port.webAudio.audioNode",r.webAudio.audioNode),t.log("audioInNode: ",e),t.log("inputChannelIndex:",s),t.log("audioInNode.connect: ",e.connect),i}else if(r.webAudio.previousAudioInNode)try{r.webAudio.previousAudioInNode.disconnect&&r.webAudio.previousAudioInNode.disconnect(r.webAudio.audioNode,0,s),t.setUiError("audioCtx",null)}catch(e){try{r.webAudio.previousAudioInNode.disconnect(r.webAudio.audioNode)}catch(i){throw t.log("Disconnecting audio node with in/out port index, as well as without in/out-port-index did not work ",e),e.printStackTrace&&e.printStackTrace(),e}}r.webAudio.previousAudioInNode=e},r},replaceNodeInPort:function(t,e,i){const s=t.webAudio.previousAudioInNode;if(s&&s.disconnect){try{s.disconnect(e)}catch(t){throw t.printStackTrace&&t.printStackTrace(),new Error("replaceNodeInPort: Could not disconnect old audio node. "+t.name+" "+t.message)}t.webAudio.audioNode=i;try{s.connect(i)}catch(t){throw t.printStackTrace&&t.printStackTrace(),new Error("replaceNodeInPort: Could not connect to new node. "+t.name+" "+t.message)}}},createAudioOutPort:function(t,e,i){if(!t||!e||!i){const e="ERROR: createAudioOutPort needs three parameters, op, portName and audioNode";throw t.log(e),new Error(e)}const s=t.outObject(e);return s.set(i),s},createAudioParamInPort:function(t,e,i,s,r){if(!t||!e||!i)return t.log("ERROR: createAudioParamInPort needs three parameters, op, portName and audioNode"),t&&t.name&&t.log("opname: ",t.name),t.log("portName",e),void t.log("audioNode: ",i);t.webAudio=t.webAudio||{},t.webAudio.audioInPorts=t.webAudio.audioInPorts||[];const n=t.inDynamic(e,[o.OP_PORT_TYPE_VALUE,o.OP_PORT_TYPE_OBJECT],s,r);return n.webAudio={},n.webAudio.previousAudioInNode=null,n.webAudio.audioNode=i,t.webAudio.audioInPorts[e]=n,n.onChange=function(){const e=n.get(),i=n.webAudio.audioNode,s=Ut.getAudioContext();if(null!=e)if("object"==typeof e&&e.connect){try{e.connect(i)}catch(e){throw t.log("Could not connect audio node: ",e),e.printStackTrace&&e.printStackTrace(),e}n.webAudio.previousAudioInNode=e}else{if(i._param&&i._param.minValue&&i._param.maxValue)if(e>=i._param.minValue&&e<=i._param.maxValue)try{i.setValueAtTime?i.setValueAtTime(e,s.currentTime):i.value=e}catch(e){throw t.log("Possible AudioParam problem with tone.js op: ",e),e.printStackTrace&&e.printStackTrace(),e}else t.log("Warning: The value for an audio parameter is out of range!");else if(i.minValue&&i.maxValue)if(e>=i.minValue&&e<=i.maxValue)try{i.setValueAtTime?i.setValueAtTime(e,s.currentTime):i.value=e}catch(e){throw t.log("AudioParam has minValue / maxValue defined, and value is in range, but setting the value failed! ",e),e.printStackTrace&&e.printStackTrace(),e}else t.log("Warning: The value for an audio parameter is out of range!");else try{i.setValueAtTime?i.setValueAtTime(e,s.currentTime):i.value=e}catch(e){throw t.log("Possible AudioParam problem (without minValue / maxValue): ",e),e.printStackTrace&&e.printStackTrace(),e}if(n.webAudio.previousAudioInNode&&n.webAudio.previousAudioInNode.disconnect){try{n.webAudio.previousAudioInNode.disconnect(i)}catch(e){throw t.log("Could not disconnect previous audio node: ",e),e}n.webAudio.previousAudioInNode=void 0}}else n.webAudio.previousAudioInNode},n},loadAudioFile:function(t,e,i,s,r){const n=Ut.createAudioContext();let o=null;(r||void 0===r)&&(o=t.loading.start("audio",e),t.isEditorMode()&&gui.jobs().start({id:"loadaudio"+o,title:" loading audio ("+e+")"}));const a=new XMLHttpRequest;e&&(a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){t.loading.finished(o),t.isEditorMode()&&gui.jobs().finish("loadaudio"+o),n.decodeAudioData(a.response,i,s)},a.send())},isValidToneTime:function(t){try{new Tone.Time(t)}catch(t){return!1}return!0},isValidToneNote:function(t){try{Tone.Frequency(t)}catch(t){return!1}return!0}},Bt=function(t,e,i){this._patch=t,this.connector=i,this._log=new r("PatchConnectionReceiver")};Bt.prototype._addOp=function(t){let e=null;t.vars.uiAttribs&&(e=t.vars.uiAttribs);const i=this._patch.addOp(t.vars.objName,e,t.vars.opId,!0);i&&(i.id=t.vars.opId,t.vars.portsIn&&t.vars.portsIn.forEach((t=>{const e=i.getPortByName(t.name);e&&e.set(t.value)})))},Bt.prototype._receive=function(t){let e={};if(e=t.hasOwnProperty("event")?t:JSON.parse(t.data),e.event==h.PACO_OP_CREATE){if(this._patch.getOpById(e.vars.opId))return;this._log.verbose("op create:",e.vars.objName),window.gui?gui.serverOps.loadOpLibs(e.vars.objName,(()=>{this._addOp(e)})):this._addOp(e)}else if(e.event==h.PACO_DESERIALIZE)e.vars.json&&(window.gui?gui.serverOps.loadProjectDependencies(e.vars.json,(()=>{this._patch.deSerialize(e.vars.json,{genIds:e.vars.genIds})})):this._patch.deSerialize(e.vars.json,{genIds:e.vars.genIds}));else if(e.event==h.PACO_LOAD)this._log.verbose("PACO load patch....."),this._patch.clear(),window.gui?gui.serverOps.loadProjectDependencies(JSON.parse(e.vars.patch),(()=>{this._patch.deSerialize(e.vars.patch)})):this._patch.deSerialize(e.vars.patch);else if(e.event==h.PACO_CLEAR)this._patch.clear(),this._log.log("clear");else if(e.event==h.PACO_OP_DELETE)this._log.verbose("op delete",e.vars.objName),this._patch.getOpById(e.vars.op),this._patch.deleteOp(e.vars.op,!0);else if(e.event==h.PACO_OP_ENABLE){const t=this._patch.getOpById(e.vars.op);t&&(t.enabled=!0)}else if(e.event==h.PACO_OP_DISABLE){const t=this._patch.getOpById(e.vars.op);t&&(t.enabled=!1)}else if(e.event==h.PACO_UIATTRIBS){const t=this._patch.getOpById(e.vars.op);t?.setUiAttrib(e.vars.uiAttribs)}else if(e.event==h.PACO_UNLINK){const t=this._patch.getOpById(e.vars.op1),i=this._patch.getOpById(e.vars.op2),s=t?.getPort(e.vars.port1),r=i?.getPort(e.vars.port2);s&&r?s.removeLinkTo(r):this._log.warn("paco unlink could not find port...")}else if(e.event==h.PACO_LINK){const t=this._patch.getOpById(e.vars.op1),i=this._patch.getOpById(e.vars.op2);t&&i&&this._patch.link(t,e.vars.port1,i,e.vars.port2)}else if(e.event==h.PACO_VALUECHANGE){if("+ create new one"===e.vars.v)return;const t=this._patch.getOpById(e.vars.op);if(t){const i=t.getPort(e.vars.port);i&&i.set(e.vars.v)}}else if(e.event==h.PACO_VARIABLES){const t=this._patch.getOpById(e.vars.opId);t&&t.varName&&t.varName.set(e.vars.varName)}else if(e.event==h.PACO_TRIGGERS){const t=this._patch.getOpById(e.vars.opId);t&&t.varName&&t.varName.set(e.vars.varName)}else if(e.event==h.PACO_PORT_SETVARIABLE){const t=this._patch.getOpById(e.vars.opId);if(t){const i=t.getPortByName(e.vars.portName);i&&i.setVariable(e.vars.variableName)}}else if(e.event==h.PACO_PORT_SETANIMATED){const t=this._patch.getOpById(e.vars.opId);t&&t.portsIn[e.vars.portIndex]&&e.vars.hasOwnProperty("targetState")&&this._patch.emitEvent("pacoPortValueSetAnimated",t,e.vars.portIndex,e.vars.targetState,e.vars.defaultValue)}else if(e.event==h.PACO_PORT_ANIM_UPDATED){const t=this._patch.getOpById(e.vars.opId);if(t){const i=t.getPortByName(e.vars.portName);if(i){const t=i.getSerialized();t.anim=e.vars.anim,i.anim=null,i.deSerializeSettings(t),this._patch.emitEvent("pacoPortAnimUpdated",i)}}}else this._log.warn("unknown patchConnectionEvent!",t)};const Lt=function(t){this.connectors=[],this.paused=!1,t.addEventListener("onOpDelete",(t=>{this.send(CABLES.PACO_OP_DELETE,{op:t.id,objName:t.objName})})),t.addEventListener("patchClearStart",(()=>{this.paused=!0})),t.addEventListener("patchClearEnd",(()=>{this.paused=!1})),t.addEventListener("patchLoadStart",(()=>{this.paused=!0})),t.addEventListener("patchLoadEnd",((t,e,i)=>{this.paused=!1,this.send(CABLES.PACO_DESERIALIZE,{json:e,genIds:i})})),t.addEventListener("onOpAdd",(t=>{const e=[];t.portsIn.forEach((t=>{const i={id:t.id,name:t.name,value:t.get()};e.push(i)}));let i={};t.uiAttribs&&(i={...t.uiAttribs}),this.send(CABLES.PACO_OP_CREATE,{opId:t.id,objName:t.objName,uiAttribs:i,portsIn:e})})),t.addEventListener("onUnLink",((t,e)=>{this.send(CABLES.PACO_UNLINK,{op1:t.op.id,op2:e.op.id,port1:t.getName(),port2:e.getName()})})),t.addEventListener("onUiAttribsChange",((t,e)=>{e&&(delete e.extendTitle,delete e.history,delete e.translate,Object.keys(e).length>0&&this.send(CABLES.PACO_UIATTRIBS,{op:t.id,uiAttribs:e}))})),t.addEventListener("opVariableNameChanged",((t,e)=>{const i={opId:t.id,varName:e};this.send(CABLES.PACO_VARIABLES,i)})),t.addEventListener("opTriggerNameChanged",((t,e)=>{const i={opId:t.id,varName:e};this.send(CABLES.PACO_TRIGGERS,i)})),t.addEventListener("onLink",((t,e)=>{this.send(CABLES.PACO_LINK,{op1:t.op.id,op2:e.op.id,port1:t.name,port2:e.name})})),t.addEventListener("portSetVariable",((t,e,i)=>{const s={opId:t.id,portName:e.name,variableName:i};this.send(CABLES.PACO_PORT_SETVARIABLE,s)})),t.addEventListener("portAnimUpdated",((t,e,i)=>{if(t&&e){const s={opId:t.id,portName:e.name,anim:i.getSerialized()};this.send(CABLES.PACO_PORT_ANIM_UPDATED,s)}}))};Lt.prototype.send=function(t,e){if(!this.paused&&(t!==CABLES.PACO_VALUECHANGE||"+ create new one"!==e.v))for(let i=0;i<this.connectors.length;i++)this.connectors[i].send(t,e)};const kt=function(){window.BroadcastChannel&&(this.bc=new BroadcastChannel("test_channel"))};kt.prototype.receive=function(t){this.bc&&(this._log.log("init"),this.bc.onmessage=t._receive.bind(t))},kt.prototype.send=function(t,e){if(!this.bc)return;const i={};i.event=t,i.vars=e,this.bc.postMessage(JSON.stringify(i))};class Dt{constructor(t){this.name=t,this.dur=0,this._startTime=0,this.childs=[]}start(){this._startTime=performance.now()}end(){this.dur=performance.now()-this._startTime}push(t){const e=new Dt(t);return this.childs.push(e),e.start(),e}print(t){t=t||0;let e="";for(let i=0;i<t;i++)e+="  ";for(let e=0;e<this.childs.length;e++)this.childs[e].print(t+1)}}class Vt extends X{constructor(t,e,i,s,r,n,o,a,h,l){super(t,e,i,s,r,n,o,a,h,l),this._loc=-1,this._cgl=t._cgl}updateValueF(){}setValueF(t){this.needsUpdate=!0,this._value=t}updateValue2F(){}setValue2F(t){this.needsUpdate=!0,this._value=t}updateValue3F(){}setValue3F(t){this.needsUpdate=!0,this._value=t}updateValue4F(){}setValue4F(t){this.needsUpdate=!0,this._value=t}getSizeBytes(){return"f"==this._type||"i"==this._type?4:"2i"==this._type||"2f"==this._type?8:"3f"==this._type?12:"4f"==this._type?16:"m4"==this._type?64:void this._log.warn("unknown type getSizeBytes")}}class Gt{constructor(t,e){if(!t)throw new Error("shader constructed without cgp "+e);this._log=new r("cgp_shader"),this._cgp=t,this._name=e,this._uniforms=[],e||this._log.stack("no shader name given"),this._name=e||"unknown",this.id=b(),this._isValid=!0,this._compileReason="",this.shaderModule=null,this._needsRecompile=!0,this._src=""}get isValid(){return this._isValid}get uniforms(){return this._uniforms}getName(){return this._name}setWhyCompile(t){this._compileReason=t}setSource(t){this._src=t,this.setWhyCompile("Source changed"),this._needsRecompile=!0}compile(){this._isValid=!0,console.log("compiling shader...",this._compileReason),this._cgp.pushErrorScope(),this.shaderModule=this._cgp.device.createShaderModule({code:this._src}),this._cgp.popErrorScope("cgp_shader "+this._name,this.error.bind(this)),this._needsRecompile=!1}error(t){this._isValid=!1}bind(){for(let t=0;t<this._uniforms.length;t++);this._needsRecompile&&this.compile()}addUniformFrag(t,e,i,s,r,n){const o=new Vt(this,t,e,i,s,r,n);return o.shaderType="frag",o}addUniformVert(t,e,i,s,r,n){const o=new Vt(this,t,e,i,s,r,n);return o.shaderType="vert",o}addUniform(t,e,i,s,r,n){const o=new Vt(this,t,e,i,s,r,n);return o.shaderType="both",o}_addUniform(t){this._uniforms.push(t),this.setWhyCompile("add uniform "+name),this._needsRecompile=!0}}class Ht{constructor(t,e){this._shaderType=e,this._shader=t,this._cgp=t._cgp,this._gpuBuffer=null,this._values=null,this._sizeBytes=0,this.update()}update(){this._sizeBytes=0;for(let t=0;t<this._shader.uniforms.length;t++){const e=this._shader.uniforms[t];this._shaderType==e.shaderType&&(this._sizeBytes+=e.getSizeBytes())}this._gpuBuffer=this._cgp.device.createBuffer({size:this._sizeBytes,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this._values=new Float32Array(this._sizeBytes/4),this.updateUniformValues()}updateUniformValues(){let t=0;for(let e=0;e<this._shader.uniforms.length;e++){const i=this._shader.uniforms[e];if(i.shaderType==this._shaderType)if(i.getSizeBytes()/4>1)for(let e=0;e<i.getValue().length;e++)this._values[t]=i.getValue()[e],t++;else this._values[t]=i.getValue(),t++}this._cgp.device.queue.writeBuffer(this._gpuBuffer,0,this._values.buffer,this._values.byteOffset,this._values.byteLength)}}class zt{constructor(t,e){if(!t)throw new Error("Pipeline constructed without cgp "+e);this._cgp=t,this._isValid=!0,this._pipeCfg=null,this._renderPipeline=null,this._fsUniformBuffer=null,this._vsUniformBuffer=null,this._old={},this.DEPTH_COMPARE_FUNCS_STRINGS=["never","less","equal","lessequal","greater","notequal","greaterequal","always"]}get isValid(){return this._isValid}setPipeline(t,e){if(!e||!t)return void console.log("pipeline unknown shader/mesh");let i=!this._renderPipeline||!this._pipeCfg||this._old.mesh!=e||this._old.shader!=t||e.needsPipelineUpdate||t.needsPipelineUpdate;this._pipeCfg&&(this._pipeCfg.depthStencil.depthWriteEnabled!=this._cgp.stateDepthWrite()&&(i=!0,this._pipeCfg.depthStencil.depthWriteEnabled=this._cgp.stateDepthWrite()),!1===this._cgp.stateDepthTest()?"never"!=this._pipeCfg.depthStencil.depthCompare&&(this._pipeCfg.depthStencil.depthCompare="never",i=!0):this._pipeCfg.depthStencil.depthCompare!=this._cgp.stateDepthFunc()&&(i=!0,this._pipeCfg.depthStencil.depthCompare=this._cgp.stateDepthFunc()),!1===this._cgp.stateCullFace()?"none"!=this._pipeCfg.primitive.cullMode&&(i=!0,this._pipeCfg.primitive.cullMode="none"):(i=!0,this._pipeCfg.primitive.cullMode=this._cgp.stateCullFaceFacing())),i&&(this._pipeCfg&&this._old.shader==t||(this._pipeCfg=this.getPiplelineObject(t,e)),this._old.shader=t,this._old.mesh=e,this._renderPipeline=this._cgp.device.createRenderPipeline(this._pipeCfg),this._bindUniforms(t)),this._renderPipeline&&this._isValid&&(mat4.copy(this._matModel,this._cgp.mMatrix),mat4.copy(this._matView,this._cgp.vMatrix),mat4.copy(this._matProj,this._cgp.pMatrix),this._cgp.device.queue.writeBuffer(this._vsUniformBuffer,0,this._vsUniformValues.buffer,this._vsUniformValues.byteOffset,this._vsUniformValues.byteLength),this._uniBufFrag.updateUniformValues(),this._cgp.passEncoder.setPipeline(this._renderPipeline),this._cgp.passEncoder.setBindGroup(0,this._bindGroup))}getPiplelineObject(t,e){return{layout:"auto",vertex:{module:t.shaderModule,entryPoint:"myVSMain",buffers:[{arrayStride:12,attributes:[{shaderLocation:0,offset:0,format:"float32x3"}]},{arrayStride:12,attributes:[{shaderLocation:1,offset:0,format:"float32x3"}]},{arrayStride:8,attributes:[{shaderLocation:2,offset:0,format:"float32x2"}]}]},fragment:{module:t.shaderModule,entryPoint:"myFSMain",targets:[{format:this._cgp.presentationFormat}]},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus"}}}_bindUniforms(t){this._cgp.pushErrorScope(),this._uniBufFrag=new Ht(t,"frag"),this._vsUniformBuffer=this._cgp.device.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this._vsUniformValues=new Float32Array(48),this._matModel=this._vsUniformValues.subarray(0,16),this._matView=this._vsUniformValues.subarray(16,32),this._matProj=this._vsUniformValues.subarray(32,48),this._bindGroup=this._cgp.device.createBindGroup({layout:this._renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this._vsUniformBuffer}},{binding:1,resource:{buffer:this._uniBufFrag._gpuBuffer}}]}),this._cgp.device.queue.writeBuffer(this._vsUniformBuffer,0,this._vsUniformValues.buffer,this._vsUniformValues.byteOffset,this._vsUniformValues.byteLength),this._uniBufFrag.updateUniformValues(),this._cgp.popErrorScope("cgp_pipeline end",(t=>{this._isValid=!1}))}}class Wt{constructor(t,e){if(!t)throw new Error("no cgp");this._log=new r("cgp_texture"),this._cgp=t,this.id=CABLES.uuid(),e=e||{},this.name=e.name||"unknown"}initTexture(t,e){this.width=t.width,this.height=t.height,this.textureType="rgba8unorm";const i={size:{width:t.width,height:t.height},format:this.textureType,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST},s=this._cgp.device.createTexture(i);return this._cgp.device.queue.copyExternalImageToTexture({source:t},{texture:s},i.size),s}getInfo(){const t=this,e={};return e.name=t.name,e.size=t.width+" x "+t.height,e.textureType=t.textureType,e}}Wt.load=function(t,e,i,s){fetch(e).then((s=>{s.blob().then((s=>{createImageBitmap(s).then((s=>{const r=new Wt(t,{name:e});r.initTexture(s),i?i(r):console.log("Texture.load no onFinished callback")}))}))}))};const Yt={Context:class extends bt{constructor(t){super(),this.patch=t,this.gApi=Tt.GAPI_WEBGPU,this._viewport=[0,0,256,256],this._shaderStack=[],this._simpleShader=null,this._stackCullFaceFacing=[],this._stackDepthTest=[],this._stackCullFace=[],this._stackDepthFunc=[],this._stackDepthWrite=[],this.DEPTH_FUNCS=["never","always","less","less-equal","greater","greater-equal","equal","not-equal"],this.CULL_MODES=["none","back","front","none"]}getViewPort(){return[0,0,this.canvasWidth,this.canvasHeight]}renderStart(t,e,i){this._simpleShader||(this._simpleShader=new Gt(this,"simple default shader"),this._simpleShader.setSource("struct VSUniforms\n{\n    modelMatrix: mat4x4<f32>,\n    viewMatrix: mat4x4<f32>,\n    projMatrix: mat4x4<f32>,\n};\n\nstruct FSUniforms\n{\n    color:vec4<f32>\n};\n\n@group(0) @binding(0) var<uniform> vsUniforms: VSUniforms;\n@group(0) @binding(1) var<uniform> fsUniforms: FSUniforms;\n\nstruct MyVSInput\n{\n    @location(0) position: vec3<f32>,\n    @location(1) normal: vec3<f32>,\n    @location(2) texcoord: vec2<f32>,\n};\n\nstruct MyVSOutput\n{\n    @builtin(position) position: vec4<f32>,\n    @location(0) normal: vec3<f32>,\n    @location(1) texcoord: vec2<f32>,\n};\n\n@vertex\nfn myVSMain(v: MyVSInput) -> MyVSOutput\n{\n    var vsOut: MyVSOutput;\n    var pos =vec4<f32>(v.position, 1.0);\n\n    var mvMatrix=vsUniforms.viewMatrix * vsUniforms.modelMatrix;\n    vsOut.position = vsUniforms.projMatrix * mvMatrix * pos;\n\n    vsOut.normal = v.normal;\n    vsOut.texcoord = v.texcoord;\n    return vsOut;\n}\n\n@fragment\nfn myFSMain(v: MyVSOutput) -> @location(0) vec4<f32>\n{\n    return fsUniforms.color+vec4<f32>(.5,.5,.5,1.0);\n}\n\n"),this._simpleShader.addUniformFrag("4f","color",1,1,0,1)),this.fpsCounter.startFrame(),this._startMatrixStacks(e,i),this.setViewPort(0,0,this.canvasWidth,this.canvasHeight),this.pushShader(this._simpleShader),this.pushDepthTest(!0),this.pushDepthWrite(!0),this.pushDepthFunc("less-equal"),this.emitEvent("beginFrame")}renderEnd(){this._endMatrixStacks(),this.popShader(),this.popDepthFunc(),this.popDepthWrite(),this.popDepthTest(),this.emitEvent("endFrame"),this.fpsCounter.endFrame()}setViewPort(t,e,i,s){this._viewport=[t,e,i,s]}getViewPort(){return this._viewPort}createMesh(t,e){return new CGP.Mesh(this,t,e)}getShader(){return{}}pushShader(t){this._shaderStack.push(t)}popShader(){if(0===this._shaderStack.length)throw new Error("Invalid shader stack pop!");this._shaderStack.pop()}getShader(){return this._shaderStack[this._shaderStack.length-1]}pushErrorScope(){this.device.pushErrorScope("validation")}popErrorScope(t,e){this.device.popErrorScope().then((i=>{i&&(this.patch.emitEvent("criticalError",{title:'WebGPU error "'+t+'"',codeText:i.message}),console.warn("[cgp]",t,i.message,i,e),e&&e(i))}))}pushDepthTest(t){this._stackDepthTest.push(t)}stateDepthTest(){return this._stackDepthTest[this._stackDepthTest.length-1]}popDepthTest(){this._stackDepthTest.pop()}pushDepthWrite(t){t=t||!1,this._stackDepthWrite.push(t)}stateDepthWrite(){return this._stackDepthWrite[this._stackDepthWrite.length-1]}popDepthWrite(){this._stackDepthWrite.pop()}pushDepthFunc(t){this._stackDepthFunc.push(t)}stateDepthFunc(){return this._stackDepthFunc.length>0&&this._stackDepthFunc[this._stackDepthFunc.length-1]}popDepthFunc(){this._stackDepthFunc.pop()}pushCullFace(t){this._stackCullFace.push(t)}stateCullFace(){return this._stackCullFace[this._stackCullFace.length-1]}popCullFace(){this._stackCullFace.pop()}pushCullFaceFacing(t){this._stackCullFaceFacing.push(t)}stateCullFaceFacing(){return this._stackCullFaceFacing[this._stackCullFaceFacing.length-1]}popCullFaceFacing(){this._stackCullFaceFacing.pop()}},Shader:Gt,Mesh:class{constructor(t,e){this._log=new r("cgl_mesh"),this._cgp=t,this._geom=null,this.numIndex=0,this._pipe=new zt(this._cgp),this._numNonIndexed=0,this._positionBuffer=null,this._bufVerticesIndizes=null,this._attributes=[],this._needsPipelineUpdate=!1,e&&this.setGeom(e)}_createBuffer(t,e,i){const s=t.createBuffer({size:e.byteLength,usage:i,mappedAtCreation:!0});return new e.constructor(s.getMappedRange()).set(e),s.unmap(),s}setGeom(t,e){this._needsPipelineUpdate=!0,this._geom=t,this._disposeAttributes(),this._positionBuffer=this._createBuffer(this._cgp.device,new Float32Array(t.vertices),GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST);let i=t.verticesIndices;t.isIndexed()||(i=Array.from(Array(t.vertices.length/3).keys())),this._numIndices=i.length,this._indicesBuffer=this._createBuffer(this._cgp.device,new Uint32Array(i),GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST),t.texCoords&&t.texCoords.length&&this.setAttribute("texCoords",t.texCoords,2),t.vertexNormals&&t.vertexNormals.length&&this.setAttribute("normals",t.vertexNormals,3)}_disposeAttributes(){this._needsPipelineUpdate=!0;for(let t=0;t<this._attributes.length;t++)this._attributes[t].buffer.destroy();this._attributes.length=0}dispose(){this._disposeAttributes()}setAttribute(t,e,i,s){if(!e)throw this._log.error("mesh addAttribute - no array given! "+t),new Error;for(let e=0;e<this._attributes.length;e++){const i=this._attributes[e];if(i.name==t)return i}const r={buffer:this._createBuffer(this._cgp.device,new Float32Array(e),GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST),name:t};return this._attributes.push(r),r}render(){if(!this._positionBuffer)return;const t=this._cgp.getShader();if(t&&t.bind(),this._cgp.getShader()&&this._cgp.getShader().isValid&&(this._pipe.setPipeline(this._cgp.getShader(),this),this._pipe.isValid)){this._cgp.passEncoder.setVertexBuffer(0,this._positionBuffer);for(let t=0;t<this._attributes.length;t++)this._cgp.passEncoder.setVertexBuffer(t+1,this._attributes[t].buffer);this._cgp.passEncoder.setIndexBuffer(this._indicesBuffer,"uint32"),this._numNonIndexed?this._cgp.passEncoder.draw(this._numIndices):this._cgp.passEncoder.drawIndexed(this._numIndices)}}},Pipeline:zt,Texture:Wt};window.CGP=Yt,window.CABLES=window.CABLES||{},CABLES.CG=Tt,CABLES.CGP=Yt,CABLES.EventTarget=H,CABLES.EMBED=Mt,CABLES.Link=yt,CABLES.Port=j,CABLES.Op=St,CABLES.Profiler=Ot,CABLES.Patch=wt,CABLES.Instancing=Ft,CABLES.Timer=ot,CABLES.WEBAUDIO=Ut,CABLES.Variable=function(){let t=null;const e=[];this.onChanged=function(t){e.push(t)},this.getValue=function(){return t},this.setValue=function(e){t=e,this.emitChanged()},this.emitChanged=function(){for(let t=0;t<e.length;t++)e[t]()}},CABLES.LoadingStatus=Pt,CABLES.now=nt,CABLES.internalNow=rt,CABLES.BranchStack=class{constructor(){}start(){this.root=new Dt("Root"),this.root.start(),this.current=this.root}push(t){this.current||this.start();const e=this.current;return this.current=this.current.push(t),this.current.prev=e,this.current.start(),this.current}pop(){this.current&&(this.current.end(),this.current=this.current.prev)}finish(){this.current.end(),this.root.print(),this.current=null}},CABLES.Branch=Dt;const jt=CABLES=Object.assign(CABLES,e,t,i,s,a,h,n,o);(function(){return!this})()||console.warn("not in strict mode: index core")})(),CABLES=__webpack_exports__.default})();
//# originalSourceMappingURL=cables.min.js.map

var CABLES = CABLES || {}; CABLES.build = {"timestamp":1699471251547,"created":"2023-11-08T19:20:51.547Z","git":{"branch":"master","commit":"d5b28c0364c69c8b6a64544e0c98648cd2502b58","date":"2023-11-08T11:39:20.000Z","message":"Hotfix patchcolors"}};
/*!
@fileoverview gl-matrix - High performance matrix and vector operations
@author Brandon Jones
@author Colin MacKenzie IV
@version 3.1.0

Copyright (c) 2015-2019, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).glMatrix={})}(this,function(t){"use strict";var n=1e-6,a="undefined"!=typeof Float32Array?Float32Array:Array,r=Math.random;var u=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)});var e=Object.freeze({EPSILON:n,get ARRAY_TYPE(){return a},RANDOM:r,setMatrixArrayType:function(t){a=t},toRadian:function(t){return t*u},equals:function(t,a){return Math.abs(t-a)<=n*Math.max(1,Math.abs(t),Math.abs(a))}});function o(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1],h=a[2],s=a[3];return t[0]=r*i+e*c,t[1]=u*i+o*c,t[2]=r*h+e*s,t[3]=u*h+o*s,t}function i(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t}var c=o,h=i,s=Object.freeze({create:function(){var t=new a(4);return a!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},clone:function(t){var n=new a(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},fromValues:function(t,n,r,u){var e=new a(4);return e[0]=t,e[1]=n,e[2]=r,e[3]=u,e},set:function(t,n,a,r,u){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t},transpose:function(t,n){if(t===n){var a=n[1];t[1]=n[2],t[2]=a}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a*e-u*r;return o?(o=1/o,t[0]=e*o,t[1]=-r*o,t[2]=-u*o,t[3]=a*o,t):null},adjoint:function(t,n){var a=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=a,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:o,rotate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c+e*i,t[1]=u*c+o*i,t[2]=r*-i+e*c,t[3]=u*-i+o*c,t},scale:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1];return t[0]=r*i,t[1]=u*i,t[2]=e*c,t[3]=o*c,t},fromRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=-a,t[3]=r,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t},str:function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3])},LDU:function(t,n,a,r){return t[2]=r[2]/r[0],a[0]=r[0],a[1]=r[1],a[3]=r[3]-t[2]*a[1],[t,n,a]},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t},subtract:i,exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=a[0],c=a[1],h=a[2],s=a[3];return Math.abs(r-i)<=n*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(u-c)<=n*Math.max(1,Math.abs(u),Math.abs(c))&&Math.abs(e-h)<=n*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(o-s)<=n*Math.max(1,Math.abs(o),Math.abs(s))},multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t},mul:c,sub:h});function M(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=a[0],s=a[1],M=a[2],f=a[3],l=a[4],v=a[5];return t[0]=r*h+e*s,t[1]=u*h+o*s,t[2]=r*M+e*f,t[3]=u*M+o*f,t[4]=r*l+e*v+i,t[5]=u*l+o*v+c,t}function f(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t}var l=M,v=f,b=Object.freeze({create:function(){var t=new a(6);return a!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},clone:function(t){var n=new a(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},fromValues:function(t,n,r,u,e,o){var i=new a(6);return i[0]=t,i[1]=n,i[2]=r,i[3]=u,i[4]=e,i[5]=o,i},set:function(t,n,a,r,u,e,o){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=a*e-r*u;return c?(c=1/c,t[0]=e*c,t[1]=-r*c,t[2]=-u*c,t[3]=a*c,t[4]=(u*i-e*o)*c,t[5]=(r*o-a*i)*c,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:M,rotate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=Math.sin(a),s=Math.cos(a);return t[0]=r*s+e*h,t[1]=u*s+o*h,t[2]=r*-h+e*s,t[3]=u*-h+o*s,t[4]=i,t[5]=c,t},scale:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=a[0],s=a[1];return t[0]=r*h,t[1]=u*h,t[2]=e*s,t[3]=o*s,t[4]=i,t[5]=c,t},translate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=a[0],s=a[1];return t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=r*h+e*s+i,t[5]=u*h+o*s+c,t},fromRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=-a,t[3]=r,t[4]=0,t[5]=0,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t},fromTranslation:function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t},str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t},subtract:f,multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=a[0],s=a[1],M=a[2],f=a[3],l=a[4],v=a[5];return Math.abs(r-h)<=n*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(u-s)<=n*Math.max(1,Math.abs(u),Math.abs(s))&&Math.abs(e-M)<=n*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(o-f)<=n*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-l)<=n*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(c-v)<=n*Math.max(1,Math.abs(c),Math.abs(v))},mul:l,sub:v});function m(){var t=new a(9);return a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function d(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=a[0],l=a[1],v=a[2],b=a[3],m=a[4],d=a[5],x=a[6],p=a[7],y=a[8];return t[0]=f*r+l*o+v*h,t[1]=f*u+l*i+v*s,t[2]=f*e+l*c+v*M,t[3]=b*r+m*o+d*h,t[4]=b*u+m*i+d*s,t[5]=b*e+m*c+d*M,t[6]=x*r+p*o+y*h,t[7]=x*u+p*i+y*s,t[8]=x*e+p*c+y*M,t}function x(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t}var p=d,y=x,q=Object.freeze({create:m,fromMat4:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t},clone:function(t){var n=new a(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},fromValues:function(t,n,r,u,e,o,i,c,h){var s=new a(9);return s[0]=t,s[1]=n,s[2]=r,s[3]=u,s[4]=e,s[5]=o,s[6]=i,s[7]=c,s[8]=h,s},set:function(t,n,a,r,u,e,o,i,c,h){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t[6]=i,t[7]=c,t[8]=h,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,n){if(t===n){var a=n[1],r=n[2],u=n[5];t[1]=n[3],t[2]=n[6],t[3]=a,t[5]=n[7],t[6]=r,t[7]=u}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=s*o-i*h,f=-s*e+i*c,l=h*e-o*c,v=a*M+r*f+u*l;return v?(v=1/v,t[0]=M*v,t[1]=(-s*r+u*h)*v,t[2]=(i*r-u*o)*v,t[3]=f*v,t[4]=(s*a-u*c)*v,t[5]=(-i*a+u*e)*v,t[6]=l*v,t[7]=(-h*a+r*c)*v,t[8]=(o*a-r*e)*v,t):null},adjoint:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8];return t[0]=o*s-i*h,t[1]=u*h-r*s,t[2]=r*i-u*o,t[3]=i*c-e*s,t[4]=a*s-u*c,t[5]=u*e-a*i,t[6]=e*h-o*c,t[7]=r*c-a*h,t[8]=a*o-r*e,t},determinant:function(t){var n=t[0],a=t[1],r=t[2],u=t[3],e=t[4],o=t[5],i=t[6],c=t[7],h=t[8];return n*(h*e-o*c)+a*(-h*u+o*i)+r*(c*u-e*i)},multiply:d,translate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=a[0],l=a[1];return t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=i,t[5]=c,t[6]=f*r+l*o+h,t[7]=f*u+l*i+s,t[8]=f*e+l*c+M,t},rotate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=Math.sin(a),l=Math.cos(a);return t[0]=l*r+f*o,t[1]=l*u+f*i,t[2]=l*e+f*c,t[3]=l*o-f*r,t[4]=l*i-f*u,t[5]=l*c-f*e,t[6]=h,t[7]=s,t[8]=M,t},scale:function(t,n,a){var r=a[0],u=a[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=u*n[3],t[4]=u*n[4],t[5]=u*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t},fromTranslation:function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t},fromRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=0,t[3]=-a,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t},fromQuat:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a+a,i=r+r,c=u+u,h=a*o,s=r*o,M=r*i,f=u*o,l=u*i,v=u*c,b=e*o,m=e*i,d=e*c;return t[0]=1-M-v,t[3]=s-d,t[6]=f+m,t[1]=s+d,t[4]=1-h-v,t[7]=l-b,t[2]=f-m,t[5]=l+b,t[8]=1-h-M,t},normalFromMat4:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=n[9],f=n[10],l=n[11],v=n[12],b=n[13],m=n[14],d=n[15],x=a*i-r*o,p=a*c-u*o,y=a*h-e*o,q=r*c-u*i,g=r*h-e*i,A=u*h-e*c,w=s*b-M*v,R=s*m-f*v,z=s*d-l*v,P=M*m-f*b,j=M*d-l*b,I=f*d-l*m,S=x*I-p*j+y*P+q*z-g*R+A*w;return S?(S=1/S,t[0]=(i*I-c*j+h*P)*S,t[1]=(c*z-o*I-h*R)*S,t[2]=(o*j-i*z+h*w)*S,t[3]=(u*j-r*I-e*P)*S,t[4]=(a*I-u*z+e*R)*S,t[5]=(r*z-a*j-e*w)*S,t[6]=(b*A-m*g+d*q)*S,t[7]=(m*y-v*A-d*p)*S,t[8]=(v*g-b*y+d*x)*S,t):null},projection:function(t,n,a){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/a,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t},subtract:x,multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t[6]=n[6]+a[6]*r,t[7]=n[7]+a[7]*r,t[8]=n[8]+a[8]*r,t},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=t[6],s=t[7],M=t[8],f=a[0],l=a[1],v=a[2],b=a[3],m=a[4],d=a[5],x=a[6],p=a[7],y=a[8];return Math.abs(r-f)<=n*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(u-l)<=n*Math.max(1,Math.abs(u),Math.abs(l))&&Math.abs(e-v)<=n*Math.max(1,Math.abs(e),Math.abs(v))&&Math.abs(o-b)<=n*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(i-m)<=n*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(c-d)<=n*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(h-x)<=n*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(s-p)<=n*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(M-y)<=n*Math.max(1,Math.abs(M),Math.abs(y))},mul:p,sub:y});function g(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=n[9],l=n[10],v=n[11],b=n[12],m=n[13],d=n[14],x=n[15],p=a[0],y=a[1],q=a[2],g=a[3];return t[0]=p*r+y*i+q*M+g*b,t[1]=p*u+y*c+q*f+g*m,t[2]=p*e+y*h+q*l+g*d,t[3]=p*o+y*s+q*v+g*x,p=a[4],y=a[5],q=a[6],g=a[7],t[4]=p*r+y*i+q*M+g*b,t[5]=p*u+y*c+q*f+g*m,t[6]=p*e+y*h+q*l+g*d,t[7]=p*o+y*s+q*v+g*x,p=a[8],y=a[9],q=a[10],g=a[11],t[8]=p*r+y*i+q*M+g*b,t[9]=p*u+y*c+q*f+g*m,t[10]=p*e+y*h+q*l+g*d,t[11]=p*o+y*s+q*v+g*x,p=a[12],y=a[13],q=a[14],g=a[15],t[12]=p*r+y*i+q*M+g*b,t[13]=p*u+y*c+q*f+g*m,t[14]=p*e+y*h+q*l+g*d,t[15]=p*o+y*s+q*v+g*x,t}function w(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=r+r,c=u+u,h=e+e,s=r*i,M=r*c,f=r*h,l=u*c,v=u*h,b=e*h,m=o*i,d=o*c,x=o*h;return t[0]=1-(l+b),t[1]=M+x,t[2]=f-d,t[3]=0,t[4]=M-x,t[5]=1-(s+b),t[6]=v+m,t[7]=0,t[8]=f+d,t[9]=v-m,t[10]=1-(s+l),t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function R(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function z(t,n){var a=n[0],r=n[1],u=n[2],e=n[4],o=n[5],i=n[6],c=n[8],h=n[9],s=n[10];return t[0]=Math.hypot(a,r,u),t[1]=Math.hypot(e,o,i),t[2]=Math.hypot(c,h,s),t}function P(t,n){var r=new a(3);z(r,n);var u=1/r[0],e=1/r[1],o=1/r[2],i=n[0]*u,c=n[1]*e,h=n[2]*o,s=n[4]*u,M=n[5]*e,f=n[6]*o,l=n[8]*u,v=n[9]*e,b=n[10]*o,m=i+M+b,d=0;return m>0?(d=2*Math.sqrt(m+1),t[3]=.25*d,t[0]=(f-v)/d,t[1]=(l-h)/d,t[2]=(c-s)/d):i>M&&i>b?(d=2*Math.sqrt(1+i-M-b),t[3]=(f-v)/d,t[0]=.25*d,t[1]=(c+s)/d,t[2]=(l+h)/d):M>b?(d=2*Math.sqrt(1+M-i-b),t[3]=(l-h)/d,t[0]=(c+s)/d,t[1]=.25*d,t[2]=(f+v)/d):(d=2*Math.sqrt(1+b-i-M),t[3]=(c-s)/d,t[0]=(l+h)/d,t[1]=(f+v)/d,t[2]=.25*d),t}function j(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t[6]=n[6]-a[6],t[7]=n[7]-a[7],t[8]=n[8]-a[8],t[9]=n[9]-a[9],t[10]=n[10]-a[10],t[11]=n[11]-a[11],t[12]=n[12]-a[12],t[13]=n[13]-a[13],t[14]=n[14]-a[14],t[15]=n[15]-a[15],t}var I=A,S=j,E=Object.freeze({create:function(){var t=new a(16);return a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},clone:function(t){var n=new a(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},fromValues:function(t,n,r,u,e,o,i,c,h,s,M,f,l,v,b,m){var d=new a(16);return d[0]=t,d[1]=n,d[2]=r,d[3]=u,d[4]=e,d[5]=o,d[6]=i,d[7]=c,d[8]=h,d[9]=s,d[10]=M,d[11]=f,d[12]=l,d[13]=v,d[14]=b,d[15]=m,d},set:function(t,n,a,r,u,e,o,i,c,h,s,M,f,l,v,b,m){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t[6]=i,t[7]=c,t[8]=h,t[9]=s,t[10]=M,t[11]=f,t[12]=l,t[13]=v,t[14]=b,t[15]=m,t},identity:g,transpose:function(t,n){if(t===n){var a=n[1],r=n[2],u=n[3],e=n[6],o=n[7],i=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=a,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=e,t[11]=n[14],t[12]=u,t[13]=o,t[14]=i}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=n[9],f=n[10],l=n[11],v=n[12],b=n[13],m=n[14],d=n[15],x=a*i-r*o,p=a*c-u*o,y=a*h-e*o,q=r*c-u*i,g=r*h-e*i,A=u*h-e*c,w=s*b-M*v,R=s*m-f*v,z=s*d-l*v,P=M*m-f*b,j=M*d-l*b,I=f*d-l*m,S=x*I-p*j+y*P+q*z-g*R+A*w;return S?(S=1/S,t[0]=(i*I-c*j+h*P)*S,t[1]=(u*j-r*I-e*P)*S,t[2]=(b*A-m*g+d*q)*S,t[3]=(f*g-M*A-l*q)*S,t[4]=(c*z-o*I-h*R)*S,t[5]=(a*I-u*z+e*R)*S,t[6]=(m*y-v*A-d*p)*S,t[7]=(s*A-f*y+l*p)*S,t[8]=(o*j-i*z+h*w)*S,t[9]=(r*z-a*j-e*w)*S,t[10]=(v*g-b*y+d*x)*S,t[11]=(M*y-s*g-l*x)*S,t[12]=(i*R-o*P-c*w)*S,t[13]=(a*P-r*R+u*w)*S,t[14]=(b*p-v*q-m*x)*S,t[15]=(s*q-M*p+f*x)*S,t):null},adjoint:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=n[4],i=n[5],c=n[6],h=n[7],s=n[8],M=n[9],f=n[10],l=n[11],v=n[12],b=n[13],m=n[14],d=n[15];return t[0]=i*(f*d-l*m)-M*(c*d-h*m)+b*(c*l-h*f),t[1]=-(r*(f*d-l*m)-M*(u*d-e*m)+b*(u*l-e*f)),t[2]=r*(c*d-h*m)-i*(u*d-e*m)+b*(u*h-e*c),t[3]=-(r*(c*l-h*f)-i*(u*l-e*f)+M*(u*h-e*c)),t[4]=-(o*(f*d-l*m)-s*(c*d-h*m)+v*(c*l-h*f)),t[5]=a*(f*d-l*m)-s*(u*d-e*m)+v*(u*l-e*f),t[6]=-(a*(c*d-h*m)-o*(u*d-e*m)+v*(u*h-e*c)),t[7]=a*(c*l-h*f)-o*(u*l-e*f)+s*(u*h-e*c),t[8]=o*(M*d-l*b)-s*(i*d-h*b)+v*(i*l-h*M),t[9]=-(a*(M*d-l*b)-s*(r*d-e*b)+v*(r*l-e*M)),t[10]=a*(i*d-h*b)-o*(r*d-e*b)+v*(r*h-e*i),t[11]=-(a*(i*l-h*M)-o*(r*l-e*M)+s*(r*h-e*i)),t[12]=-(o*(M*m-f*b)-s*(i*m-c*b)+v*(i*f-c*M)),t[13]=a*(M*m-f*b)-s*(r*m-u*b)+v*(r*f-u*M),t[14]=-(a*(i*m-c*b)-o*(r*m-u*b)+v*(r*c-u*i)),t[15]=a*(i*f-c*M)-o*(r*f-u*M)+s*(r*c-u*i),t},determinant:function(t){var n=t[0],a=t[1],r=t[2],u=t[3],e=t[4],o=t[5],i=t[6],c=t[7],h=t[8],s=t[9],M=t[10],f=t[11],l=t[12],v=t[13],b=t[14],m=t[15];return(n*o-a*e)*(M*m-f*b)-(n*i-r*e)*(s*m-f*v)+(n*c-u*e)*(s*b-M*v)+(a*i-r*o)*(h*m-f*l)-(a*c-u*o)*(h*b-M*l)+(r*c-u*i)*(h*v-s*l)},multiply:A,translate:function(t,n,a){var r,u,e,o,i,c,h,s,M,f,l,v,b=a[0],m=a[1],d=a[2];return n===t?(t[12]=n[0]*b+n[4]*m+n[8]*d+n[12],t[13]=n[1]*b+n[5]*m+n[9]*d+n[13],t[14]=n[2]*b+n[6]*m+n[10]*d+n[14],t[15]=n[3]*b+n[7]*m+n[11]*d+n[15]):(r=n[0],u=n[1],e=n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=n[8],f=n[9],l=n[10],v=n[11],t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=i,t[5]=c,t[6]=h,t[7]=s,t[8]=M,t[9]=f,t[10]=l,t[11]=v,t[12]=r*b+i*m+M*d+n[12],t[13]=u*b+c*m+f*d+n[13],t[14]=e*b+h*m+l*d+n[14],t[15]=o*b+s*m+v*d+n[15]),t},scale:function(t,n,a){var r=a[0],u=a[1],e=a[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*u,t[5]=n[5]*u,t[6]=n[6]*u,t[7]=n[7]*u,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=n[11]*e,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},rotate:function(t,a,r,u){var e,o,i,c,h,s,M,f,l,v,b,m,d,x,p,y,q,g,A,w,R,z,P,j,I=u[0],S=u[1],E=u[2],O=Math.hypot(I,S,E);return O<n?null:(I*=O=1/O,S*=O,E*=O,e=Math.sin(r),i=1-(o=Math.cos(r)),c=a[0],h=a[1],s=a[2],M=a[3],f=a[4],l=a[5],v=a[6],b=a[7],m=a[8],d=a[9],x=a[10],p=a[11],y=I*I*i+o,q=S*I*i+E*e,g=E*I*i-S*e,A=I*S*i-E*e,w=S*S*i+o,R=E*S*i+I*e,z=I*E*i+S*e,P=S*E*i-I*e,j=E*E*i+o,t[0]=c*y+f*q+m*g,t[1]=h*y+l*q+d*g,t[2]=s*y+v*q+x*g,t[3]=M*y+b*q+p*g,t[4]=c*A+f*w+m*R,t[5]=h*A+l*w+d*R,t[6]=s*A+v*w+x*R,t[7]=M*A+b*w+p*R,t[8]=c*z+f*P+m*j,t[9]=h*z+l*P+d*j,t[10]=s*z+v*P+x*j,t[11]=M*z+b*P+p*j,a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t)},rotateX:function(t,n,a){var r=Math.sin(a),u=Math.cos(a),e=n[4],o=n[5],i=n[6],c=n[7],h=n[8],s=n[9],M=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=e*u+h*r,t[5]=o*u+s*r,t[6]=i*u+M*r,t[7]=c*u+f*r,t[8]=h*u-e*r,t[9]=s*u-o*r,t[10]=M*u-i*r,t[11]=f*u-c*r,t},rotateY:function(t,n,a){var r=Math.sin(a),u=Math.cos(a),e=n[0],o=n[1],i=n[2],c=n[3],h=n[8],s=n[9],M=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=e*u-h*r,t[1]=o*u-s*r,t[2]=i*u-M*r,t[3]=c*u-f*r,t[8]=e*r+h*u,t[9]=o*r+s*u,t[10]=i*r+M*u,t[11]=c*r+f*u,t},rotateZ:function(t,n,a){var r=Math.sin(a),u=Math.cos(a),e=n[0],o=n[1],i=n[2],c=n[3],h=n[4],s=n[5],M=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=e*u+h*r,t[1]=o*u+s*r,t[2]=i*u+M*r,t[3]=c*u+f*r,t[4]=h*u-e*r,t[5]=s*u-o*r,t[6]=M*u-i*r,t[7]=f*u-c*r,t},fromTranslation:function(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromScaling:function(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,a,r){var u,e,o,i=r[0],c=r[1],h=r[2],s=Math.hypot(i,c,h);return s<n?null:(i*=s=1/s,c*=s,h*=s,u=Math.sin(a),o=1-(e=Math.cos(a)),t[0]=i*i*o+e,t[1]=c*i*o+h*u,t[2]=h*i*o-c*u,t[3]=0,t[4]=i*c*o-h*u,t[5]=c*c*o+e,t[6]=h*c*o+i*u,t[7]=0,t[8]=i*h*o+c*u,t[9]=c*h*o-i*u,t[10]=h*h*o+e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=a,t[7]=0,t[8]=0,t[9]=-a,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromYRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-a,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=a,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,n){var a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=0,t[3]=0,t[4]=-a,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:w,fromQuat2:function(t,n){var r=new a(3),u=-n[0],e=-n[1],o=-n[2],i=n[3],c=n[4],h=n[5],s=n[6],M=n[7],f=u*u+e*e+o*o+i*i;return f>0?(r[0]=2*(c*i+M*u+h*o-s*e)/f,r[1]=2*(h*i+M*e+s*u-c*o)/f,r[2]=2*(s*i+M*o+c*e-h*u)/f):(r[0]=2*(c*i+M*u+h*o-s*e),r[1]=2*(h*i+M*e+s*u-c*o),r[2]=2*(s*i+M*o+c*e-h*u)),w(t,n,r),t},getTranslation:R,getScaling:z,getRotation:P,fromRotationTranslationScale:function(t,n,a,r){var u=n[0],e=n[1],o=n[2],i=n[3],c=u+u,h=e+e,s=o+o,M=u*c,f=u*h,l=u*s,v=e*h,b=e*s,m=o*s,d=i*c,x=i*h,p=i*s,y=r[0],q=r[1],g=r[2];return t[0]=(1-(v+m))*y,t[1]=(f+p)*y,t[2]=(l-x)*y,t[3]=0,t[4]=(f-p)*q,t[5]=(1-(M+m))*q,t[6]=(b+d)*q,t[7]=0,t[8]=(l+x)*g,t[9]=(b-d)*g,t[10]=(1-(M+v))*g,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,n,a,r,u){var e=n[0],o=n[1],i=n[2],c=n[3],h=e+e,s=o+o,M=i+i,f=e*h,l=e*s,v=e*M,b=o*s,m=o*M,d=i*M,x=c*h,p=c*s,y=c*M,q=r[0],g=r[1],A=r[2],w=u[0],R=u[1],z=u[2],P=(1-(b+d))*q,j=(l+y)*q,I=(v-p)*q,S=(l-y)*g,E=(1-(f+d))*g,O=(m+x)*g,T=(v+p)*A,D=(m-x)*A,F=(1-(f+b))*A;return t[0]=P,t[1]=j,t[2]=I,t[3]=0,t[4]=S,t[5]=E,t[6]=O,t[7]=0,t[8]=T,t[9]=D,t[10]=F,t[11]=0,t[12]=a[0]+w-(P*w+S*R+T*z),t[13]=a[1]+R-(j*w+E*R+D*z),t[14]=a[2]+z-(I*w+O*R+F*z),t[15]=1,t},fromQuat:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a+a,i=r+r,c=u+u,h=a*o,s=r*o,M=r*i,f=u*o,l=u*i,v=u*c,b=e*o,m=e*i,d=e*c;return t[0]=1-M-v,t[1]=s+d,t[2]=f-m,t[3]=0,t[4]=s-d,t[5]=1-h-v,t[6]=l+b,t[7]=0,t[8]=f+m,t[9]=l-b,t[10]=1-h-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,n,a,r,u,e,o){var i=1/(a-n),c=1/(u-r),h=1/(e-o);return t[0]=2*e*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*e*c,t[6]=0,t[7]=0,t[8]=(a+n)*i,t[9]=(u+r)*c,t[10]=(o+e)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*e*2*h,t[15]=0,t},perspective:function(t,n,a,r,u){var e,o=1/Math.tan(n/2);return t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=u&&u!==1/0?(e=1/(r-u),t[10]=(u+r)*e,t[14]=2*u*r*e):(t[10]=-1,t[14]=-2*r),t},perspectiveFromFieldOfView:function(t,n,a,r){var u=Math.tan(n.upDegrees*Math.PI/180),e=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),i=Math.tan(n.rightDegrees*Math.PI/180),c=2/(o+i),h=2/(u+e);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(o-i)*c*.5,t[9]=(u-e)*h*.5,t[10]=r/(a-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*a/(a-r),t[15]=0,t},ortho:function(t,n,a,r,u,e,o){var i=1/(n-a),c=1/(r-u),h=1/(e-o);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(n+a)*i,t[13]=(u+r)*c,t[14]=(o+e)*h,t[15]=1,t},lookAt:function(t,a,r,u){var e,o,i,c,h,s,M,f,l,v,b=a[0],m=a[1],d=a[2],x=u[0],p=u[1],y=u[2],q=r[0],A=r[1],w=r[2];return Math.abs(b-q)<n&&Math.abs(m-A)<n&&Math.abs(d-w)<n?g(t):(M=b-q,f=m-A,l=d-w,e=p*(l*=v=1/Math.hypot(M,f,l))-y*(f*=v),o=y*(M*=v)-x*l,i=x*f-p*M,(v=Math.hypot(e,o,i))?(e*=v=1/v,o*=v,i*=v):(e=0,o=0,i=0),c=f*i-l*o,h=l*e-M*i,s=M*o-f*e,(v=Math.hypot(c,h,s))?(c*=v=1/v,h*=v,s*=v):(c=0,h=0,s=0),t[0]=e,t[1]=c,t[2]=M,t[3]=0,t[4]=o,t[5]=h,t[6]=f,t[7]=0,t[8]=i,t[9]=s,t[10]=l,t[11]=0,t[12]=-(e*b+o*m+i*d),t[13]=-(c*b+h*m+s*d),t[14]=-(M*b+f*m+l*d),t[15]=1,t)},targetTo:function(t,n,a,r){var u=n[0],e=n[1],o=n[2],i=r[0],c=r[1],h=r[2],s=u-a[0],M=e-a[1],f=o-a[2],l=s*s+M*M+f*f;l>0&&(s*=l=1/Math.sqrt(l),M*=l,f*=l);var v=c*f-h*M,b=h*s-i*f,m=i*M-c*s;return(l=v*v+b*b+m*m)>0&&(v*=l=1/Math.sqrt(l),b*=l,m*=l),t[0]=v,t[1]=b,t[2]=m,t[3]=0,t[4]=M*m-f*b,t[5]=f*v-s*m,t[6]=s*b-M*v,t[7]=0,t[8]=s,t[9]=M,t[10]=f,t[11]=0,t[12]=u,t[13]=e,t[14]=o,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t[8]=n[8]+a[8],t[9]=n[9]+a[9],t[10]=n[10]+a[10],t[11]=n[11]+a[11],t[12]=n[12]+a[12],t[13]=n[13]+a[13],t[14]=n[14]+a[14],t[15]=n[15]+a[15],t},subtract:j,multiplyScalar:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=n[11]*a,t[12]=n[12]*a,t[13]=n[13]*a,t[14]=n[14]*a,t[15]=n[15]*a,t},multiplyScalarAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t[6]=n[6]+a[6]*r,t[7]=n[7]+a[7]*r,t[8]=n[8]+a[8]*r,t[9]=n[9]+a[9]*r,t[10]=n[10]+a[10]*r,t[11]=n[11]+a[11]*r,t[12]=n[12]+a[12]*r,t[13]=n[13]+a[13]*r,t[14]=n[14]+a[14]*r,t[15]=n[15]+a[15]*r,t},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=t[6],s=t[7],M=t[8],f=t[9],l=t[10],v=t[11],b=t[12],m=t[13],d=t[14],x=t[15],p=a[0],y=a[1],q=a[2],g=a[3],A=a[4],w=a[5],R=a[6],z=a[7],P=a[8],j=a[9],I=a[10],S=a[11],E=a[12],O=a[13],T=a[14],D=a[15];return Math.abs(r-p)<=n*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(u-y)<=n*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(e-q)<=n*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(o-g)<=n*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(i-A)<=n*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(c-w)<=n*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(h-R)<=n*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(s-z)<=n*Math.max(1,Math.abs(s),Math.abs(z))&&Math.abs(M-P)<=n*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(f-j)<=n*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(l-I)<=n*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(v-S)<=n*Math.max(1,Math.abs(v),Math.abs(S))&&Math.abs(b-E)<=n*Math.max(1,Math.abs(b),Math.abs(E))&&Math.abs(m-O)<=n*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(d-T)<=n*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(x-D)<=n*Math.max(1,Math.abs(x),Math.abs(D))},mul:I,sub:S});function O(){var t=new a(3);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function T(t){var n=t[0],a=t[1],r=t[2];return Math.hypot(n,a,r)}function D(t,n,r){var u=new a(3);return u[0]=t,u[1]=n,u[2]=r,u}function F(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t}function L(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t}function V(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t}function Q(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2];return Math.hypot(a,r,u)}function Y(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2];return a*a+r*r+u*u}function X(t){var n=t[0],a=t[1],r=t[2];return n*n+a*a+r*r}function Z(t,n){var a=n[0],r=n[1],u=n[2],e=a*a+r*r+u*u;return e>0&&(e=1/Math.sqrt(e)),t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function _(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function B(t,n,a){var r=n[0],u=n[1],e=n[2],o=a[0],i=a[1],c=a[2];return t[0]=u*c-e*i,t[1]=e*o-r*c,t[2]=r*i-u*o,t}var N,k=F,U=L,W=V,C=Q,G=Y,H=T,J=X,K=(N=O(),function(t,n,a,r,u,e){var o,i;for(n||(n=3),a||(a=0),i=r?Math.min(r*n+a,t.length):t.length,o=a;o<i;o+=n)N[0]=t[o],N[1]=t[o+1],N[2]=t[o+2],u(N,N,e),t[o]=N[0],t[o+1]=N[1],t[o+2]=N[2];return t}),$=Object.freeze({create:O,clone:function(t){var n=new a(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},length:T,fromValues:D,copy:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},set:function(t,n,a,r){return t[0]=n,t[1]=a,t[2]=r,t},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t},subtract:F,multiply:L,divide:V,ceil:function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t},floor:function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t},min:function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t},max:function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t},round:function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t},scale:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t},scaleAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t},distance:Q,squaredDistance:Y,squaredLength:X,negate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t},inverse:function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t},normalize:Z,dot:_,cross:B,lerp:function(t,n,a,r){var u=n[0],e=n[1],o=n[2];return t[0]=u+r*(a[0]-u),t[1]=e+r*(a[1]-e),t[2]=o+r*(a[2]-o),t},hermite:function(t,n,a,r,u,e){var o=e*e,i=o*(2*e-3)+1,c=o*(e-2)+e,h=o*(e-1),s=o*(3-2*e);return t[0]=n[0]*i+a[0]*c+r[0]*h+u[0]*s,t[1]=n[1]*i+a[1]*c+r[1]*h+u[1]*s,t[2]=n[2]*i+a[2]*c+r[2]*h+u[2]*s,t},bezier:function(t,n,a,r,u,e){var o=1-e,i=o*o,c=e*e,h=i*o,s=3*e*i,M=3*c*o,f=c*e;return t[0]=n[0]*h+a[0]*s+r[0]*M+u[0]*f,t[1]=n[1]*h+a[1]*s+r[1]*M+u[1]*f,t[2]=n[2]*h+a[2]*s+r[2]*M+u[2]*f,t},random:function(t,n){n=n||1;var a=2*r()*Math.PI,u=2*r()-1,e=Math.sqrt(1-u*u)*n;return t[0]=Math.cos(a)*e,t[1]=Math.sin(a)*e,t[2]=u*n,t},transformMat4:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=a[3]*r+a[7]*u+a[11]*e+a[15];return o=o||1,t[0]=(a[0]*r+a[4]*u+a[8]*e+a[12])/o,t[1]=(a[1]*r+a[5]*u+a[9]*e+a[13])/o,t[2]=(a[2]*r+a[6]*u+a[10]*e+a[14])/o,t},transformMat3:function(t,n,a){var r=n[0],u=n[1],e=n[2];return t[0]=r*a[0]+u*a[3]+e*a[6],t[1]=r*a[1]+u*a[4]+e*a[7],t[2]=r*a[2]+u*a[5]+e*a[8],t},transformQuat:function(t,n,a){var r=a[0],u=a[1],e=a[2],o=a[3],i=n[0],c=n[1],h=n[2],s=u*h-e*c,M=e*i-r*h,f=r*c-u*i,l=u*f-e*M,v=e*s-r*f,b=r*M-u*s,m=2*o;return s*=m,M*=m,f*=m,l*=2,v*=2,b*=2,t[0]=i+s+l,t[1]=c+M+v,t[2]=h+f+b,t},rotateX:function(t,n,a,r){var u=[],e=[];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u[2]=n[2]-a[2],e[0]=u[0],e[1]=u[1]*Math.cos(r)-u[2]*Math.sin(r),e[2]=u[1]*Math.sin(r)+u[2]*Math.cos(r),t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},rotateY:function(t,n,a,r){var u=[],e=[];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u[2]=n[2]-a[2],e[0]=u[2]*Math.sin(r)+u[0]*Math.cos(r),e[1]=u[1],e[2]=u[2]*Math.cos(r)-u[0]*Math.sin(r),t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},rotateZ:function(t,n,a,r){var u=[],e=[];return u[0]=n[0]-a[0],u[1]=n[1]-a[1],u[2]=n[2]-a[2],e[0]=u[0]*Math.cos(r)-u[1]*Math.sin(r),e[1]=u[0]*Math.sin(r)+u[1]*Math.cos(r),e[2]=u[2],t[0]=e[0]+a[0],t[1]=e[1]+a[1],t[2]=e[2]+a[2],t},angle:function(t,n){var a=D(t[0],t[1],t[2]),r=D(n[0],n[1],n[2]);Z(a,a),Z(r,r);var u=_(a,r);return u>1?0:u<-1?Math.PI:Math.acos(u)},zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t},str:function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=a[0],i=a[1],c=a[2];return Math.abs(r-o)<=n*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(u-i)<=n*Math.max(1,Math.abs(u),Math.abs(i))&&Math.abs(e-c)<=n*Math.max(1,Math.abs(e),Math.abs(c))},sub:k,mul:U,div:W,dist:C,sqrDist:G,len:H,sqrLen:J,forEach:K});function tt(){var t=new a(4);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function nt(t){var n=new a(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function at(t,n,r,u){var e=new a(4);return e[0]=t,e[1]=n,e[2]=r,e[3]=u,e}function rt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function ut(t,n,a,r,u){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t}function et(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t}function ot(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t}function it(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t[3]=n[3]*a[3],t}function ct(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t[3]=n[3]/a[3],t}function ht(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t}function st(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2],e=n[3]-t[3];return Math.hypot(a,r,u,e)}function Mt(t,n){var a=n[0]-t[0],r=n[1]-t[1],u=n[2]-t[2],e=n[3]-t[3];return a*a+r*r+u*u+e*e}function ft(t){var n=t[0],a=t[1],r=t[2],u=t[3];return Math.hypot(n,a,r,u)}function lt(t){var n=t[0],a=t[1],r=t[2],u=t[3];return n*n+a*a+r*r+u*u}function vt(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a*a+r*r+u*u+e*e;return o>0&&(o=1/Math.sqrt(o)),t[0]=a*o,t[1]=r*o,t[2]=u*o,t[3]=e*o,t}function bt(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function mt(t,n,a,r){var u=n[0],e=n[1],o=n[2],i=n[3];return t[0]=u+r*(a[0]-u),t[1]=e+r*(a[1]-e),t[2]=o+r*(a[2]-o),t[3]=i+r*(a[3]-i),t}function dt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function xt(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=a[0],c=a[1],h=a[2],s=a[3];return Math.abs(r-i)<=n*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(u-c)<=n*Math.max(1,Math.abs(u),Math.abs(c))&&Math.abs(e-h)<=n*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(o-s)<=n*Math.max(1,Math.abs(o),Math.abs(s))}var pt=ot,yt=it,qt=ct,gt=st,At=Mt,wt=ft,Rt=lt,zt=function(){var t=tt();return function(n,a,r,u,e,o){var i,c;for(a||(a=4),r||(r=0),c=u?Math.min(u*a+r,n.length):n.length,i=r;i<c;i+=a)t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],t[3]=n[i+3],e(t,t,o),n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],n[i+3]=t[3];return n}}(),Pt=Object.freeze({create:tt,clone:nt,fromValues:at,copy:rt,set:ut,add:et,subtract:ot,multiply:it,divide:ct,ceil:function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t},floor:function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t},min:function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t[3]=Math.min(n[3],a[3]),t},max:function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t[3]=Math.max(n[3],a[3]),t},round:function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t},scale:ht,scaleAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t},distance:st,squaredDistance:Mt,length:ft,squaredLength:lt,negate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t},inverse:function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t},normalize:vt,dot:bt,cross:function(t,n,a,r){var u=a[0]*r[1]-a[1]*r[0],e=a[0]*r[2]-a[2]*r[0],o=a[0]*r[3]-a[3]*r[0],i=a[1]*r[2]-a[2]*r[1],c=a[1]*r[3]-a[3]*r[1],h=a[2]*r[3]-a[3]*r[2],s=n[0],M=n[1],f=n[2],l=n[3];return t[0]=M*h-f*c+l*i,t[1]=-s*h+f*o-l*e,t[2]=s*c-M*o+l*u,t[3]=-s*i+M*e-f*u,t},lerp:mt,random:function(t,n){var a,u,e,o,i,c;n=n||1;do{i=(a=2*r()-1)*a+(u=2*r()-1)*u}while(i>=1);do{c=(e=2*r()-1)*e+(o=2*r()-1)*o}while(c>=1);var h=Math.sqrt((1-i)/c);return t[0]=n*a,t[1]=n*u,t[2]=n*e*h,t[3]=n*o*h,t},transformMat4:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3];return t[0]=a[0]*r+a[4]*u+a[8]*e+a[12]*o,t[1]=a[1]*r+a[5]*u+a[9]*e+a[13]*o,t[2]=a[2]*r+a[6]*u+a[10]*e+a[14]*o,t[3]=a[3]*r+a[7]*u+a[11]*e+a[15]*o,t},transformQuat:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=a[0],i=a[1],c=a[2],h=a[3],s=h*r+i*e-c*u,M=h*u+c*r-o*e,f=h*e+o*u-i*r,l=-o*r-i*u-c*e;return t[0]=s*h+l*-o+M*-c-f*-i,t[1]=M*h+l*-i+f*-o-s*-c,t[2]=f*h+l*-c+s*-i-M*-o,t[3]=n[3],t},zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},exactEquals:dt,equals:xt,sub:pt,mul:yt,div:qt,dist:gt,sqrDist:At,len:wt,sqrLen:Rt,forEach:zt});function jt(){var t=new a(4);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function It(t,n,a){a*=.5;var r=Math.sin(a);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(a),t}function St(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1],h=a[2],s=a[3];return t[0]=r*s+o*i+u*h-e*c,t[1]=u*s+o*c+e*i-r*h,t[2]=e*s+o*h+r*c-u*i,t[3]=o*s-r*i-u*c-e*h,t}function Et(t,n,a){a*=.5;var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c+o*i,t[1]=u*c+e*i,t[2]=e*c-u*i,t[3]=o*c-r*i,t}function Ot(t,n,a){a*=.5;var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c-e*i,t[1]=u*c+o*i,t[2]=e*c+r*i,t[3]=o*c-u*i,t}function Tt(t,n,a){a*=.5;var r=n[0],u=n[1],e=n[2],o=n[3],i=Math.sin(a),c=Math.cos(a);return t[0]=r*c+u*i,t[1]=u*c-r*i,t[2]=e*c+o*i,t[3]=o*c-e*i,t}function Dt(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=Math.sqrt(a*a+r*r+u*u),i=Math.exp(e),c=o>0?i*Math.sin(o)/o:0;return t[0]=a*c,t[1]=r*c,t[2]=u*c,t[3]=i*Math.cos(o),t}function Ft(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=Math.sqrt(a*a+r*r+u*u),i=o>0?Math.atan2(o,e)/o:0;return t[0]=a*i,t[1]=r*i,t[2]=u*i,t[3]=.5*Math.log(a*a+r*r+u*u+e*e),t}function Lt(t,a,r,u){var e,o,i,c,h,s=a[0],M=a[1],f=a[2],l=a[3],v=r[0],b=r[1],m=r[2],d=r[3];return(o=s*v+M*b+f*m+l*d)<0&&(o=-o,v=-v,b=-b,m=-m,d=-d),1-o>n?(e=Math.acos(o),i=Math.sin(e),c=Math.sin((1-u)*e)/i,h=Math.sin(u*e)/i):(c=1-u,h=u),t[0]=c*s+h*v,t[1]=c*M+h*b,t[2]=c*f+h*m,t[3]=c*l+h*d,t}function Vt(t,n){var a,r=n[0]+n[4]+n[8];if(r>0)a=Math.sqrt(r+1),t[3]=.5*a,a=.5/a,t[0]=(n[5]-n[7])*a,t[1]=(n[6]-n[2])*a,t[2]=(n[1]-n[3])*a;else{var u=0;n[4]>n[0]&&(u=1),n[8]>n[3*u+u]&&(u=2);var e=(u+1)%3,o=(u+2)%3;a=Math.sqrt(n[3*u+u]-n[3*e+e]-n[3*o+o]+1),t[u]=.5*a,a=.5/a,t[3]=(n[3*e+o]-n[3*o+e])*a,t[e]=(n[3*e+u]+n[3*u+e])*a,t[o]=(n[3*o+u]+n[3*u+o])*a}return t}var Qt,Yt,Xt,Zt,_t,Bt,Nt=nt,kt=at,Ut=rt,Wt=ut,Ct=et,Gt=St,Ht=ht,Jt=bt,Kt=mt,$t=ft,tn=$t,nn=lt,an=nn,rn=vt,un=dt,en=xt,on=(Qt=O(),Yt=D(1,0,0),Xt=D(0,1,0),function(t,n,a){var r=_(n,a);return r<-.999999?(B(Qt,Yt,n),H(Qt)<1e-6&&B(Qt,Xt,n),Z(Qt,Qt),It(t,Qt,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(B(Qt,n,a),t[0]=Qt[0],t[1]=Qt[1],t[2]=Qt[2],t[3]=1+r,rn(t,t))}),cn=(Zt=jt(),_t=jt(),function(t,n,a,r,u,e){return Lt(Zt,n,u,e),Lt(_t,a,r,e),Lt(t,Zt,_t,2*e*(1-e)),t}),hn=(Bt=m(),function(t,n,a,r){return Bt[0]=a[0],Bt[3]=a[1],Bt[6]=a[2],Bt[1]=r[0],Bt[4]=r[1],Bt[7]=r[2],Bt[2]=-n[0],Bt[5]=-n[1],Bt[8]=-n[2],rn(t,Vt(t,Bt))}),sn=Object.freeze({create:jt,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:It,getAxisAngle:function(t,a){var r=2*Math.acos(a[3]),u=Math.sin(r/2);return u>n?(t[0]=a[0]/u,t[1]=a[1]/u,t[2]=a[2]/u):(t[0]=1,t[1]=0,t[2]=0),r},getAngle:function(t,n){var a=Jt(t,n);return Math.acos(2*a*a-1)},multiply:St,rotateX:Et,rotateY:Ot,rotateZ:Tt,calculateW:function(t,n){var a=n[0],r=n[1],u=n[2];return t[0]=a,t[1]=r,t[2]=u,t[3]=Math.sqrt(Math.abs(1-a*a-r*r-u*u)),t},exp:Dt,ln:Ft,pow:function(t,n,a){return Ft(t,n),Ht(t,t,a),Dt(t,t),t},slerp:Lt,random:function(t){var n=r(),a=r(),u=r(),e=Math.sqrt(1-n),o=Math.sqrt(n);return t[0]=e*Math.sin(2*Math.PI*a),t[1]=e*Math.cos(2*Math.PI*a),t[2]=o*Math.sin(2*Math.PI*u),t[3]=o*Math.cos(2*Math.PI*u),t},invert:function(t,n){var a=n[0],r=n[1],u=n[2],e=n[3],o=a*a+r*r+u*u+e*e,i=o?1/o:0;return t[0]=-a*i,t[1]=-r*i,t[2]=-u*i,t[3]=e*i,t},conjugate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t},fromMat3:Vt,fromEuler:function(t,n,a,r){var u=.5*Math.PI/180;n*=u,a*=u,r*=u;var e=Math.sin(n),o=Math.cos(n),i=Math.sin(a),c=Math.cos(a),h=Math.sin(r),s=Math.cos(r);return t[0]=e*c*s-o*i*h,t[1]=o*i*s+e*c*h,t[2]=o*c*h-e*i*s,t[3]=o*c*s+e*i*h,t},str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},clone:Nt,fromValues:kt,copy:Ut,set:Wt,add:Ct,mul:Gt,scale:Ht,dot:Jt,lerp:Kt,length:$t,len:tn,squaredLength:nn,sqrLen:an,normalize:rn,exactEquals:un,equals:en,rotationTo:on,sqlerp:cn,setAxes:hn});function Mn(t,n,a){var r=.5*a[0],u=.5*a[1],e=.5*a[2],o=n[0],i=n[1],c=n[2],h=n[3];return t[0]=o,t[1]=i,t[2]=c,t[3]=h,t[4]=r*h+u*c-e*i,t[5]=u*h+e*o-r*c,t[6]=e*h+r*i-u*o,t[7]=-r*o-u*i-e*c,t}function fn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}var ln=Ut;var vn=Ut;function bn(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[4],c=a[5],h=a[6],s=a[7],M=n[4],f=n[5],l=n[6],v=n[7],b=a[0],m=a[1],d=a[2],x=a[3];return t[0]=r*x+o*b+u*d-e*m,t[1]=u*x+o*m+e*b-r*d,t[2]=e*x+o*d+r*m-u*b,t[3]=o*x-r*b-u*m-e*d,t[4]=r*s+o*i+u*h-e*c+M*x+v*b+f*d-l*m,t[5]=u*s+o*c+e*i-r*h+f*x+v*m+l*b-M*d,t[6]=e*s+o*h+r*c-u*i+l*x+v*d+M*m-f*b,t[7]=o*s-r*i-u*c-e*h+v*x-M*b-f*m-l*d,t}var mn=bn;var dn=Jt;var xn=$t,pn=xn,yn=nn,qn=yn;var gn=Object.freeze({create:function(){var t=new a(8);return a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},clone:function(t){var n=new a(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n},fromValues:function(t,n,r,u,e,o,i,c){var h=new a(8);return h[0]=t,h[1]=n,h[2]=r,h[3]=u,h[4]=e,h[5]=o,h[6]=i,h[7]=c,h},fromRotationTranslationValues:function(t,n,r,u,e,o,i){var c=new a(8);c[0]=t,c[1]=n,c[2]=r,c[3]=u;var h=.5*e,s=.5*o,M=.5*i;return c[4]=h*u+s*r-M*n,c[5]=s*u+M*t-h*r,c[6]=M*u+h*n-s*t,c[7]=-h*t-s*n-M*r,c},fromRotationTranslation:Mn,fromTranslation:function(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t},fromRotation:function(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},fromMat4:function(t,n){var r=jt();P(r,n);var u=new a(3);return R(u,n),Mn(t,r,u),t},copy:fn,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},set:function(t,n,a,r,u,e,o,i,c){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=e,t[5]=o,t[6]=i,t[7]=c,t},getReal:ln,getDual:function(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t},setReal:vn,setDual:function(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t},getTranslation:function(t,n){var a=n[4],r=n[5],u=n[6],e=n[7],o=-n[0],i=-n[1],c=-n[2],h=n[3];return t[0]=2*(a*h+e*o+r*c-u*i),t[1]=2*(r*h+e*i+u*o-a*c),t[2]=2*(u*h+e*c+a*i-r*o),t},translate:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=.5*a[0],c=.5*a[1],h=.5*a[2],s=n[4],M=n[5],f=n[6],l=n[7];return t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=o*i+u*h-e*c+s,t[5]=o*c+e*i-r*h+M,t[6]=o*h+r*c-u*i+f,t[7]=-r*i-u*c-e*h+l,t},rotateX:function(t,n,a){var r=-n[0],u=-n[1],e=-n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=i*o+s*r+c*e-h*u,f=c*o+s*u+h*r-i*e,l=h*o+s*e+i*u-c*r,v=s*o-i*r-c*u-h*e;return Et(t,n,a),r=t[0],u=t[1],e=t[2],o=t[3],t[4]=M*o+v*r+f*e-l*u,t[5]=f*o+v*u+l*r-M*e,t[6]=l*o+v*e+M*u-f*r,t[7]=v*o-M*r-f*u-l*e,t},rotateY:function(t,n,a){var r=-n[0],u=-n[1],e=-n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=i*o+s*r+c*e-h*u,f=c*o+s*u+h*r-i*e,l=h*o+s*e+i*u-c*r,v=s*o-i*r-c*u-h*e;return Ot(t,n,a),r=t[0],u=t[1],e=t[2],o=t[3],t[4]=M*o+v*r+f*e-l*u,t[5]=f*o+v*u+l*r-M*e,t[6]=l*o+v*e+M*u-f*r,t[7]=v*o-M*r-f*u-l*e,t},rotateZ:function(t,n,a){var r=-n[0],u=-n[1],e=-n[2],o=n[3],i=n[4],c=n[5],h=n[6],s=n[7],M=i*o+s*r+c*e-h*u,f=c*o+s*u+h*r-i*e,l=h*o+s*e+i*u-c*r,v=s*o-i*r-c*u-h*e;return Tt(t,n,a),r=t[0],u=t[1],e=t[2],o=t[3],t[4]=M*o+v*r+f*e-l*u,t[5]=f*o+v*u+l*r-M*e,t[6]=l*o+v*e+M*u-f*r,t[7]=v*o-M*r-f*u-l*e,t},rotateByQuatAppend:function(t,n,a){var r=a[0],u=a[1],e=a[2],o=a[3],i=n[0],c=n[1],h=n[2],s=n[3];return t[0]=i*o+s*r+c*e-h*u,t[1]=c*o+s*u+h*r-i*e,t[2]=h*o+s*e+i*u-c*r,t[3]=s*o-i*r-c*u-h*e,i=n[4],c=n[5],h=n[6],s=n[7],t[4]=i*o+s*r+c*e-h*u,t[5]=c*o+s*u+h*r-i*e,t[6]=h*o+s*e+i*u-c*r,t[7]=s*o-i*r-c*u-h*e,t},rotateByQuatPrepend:function(t,n,a){var r=n[0],u=n[1],e=n[2],o=n[3],i=a[0],c=a[1],h=a[2],s=a[3];return t[0]=r*s+o*i+u*h-e*c,t[1]=u*s+o*c+e*i-r*h,t[2]=e*s+o*h+r*c-u*i,t[3]=o*s-r*i-u*c-e*h,i=a[4],c=a[5],h=a[6],s=a[7],t[4]=r*s+o*i+u*h-e*c,t[5]=u*s+o*c+e*i-r*h,t[6]=e*s+o*h+r*c-u*i,t[7]=o*s-r*i-u*c-e*h,t},rotateAroundAxis:function(t,a,r,u){if(Math.abs(u)<n)return fn(t,a);var e=Math.hypot(r[0],r[1],r[2]);u*=.5;var o=Math.sin(u),i=o*r[0]/e,c=o*r[1]/e,h=o*r[2]/e,s=Math.cos(u),M=a[0],f=a[1],l=a[2],v=a[3];t[0]=M*s+v*i+f*h-l*c,t[1]=f*s+v*c+l*i-M*h,t[2]=l*s+v*h+M*c-f*i,t[3]=v*s-M*i-f*c-l*h;var b=a[4],m=a[5],d=a[6],x=a[7];return t[4]=b*s+x*i+m*h-d*c,t[5]=m*s+x*c+d*i-b*h,t[6]=d*s+x*h+b*c-m*i,t[7]=x*s-b*i-m*c-d*h,t},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t[6]=n[6]+a[6],t[7]=n[7]+a[7],t},multiply:bn,mul:mn,scale:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=n[7]*a,t},dot:dn,lerp:function(t,n,a,r){var u=1-r;return dn(n,a)<0&&(r=-r),t[0]=n[0]*u+a[0]*r,t[1]=n[1]*u+a[1]*r,t[2]=n[2]*u+a[2]*r,t[3]=n[3]*u+a[3]*r,t[4]=n[4]*u+a[4]*r,t[5]=n[5]*u+a[5]*r,t[6]=n[6]*u+a[6]*r,t[7]=n[7]*u+a[7]*r,t},invert:function(t,n){var a=yn(n);return t[0]=-n[0]/a,t[1]=-n[1]/a,t[2]=-n[2]/a,t[3]=n[3]/a,t[4]=-n[4]/a,t[5]=-n[5]/a,t[6]=-n[6]/a,t[7]=n[7]/a,t},conjugate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t},length:xn,len:pn,squaredLength:yn,sqrLen:qn,normalize:function(t,n){var a=yn(n);if(a>0){a=Math.sqrt(a);var r=n[0]/a,u=n[1]/a,e=n[2]/a,o=n[3]/a,i=n[4],c=n[5],h=n[6],s=n[7],M=r*i+u*c+e*h+o*s;t[0]=r,t[1]=u,t[2]=e,t[3]=o,t[4]=(i-r*M)/a,t[5]=(c-u*M)/a,t[6]=(h-e*M)/a,t[7]=(s-o*M)/a}return t},str:function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]},equals:function(t,a){var r=t[0],u=t[1],e=t[2],o=t[3],i=t[4],c=t[5],h=t[6],s=t[7],M=a[0],f=a[1],l=a[2],v=a[3],b=a[4],m=a[5],d=a[6],x=a[7];return Math.abs(r-M)<=n*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(u-f)<=n*Math.max(1,Math.abs(u),Math.abs(f))&&Math.abs(e-l)<=n*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(o-v)<=n*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-b)<=n*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(c-m)<=n*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(h-d)<=n*Math.max(1,Math.abs(h),Math.abs(d))&&Math.abs(s-x)<=n*Math.max(1,Math.abs(s),Math.abs(x))}});function An(){var t=new a(2);return a!=Float32Array&&(t[0]=0,t[1]=0),t}function wn(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t}function Rn(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t}function zn(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t}function Pn(t,n){var a=n[0]-t[0],r=n[1]-t[1];return Math.hypot(a,r)}function jn(t,n){var a=n[0]-t[0],r=n[1]-t[1];return a*a+r*r}function In(t){var n=t[0],a=t[1];return Math.hypot(n,a)}function Sn(t){var n=t[0],a=t[1];return n*n+a*a}var En=In,On=wn,Tn=Rn,Dn=zn,Fn=Pn,Ln=jn,Vn=Sn,Qn=function(){var t=An();return function(n,a,r,u,e,o){var i,c;for(a||(a=2),r||(r=0),c=u?Math.min(u*a+r,n.length):n.length,i=r;i<c;i+=a)t[0]=n[i],t[1]=n[i+1],e(t,t,o),n[i]=t[0],n[i+1]=t[1];return n}}(),Yn=Object.freeze({create:An,clone:function(t){var n=new a(2);return n[0]=t[0],n[1]=t[1],n},fromValues:function(t,n){var r=new a(2);return r[0]=t,r[1]=n,r},copy:function(t,n){return t[0]=n[0],t[1]=n[1],t},set:function(t,n,a){return t[0]=n,t[1]=a,t},add:function(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t},subtract:wn,multiply:Rn,divide:zn,ceil:function(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t},floor:function(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t},min:function(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t},max:function(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t},round:function(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t},scale:function(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t},scaleAndAdd:function(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t},distance:Pn,squaredDistance:jn,length:In,squaredLength:Sn,negate:function(t,n){return t[0]=-n[0],t[1]=-n[1],t},inverse:function(t,n){return t[0]=1/n[0],t[1]=1/n[1],t},normalize:function(t,n){var a=n[0],r=n[1],u=a*a+r*r;return u>0&&(u=1/Math.sqrt(u)),t[0]=n[0]*u,t[1]=n[1]*u,t},dot:function(t,n){return t[0]*n[0]+t[1]*n[1]},cross:function(t,n,a){var r=n[0]*a[1]-n[1]*a[0];return t[0]=t[1]=0,t[2]=r,t},lerp:function(t,n,a,r){var u=n[0],e=n[1];return t[0]=u+r*(a[0]-u),t[1]=e+r*(a[1]-e),t},random:function(t,n){n=n||1;var a=2*r()*Math.PI;return t[0]=Math.cos(a)*n,t[1]=Math.sin(a)*n,t},transformMat2:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[2]*u,t[1]=a[1]*r+a[3]*u,t},transformMat2d:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[2]*u+a[4],t[1]=a[1]*r+a[3]*u+a[5],t},transformMat3:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[3]*u+a[6],t[1]=a[1]*r+a[4]*u+a[7],t},transformMat4:function(t,n,a){var r=n[0],u=n[1];return t[0]=a[0]*r+a[4]*u+a[12],t[1]=a[1]*r+a[5]*u+a[13],t},rotate:function(t,n,a,r){var u=n[0]-a[0],e=n[1]-a[1],o=Math.sin(r),i=Math.cos(r);return t[0]=u*i-e*o+a[0],t[1]=u*o+e*i+a[1],t},angle:function(t,n){var a=t[0],r=t[1],u=n[0],e=n[1],o=a*a+r*r;o>0&&(o=1/Math.sqrt(o));var i=u*u+e*e;i>0&&(i=1/Math.sqrt(i));var c=(a*u+r*e)*o*i;return c>1?0:c<-1?Math.PI:Math.acos(c)},zero:function(t){return t[0]=0,t[1]=0,t},str:function(t){return"vec2("+t[0]+", "+t[1]+")"},exactEquals:function(t,n){return t[0]===n[0]&&t[1]===n[1]},equals:function(t,a){var r=t[0],u=t[1],e=a[0],o=a[1];return Math.abs(r-e)<=n*Math.max(1,Math.abs(r),Math.abs(e))&&Math.abs(u-o)<=n*Math.max(1,Math.abs(u),Math.abs(o))},len:En,sub:On,mul:Tn,div:Dn,dist:Fn,sqrDist:Ln,sqrLen:Vn,forEach:Qn});t.glMatrix=e,t.mat2=s,t.mat2d=b,t.mat3=q,t.mat4=E,t.quat=sn,t.quat2=gn,t.vec2=Yn,t.vec3=$,t.vec4=Pt,Object.defineProperty(t,"__esModule",{value:!0})});

// ["glMatrix", "mat2", "mat2d", "mat3", "mat4", "quat", "quat2", "vec2", "vec3", "vec4"]
window.glMatrix = glMatrix;
window.mat2 = glMatrix.mat2;
window.mat2d = glMatrix.mat2d;
window.mat3 = glMatrix.mat3;
window.mat4 = glMatrix.mat4;
window.quat = glMatrix.quat;
window.quat2 = glMatrix.quat2;
window.vec2 = glMatrix.vec2;
window.vec3 = glMatrix.vec3;
window.vec4 = glMatrix.vec4;



var CABLES = CABLES || {}; CABLES.build = {"timestamp":1699471251547,"created":"2023-11-08T19:20:51.547Z","git":{"branch":"master","commit":"d5b28c0364c69c8b6a64544e0c98648cd2502b58","date":"2023-11-08T11:39:20.000Z","message":"Hotfix patchcolors"}};
if(!CABLES.exportedPatches)CABLES.exportedPatches={};CABLES.exportedPatches["fZqwLK"]={ops:[{id:"bf23a3d0-7c18-4237-8941-03c8cd47e494",uiAttribs:{},portsIn:[{name:"FPS Limit",value:60},{name:"Reduce FPS not focussed",value:true},{name:"Reduce FPS loading",value:false},{name:"Clear",value:true},{name:"ClearAlpha",value:true},{name:"Fullscreen Button",value:false},{name:"Active",value:true},{name:"Hires Displays",value:false},{name:"Pixel Unit index",value:0},{name:"Pixel Unit",value:"Display"}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"e2dd6138-a9ca-4fa6-af86-26f7007908d5",objOut:"bf23a3d0-7c18-4237-8941-03c8cd47e494"},{portIn:"exe",portOut:"trigger",objIn:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a",objOut:"bf23a3d0-7c18-4237-8941-03c8cd47e494"}]},{name:"width",links:[{portIn:"Value",portOut:"width",objIn:"e859c162-4e16-4f3f-bce5-e7932c802b7f",objOut:"bf23a3d0-7c18-4237-8941-03c8cd47e494"}]},{name:"height",links:[{portIn:"Value",portOut:"height",objIn:"529fc5cd-68b0-4b0c-819f-2e2439a10ad6",objOut:"bf23a3d0-7c18-4237-8941-03c8cd47e494"}]}],objName:"Ops.Gl.MainLoop"},{id:"db708672-1389-4d99-85be-009662e34fbf",uiAttribs:{},portsOut:[{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"7a3ce484-a0ad-41cb-9a59-9845bca7ab74",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 6",links:[{portIn:"render",portOut:"trigger 6",objIn:"f5f3a926-b087-46da-929a-5a4af111a60c",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 7",links:[{portIn:"Render",portOut:"trigger 7",objIn:"d2e0bbce-2969-4956-afd3-c2883932d30d",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 8",links:[{portIn:"Render",portOut:"trigger 8",objIn:"654ea0b9-d0c4-413e-8211-37db694e21f3",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 9",links:[{portIn:"Render",portOut:"trigger 9",objIn:"01b15a97-e8cb-465a-9dd0-228c90de109a",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 10",links:[{portIn:"Render",portOut:"trigger 10",objIn:"6a501dff-55db-40f8-90d6-892c53c1750b",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 11",links:[{portIn:"render",portOut:"trigger 11",objIn:"86579980-c684-46e6-a975-005b0108a751",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 13",links:[{portIn:"Render",portOut:"trigger 13",objIn:"ccdc60e1-bb69-4d11-9f37-d6b94b396831",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 14",links:[{portIn:"Render",portOut:"trigger 14",objIn:"f2342897-e012-4929-b5d2-62ffacd4f78c",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]},{name:"trigger 15",links:[{portIn:"render",portOut:"trigger 15",objIn:"f2de87f6-2683-4c85-984b-f1c0ad256056",objOut:"db708672-1389-4d99-85be-009662e34fbf"}]}],objName:"Ops.Trigger.Sequence"},{id:"f2de87f6-2683-4c85-984b-f1c0ad256056",uiAttribs:{},portsIn:[{name:"Scale index",value:0},{name:"Scale",value:"Stretch"},{name:"Flip Y",value:false},{name:"Flip X",value:false}],objName:"Ops.Gl.Meshes.FullscreenRectangle"},{id:"9970dcdb-e9de-4258-9ef2-8f93933830ea",uiAttribs:{},portsIn:[{name:"title",value:"Hex"},{name:"text",value:".5 .6 - .7 - .3333\n\n.866\n\n\n1: 1.1547005.\n\n10x 5y is the player center\n\n\nFor mult .19\n.22*.866 = 0.19052  is the Y perfect movement\n.38/2 = .19 is the perfect X movement\n\n\nscale sep mult .42\nscale hex .53"}],objName:"Ops.Ui.Comment_v2"},{id:"ccdc60e1-bb69-4d11-9f37-d6b94b396831",uiAttribs:{},portsIn:[{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"4b8ade56-bbbe-4a0e-882c-d01137795609",objOut:"ccdc60e1-bb69-4d11-9f37-d6b94b396831"}]},{name:"texture_out",links:[{portIn:"Texture 1",portOut:"texture_out",objIn:"5672d089-99d0-49c9-97cf-43a0455c1a46",objOut:"ccdc60e1-bb69-4d11-9f37-d6b94b396831"}]},{name:"Aspect Ratio",value:1.8635346756152125}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"f2342897-e012-4929-b5d2-62ffacd4f78c",uiAttribs:{},portsIn:[{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"5672d089-99d0-49c9-97cf-43a0455c1a46",objOut:"f2342897-e012-4929-b5d2-62ffacd4f78c"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"f2de87f6-2683-4c85-984b-f1c0ad256056",objOut:"f2342897-e012-4929-b5d2-62ffacd4f78c"}]},{name:"Aspect Ratio",value:1.8635346756152125}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"5672d089-99d0-49c9-97cf-43a0455c1a46",uiAttribs:{},portsIn:[{name:"Mask Invert",value:false},{name:"Blendmode 1 index",value:0},{name:"Blendmode 1",value:"normal"},{name:"Mask Source 1 index",value:0},{name:"Mask Source 1",value:"R"},{name:"Opacity 1 index",value:0},{name:"Opacity 1",value:"Normal"},{name:"Amount 1",value:1},{name:"Blendmode 2 index",value:0},{name:"Blendmode 2",value:"normal"},{name:"Mask Source 2 index",value:0},{name:"Mask Source 2",value:"R"},{name:"Opacity 2 index",value:0},{name:"Opacity 2",value:"Normal"},{name:"Amount 2",value:1},{name:"Blendmode 3 index",value:0},{name:"Blendmode 3",value:"normal"},{name:"Mask Source 3 index",value:0},{name:"Mask Source 3",value:"R"},{name:"Opacity 3 index",value:0},{name:"Opacity 3",value:"Normal"},{name:"Amount 3",value:1},{name:"Blendmode 4 index",value:0},{name:"Blendmode 4",value:"normal"},{name:"Mask Source 4 index",value:0},{name:"Mask Source 4",value:"R"},{name:"Opacity 4 index",value:0},{name:"Opacity 4",value:"Normal"},{name:"Amount 4",value:1},{name:"Blendmode 5 index",value:0},{name:"Blendmode 5",value:"normal"},{name:"Mask Source 5 index",value:0},{name:"Mask Source 5",value:"R"},{name:"Opacity 5 index",value:0},{name:"Opacity 5",value:"Normal"},{name:"Amount 5",value:1},{name:"Blendmode 6 index",value:0},{name:"Blendmode 6",value:"normal"},{name:"Mask Source 6 index",value:0},{name:"Mask Source 6",value:"R"},{name:"Opacity 6 index",value:0},{name:"Opacity 6",value:"Normal"},{name:"Amount 6",value:1},{name:"Blendmode 7 index",value:0},{name:"Blendmode 7",value:"normal"},{name:"Mask Source 7 index",value:0},{name:"Mask Source 7",value:"R"},{name:"Opacity 7 index",value:0},{name:"Opacity 7",value:"Normal"},{name:"Amount 7",value:1},{name:"Blendmode 8 index",value:0},{name:"Blendmode 8",value:"normal"},{name:"Mask Source 8 index",value:0},{name:"Mask Source 8",value:"R"},{name:"Opacity 8 index",value:0},{name:"Opacity 8",value:"Normal"},{name:"Amount 8",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"43432dc4-d352-490e-90d8-971ee1da7eb4",objOut:"5672d089-99d0-49c9-97cf-43a0455c1a46"}]}],objName:"Ops.Gl.TextureEffects.MultiDrawImage"},{id:"58324b62-275b-448c-b182-6e11aa5446ec",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsOut:[{name:"create port",value:0}],objName:"Ops.Ui.PatchInput"},{id:"146c5304-c27f-40dc-a608-cd88d7e8b2fc",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"create port",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"ac8812c0-1d07-49b3-8708-70c39a4b082a",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:0},{name:"patchId",value:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"}],portsOut:[{name:"create port out",value:0}],objName:"Ops.Ui.SubPatch"},{id:"3e148d35-7e00-48f0-b75e-36f8d8c9f2d0",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"number2",value:.017}],portsOut:[{name:"result",value:0}],objName:"Ops.Math.Multiply"},{id:"1a4c62bd-8329-46bd-b6f0-dc722bd29396",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"number2",value:-.34}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"9c838691-941c-4af9-98c1-d3469e2ae19f",objOut:"1a4c62bd-8329-46bd-b6f0-dc722bd29396"}]}],objName:"Ops.Math.Multiply"},{id:"abaec7e0-8a17-4b14-8fce-0d7340793aeb",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Base",value:0},{name:"Exponent",value:4}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"1a4c62bd-8329-46bd-b6f0-dc722bd29396",objOut:"abaec7e0-8a17-4b14-8fce-0d7340793aeb"}]}],objName:"Ops.Math.Pow"},{id:"9c838691-941c-4af9-98c1-d3469e2ae19f",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsOut:[{name:"result",value:0}],objName:"Ops.Math.Sum"},{id:"e1c88a76-527d-46a1-85a8-46e0a81fcc76",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Speed",value:1},{name:"Play",value:false},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"number1",portOut:"Time",objIn:"6937d2c7-0325-496a-ab19-d733604a84f8",objOut:"e1c88a76-527d-46a1-85a8-46e0a81fcc76"}]}],objName:"Ops.Anim.Timer_v2"},{id:"6937d2c7-0325-496a-ab19-d733604a84f8",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"number2",value:100}],portsOut:[{name:"result",links:[{portIn:"number2",portOut:"result",objIn:"9c838691-941c-4af9-98c1-d3469e2ae19f",objOut:"6937d2c7-0325-496a-ab19-d733604a84f8"}]}],objName:"Ops.Math.Multiply"},{id:"a6bed536-b16b-45f2-8cf3-287d49a8413b",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Base",value:0},{name:"Exponent",value:4.61}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"3e148d35-7e00-48f0-b75e-36f8d8c9f2d0",objOut:"a6bed536-b16b-45f2-8cf3-287d49a8413b"}]}],objName:"Ops.Math.Pow"},{id:"0fa7c5c4-18e4-4ea9-8f95-c70888f6401a",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"number1",value:1},{name:"number2",value:2}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"aee2614a-0d2e-4ab8-ad64-44f8adeac4cb",objOut:"0fa7c5c4-18e4-4ea9-8f95-c70888f6401a"}]}],objName:"Ops.Math.Multiply"},{id:"aee2614a-0d2e-4ab8-ad64-44f8adeac4cb",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"number2",value:0}],portsOut:[{name:"result",value:0}],objName:"Ops.Math.Multiply"},{id:"2d641bfe-93e3-4791-972b-a7ed0db229e5",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"r",value:.684},{name:"g",value:.766},{name:"b",value:1},{name:"a",value:1},{name:"colorizeTexture",value:false},{name:"Vertex Colors",value:false},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:false},{name:"Discard Transparent Pixels",value:false},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:false},{name:"billboard",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"a635c75b-39ec-4315-bb9d-9bfaabe0ca07",objOut:"2d641bfe-93e3-4791-972b-a7ed0db229e5"}]}],objName:"Ops.Gl.Shader.BasicMaterial_v3"},{id:"a635c75b-39ec-4315-bb9d-9bfaabe0ca07",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"innerRadius",value:0},{name:"segments",value:6},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true}],objName:"Ops.Gl.Meshes.Circle"},{id:"ac576296-603e-4711-a964-bb4ed292db7f",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"number1",value:1},{name:"number2",value:.53}],portsOut:[{name:"result",links:[{portIn:"radius",portOut:"result",objIn:"a635c75b-39ec-4315-bb9d-9bfaabe0ca07",objOut:"ac576296-603e-4711-a964-bb4ed292db7f"}]}],objName:"Ops.Math.Multiply"},{id:"e07339b2-fafa-4c41-8079-cbfd873e426f",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Scale",value:-.2},{name:"Blendmode index",value:0},{name:"Blendmode",value:"Mul"},{name:"Target index",value:0},{name:"Target",value:"Color"},{name:"Amount",value:.99},{name:"Use Texture Alpha",value:false},{name:"Pos X",value:0},{name:"Pos Y",value:0},{name:"Rot X",value:0},{name:"Rot Y",value:0},{name:"Rot Z",value:210},{name:"Mapping index",value:1},{name:"Mapping",value:"XY"},{name:"Discard",value:false},{name:"WorldSpace",value:false}],objName:"Ops.Gl.ShaderEffects.TextureProjection"},{id:"6a0b5049-e78b-40f6-a4dc-b9ab37326ab8",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:3},{name:"Radius",value:8},{name:"X",value:2.3},{name:"Y",value:-1},{name:"Z",value:4},{name:"R",value:1},{name:"G",value:.4706050793916745},{name:"B",value:.4706050793916745},{name:"Specular R",value:1},{name:"Specular G",value:.9505140565068344},{name:"Specular B",value:.9393554678463261},{name:"Falloff",value:.5},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"World Position X",value:-.2550000250339508},{name:"World Position Y",value:-1.0458701848983765},{name:"World Position Z",value:2.4156718254089355}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"0f897314-556d-487a-b395-0e9e84580184",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:2},{name:"Radius",value:10},{name:"X",value:2.5},{name:"Y",value:4},{name:"Z",value:3},{name:"R",value:1},{name:"G",value:.3294117647058824},{name:"B",value:.4313411779894557},{name:"Specular R",value:.38905428973133677},{name:"Specular G",value:.685894847713983},{name:"Specular B",value:.707999995648861},{name:"Falloff",value:.2},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"6a0b5049-e78b-40f6-a4dc-b9ab37326ab8",objOut:"0f897314-556d-487a-b395-0e9e84580184"}]},{name:"World Position X",value:-.08499997854232788},{name:"World Position Y",value:2.657106399536133},{name:"World Position Z",value:.16334760189056396}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"373d5f5e-cd2a-4f3d-a192-f2c2e6af33f0",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"R",value:.4881770770562192},{name:"G",value:.5342266673642708},{name:"B",value:.6866666619976362},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:1},{name:"Roughness",value:.3},{name:"Active",value:false},{name:"Fresnel Intensity",value:0},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.122},{name:"Emissive R",value:.3058823529411765},{name:"Emissive G",value:.7607843137254902},{name:"Emissive B",value:.7171137045037511},{name:"Shininess",value:3},{name:"Specular Amount",value:1},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.5},{name:"AO Intensity",value:1},{name:"AO UV Channel index",value:0},{name:"AO UV Channel",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"render",portOut:"Trigger Out",objIn:"e07339b2-fafa-4c41-8079-cbfd873e426f",objOut:"373d5f5e-cd2a-4f3d-a192-f2c2e6af33f0"}]}],objName:"Ops.Gl.Phong.PhongMaterial_v6"},{id:"d3483801-1189-4990-b1e1-c967ed91f959",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.MainLoop trigger",links:[{portIn:"Trigger",portOut:"in0 Ops.Gl.MainLoop trigger",objIn:"dcecdf55-44b4-4f03-849e-bb92f7638e10",objOut:"d3483801-1189-4990-b1e1-c967ed91f959"}]}],objName:"Ops.Ui.PatchInput"},{id:"25335596-56a8-47ca-bb63-91bcd4c2711a",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"create port",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"f3da69b2-addb-4ac4-8c60-7ead11d6e59b",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.MainLoop trigger","type":1}],"portsOut":[]}'},{name:"patchId",value:"53fe52bf-7e14-4395-8540-8fd6933a628b"}],portsOut:[{name:"create port out",value:0}],objName:"Ops.Ui.SubPatch"},{id:"6a82ca0a-c96c-40dd-88b1-9f5cb14a171e",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"newBauplan loop"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"128b8dfa-354b-48a7-8be1-9875cf7bf795",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Speed",value:1},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Value",portOut:"Time",objIn:"6a82ca0a-c96c-40dd-88b1-9f5cb14a171e",objOut:"128b8dfa-354b-48a7-8be1-9875cf7bf795"}]}],objName:"Ops.Anim.Timer_v2"},{id:"c27f0cf9-4973-4ebe-9115-cb8d34b576e1",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"metaBlur"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"75e3d5c6-f9b8-455b-b941-daa18d31eadf",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:.25}],portsOut:[{name:"result",value:.25}],objName:"Ops.Value.Number"},{id:"7050cfa7-138d-4bec-8d82-23240e462d36",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"complexityA"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"3efe4e47-c887-4626-802b-0afda4b384dd",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:4.58}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"6c1659b5-1032-47d9-93d2-b302cc4d14fd",objOut:"3efe4e47-c887-4626-802b-0afda4b384dd"}]}],objName:"Ops.Value.Number"},{id:"6c1659b5-1032-47d9-93d2-b302cc4d14fd",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"ed6b33b7-110b-4953-b65a-6eb778e7297b",objOut:"6c1659b5-1032-47d9-93d2-b302cc4d14fd"}]}],objName:"Ops.Math.Ceil"},{id:"1551b30a-2fcb-4b76-b013-fc57515661e0",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"complexityB"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"2363603e-0184-4f78-85f3-337d952149c0",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:6.97}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"33b86dae-69cb-48fc-a017-daac47bf84d8",objOut:"2363603e-0184-4f78-85f3-337d952149c0"}]}],objName:"Ops.Value.Number"},{id:"33b86dae-69cb-48fc-a017-daac47bf84d8",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"13bef098-fc08-445b-8466-8cde9e935093",objOut:"33b86dae-69cb-48fc-a017-daac47bf84d8"}]}],objName:"Ops.Math.Ceil"},{id:"5035350a-7ce3-42a3-a837-fbbe559bb222",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"complexityC"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"07c5a2fb-76e1-4fae-b7fa-97bd33ccdb9c",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:3.45}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"917d0039-c34d-4a64-a39e-d14cf5cb21eb",objOut:"07c5a2fb-76e1-4fae-b7fa-97bd33ccdb9c"}]}],objName:"Ops.Value.Number"},{id:"917d0039-c34d-4a64-a39e-d14cf5cb21eb",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"65a2aedc-adc5-405b-8270-0f2c09817634",objOut:"917d0039-c34d-4a64-a39e-d14cf5cb21eb"}]}],objName:"Ops.Math.Ceil"},{id:"13bef098-fc08-445b-8466-8cde9e935093",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"1551b30a-2fcb-4b76-b013-fc57515661e0",objOut:"13bef098-fc08-445b-8466-8cde9e935093"}]}],objName:"Ops.Ui.VizNumber"},{id:"65a2aedc-adc5-405b-8270-0f2c09817634",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"5035350a-7ce3-42a3-a837-fbbe559bb222",objOut:"65a2aedc-adc5-405b-8270-0f2c09817634"}]}],objName:"Ops.Ui.VizNumber"},{id:"3d37e8d9-dc5a-4cd7-b704-27f94c0dd3e9",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"c27f0cf9-4973-4ebe-9115-cb8d34b576e1",objOut:"3d37e8d9-dc5a-4cd7-b704-27f94c0dd3e9"}]}],objName:"Ops.Ui.VizNumber"},{id:"ed6b33b7-110b-4953-b65a-6eb778e7297b",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"7050cfa7-138d-4bec-8d82-23240e462d36",objOut:"ed6b33b7-110b-4953-b65a-6eb778e7297b"}]}],objName:"Ops.Ui.VizNumber"},{id:"1d2602f9-f8b6-44d6-ab20-0e437a6c314a",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"bauScale"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"de929351-b9b8-4a58-9a1f-10f4f634990b",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:1.8}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"4d106a9c-3827-4e53-9d77-28c447bb489e",objOut:"de929351-b9b8-4a58-9a1f-10f4f634990b"}]}],objName:"Ops.Value.Number"},{id:"79c30e88-bd8f-43ef-b4c2-c6c25b66da1e",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"1d2602f9-f8b6-44d6-ab20-0e437a6c314a",objOut:"79c30e88-bd8f-43ef-b4c2-c6c25b66da1e"}]}],objName:"Ops.Ui.VizNumber"},{id:"4d106a9c-3827-4e53-9d77-28c447bb489e",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"number2",value:.1}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"79c30e88-bd8f-43ef-b4c2-c6c25b66da1e",objOut:"4d106a9c-3827-4e53-9d77-28c447bb489e"}]}],objName:"Ops.Math.Multiply"},{id:"c8419e6c-05c4-4016-bbd8-77ba84b9c7e5",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"5aef50d2-310c-4d8a-acf4-47bbe7973335",objOut:"c8419e6c-05c4-4016-bbd8-77ba84b9c7e5"}]}],objName:"Ops.Ui.VizNumber"},{id:"5aef50d2-310c-4d8a-acf4-47bbe7973335",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"boneWeight"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8bf14b2c-4193-4843-9364-1530b3e734ef",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:0}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"4e05fbbd-d8fe-47d3-8757-334f6964a714",objOut:"8bf14b2c-4193-4843-9364-1530b3e734ef"}]}],objName:"Ops.Value.Number"},{id:"f3ac3130-444b-41c2-834a-4a5b3aa265a7",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"7495d012-fde0-4393-9b45-ef3c33a93922",objOut:"f3ac3130-444b-41c2-834a-4a5b3aa265a7"}]}],objName:"Ops.Ui.VizNumber"},{id:"7495d012-fde0-4393-9b45-ef3c33a93922",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"jointWeight"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"4e05fbbd-d8fe-47d3-8757-334f6964a714",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"number2",value:.1}],portsOut:[{name:"result",links:[{portIn:"number",portOut:"result",objIn:"f0904779-ab45-44c6-bd0e-c32022135071",objOut:"4e05fbbd-d8fe-47d3-8757-334f6964a714"}]}],objName:"Ops.Math.Multiply"},{id:"f0904779-ab45-44c6-bd0e-c32022135071",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"f3ac3130-444b-41c2-834a-4a5b3aa265a7",objOut:"f0904779-ab45-44c6-bd0e-c32022135071"}]}],objName:"Ops.Math.Abs"},{id:"67af66b5-4c7a-4562-aec6-ac9d95cb50f8",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"33ed37b0-2985-440a-a00a-951bc0e22ecd",objOut:"67af66b5-4c7a-4562-aec6-ac9d95cb50f8"}]}],objName:"Ops.Ui.VizNumber"},{id:"33ed37b0-2985-440a-a00a-951bc0e22ecd",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"randomSeed"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"2747a45a-7f24-4869-ab85-556a08c86d57",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"67af66b5-4c7a-4562-aec6-ac9d95cb50f8",objOut:"2747a45a-7f24-4869-ab85-556a08c86d57"}]}],objName:"Ops.Math.Ceil"},{id:"96c7dfe7-5195-4eda-a1fa-a8045302465d",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"distortionVal"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8ad1e471-2380-426e-8881-c48f912ec31a",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"96c7dfe7-5195-4eda-a1fa-a8045302465d",objOut:"8ad1e471-2380-426e-8881-c48f912ec31a"}]}],objName:"Ops.Ui.VizNumber"},{id:"5a8af961-1591-46a2-a373-c617ce03091b",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"angleIN"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"2906cde8-3499-4608-8bf2-9577ee3f8f75",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"5a8af961-1591-46a2-a373-c617ce03091b",objOut:"2906cde8-3499-4608-8bf2-9577ee3f8f75"}]}],objName:"Ops.Ui.VizNumber"},{id:"8255e581-8e22-412b-abf6-08142ff50d33",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:-3}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"2906cde8-3499-4608-8bf2-9577ee3f8f75",objOut:"8255e581-8e22-412b-abf6-08142ff50d33"}]}],objName:"Ops.Value.Number"},{id:"b4ffc138-8a63-46d0-9431-76513fcc7130",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"cf895d4d-daef-4e89-be4c-ead079475894",objOut:"b4ffc138-8a63-46d0-9431-76513fcc7130"}]}],objName:"Ops.Ui.VizNumber"},{id:"6816612a-5e95-4adf-8486-cb0e4c6a418a",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:0}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"57c6a49e-42ca-4bf9-af10-33d7fba7f10c",objOut:"6816612a-5e95-4adf-8486-cb0e4c6a418a"}]}],objName:"Ops.Value.Number"},{id:"57c6a49e-42ca-4bf9-af10-33d7fba7f10c",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"number2",value:.1}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"b4ffc138-8a63-46d0-9431-76513fcc7130",objOut:"57c6a49e-42ca-4bf9-af10-33d7fba7f10c"}]}],objName:"Ops.Math.Multiply"},{id:"77c47a60-7672-41a7-b0c9-7a3a1d282c77",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"contraction"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"58093a7b-61b4-4d29-868d-64242059207e",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"77c47a60-7672-41a7-b0c9-7a3a1d282c77",objOut:"58093a7b-61b4-4d29-868d-64242059207e"}]}],objName:"Ops.Ui.VizNumber"},{id:"10f5fb21-a78a-4c2a-9f73-408a1f88561c",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"jointY"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"20358222-e9f6-4b8c-9f4a-c24f82d92b0e",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"10f5fb21-a78a-4c2a-9f73-408a1f88561c",objOut:"20358222-e9f6-4b8c-9f4a-c24f82d92b0e"}]}],objName:"Ops.Ui.VizNumber"},{id:"f547a0ec-1869-4712-a956-c24a69e55a62",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:0}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"f7bad846-d341-4c1b-b8b2-63b4b9397f62",objOut:"f547a0ec-1869-4712-a956-c24a69e55a62"}]}],objName:"Ops.Value.Number"},{id:"f7bad846-d341-4c1b-b8b2-63b4b9397f62",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"number2",value:.1}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"20358222-e9f6-4b8c-9f4a-c24f82d92b0e",objOut:"f7bad846-d341-4c1b-b8b2-63b4b9397f62"}]}],objName:"Ops.Math.Multiply"},{id:"cf895d4d-daef-4e89-be4c-ead079475894",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"jointX"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8abc0a9d-048f-496b-89ab-53a59c6862b6",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"rotateEach"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"cb896123-4540-4284-9117-85e5fb0c3be8",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"8abc0a9d-048f-496b-89ab-53a59c6862b6",objOut:"cb896123-4540-4284-9117-85e5fb0c3be8"}]}],objName:"Ops.Ui.VizNumber"},{id:"d4e9a90e-5773-45ab-9123-a488fb04066d",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"distortionVal2"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"191697c4-61eb-48ed-9e39-bfbd3880a712",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"d4e9a90e-5773-45ab-9123-a488fb04066d",objOut:"191697c4-61eb-48ed-9e39-bfbd3880a712"}]}],objName:"Ops.Ui.VizNumber"},{id:"5f0da96f-60de-4c41-bac8-2f76d5f1958b",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"number2",value:3}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"191697c4-61eb-48ed-9e39-bfbd3880a712",objOut:"5f0da96f-60de-4c41-bac8-2f76d5f1958b"}]}],objName:"Ops.Math.Multiply"},{id:"d8a657ff-aaca-4be2-834a-5b1e3aa4e483",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"jitterSpeed"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8fa8f2f3-2230-43a4-b317-e0e71b33e42b",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"d8a657ff-aaca-4be2-834a-5b1e3aa4e483",objOut:"8fa8f2f3-2230-43a4-b317-e0e71b33e42b"}]}],objName:"Ops.Ui.VizNumber"},{id:"f75fc98a-42b7-44ee-a559-abd26a6e976b",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:2}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"8fa8f2f3-2230-43a4-b317-e0e71b33e42b",objOut:"f75fc98a-42b7-44ee-a559-abd26a6e976b"}]}],objName:"Ops.Value.Number"},{id:"8b920dff-4c2b-4ac4-8617-414e61613969",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"jitterIN"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"85429d35-749e-4f44-acad-9c73e1ce0853",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"8b920dff-4c2b-4ac4-8617-414e61613969",objOut:"85429d35-749e-4f44-acad-9c73e1ce0853"}]}],objName:"Ops.Ui.VizNumber"},{id:"10b2b40f-8006-42a9-9ad4-94d67365245e",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:2.5}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"85429d35-749e-4f44-acad-9c73e1ce0853",objOut:"10b2b40f-8006-42a9-9ad4-94d67365245e"}]}],objName:"Ops.Value.Number"},{id:"053b2319-9e61-499d-8092-8c22b1ad9427",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"isBreathing"}],portsOut:[{name:"Value",links:[{portIn:"bool",portOut:"Value",objIn:"001d9787-923b-431b-99a9-d6695178dcce",objOut:"053b2319-9e61-499d-8092-8c22b1ad9427"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"001d9787-923b-431b-99a9-d6695178dcce",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsOut:[{name:"number",links:[{portIn:"Index",portOut:"number",objIn:"66067155-9955-40d1-8d30-ee87b73a76a8",objOut:"001d9787-923b-431b-99a9-d6695178dcce"}]}],objName:"Ops.Boolean.BoolToNumber"},{id:"66067155-9955-40d1-8d30-ee87b73a76a8",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Value 0",value:0},{name:"Value 1",value:1.12},{name:"Value 2",value:0},{name:"Value 3",value:0},{name:"Value 4",value:0},{name:"Value 5",value:0},{name:"Value 6",value:0},{name:"Value 7",value:0},{name:"Value 8",value:0},{name:"Value 9",value:0},{name:"Value 10",value:0},{name:"Value 11",value:0},{name:"Value 12",value:0},{name:"Value 13",value:0},{name:"Value 14",value:0},{name:"Value 15",value:0}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"15de049b-bb87-4281-89f1-9a7149a3d59a",objOut:"66067155-9955-40d1-8d30-ee87b73a76a8"}]}],objName:"Ops.Value.SwitchNumber"},{id:"15de049b-bb87-4281-89f1-9a7149a3d59a",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"duration",value:2},{name:"easing index",value:0},{name:"easing",value:"Cubic In Out"}],portsOut:[{name:"result",value:1.12}],objName:"Ops.Anim.AnimNumber"},{id:"dcecdf55-44b4-4f03-849e-bb92f7638e10",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],objName:"Ops.Trigger.TriggerSend"},{id:"a8a35813-847e-43bc-bdd0-1efdf99b0d32",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"15de049b-bb87-4281-89f1-9a7149a3d59a",objOut:"a8a35813-847e-43bc-bdd0-1efdf99b0d32"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"35054a31-8c7e-4f8b-95ee-9e4be662f602",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"old min",value:5},{name:"old max",value:.5},{name:"new min",value:.8},{name:"new max",value:1.3},{name:"Easing index",value:0},{name:"Easing",value:"Smoothstep"}],portsOut:[{name:"result",value:.8}],objName:"Ops.Math.MapRange"},{id:"218aae70-f28d-429d-a2c5-76c996926e59",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"lungLevel"}],portsOut:[{name:"Value",value:10}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"2de3346b-42fe-4046-9c8c-47c2fa20ece6",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"lungMaxStillTime"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"bbf74e47-1983-4fe7-b940-054011936888",objOut:"2de3346b-42fe-4046-9c8c-47c2fa20ece6"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"a7ac853a-49c7-4965-a07e-283f8db18893",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:14.2}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"2747a45a-7f24-4869-ab85-556a08c86d57",objOut:"a7ac853a-49c7-4965-a07e-283f8db18893"}]}],objName:"Ops.Value.Number"},{id:"17987b25-9a3a-47c6-ae20-90e8dfe3ca0c",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"newBauplan loop"}],portsOut:[{name:"Value",value:6918.197199999989}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"2e7d82e7-3458-4a0e-9e38-fe9a22fed022",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"number1",value:1},{name:"number2",value:.01}],portsOut:[{name:"result",value:.01}],objName:"Ops.Math.Multiply"},{id:"0755d1cf-2168-4b9b-9e60-665a07bb7412",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"lungAvgRate"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"94729c38-3c02-45ed-a46d-448ddb3fbbf2",objOut:"0755d1cf-2168-4b9b-9e60-665a07bb7412"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"d4de9be3-74b5-4b6a-8140-d145a6c98e44",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"old min",value:.5},{name:"old max",value:3},{name:"new min",value:.2},{name:"new max",value:0},{name:"Easing index",value:0},{name:"Easing",value:"Linear"}],portsOut:[{name:"result",value:.2}],objName:"Ops.Math.MapRange"},{id:"42540baa-d0d0-4a94-85f2-465216f38f70",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"duration",value:1},{name:"easing index",value:0},{name:"easing",value:"Cubic In Out"}],portsOut:[{name:"result",links:[{portIn:"value",portOut:"result",objIn:"35054a31-8c7e-4f8b-95ee-9e4be662f602",objOut:"42540baa-d0d0-4a94-85f2-465216f38f70"}]}],objName:"Ops.Anim.AnimNumber"},{id:"eac15c5d-6632-4c94-bc48-256d8343018d",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"42540baa-d0d0-4a94-85f2-465216f38f70",objOut:"eac15c5d-6632-4c94-bc48-256d8343018d"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"dc676dbe-4765-49d2-bf37-2445d049e4a3",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"indexVol"}],portsOut:[{name:"Value",value:0}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"fbc04e2e-6e03-424f-af03-0b90df724003",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"lungAvgRate"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"42540baa-d0d0-4a94-85f2-465216f38f70",objOut:"fbc04e2e-6e03-424f-af03-0b90df724003"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"f1cd4ef2-25c0-48bc-bbd9-7783f69ce62a",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"old min",value:5},{name:"old max",value:.5},{name:"new min",value:0},{name:"new max",value:.03},{name:"Easing index",value:0},{name:"Easing",value:"Linear"}],portsOut:[{name:"result",value:0}],objName:"Ops.Math.MapRange"},{id:"562cf34e-f635-49c0-91c0-5a85ab73e777",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"duration",value:2},{name:"easing index",value:0},{name:"easing",value:"Cubic In Out"}],portsOut:[{name:"result",links:[{portIn:"value",portOut:"result",objIn:"f1cd4ef2-25c0-48bc-bbd9-7783f69ce62a",objOut:"562cf34e-f635-49c0-91c0-5a85ab73e777"}]}],objName:"Ops.Anim.AnimNumber"},{id:"71055fc5-9880-43dc-be44-44aef8069de1",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"562cf34e-f635-49c0-91c0-5a85ab73e777",objOut:"71055fc5-9880-43dc-be44-44aef8069de1"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"7fe60179-9ca7-4ab7-8513-99f8bb8fba06",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"lungAvgRate"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"562cf34e-f635-49c0-91c0-5a85ab73e777",objOut:"7fe60179-9ca7-4ab7-8513-99f8bb8fba06"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"f3713269-d113-44ff-9149-a475b6b4a938",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:0}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"8ad1e471-2380-426e-8881-c48f912ec31a",objOut:"f3713269-d113-44ff-9149-a475b6b4a938"}]}],objName:"Ops.Value.Number"},{id:"b0787d07-562f-4f13-b971-d700293dcbae",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"94729c38-3c02-45ed-a46d-448ddb3fbbf2",objOut:"b0787d07-562f-4f13-b971-d700293dcbae"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"94729c38-3c02-45ed-a46d-448ddb3fbbf2",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"duration",value:1},{name:"easing index",value:0},{name:"easing",value:"Cubic In Out"}],portsOut:[{name:"result",links:[{portIn:"value",portOut:"result",objIn:"d4de9be3-74b5-4b6a-8140-d145a6c98e44",objOut:"94729c38-3c02-45ed-a46d-448ddb3fbbf2"}]}],objName:"Ops.Anim.AnimNumber"},{id:"bbf74e47-1983-4fe7-b940-054011936888",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"duration",value:1},{name:"easing index",value:0},{name:"easing",value:"Cubic In Out"}],portsOut:[{name:"result",value:0}],objName:"Ops.Anim.AnimNumber"},{id:"f732a720-ebe7-4acf-83f5-a3d883628337",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"bbf74e47-1983-4fe7-b940-054011936888",objOut:"f732a720-ebe7-4acf-83f5-a3d883628337"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"f96e62f1-3feb-49c8-8bc7-083c6f0b6a0f",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:78.203}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"cb896123-4540-4284-9117-85e5fb0c3be8",objOut:"f96e62f1-3feb-49c8-8bc7-083c6f0b6a0f"}]}],objName:"Ops.Value.Number"},{id:"934de5ae-b468-4330-b6b9-92dd59302743",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:.12}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"3d37e8d9-dc5a-4cd7-b704-27f94c0dd3e9",objOut:"934de5ae-b468-4330-b6b9-92dd59302743"}]}],objName:"Ops.Value.Number"},{id:"cdfda5e9-1abd-4ed6-9bef-de674181d359",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:0}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"5f0da96f-60de-4c41-bac8-2f76d5f1958b",objOut:"cdfda5e9-1abd-4ed6-9bef-de674181d359"}]}],objName:"Ops.Value.Number"},{id:"b7ccb9ab-3c04-4b0c-9703-ce97ac48fd13",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:1.08}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"58093a7b-61b4-4d29-868d-64242059207e",objOut:"b7ccb9ab-3c04-4b0c-9703-ce97ac48fd13"}]}],objName:"Ops.Value.Number"},{id:"9d78b579-fbce-441e-ab15-89c518cb0437",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"value",value:.05}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"c8419e6c-05c4-4016-bbd8-77ba84b9c7e5",objOut:"9d78b579-fbce-441e-ab15-89c518cb0437"}]}],objName:"Ops.Value.Number"},{id:"716c72f4-6ed9-4cf4-85a2-13ddb5dfc252",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"create port",value:0},{name:"in0 Ops.Gl.MainLoop trigger",links:[{portIn:"Trigger",portOut:"in0 Ops.Gl.MainLoop trigger",objIn:"e19a1b8d-2784-4d91-a62c-738791dbdf7c",objOut:"716c72f4-6ed9-4cf4-85a2-13ddb5dfc252"}]},{name:"in1 Controls and uniforms out0 create port out value",value:0},{name:"in2 Controls and uniforms out1 aaa value",value:0},{name:"in3 Controls and uniforms out2 aaa value",value:0}],objName:"Ops.Ui.PatchInput"},{id:"0b457a71-d701-4179-9301-8ec8b43a84fe",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"create port",value:0},{name:"out0 create port out value",value:0},{name:"out1 aaa value",value:0},{name:"out2 aaa value",value:0},{name:"out3 aaa value",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"c96fdaa3-93b5-4aab-98ba-7ccc81dc2e02",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Ops.Gl.MainLoop trigger","type":1},{"name":"in1 Controls and uniforms out0 create port out value","type":0},{"name":"in2 Controls and uniforms out1 aaa value","type":0},{"name":"in3 Controls and uniforms out2 aaa value","type":0},{"name":"in4 Ops.Gl.MainLoop trigger","type":1}],"portsOut":[{"name":"out0 create port out value","type":0},{"name":"out1 aaa value","type":0},{"name":"out2 aaa value","type":0},{"name":"out3 aaa value","type":0},{"name":"out4 Ops.Sequence exe","type":1}]}'},{name:"patchId",value:"e26d67e4-380f-43d2-832e-97d9c7af8995"}],portsOut:[{name:"create port out",value:0}],objName:"Ops.Ui.SubPatch"},{id:"a851985a-7bd7-4ca8-a0a1-3275a6836579",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"breathingIn"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"df4cc858-3714-49cb-9c66-899472330cb4",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"breathingOut"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"65a2cd60-bdde-4901-9761-66a050479521",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"df4cc858-3714-49cb-9c66-899472330cb4",objOut:"65a2cd60-bdde-4901-9761-66a050479521"}]}],objName:"Ops.Ui.VizNumber"},{id:"dadad02a-138e-49d0-b865-ef413884e4de",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"key code",value:73},{name:"canvas only",value:true},{name:"Mod Key index",value:0},{name:"Mod Key",value:"none"},{name:"Enabled",value:true},{name:"Prevent Default",value:false}],portsOut:[{name:"on press",links:[{portIn:"Trigger",portOut:"on press",objIn:"931d6f1e-8af3-4937-8ff6-94326c3a4032",objOut:"dadad02a-138e-49d0-b865-ef413884e4de"}]},{name:"Pressed",links:[{portIn:"Boolean",portOut:"Pressed",objIn:"ab11e221-6f28-4897-949a-5d136db1cf2a",objOut:"dadad02a-138e-49d0-b865-ef413884e4de"},{portIn:"Number",portOut:"Pressed",objIn:"beed54c3-c82d-4284-b11f-e936dcdbf514",objOut:"dadad02a-138e-49d0-b865-ef413884e4de"}]},{name:"Key",value:"I"}],objName:"Ops.Devices.Keyboard.KeyPressLearn"},{id:"68816b70-3936-4aa3-84c7-7724e6679c23",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"key code",value:79},{name:"canvas only",value:true},{name:"Mod Key index",value:0},{name:"Mod Key",value:"none"},{name:"Enabled",value:true},{name:"Prevent Default",value:false}],portsOut:[{name:"on press",links:[{portIn:"Trigger",portOut:"on press",objIn:"ae984ae7-e6e6-447c-85f8-a1d3068eb834",objOut:"68816b70-3936-4aa3-84c7-7724e6679c23"}]},{name:"Pressed",links:[{portIn:"Number",portOut:"Pressed",objIn:"65a2cd60-bdde-4901-9761-66a050479521",objOut:"68816b70-3936-4aa3-84c7-7724e6679c23"},{portIn:"Boolean",portOut:"Pressed",objIn:"564f4178-e862-4482-b367-f963a9c2f321",objOut:"68816b70-3936-4aa3-84c7-7724e6679c23"}]},{name:"Key",value:"O"}],objName:"Ops.Devices.Keyboard.KeyPressLearn"},{id:"3e4eff1d-0fab-4ad2-8780-85645f292d08",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"fullLungs"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"0f0f74c8-02b1-41f0-9255-6e15bf67cc62",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"emptyLungs"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"71f201eb-06c2-4f1f-932d-88a3caf2233d",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"3e4eff1d-0fab-4ad2-8780-85645f292d08",objOut:"71f201eb-06c2-4f1f-932d-88a3caf2233d"}]}],objName:"Ops.Ui.VizNumber"},{id:"5d954ec0-5c06-4370-949f-c0aa23ebff65",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"key code",links:[{portIn:"number1",portOut:"key code",objIn:"145655b0-402d-4b57-8ab6-f04d6957a341",objOut:"5d954ec0-5c06-4370-949f-c0aa23ebff65"},{portIn:"number1",portOut:"key code",objIn:"579ad48f-f62f-464e-80dc-373e9d28e2d5",objOut:"5d954ec0-5c06-4370-949f-c0aa23ebff65"},{portIn:"number1",portOut:"key code",objIn:"d9292211-a105-49f8-b621-215f641b9a45",objOut:"5d954ec0-5c06-4370-949f-c0aa23ebff65"},{portIn:"number1",portOut:"key code",objIn:"b8574f34-298f-4d7f-bb2d-2c2c7c6ec3ee",objOut:"5d954ec0-5c06-4370-949f-c0aa23ebff65"},{portIn:"number1",portOut:"key code",objIn:"a65ec3d7-2c83-4e4d-944e-1a7e74baee3e",objOut:"5d954ec0-5c06-4370-949f-c0aa23ebff65"}]},{name:"Char",value:"f"}],objName:"Ops.Devices.Keyboard.KeyPress"},{id:"145655b0-402d-4b57-8ab6-f04d6957a341",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"number2",value:105}],portsOut:[{name:"result",links:[{portIn:"bool 1",portOut:"result",objIn:"9dbab7a2-6acf-491d-ba73-3cd1e282d39e",objOut:"145655b0-402d-4b57-8ab6-f04d6957a341"}]}],objName:"Ops.Math.Compare.Equals"},{id:"579ad48f-f62f-464e-80dc-373e9d28e2d5",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"number2",value:111}],portsOut:[{name:"result",links:[{portIn:"bool 1",portOut:"result",objIn:"a33174db-502c-435b-86cf-dfba307fe8cc",objOut:"579ad48f-f62f-464e-80dc-373e9d28e2d5"}]}],objName:"Ops.Math.Compare.Equals"},{id:"710621d6-61d1-45c7-9ad4-8e7ada0b0145",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"0f0f74c8-02b1-41f0-9255-6e15bf67cc62",objOut:"710621d6-61d1-45c7-9ad4-8e7ada0b0145"}]}],objName:"Ops.Ui.VizNumber"},{id:"9dbab7a2-6acf-491d-ba73-3cd1e282d39e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"71f201eb-06c2-4f1f-932d-88a3caf2233d",objOut:"9dbab7a2-6acf-491d-ba73-3cd1e282d39e"}]}],objName:"Ops.Boolean.And"},{id:"ab11e221-6f28-4897-949a-5d136db1cf2a",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"9dbab7a2-6acf-491d-ba73-3cd1e282d39e",objOut:"ab11e221-6f28-4897-949a-5d136db1cf2a"}]}],objName:"Ops.Boolean.Not"},{id:"a33174db-502c-435b-86cf-dfba307fe8cc",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"710621d6-61d1-45c7-9ad4-8e7ada0b0145",objOut:"a33174db-502c-435b-86cf-dfba307fe8cc"}]}],objName:"Ops.Boolean.And"},{id:"564f4178-e862-4482-b367-f963a9c2f321",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"a33174db-502c-435b-86cf-dfba307fe8cc",objOut:"564f4178-e862-4482-b367-f963a9c2f321"}]}],objName:"Ops.Boolean.Not"},{id:"beed54c3-c82d-4284-b11f-e936dcdbf514",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"a851985a-7bd7-4ca8-a0a1-3275a6836579",objOut:"beed54c3-c82d-4284-b11f-e936dcdbf514"}]}],objName:"Ops.Ui.VizNumber"},{id:"8aa2600c-7127-4ab2-93b3-8cc27060a934",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line thickness\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, 0.00025); // choose thickness here\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3.0 / iResolution.y, max(0.0, d));\n}\n\nvec3 draw_distance(float d, vec2 p) {\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1., 1., 1.), vec3(.1), t); // ramp colors\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125)));\n\n  grad -= rim;\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // color of inside and outside creature\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\treturn length( (start - p) - proj ) - (width / 2.0);\n}\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord )\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y;\n\n    float d = 10000000.;\n    float i = float(int(iTime/0.)+1234); // change the new creature thing\n    i = rand(i); \n    for(int b=0;b<3;b++){ // extremity complex\n\t    vec2 last = vec2(0.0);\n    \tfloat la = 0.0;\n        for(int x=0;x<10;x++){ // extremity complex\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s*=.2; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse\n            //a += smoothstep(.5,1.,sin(iTime*6.))* srand(i++)*.01;\n            a += la;\n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            float bs = rand(i++);\n            float ls = rand(i++);\n            float ma = rand(i++);\n            for(int k=0;k<2;k++){ // extemity return\n                vec2 uv = k==1?_uv:_uv*vec2(-1.,1.);\n\n                float o1 = lineDist( uv,opos,last,.02+ls*.03); // bone lines\n                float o2= length( uv - opos)- (.01+bs*.02); // joint balls\n                float o = min(o1,o2);\n                //d = smoothMerge(d,o,.01 + ma * .05);     // Merge shape    \n                d= min(d,o);\n            }        \n            la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv);\n\n    // Output to screen\n    outColor = vec4(col,1.0);\n}\n\n\n\n// void main()\n// {\n//     vec4 col=vec4(texCoord,0.0,1.0);\n//     {{MODULE_COLOR}}\n//     outColor = col;\n// }"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:0},{name:"iResolution Y",value:0},{name:"iTime",value:0}],portsOut:[{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"df904a42-e790-44ef-8ed2-67f2611fd063",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  //float aa = smoothstep(3.0,10.0,)// base line gradient\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) {\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // antialias\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // mix color of inside and outside creature\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\treturn length( (start - p) - proj ) - (width / 2.0);\n}\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\n///////////////Bezierzone\n// Test if point p crosses line (a, b), returns sign of result\nfloat testCross(vec2 a, vec2 b, vec2 p) {\n    return sign((b.y-a.y) * (p.x-a.x) - (b.x-a.x) * (p.y-a.y));\n}\n\n// Determine which side we're on (using barycentric parameterization)\nfloat signBezier(vec2 A, vec2 B, vec2 C, vec2 p)\n{ \n    vec2 a = C - A, b = B - A, c = p - A;\n    vec2 bary = vec2(c.x*b.y-b.x*c.y,a.x*c.y-c.x*a.y) / (a.x*b.y-b.x*a.y);\n    vec2 d = vec2(bary.y * 0.5, 0.0) + 1.0 - bary.x - bary.y;\n    return mix(sign(d.x * d.x - d.y), mix(-1.0, 1.0, \n        step(testCross(A, B, p) * testCross(B, C, p), 0.0)),\n        step((d.x - d.y), 0.0)) * testCross(A, C, B);\n}\n\n// Solve cubic equation for roots\nvec3 solveCubic(float a, float b, float c)\n{\n    float p = b - a*a / 3.0, p3 = p*p*p;\n    float q = a * (2.0*a*a - 9.0*b) / 27.0 + c;\n    float d = q*q + 4.0*p3 / 27.0;\n    float offset = -a / 3.0;\n    if(d >= 0.0) { \n        float z = sqrt(d);\n        vec2 x = (vec2(z, -z) - q) / 2.0;\n        vec2 uv = sign(x)*pow(abs(x), vec2(1.0/3.0));\n        return vec3(offset + uv.x + uv.y);\n    }\n    float v = acos(-sqrt(-27.0 / p3) * q / 2.0) / 3.0;\n    float m = cos(v), n = sin(v)*1.732050808;\n    return vec3(m + m, -n - m, n - m) * sqrt(-p / 3.0) + offset;\n}\n\n// Find the signed distance from a point to a bezier curve\nfloat sdBezier(vec2 A, vec2 B, vec2 C, vec2 p)\n{    \n    B = mix(B + vec2(1e-4), B, abs(sign(B * 2.0 - A - C)));\n    vec2 a = B - A, b = A - B * 2.0 + C, c = a * 2.0, d = A - p;\n    vec3 k = vec3(3.*dot(a,b),2.*dot(a,a)+dot(d,b),dot(d,a)) / dot(b,b);      \n    vec3 t = clamp(solveCubic(k.x, k.y, k.z), 0.0, 1.0);\n    vec2 pos = A + (c + b*t.x)*t.x;\n    float dis = length(pos - p);\n    pos = A + (c + b*t.y)*t.y;\n    dis = min(dis, length(pos - p));\n    pos = A + (c + b*t.z)*t.z;\n    dis = min(dis, length(pos - p));\n    return dis * signBezier(A, B, C, p);\n}\n//////////////////\n\n\n\nvec3 draw_distanceCurve(float d, vec2 uv) {\n//   float t = clamp(d * 0.85, 0.0, 1.0);\n//   //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n//   vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n//   float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n//   float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n//   float d2 = abs(1.0 - draw_line(d).x);\n//   vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // antialias\n//   grad -= rim; // antialias\n//   //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n//   grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // mix color of inside and outside creature\n\n//   return grad;\n\n///bezier testCross\n vec3 outboi = vec3(0.);\n\nvec2 p = (2.0*gl_FragCoord.xy-iResolution.xy)/iResolution.y;\n    vec2 A = vec2(0.0, -0.6), C = vec2(0.0, +0.6), B = vec2(1.0, 0.);\n    float curva = min(distance(p, A),(distance(p, C)));\n    curva = sdBezier(A, B, C, p);\n\n     outboi = mix(outboi, vec3(1.0), 1.0-smoothstep(0.0,0.02,abs(curva)) );\n     return outboi;\n\n////\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    float i = float(int(iTime/10.)); // new creature loop\n    i = rand(i); \n    \n    for(int b=0;b< complexityA;b++){\n        vec2 last = vec2(0.0);\n        vec2 last2 = vec2(0.0);\n        float la = 0.0;\n    }\n    \n    //////// bezier zone\n    vec2 p = (2.0*gl_FragCoord.xy-iResolution.xy)/iResolution.y;\n    vec2 A = vec2(0.0, -0.6), C = vec2(0.0, +0.6), B = vec2(1.0, 0.);\n    float curva = min(distance(p, A),(distance(p, C)));\n    curva = sdBezier(A, B, C, p);\n\n    outColor = mix(outColor, vec4(1.0), 1.0-smoothstep(0.0,0.02,abs(curva)) );\n    \n    //////////\n    \n    // for(int b=0;b< complexityA;b++){ // extremity complex\n\t   // vec2 last = vec2(0.0);\n    // \tfloat la = 0.0;\n    //     for(int x=0;x< complexityB;x++){ // extremity complex\n    //         float a = srand(i++)*2.1415;\n    //         float s = .5+.5*rand(i++);\n    //         s *= 0.18; // size\n    //         //s *= float(bauScale); // size\n    //         // move\n    //         //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n    //         // preparation\n    //         //a += sin(iTime*3.0)* srand(i++)*.25;\n    //         // breathe\n    //         //a += sin(iTime*1.0)* srand(i++)*.04;\n    //         // pulse\n    //         //a += smoothstep(.5,1.,sin(iTime*6.))* srand(i++)*.01;\n    //         a += la;\n    //         vec2 opos = last + vec2(sin(a),cos(a))*s;\n    //         float bs = rand(i++);\n    //         float ls = rand(i++);\n    //         float ma = rand(i++);\n    //         for(int k=0;k< complexityC;k++){ // extemity return\n    //             vec2 uv = k==1?_uv:_uv*vec2(-1.,1.);\n\n    //             float o1 = lineDist( uv,opos,last,.02+ls*boneWeight); // bone lines\n                \n                \n    //             //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n    //             //float o = min(o1,o2);\n    //             float o = o1;\n    //             d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n    //             d= min(d,o);\n    //         }        \n    //         la = a;\n    //         last = opos;        \n    //     }\n    //}\n\n    \n    //vec3 col = draw_distance(d,_uv);\n\n    //outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:0},{name:"iResolution Y",value:0},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",value:.12,useVariable:"metaBlur"},{name:"complexityA",value:5,useVariable:"complexityA"},{name:"complexityB",value:7,useVariable:"complexityB"},{name:"complexityC",value:4,useVariable:"complexityC"},{name:"bauScale",value:.18000000000000002,useVariable:"bauScale"},{name:"boneWeight",value:.05,useVariable:"boneWeight"},{name:"jointWeight",value:0,useVariable:"jointWeight"}],portsOut:[{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"7350f245-e108-4d17-881b-2825a7004a5a",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"title",value:"todo"},{name:"text",value:"*Normal respiratory rate 12-20 so 3-5 seconds for 1 cycle\n\n*Creature dies if there's no input in 2 minutes\n\n- (d)Make it so that the extremities are distorted\nand looklike curves\n- (d) find LungAvgRate, LungDepth\n- (d) make 123 breathVolume\n- d Gm will control this\n\n\nMake feedback Look\n\nconnect all to to Bauplan\n\nd Make guide\nd Set Bauplan as Dice\nd Make ambient cues and encounters (save baustates make encounters of of them)\nd Derive abilities from morphology (???)\n\nd Tie-in midnight\nd Make <<map>>\n\n\n\n\n"}],objName:"Ops.Ui.Comment_v2"},{id:"0b37933b-ea35-4400-8a69-9dec16d92740",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI bool breathingIn;\nUNI bool breathingOut;\nUNI bool fullLungs;\nUNI bool emptyLungs;\n\n//-------------------------------------------------------------------------\n#define HASHSCALE 0.1031\n\nfloat hash(float p)\n{\n\tvec3 p3  = fract(vec3(p) * HASHSCALE);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nfloat fade(float t) { return t*t*t*(t*(6.*t-15.)+10.); }\n\nfloat grad(float hash, float p)\n{\n    int i = int(1e4*hash);\n\treturn (i & 1) == 0 ? p : -p;\n}\n\nfloat perlinNoise1D(float p)\n{\n\tfloat pi = floor(p), pf = p - pi, w = fade(pf);\n    return mix(grad(hash(pi), pf), grad(hash(pi + 1.0), pf - 1.0), w) * 2.0;\n}\n\nfloat fbm(float pos, int octaves, float persistence) \n{\n    float total = 0., frequency = 1., amplitude = 1., maxValue = 0.;\n    for(int i = 0; i < octaves; ++i) \n    {\n        total += perlinNoise1D(pos * frequency) * amplitude;\n        maxValue += amplitude;\n        amplitude *= persistence;\n        frequency *= 2.;\n    }\n    return total / maxValue;\n}\n//-------------------------------------------------------------\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  //float aa = smoothstep(3.0,10.0,)// base line gradient\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) {\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // antialias\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // mix color of inside and outside creature\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\treturn length( (start - p) - proj ) - (width / 2.0);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    \n    float i = rand(randomSeed); \n    \n    vec2 noise = vec2(.02 * fbm(_uv.x + _uv.y, 6, 1.),.02 * fbm(_uv.x + _uv.y, 6, 1.));\n    \n    for(int b=0;b< complexityA;b++){ // extremity complex\n\t    vec2 last = vec2(0.0);\n    \tfloat la = 0.0;\n        for(int x=0;x< complexityB;x++){ // extremity complex\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            //s *= float(bauScale); // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;//* srand(i++);\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse\n            //a += smoothstep(.5,1.,sin(iTime*6.))* srand(i++)*.01;\n            a += la;\n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            //float bs = rand(i++); // ball randomness\n            float ls = rand(i++); // line randomness\n            float ma = rand(i++); // merge randomness\n            \n                float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n                vec2 uv = _uv;\n\n                for(int k=1;k<=complexityC;k++){ // symmetry loop\n            \n                    if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                         uv = rotate2D(_uv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                         if ((k%2)==1){ // Invert axis every 2 symmetries\n                             uv = _uv*vec2(-1.,1.);\n                         }\n                         uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                    } else {\n                        uv = rotate2D(uv,anglePie);\n                    }\n                    \n                float o1 = lineDist( uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d= min(d,o);\n                \n            } \n            la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:0},{name:"iResolution Y",value:0},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",value:.12,useVariable:"metaBlur"},{name:"complexityA",value:5,useVariable:"complexityA"},{name:"complexityB",value:7,useVariable:"complexityB"},{name:"complexityC",value:4,useVariable:"complexityC"},{name:"bauScale",value:.18000000000000002,useVariable:"bauScale"},{name:"boneWeight",value:.05,useVariable:"boneWeight"},{name:"jointWeight",value:0,useVariable:"jointWeight"},{name:"randomSeed",value:15,useVariable:"randomSeed"},{name:"breathingIn",value:false},{name:"breathingOut",value:false},{name:"fullLungs",value:false},{name:"emptyLungs",value:false}],portsOut:[{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"4724ca9c-6c2a-4a05-8dbc-413bcb5ec1af",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"easing index",value:0},{name:"easing",value:"Sin In Out"}],portsOut:[{name:"result",links:[{portIn:"Number 1",portOut:"result",objIn:"10591af8-ae99-482d-8b71-3a0d98afa1cb",objOut:"4724ca9c-6c2a-4a05-8dbc-413bcb5ec1af"},{portIn:"Value",portOut:"result",objIn:"57e20d89-cfe9-4dd7-a00c-3c308df82522",objOut:"4724ca9c-6c2a-4a05-8dbc-413bcb5ec1af"}]}],objName:"Ops.Anim.AnimNumber"},{id:"10591af8-ae99-482d-8b71-3a0d98afa1cb",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Number 2",value:0},{name:"Number 3",value:0},{name:"Number 4",value:0},{name:"Number 5",value:0},{name:"Number 6",value:0},{name:"Number 7",value:0},{name:"Number 8",value:0}],objName:"Ops.Ui.VizGraph"},{id:"537daadd-c882-43ef-bcb0-1f2bf9d3d308",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Value 3",value:0},{name:"Value 4",value:0},{name:"Value 5",value:0},{name:"Value 6",value:0},{name:"Value 7",value:0},{name:"Value 8",value:0},{name:"Value 9",value:0},{name:"Value 10",value:0},{name:"Value 11",value:0},{name:"Value 12",value:0},{name:"Value 13",value:0},{name:"Value 14",value:0},{name:"Value 15",value:0}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"4724ca9c-6c2a-4a05-8dbc-413bcb5ec1af",objOut:"537daadd-c882-43ef-bcb0-1f2bf9d3d308"}]}],objName:"Ops.Value.SwitchNumber"},{id:"2c712a88-2041-479c-88f9-49b33a9c039f",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Index",portOut:"Result",objIn:"537daadd-c882-43ef-bcb0-1f2bf9d3d308",objOut:"2c712a88-2041-479c-88f9-49b33a9c039f"}]}],objName:"Ops.Ui.VizNumber"},{id:"e19a1b8d-2784-4d91-a62c-738791dbdf7c",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],objName:"Ops.Trigger.TriggerSend"},{id:"8b8bfebb-c40c-4970-ae94-2214b7f2f814",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Named Trigger",value:"in0 Ops.Gl.MainLoop trigger"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"4724ca9c-6c2a-4a05-8dbc-413bcb5ec1af",objOut:"8b8bfebb-c40c-4970-ae94-2214b7f2f814"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"24fd9df6-8983-4dac-98a6-b124d4927b8d",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Number",value:10}],portsOut:[{name:"Result",links:[{portIn:"Value 0",portOut:"Result",objIn:"537daadd-c882-43ef-bcb0-1f2bf9d3d308",objOut:"24fd9df6-8983-4dac-98a6-b124d4927b8d"}]}],objName:"Ops.Ui.VizNumber"},{id:"ae93e05b-6f4d-4064-8c40-3c0d40461c12",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Number",value:-10}],portsOut:[{name:"Result",links:[{portIn:"Value 1",portOut:"Result",objIn:"537daadd-c882-43ef-bcb0-1f2bf9d3d308",objOut:"ae93e05b-6f4d-4064-8c40-3c0d40461c12"}]}],objName:"Ops.Ui.VizNumber"},{id:"57e20d89-cfe9-4dd7-a00c-3c308df82522",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungLevel"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"45761bd9-675f-4f86-9eff-03ddf557614c",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Number",value:10,useVariable:"lungLevel"}],portsOut:[{name:"Result",links:[{portIn:"Value 2",portOut:"Result",objIn:"537daadd-c882-43ef-bcb0-1f2bf9d3d308",objOut:"45761bd9-675f-4f86-9eff-03ddf557614c"}]}],objName:"Ops.Ui.VizNumber"},{id:"b5415e9a-ba1f-4e8b-b5d2-996b1bdf5bdc",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"True",links:[{portIn:"2",portOut:"True",objIn:"534d6fbf-6eb4-49f5-aeef-2c856b11ab65",objOut:"b5415e9a-ba1f-4e8b-b5d2-996b1bdf5bdc"}]}],objName:"Ops.Boolean.TriggerOnChangeBoolean"},{id:"b486b834-42f2-4cdc-9cff-1d4b64080395",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"emptyLungs"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"b5415e9a-ba1f-4e8b-b5d2-996b1bdf5bdc",objOut:"b486b834-42f2-4cdc-9cff-1d4b64080395"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"347788d2-466f-4f69-9c67-ee4f1725346a",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"fullLungs"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"b5415e9a-ba1f-4e8b-b5d2-996b1bdf5bdc",objOut:"347788d2-466f-4f69-9c67-ee4f1725346a"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"534d6fbf-6eb4-49f5-aeef-2c856b11ab65",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"number",links:[{portIn:"Number",portOut:"number",objIn:"2c712a88-2041-479c-88f9-49b33a9c039f",objOut:"534d6fbf-6eb4-49f5-aeef-2c856b11ab65"}]}],objName:"Ops.Trigger.NumberByTrigger"},{id:"931d6f1e-8af3-4937-8ff6-94326c3a4032",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Named Trigger",value:"on press bIN"}],objName:"Ops.Trigger.TriggerSend"},{id:"cb462595-23f8-4348-ae6e-763b3cdedf4b",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Named Trigger",value:"on press bIN"}],portsOut:[{name:"Triggered",links:[{portIn:"0",portOut:"Triggered",objIn:"534d6fbf-6eb4-49f5-aeef-2c856b11ab65",objOut:"cb462595-23f8-4348-ae6e-763b3cdedf4b"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"ae984ae7-e6e6-447c-85f8-a1d3068eb834",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Named Trigger",value:"on press bOUT"}],objName:"Ops.Trigger.TriggerSend"},{id:"fb2f2cfa-5948-4832-8a9a-7aae728fd54b",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Named Trigger",value:"on press bOUT"}],portsOut:[{name:"Triggered",links:[{portIn:"1",portOut:"Triggered",objIn:"534d6fbf-6eb4-49f5-aeef-2c856b11ab65",objOut:"fb2f2cfa-5948-4832-8a9a-7aae728fd54b"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"d9292211-a105-49f8-b621-215f641b9a45",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"number2",value:49}],portsOut:[{name:"result",value:0}],objName:"Ops.Math.Compare.Equals"},{id:"b8574f34-298f-4d7f-bb2d-2c2c7c6ec3ee",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"number2",value:50}],portsOut:[{name:"result",value:0}],objName:"Ops.Math.Compare.Equals"},{id:"a65ec3d7-2c83-4e4d-944e-1a7e74baee3e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"number2",value:51}],portsOut:[{name:"result",value:0}],objName:"Ops.Math.Compare.Equals"},{id:"d84630c6-80f5-4765-a274-0984d02c0ed0",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Value",value:0},{name:"Variable",value:"indexVol"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"a0ccb44c-9110-4fc1-9190-539416ae156c",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"duration",portOut:"Result",objIn:"4724ca9c-6c2a-4a05-8dbc-413bcb5ec1af",objOut:"a0ccb44c-9110-4fc1-9190-539416ae156c"}]}],objName:"Ops.Ui.VizNumber"},{id:"0b33a42d-df24-43f0-867c-81ebacea5281",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Index",value:0,useVariable:"indexVol"},{name:"Value 0",value:4.5},{name:"Value 1",value:3},{name:"Value 2",value:2},{name:"Value 3",value:0},{name:"Value 4",value:0},{name:"Value 5",value:0},{name:"Value 6",value:0},{name:"Value 7",value:0},{name:"Value 8",value:0},{name:"Value 9",value:0},{name:"Value 10",value:0},{name:"Value 11",value:0},{name:"Value 12",value:0},{name:"Value 13",value:0},{name:"Value 14",value:0},{name:"Value 15",value:0}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"a0ccb44c-9110-4fc1-9190-539416ae156c",objOut:"0b33a42d-df24-43f0-867c-81ebacea5281"}]}],objName:"Ops.Value.SwitchNumber"},{id:"4e0a8c32-8f13-43d8-b036-825219123cb9",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"breathingOut"}],portsOut:[{name:"Value",links:[{portIn:"Play",portOut:"Value",objIn:"f4af3bbb-a64e-4014-8ecb-20c453e6171f",objOut:"4e0a8c32-8f13-43d8-b036-825219123cb9"},{portIn:"Value",portOut:"Value",objIn:"03cce395-203f-40ed-a0a4-34904b7bf3f2",objOut:"4e0a8c32-8f13-43d8-b036-825219123cb9"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"33dc9a58-d02d-4ba1-b854-3d0de501f3c1",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"breathingIn"}],portsOut:[{name:"Value",links:[{portIn:"Play",portOut:"Value",objIn:"f4af3bbb-a64e-4014-8ecb-20c453e6171f",objOut:"33dc9a58-d02d-4ba1-b854-3d0de501f3c1"},{portIn:"Value",portOut:"Value",objIn:"03cce395-203f-40ed-a0a4-34904b7bf3f2",objOut:"33dc9a58-d02d-4ba1-b854-3d0de501f3c1"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"f4af3bbb-a64e-4014-8ecb-20c453e6171f",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Speed",value:1},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Number",portOut:"Time",objIn:"b9d927c7-8d2c-436d-b02b-3f264444e0f4",objOut:"f4af3bbb-a64e-4014-8ecb-20c453e6171f"}]}],objName:"Ops.Anim.Timer_v2"},{id:"b9d927c7-8d2c-436d-b02b-3f264444e0f4",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"95d0c911-5050-4823-b5be-f28d22aa60ab",objOut:"b9d927c7-8d2c-436d-b02b-3f264444e0f4"}]}],objName:"Ops.Ui.VizNumber"},{id:"03cce395-203f-40ed-a0a4-34904b7bf3f2",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Trigger",links:[{portIn:"Reset",portOut:"Trigger",objIn:"f4af3bbb-a64e-4014-8ecb-20c453e6171f",objOut:"03cce395-203f-40ed-a0a4-34904b7bf3f2"}]}],objName:"Ops.Trigger.TriggerIfIncreased"},{id:"0be7706f-91be-415c-a038-d6d5b49865f3",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"JavaScript",value:'const vol1 = op.inBool("vol1 ",false);\r\nconst vol2 = op.inBool("vol2",false);\r\nconst vol3 = op.inBool("vol3",false);\r\nconst outVol = op.outNumber("result");\r\n\r\nvol1.onChange=vol2.onChange=vol3.onChange=update;\r\n \r\n \r\nfunction update()\r\n{\r\n    var v1 = vol1.get();\r\n    var v2 = vol2.get();\r\n    var v3 = vol3.get();\r\n\r\n      // default v2 index\r\n    \r\n    if (v1)\r\n    {\r\n        outVol.set(0)\r\n    } else if (v2)\r\n    {\r\n        outVol.set(1)\r\n    } else if (v3)\r\n    {\r\n       outVol.set(2)\r\n    }\r\n}'},{name:"Library",value:0,display:"file"},{name:"portsData",value:'{"portsIn":{"vol1 ":{"name":"vol1 ","title":"vol1 ","value":false,"type":0,"links":[]},"vol2":{"name":"vol2","title":"vol2","value":false,"type":0,"links":[]},"vol3":{"name":"vol3","title":"vol3","value":false,"type":0,"links":[]}},"portsOut":{"result":{"name":"result","title":"result","value":0,"type":0,"links":[]}}}'},{name:"vol1 ",value:false},{name:"vol2",value:false},{name:"vol3",value:false}],portsOut:[{name:"result",value:0}],objName:"Ops.Deprecated.Cables.CustomOp_v2"},{id:"95d0c911-5050-4823-b5be-f28d22aa60ab",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Became Zero Trigger",links:[{portIn:"Execute",portOut:"Became Zero Trigger",objIn:"2b719336-f281-497a-8d02-610b6f01308f",objOut:"95d0c911-5050-4823-b5be-f28d22aa60ab"}]},{name:"Last Value",links:[{portIn:"Number",portOut:"Last Value",objIn:"1fc4fb6c-8b2a-4833-8d1a-66ac5d98b1b2",objOut:"95d0c911-5050-4823-b5be-f28d22aa60ab"}]}],objName:"Ops.User.paramuno.ValueBecameZeroTrigger2"},{id:"1fc4fb6c-8b2a-4833-8d1a-66ac5d98b1b2",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"2b719336-f281-497a-8d02-610b6f01308f",objOut:"1fc4fb6c-8b2a-4833-8d1a-66ac5d98b1b2"}]}],objName:"Ops.Ui.VizNumber"},{id:"ba7260e2-4bba-4ff0-bf17-84b524df9b22",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Mode select index",value:0},{name:"Mode select",value:"Number"},{name:"Default Value",value:0}],portsOut:[{name:"Array",links:[{portIn:"Array",portOut:"Array",objIn:"2b719336-f281-497a-8d02-610b6f01308f",objOut:"ba7260e2-4bba-4ff0-bf17-84b524df9b22"}]},{name:"Array length out",value:10}],objName:"Ops.Array.Array_v2"},{id:"2b719336-f281-497a-8d02-610b6f01308f",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"ea8a6dd6-4853-4ead-88c0-28c01105bd2d",objOut:"2b719336-f281-497a-8d02-610b6f01308f"},{portIn:"In2",portOut:"Result",objIn:"5c9b7913-85b9-4d04-8783-bc07726cee80",objOut:"2b719336-f281-497a-8d02-610b6f01308f"}]}],objName:"Ops.User.paramuno.ArrayUnshiftNumber"},{id:"3319fa52-527e-443d-9d50-8d5d69f93551",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"JavaScript",value:'// you can use custom javascript code here, it will be bound to the\n// scope of the current op, which is available as `op`.\n// \n// have a look at the documentation at:\n// https://docs.cables.gl/dev_hello_op/dev_hello_op.html\n\nconst\n    inSpeed = op.inValue("Speed", 1),\n    playPause = op.inValueBool("Play", true),\n    reset = op.inTriggerButton("Reset"),\n    inSyncTimeline = op.inValueBool("Sync to timeline", false),\n    outTime = op.outValue("Time");\n    ruleTrigger = op.outValueBool("Rule Trigger", false);\n\nop.setPortGroup("Controls", [playPause, reset, inSpeed]);\n\nconst timer = new CABLES.Timer();\nlet lastTime = null;\nlet time = 0;\nlet syncTimeline = false;\n\n\nplayPause.onChange = setState;\nsetState();\n\nfunction setState()\n{\n    if (playPause.get() && !ruleTrigger.get())\n    {\n        timer.play();\n        op.patch.addOnAnimFrame(op);\n    }\n    else\n    {\n        timer.pause();\n        op.patch.removeOnAnimFrame(op);\n    }\n}\n\nreset.onTriggered = doReset;\n\nfunction doReset()\n{\n    time = 0;\n    lastTime = null;\n    timer.setTime(0);\n    outTime.set(0);\n    ruleTrigger.set(false);\n}\n\ninSyncTimeline.onChange = function ()\n{\n    syncTimeline = inSyncTimeline.get();\n    playPause.setUiAttribs({ "greyout": syncTimeline });\n    reset.setUiAttribs({ "greyout": syncTimeline });\n};\n\nop.onAnimFrame = function (tt)\n{\n    if (timer.isPlaying())\n    {\n        if (CABLES.overwriteTime !== undefined)\n        {\n            outTime.set(CABLES.overwriteTime * inSpeed.get());\n        }\n        else\n\n        if (syncTimeline)\n        {\n            outTime.set(tt * inSpeed.get());\n        }\n        else\n        {\n            timer.update();\n            const timerVal = timer.get();\n\n            if (lastTime === null)\n            {\n                lastTime = timerVal;\n                return;\n            }\n\n            const t = Math.abs(timerVal - lastTime);\n            lastTime = timerVal;\n\n            time += t * inSpeed.get();\n            if (time != time)time = 0;\n  \n            if (time>20) ruleTrigger.set(true);\n            \n            outTime.set(time);\n        }\n    }\n};\n'},{name:"Library",value:0,display:"file"},{name:"portsData",value:'{"portsIn":{"Speed":{"name":"Speed","title":"Speed","value":1,"type":0,"links":[]},"Play":{"name":"Play","title":"Play","value":true,"type":0,"links":[]},"Reset":{"name":"Reset","title":"Reset","value":0,"type":1,"links":[]},"Sync to timeline":{"name":"Sync to timeline","title":"Sync to timeline","value":false,"type":0,"links":[]}},"portsOut":{"Time":{"name":"Time","title":"Time","value":0,"type":0,"links":[]},"Rule Trigger":{"name":"Rule Trigger","title":"Rule Trigger","value":false,"type":0,"links":[]}}}'},{name:"Speed",value:1},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",value:6918.1974000000055},{name:"Rule Trigger",value:true}],objName:"Ops.Deprecated.Cables.CustomOp_v2"},{id:"b36a2524-3b41-4e18-a2fa-397202d61b4d",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Boolean",value:false}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"029ebad1-3489-47ae-877a-26493560aa17",objOut:"b36a2524-3b41-4e18-a2fa-397202d61b4d"}]}],objName:"Ops.Boolean.Not"},{id:"a2f2a093-aed5-4deb-8743-4abd415d12fc",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"isBreathing"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"e315fc2f-d447-4cbf-8b4e-19190fb972b4",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"emptyLungs"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"43d24169-8379-4e77-9d79-5e465f20d7be",objOut:"e315fc2f-d447-4cbf-8b4e-19190fb972b4"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"902b2e91-685f-4c06-b016-d21307f477f2",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"fullLungs"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"43d24169-8379-4e77-9d79-5e465f20d7be",objOut:"902b2e91-685f-4c06-b016-d21307f477f2"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"43d24169-8379-4e77-9d79-5e465f20d7be",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},objName:"Ops.Trigger.TriggerIfIncreased"},{id:"029ebad1-3489-47ae-877a-26493560aa17",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"a2f2a093-aed5-4deb-8743-4abd415d12fc",objOut:"029ebad1-3489-47ae-877a-26493560aa17"}]}],objName:"Ops.Ui.VizNumber"},{id:"ea8a6dd6-4853-4ead-88c0-28c01105bd2d",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Min",value:.40180000001192095},{name:"Max",links:[{portIn:"Value",portOut:"Max",objIn:"200ba6db-71ac-40d5-8c3e-11797ac9e4f1",objOut:"ea8a6dd6-4853-4ead-88c0-28c01105bd2d"}]},{name:"Average",links:[{portIn:"Value",portOut:"Average",objIn:"0f7191f1-74f5-4a27-ae5b-46236c7888fd",objOut:"ea8a6dd6-4853-4ead-88c0-28c01105bd2d"}]}],objName:"Ops.Array.InfoArray"},{id:"a6e5a5ab-9478-4f9e-b42c-9b337b53f455",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Value",value:-1}],portsOut:[{name:"Became Zero Trigger",links:[{portIn:"Execute",portOut:"Became Zero Trigger",objIn:"113e6a70-5516-4276-bcb7-e25bf38648b5",objOut:"a6e5a5ab-9478-4f9e-b42c-9b337b53f455"}]},{name:"Last Value",links:[{portIn:"Number",portOut:"Last Value",objIn:"e7c0bac8-309e-46d1-b452-891fd2b4989e",objOut:"a6e5a5ab-9478-4f9e-b42c-9b337b53f455"}]}],objName:"Ops.User.paramuno.ValueBecameZeroTrigger2"},{id:"e7c0bac8-309e-46d1-b452-891fd2b4989e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"ca4aad06-b139-45f0-99f8-5ca6f31ed0ce",objOut:"e7c0bac8-309e-46d1-b452-891fd2b4989e"}]}],objName:"Ops.Ui.VizNumber"},{id:"93481324-efb7-4d57-81c1-5759a1ce9f55",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Mode select index",value:0},{name:"Mode select",value:"Number"},{name:"Default Value",value:0}],portsOut:[{name:"Array",links:[{portIn:"Array",portOut:"Array",objIn:"113e6a70-5516-4276-bcb7-e25bf38648b5",objOut:"93481324-efb7-4d57-81c1-5759a1ce9f55"}]},{name:"Array length out",value:10}],objName:"Ops.Array.Array_v2"},{id:"113e6a70-5516-4276-bcb7-e25bf38648b5",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"f2289176-57d2-4a09-8bb1-bcef6cd3f666",objOut:"113e6a70-5516-4276-bcb7-e25bf38648b5"},{portIn:"In",portOut:"Result",objIn:"5c9b7913-85b9-4d04-8783-bc07726cee80",objOut:"113e6a70-5516-4276-bcb7-e25bf38648b5"}]}],objName:"Ops.User.paramuno.ArrayUnshiftNumber"},{id:"f2289176-57d2-4a09-8bb1-bcef6cd3f666",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Min",value:0},{name:"Max",links:[{portIn:"Value",portOut:"Max",objIn:"b82ecab5-63dd-48b6-9350-365b226453d0",objOut:"f2289176-57d2-4a09-8bb1-bcef6cd3f666"}]},{name:"Average",links:[{portIn:"Value",portOut:"Average",objIn:"aaf9e49f-4afa-4246-a684-44792e96f0de",objOut:"f2289176-57d2-4a09-8bb1-bcef6cd3f666"}]}],objName:"Ops.Array.InfoArray"},{id:"9b94db43-6f81-488c-a557-8c1d58901797",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Min",value:999999999},{name:"Max",value:-999999999},{name:"Average",links:[{portIn:"Number",portOut:"Average",objIn:"74fd9620-4db0-4a47-9cae-e243cb41220e",objOut:"9b94db43-6f81-488c-a557-8c1d58901797"}]}],objName:"Ops.Array.InfoArray"},{id:"b0b85f83-0143-42f5-874a-5ec16e7fd90b",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungAvgRate"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"0f7191f1-74f5-4a27-ae5b-46236c7888fd",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungDepth"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"aaf9e49f-4afa-4246-a684-44792e96f0de",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungStillTime"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"200ba6db-71ac-40d5-8c3e-11797ac9e4f1",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungMaxDepth"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"b82ecab5-63dd-48b6-9350-365b226453d0",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungMaxStillTime"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"9798a34e-8e19-4fb5-b21f-9f20b17fd711",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungMemory"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"9b0ce11b-b617-42e2-8cf1-ca77f01a65a8",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"value",value:10}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"3ae36e94-2cf2-4d20-8560-146f71bb1bb5",objOut:"9b0ce11b-b617-42e2-8cf1-ca77f01a65a8"}]}],objName:"Ops.Value.Number"},{id:"3ae36e94-2cf2-4d20-8560-146f71bb1bb5",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"d4d8a2c8-f1ca-4684-a20c-ebdd9f0f6487",objOut:"3ae36e94-2cf2-4d20-8560-146f71bb1bb5"}]}],objName:"Ops.Math.Floor"},{id:"d4d8a2c8-f1ca-4684-a20c-ebdd9f0f6487",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"9798a34e-8e19-4fb5-b21f-9f20b17fd711",objOut:"d4d8a2c8-f1ca-4684-a20c-ebdd9f0f6487"}]}],objName:"Ops.Ui.VizNumber"},{id:"840c9cff-b45a-461e-ad0a-cf22be352aaa",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Variable",value:"lungMemory"}],portsOut:[{name:"Value",links:[{portIn:"Array length",portOut:"Value",objIn:"93481324-efb7-4d57-81c1-5759a1ce9f55",objOut:"840c9cff-b45a-461e-ad0a-cf22be352aaa"},{portIn:"Array length",portOut:"Value",objIn:"ba7260e2-4bba-4ff0-bf17-84b524df9b22",objOut:"840c9cff-b45a-461e-ad0a-cf22be352aaa"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"d9ba0599-d667-4ac9-9657-a529b019aa0e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float noiseStrength;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\n\n//-------------------------------------------------------------------------\n#define HASHSCALE 0.1031\n\nfloat hash(float p)\n{\n\tvec3 p3  = fract(vec3(p) * HASHSCALE);\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nfloat fade(float t) { return t*t*t*(t*(6.*t-15.)+10.); }\n\nfloat grad(float hash, float p)\n{\n    int i = int(1e4*hash);\n\treturn (i & 1) == 0 ? p : -p;\n}\n\nfloat perlinNoise1D(float p)\n{\n\tfloat pi = floor(p), pf = p - pi, w = fade(pf);\n    return mix(grad(hash(pi), pf), grad(hash(pi + 1.0), pf - 1.0), w) * 2.0;\n}\n\nfloat fbm(float pos, int octaves, float frequency,float persistence) \n{\n    float total = 0., amplitude = 1., maxValue = 0.;\n    for(int i = 0; i < octaves; ++i) \n    {\n        total += perlinNoise1D(pos * frequency) * amplitude;\n        maxValue += amplitude;\n        amplitude *= persistence;\n        frequency *= 2.;\n    }\n    return total / maxValue;\n}\n//-------------------------------------------------------------\n/// 2D perlinNoise\n\nuint hash(uint x, uint seed) {\n    const uint m = 0x5bd1e995U;\n    uint hash = seed;\n    // process input\n    uint k = x;\n    k *= m;\n    k ^= k >> 24;\n    k *= m;\n    hash *= m;\n    hash ^= k;\n    // some final mixing\n    hash ^= hash >> 13;\n    hash *= m;\n    hash ^= hash >> 15;\n    return hash;\n}\n\n// implementation of MurmurHash (https://sites.google.com/site/murmurhash/) for a  \n// 2-dimensional unsigned integer input vector.\n\nuint hash(uvec2 x, uint seed){\n    const uint m = 0x5bd1e995U;\n    uint hash = seed;\n    // process first vector element\n    uint k = x.x; \n    k *= m;\n    k ^= k >> 24;\n    k *= m;\n    hash *= m;\n    hash ^= k;\n    // process second vector element\n    k = x.y; \n    k *= m;\n    k ^= k >> 24;\n    k *= m;\n    hash *= m;\n    hash ^= k;\n\t// some final mixing\n    hash ^= hash >> 13;\n    hash *= m;\n    hash ^= hash >> 15;\n    return hash;\n}\n\n\nvec2 gradientDirection(uint hash) {\n    switch (int(hash) & 3) { // look at the last two bits to pick a gradient direction\n    case 0:\n        return vec2(1.0, 1.0);\n    case 1:\n        return vec2(-1.0, 1.0);\n    case 2:\n        return vec2(1.0, -1.0);\n    case 3:\n        return vec2(-1.0, -1.0);\n    }\n}\n\nfloat interpolate(float value1, float value2, float value3, float value4, vec2 t) {\n    return mix(mix(value1, value2, t.x), mix(value3, value4, t.x), t.y);\n}\n\nvec2 fade(vec2 t) {\n    // 6t^5 - 15t^4 + 10t^3\n\treturn t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n}\n\nfloat perlinNoise(vec2 position, uint seed) {\n    vec2 floorPosition = floor(position);\n    vec2 fractPosition = position - floorPosition;\n    uvec2 cellCoordinates = uvec2(floorPosition);\n    float value1 = dot(gradientDirection(hash(cellCoordinates, seed)), fractPosition);\n    float value2 = dot(gradientDirection(hash((cellCoordinates + uvec2(1, 0)), seed)), fractPosition - vec2(1.0, 0.0));\n    float value3 = dot(gradientDirection(hash((cellCoordinates + uvec2(0, 1)), seed)), fractPosition - vec2(0.0, 1.0));\n    float value4 = dot(gradientDirection(hash((cellCoordinates + uvec2(1, 1)), seed)), fractPosition - vec2(1.0, 1.0));\n    return interpolate(value1, value2, value3, value4, fade(fractPosition));\n}\n\nfloat perlinNoise(vec2 position, int frequency, int octaveCount, float persistence, float lacunarity, uint seed) {\n    float value = 0.0;\n    float amplitude = 1.0;\n    float currentFrequency = float(frequency);\n    uint currentSeed = seed;\n    for (int i = 0; i < octaveCount; i++) {\n        currentSeed = hash(currentSeed, 0x0U); // create a new seed for each octave\n        value += perlinNoise(position * currentFrequency, currentSeed) * amplitude;\n        amplitude *= persistence;\n        currentFrequency *= lacunarity;\n    }\n    return value;\n}\n\n///-------\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  //float aa = smoothstep(3.0,10.0,)// base line gradient\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) {\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // antialias\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // mix color of inside and outside creature\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\treturn length( (start - p) - proj ) - (width / 2.0);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n    //float noiseVal = fbm(noiseStrength*_uv.x + 5.*iTime, 6, .03, 1.);  // 1D noise over uv float pos, int octaves, float persistence\n    //float noiseVal = fbm(noiseStrength + 4.*iTime, 6, .01, 1.);\n    //noiseVal = (noiseVal + 1.0) * 0.5; // from -1/1 to 0/1\n    \n    \n    //uint noiseSeed = 0x578437adU;\n    //float value = perlinNoise(vec2(.5,.5), 1, 6, 0.5, 2.0, noiseSeed);\n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,4.,float(complexityB))); // choose random from 4-complexityB as maxnumber\n    \t\n        for(int x=0;x< exLength;x++){ // extremity length\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse\n            //a += smoothstep(.5,1.,sin(iTime*6.))* srand(i++)*.01;\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n                float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n                vec2 uv = _uv;\n\n                for(int k=1;k<=complexityC;k++){ // symmetry loop\n                    if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                         uv = rotate2D(_uv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                         if ((k%2)==1){ // Invert axis every 2 symmetries\n                             uv = _uv*vec2(-1.,1.);\n                         }\n                         uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                    } else {\n                        uv = rotate2D(uv,anglePie);\n                    }\n                    \n                    \n                //connecting noise to lines\n                \n                ///Drawing part\n                float o1 = lineDist( uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d= min(d,o);\n                \n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv);\n    //col = vec3(noiseVal);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",value:.12,useVariable:"metaBlur"},{name:"complexityA",value:5,useVariable:"complexityA"},{name:"complexityB",value:7,useVariable:"complexityB"},{name:"complexityC",value:4,useVariable:"complexityC"},{name:"bauScale",value:.18000000000000002,useVariable:"bauScale"},{name:"boneWeight",value:.05,useVariable:"boneWeight"},{name:"jointWeight",value:0,useVariable:"jointWeight"},{name:"randomSeed",value:15,useVariable:"randomSeed"},{name:"noiseStrength",value:1.7999999999999998},{name:"angleIN",value:-3,useVariable:"angleIN"},{name:"jointX",value:0,useVariable:"jointX"},{name:"jointY",value:0,useVariable:"jointY"},{name:"contraction",value:1.08,useVariable:"contraction"},{name:"rotateEach",value:78.203,useVariable:"rotateEach"}],portsOut:[{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"64a3eff3-81c2-4252-a2fe-27c423793c78",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n    //distorting uv\n    float x = p.x;\n    float m = (x-0.1)*(x+0.1);\n    //m = m*m*2.;\n    float y = p.y+m;\n    vec2 p2 = vec2(x,y);\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  //grad -= mix(vec3(.0, .0, .0), vec3(0.93), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n                \n    // // //distorting uv\n    // float x = p.x;\n    // float m = (x-0.1)*(x+0.1);\n    // //m = m*m*2.;\n    // float y = p.y+m;\n    // vec2 p2 = vec2(x,y);\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,4.,float(complexityB))); // choose random from 4-complexityB as maxnumber\n    \t\n        for(int x=0;x< exLength;x++){ // extremity length\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse\n            //a += smoothstep(.5,1.,sin(iTime*6.))* srand(i++)*.01;\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                //distorting uv  // this distortis the whole thing not each line\n                vec2 tempuv = _uv;\n                float x = tempuv.x;\n                float m = (x-.5)*(x+.5);\n                float y = tempuv.y;\n                //y += m; \n                tempuv = vec2(x,y);\n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                }\n                \n                //  if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                //      uv = rotate2D(_uv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                //      if ((k%2)==1){ // Invert axis every 2 symmetries\n                //          uv = _uv*vec2(-1.,1.);\n                //      }\n                //      uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                // } else {\n                //     uv = rotate2D(uv,anglePie);\n                // }               \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting uv\n                // float x = uv.x;\n                // float m = (x-.5)*(x+.5);\n                // float y = uv.y;\n                // uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",value:.12,useVariable:"metaBlur"},{name:"complexityA",value:5,useVariable:"complexityA"},{name:"complexityB",value:7,useVariable:"complexityB"},{name:"complexityC",value:4,useVariable:"complexityC"},{name:"bauScale",value:.18000000000000002,useVariable:"bauScale"},{name:"boneWeight",value:.05,useVariable:"boneWeight"},{name:"jointWeight",value:0,useVariable:"jointWeight"},{name:"randomSeed",value:15,useVariable:"randomSeed"},{name:"distortionVal",value:0,useVariable:"distortionVal"},{name:"angleIN",value:-3,useVariable:"angleIN"},{name:"jointX",value:0,useVariable:"jointX"},{name:"jointY",value:0,useVariable:"jointY"},{name:"contraction",value:1.08,useVariable:"contraction"},{name:"rotateEach",value:78.203,useVariable:"rotateEach"}],portsOut:[{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"74fd9620-4db0-4a47-9cae-e243cb41220e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"b0b85f83-0143-42f5-874a-5ec16e7fd90b",objOut:"74fd9620-4db0-4a47-9cae-e243cb41220e"}]}],objName:"Ops.Ui.VizNumber"},{id:"3f775f1c-c1e0-460e-b98c-fe78d91e19d2",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Array length",value:10},{name:"Mode select index",value:0},{name:"Mode select",value:"Number"},{name:"Default Value",value:0}],portsOut:[{name:"Array length out",value:10}],objName:"Ops.Array.Array_v2"},{id:"51809a2a-486b-416e-b2f7-acdabbc590d3",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"JavaScript",value:'const\n    inTrigger = op.inTriggerButton("Populate"),\n    inArray = op.inArray("Array"),\n    inValue0 = op.inFloat("Number1", 1),\n    inValue1 = op.inFloat("Number2", 1),\n    inValue2 = op.inFloat("Number3", 1),\n    inValue3 = op.inFloat("Number4", 1),\n    inValue4 = op.inFloat("Number5", 1),\n    inValue5 = op.inFloat("Number6", 1),\n    inValue6 = op.inFloat("Number7", 1),\n    inValue7 = op.inFloat("Number8", 1),\n    inValue8 = op.inFloat("Number9", 1),\n    inValue9 = op.inFloat("Number10", 1),\n    outNext = op.outTrigger("Next"),\n    outArray = op.outArray("Result");\n\nlet arr = [];\ninArray.onChange = () =>\n{\n    arr = inArray.get();\n};\n\ninTrigger.onTriggered = () =>\n{\n    arr = inArray.get();\n    if (!arr)\n    {\n        outArray.set(null);\n        return;\n    }\n\n\n    for(var i=0;i<arr.length;i++)\n    {\n        arr[i]=eval("inValue" + i).get(); // hacky solution\n    }\n    \n\n    outArray.set(arr);\n};\n'},{name:"Library",value:0,display:"file"},{name:"portsData",value:'{"portsIn":{"Populate":{"name":"Populate","title":"Populate","value":0,"type":1,"links":[]},"Array":{"name":"Array","title":"Array","value":0,"type":3,"links":[]},"Number1":{"name":"Number1","title":"Number1","value":1,"type":0,"links":[]},"Number2":{"name":"Number2","title":"Number2","value":1,"type":0,"links":[]},"Number3":{"name":"Number3","title":"Number3","value":1,"type":0,"links":[]},"Number4":{"name":"Number4","title":"Number4","value":1,"type":0,"links":[]},"Number5":{"name":"Number5","title":"Number5","value":1,"type":0,"links":[]},"Number6":{"name":"Number6","title":"Number6","value":1,"type":0,"links":[]},"Number7":{"name":"Number7","title":"Number7","value":1,"type":0,"links":[]},"Number8":{"name":"Number8","title":"Number8","value":1,"type":0,"links":[]},"Number9":{"name":"Number9","title":"Number9","value":1,"type":0,"links":[]},"Number10":{"name":"Number10","title":"Number10","value":1,"type":0,"links":[]}},"portsOut":{"Next":{"name":"Next","title":"Next","value":0,"type":1,"links":[]},"Result":{"name":"Result","title":"Result","value":null,"type":3,"links":[]}}}'},{name:"Array",value:0},{name:"Number1",value:1},{name:"Number2",value:1},{name:"Number3",value:1},{name:"Number4",value:1},{name:"Number5",value:1},{name:"Number6",value:1},{name:"Number7",value:1},{name:"Number8",value:1},{name:"Number9",value:1},{name:"Number10",value:1}],objName:"Ops.Deprecated.Cables.CustomOp_v2"},{id:"5c9b7913-85b9-4d04-8783-bc07726cee80",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"9b94db43-6f81-488c-a557-8c1d58901797",objOut:"5c9b7913-85b9-4d04-8783-bc07726cee80"}]}],objName:"Ops.User.paramuno.ArrayAdd"},{id:"942e5df4-7704-4496-b261-c9fbed57a997",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"JavaScript",value:'const\n    inUpdate = op.inTrigger("Update"),\n    inLimit = op.inInt("Limit", 12),\n    outArr = op.outArray("Array");\n\nconst clamp = (num, min, max) => Math.min(Math.max(num, min), max);\nconst inPorts = [];\n\n\nfor (let i = 0; i < 12; i++)\n{\n    const inp = op.inFloat("Index " + i, 0);\n    //inp = Math.round(inp* 1000)/1000;\n    inPorts.push(inp);\n    inp.onChange=update;\n}\n\nconst arr = [];\n\n\ninUpdate.onTriggered = update;\n\nfunction update()\n{\n    const l = Math.max(0, Math.ceil(Math.min(inLimit.get(), inPorts.length)));\n    arr.length = l;\n    for (let i = 0; i < l; i++)\n    {\n        arr[i] = Math.round(inPorts[i].get()* 1000)/1000; // This rounds to the 3rd decimal\n    }\n\n    outArr.set(null);\n    outArr.set(arr);\n}'},{name:"Library",value:0,display:"file"},{name:"portsData",value:'{"portsIn":{"Update":{"name":"Update","title":"Update","value":0,"type":1,"links":[]},"Limit":{"name":"Limit","title":"Limit","value":12,"type":0,"links":[]},"Index 0":{"name":"Index 0","title":"Index 0","value":0,"type":0,"links":[]},"Index 1":{"name":"Index 1","title":"Index 1","value":0,"type":0,"links":[]},"Index 2":{"name":"Index 2","title":"Index 2","value":0,"type":0,"links":[]},"Index 3":{"name":"Index 3","title":"Index 3","value":0,"type":0,"links":[]},"Index 4":{"name":"Index 4","title":"Index 4","value":0,"type":0,"links":[]},"Index 5":{"name":"Index 5","title":"Index 5","value":0,"type":0,"links":[]},"Index 6":{"name":"Index 6","title":"Index 6","value":0,"type":0,"links":[]},"Index 7":{"name":"Index 7","title":"Index 7","value":0,"type":0,"links":[]},"Index 8":{"name":"Index 8","title":"Index 8","value":0,"type":0,"links":[]},"Index 9":{"name":"Index 9","title":"Index 9","value":0,"type":0,"links":[]},"Index 10":{"name":"Index 10","title":"Index 10","value":0,"type":0,"links":[]},"Index 11":{"name":"Index 11","title":"Index 11","value":0,"type":0,"links":[]}},"portsOut":{"Array":{"name":"Array","title":"Array","value":null,"type":3,"links":[]}}}'},{name:"Limit",value:12},{name:"Index 0",value:0},{name:"Index 1",value:0},{name:"Index 2",value:0},{name:"Index 3",value:0},{name:"Index 4",value:0},{name:"Index 5",value:0},{name:"Index 6",value:0},{name:"Index 7",value:0},{name:"Index 8",value:0},{name:"Index 9",value:0},{name:"Index 10",value:0},{name:"Index 11",value:0}],objName:"Ops.Deprecated.Cables.CustomOp_v2"},{id:"654a6f74-f33e-4efd-903d-0d5b4f32ae46",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},objName:"Ops.Trigger.TriggerButton"},{id:"ca4aad06-b139-45f0-99f8-5ca6f31ed0ce",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Max",value:10}],portsOut:[{name:"Current Value",value:0},{name:"Previous Value",links:[{portIn:"Number",portOut:"Previous Value",objIn:"113e6a70-5516-4276-bcb7-e25bf38648b5",objOut:"ca4aad06-b139-45f0-99f8-5ca6f31ed0ce"}]}],objName:"Ops.User.paramuno.PreviousValueStore2"},{id:"d08847f7-f6c1-4c8d-8eee-536de5daf386",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"number2",value:102}],portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"8ec81135-278b-49ee-9cf9-00b405fd4f1e",objOut:"d08847f7-f6c1-4c8d-8eee-536de5daf386"}]}],objName:"Ops.Math.Compare.Equals"},{id:"7f179780-6d40-4061-bf9c-c6731f2225be",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsIn:[{name:"Element index",value:0},{name:"Element",value:"Canvas"}],portsOut:[{name:"Is Fullscreen",value:0}],objName:"Ops.Html.FullscreenMode"},{id:"e4638eb6-6704-480b-af38-338626e6166f",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"on press",links:[{portIn:"exe",portOut:"on press",objIn:"8ec81135-278b-49ee-9cf9-00b405fd4f1e",objOut:"e4638eb6-6704-480b-af38-338626e6166f"}]},{name:"key code",links:[{portIn:"number1",portOut:"key code",objIn:"d08847f7-f6c1-4c8d-8eee-536de5daf386",objOut:"e4638eb6-6704-480b-af38-338626e6166f"}]},{name:"Char",value:"f"}],objName:"Ops.Devices.Keyboard.KeyPress"},{id:"8ec81135-278b-49ee-9cf9-00b405fd4f1e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"then",links:[{portIn:"Exec",portOut:"then",objIn:"fb485c73-484e-46a1-8520-890689d3b80e",objOut:"8ec81135-278b-49ee-9cf9-00b405fd4f1e"},{portIn:"Reset",portOut:"then",objIn:"fb485c73-484e-46a1-8520-890689d3b80e",objOut:"8ec81135-278b-49ee-9cf9-00b405fd4f1e"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"fb485c73-484e-46a1-8520-890689d3b80e",uiAttribs:{subPatch:"e26d67e4-380f-43d2-832e-97d9c7af8995"},portsOut:[{name:"Next",links:[{portIn:"Request Fullscreen",portOut:"Next",objIn:"7f179780-6d40-4061-bf9c-c6731f2225be",objOut:"fb485c73-484e-46a1-8520-890689d3b80e"}]},{name:"Was Triggered",value:0}],objName:"Ops.Trigger.TriggerOnce"},{id:"df91856e-e2cf-4119-aeef-e5fd5765c2c9",uiAttribs:{},portsIn:[{name:"Use Viewport Size",value:false},{name:"Width",value:360},{name:"Height",value:360},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"c3162f87-13c0-457c-a774-8ac65296a217",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"}]},{name:"Texture",links:[{portIn:"Image",portOut:"Texture",objIn:"3748c2c0-dbfe-4744-98cd-428fa2b2ce58",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"},{portIn:"Image",portOut:"Texture",objIn:"b3303e58-3ef0-4b51-94c2-1aa63bfce2b5",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"},{portIn:"Mask",portOut:"Texture",objIn:"b3303e58-3ef0-4b51-94c2-1aa63bfce2b5",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"},{portIn:"Image",portOut:"Texture",objIn:"b4318ace-24c1-4f57-973e-3cedcc669321",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"},{portIn:"Mask",portOut:"Texture",objIn:"b4318ace-24c1-4f57-973e-3cedcc669321",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"},{portIn:"Image",portOut:"Texture",objIn:"a7cca56d-d6b0-4ca7-806c-2c6935b0c8fe",objOut:"df91856e-e2cf-4119-aeef-e5fd5765c2c9"}]}],objName:"Ops.Gl.Shader.ShaderToTexture"},{id:"4b8ade56-bbbe-4a0e-882c-d01137795609",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:.06},{name:"Position Y",value:.06},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"e859c162-4e16-4f3f-bce5-e7932c802b7f",uiAttribs:{},portsIn:[{name:"Variable",value:"vwidth"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"529fc5cd-68b0-4b0c-819f-2e2439a10ad6",uiAttribs:{},portsIn:[{name:"Variable",value:"vheight"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a",uiAttribs:{},portsOut:[{name:"trigger 2",links:[{portIn:"exe",portOut:"trigger 2",objIn:"db708672-1389-4d99-85be-009662e34fbf",objOut:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a"}]},{name:"trigger 5",links:[{portIn:"in0 Sequence exe",portOut:"trigger 5",objIn:"xxedzm42u",objOut:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a"}]},{name:"trigger 6",links:[{portIn:"in0 Sequence exe",portOut:"trigger 6",objIn:"x0bytsnd0",objOut:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a"}]},{name:"trigger 7",links:[{portIn:"in0 Sequence exe",portOut:"trigger 7",objIn:"50cblxqco",objOut:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a"}]},{name:"trigger 8",links:[{portIn:"in0 Sequence exe",portOut:"trigger 8",objIn:"daypqvfci",objOut:"f4c1bbe1-8328-4437-b7f6-af0e82e83c2a"}]}],objName:"Ops.Trigger.Sequence"},{id:"3daf69a7-6308-40f9-bceb-8a92f8e72127",uiAttribs:{},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float distortionVal2;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\nUNI float jitterIN;\nUNI float jitterSpeed;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,\n    \t4.,float(complexityB))); // map rand float to 4-complexityB as maxnumber\n    \t\n        for(int v=0;v< exLength;v++){ // extremity joint no.\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse jitter\n            a += smoothstep(.1,1.,sin(iTime*(srand(i++)*jitterSpeed))) // \n            * srand(i++)*jitterIN // JitterIN controls jitterRange\n            *map(float(v),0.,float(exLength),0.1,1.); // maps 0-exlength to 0.1-1 so that there's more jitterRange in tip joints\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                vec2 tempuv = _uv;\n                \n                //distorting whole uv\n                float x1 = tempuv.x;\n                \n                float mx1 = x1 < 0. ?  // stich x distortion in in half\n                sin(-2.*iTime+x1*distortionVal2)*.1 :\n                sin(2.*iTime+x1*distortionVal2)*-.1;\n                \n                float y1 = tempuv.y;\n                y1 += mx1*(distortionVal2/60.);   // higher y distortion for swimming effect\n                //y1 += mx1*.4;\n                float my1 = sin(5.*iTime+y1*10.)*.1;\n                x1 += my1*.01;  // low x distortion for watery effect\n                tempuv = vec2(x1,y1);\n                \n \n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                } \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting rotated uv\n                 float x = uv.x;\n                // //float m = (x-.1)*(x+.1); // this makes symmetry drift\n                 float mx = x*x;\n                 float y = uv.y + (mx*distortionVal);\n                 float my = y*y;\n                 x = x + (my*distortionVal); // distorts only Y axis bc of symmetyr\n                 uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",useVariable:"metaBlur"},{name:"complexityA",useVariable:"complexityA"},{name:"complexityB",useVariable:"complexityB"},{name:"complexityC",useVariable:"complexityC"},{name:"bauScale",useVariable:"bauScale"},{name:"boneWeight",useVariable:"boneWeight"},{name:"jointWeight",useVariable:"jointWeight"},{name:"randomSeed",useVariable:"randomSeed"},{name:"distortionVal",useVariable:"distortionVal"},{name:"distortionVal2",useVariable:"distortionVal2"},{name:"angleIN",useVariable:"angleIN"},{name:"jointX",useVariable:"jointX"},{name:"jointY",useVariable:"jointY"},{name:"contraction",useVariable:"contraction"},{name:"rotateEach",useVariable:"rotateEach"},{name:"jitterIN",useVariable:"jitterIN"},{name:"jitterSpeed",useVariable:"jitterSpeed"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"df91856e-e2cf-4119-aeef-e5fd5765c2c9",objOut:"3daf69a7-6308-40f9-bceb-8a92f8e72127"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"df91856e-e2cf-4119-aeef-e5fd5765c2c9",objOut:"3daf69a7-6308-40f9-bceb-8a92f8e72127"}]},{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"90d51fc8-5b8f-456a-ad95-c8d96b8d455c",uiAttribs:{subPatch:"169bacb7-5450-41b0-bc0d-15bfabe8d20e"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float distortionVal2;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\nUNI float jitterIN;\nUNI float jitterSpeed;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,\n    \t4.,float(complexityB))); // map rand float to 4-complexityB as maxnumber\n    \t\n        for(int v=0;v< exLength;v++){ // extremity joint no.\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse jitter\n            a += smoothstep(.1,1.,sin(iTime*(srand(i++)*jitterSpeed))) // \n            * srand(i++)*jitterIN // JitterIN controls jitterRange\n            *map(float(v),0.,float(exLength),0.1,1.); // maps 0-exlength to 0.1-1 so that there's more jitterRange in tip joints\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                vec2 tempuv = _uv;\n                \n                //distorting whole uv\n                float x1 = tempuv.x;\n                \n                float mx1 = x1 < 0. ?  // stich x distortion in in half\n                sin(-2.*iTime+x1*distortionVal2)*.1 :\n                sin(2.*iTime+x1*distortionVal2)*-.1;\n                \n                float y1 = tempuv.y;\n                y1 += mx1*(distortionVal2/60.);   // higher y distortion for swimming effect\n                //y1 += mx1*.4;\n                float my1 = sin(5.*iTime+y1*10.)*.1;\n                x1 += my1*.01;  // low x distortion for watery effect\n                tempuv = vec2(x1,y1);\n                \n \n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                } \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting rotated uv\n                 float x = uv.x;\n                // //float m = (x-.1)*(x+.1); // this makes symmetry drift\n                 float mx = x*x;\n                 float y = uv.y + (mx*distortionVal);\n                 float my = y*y;\n                 x = x + (my*distortionVal); // distorts only Y axis bc of symmetyr\n                 uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:350},{name:"iResolution Y",value:350},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",value:.12,useVariable:"metaBlur"},{name:"complexityA",value:5,useVariable:"complexityA"},{name:"complexityB",value:7,useVariable:"complexityB"},{name:"complexityC",value:4,useVariable:"complexityC"},{name:"bauScale",value:.18000000000000002,useVariable:"bauScale"},{name:"boneWeight",value:.05,useVariable:"boneWeight"},{name:"jointWeight",value:0,useVariable:"jointWeight"},{name:"randomSeed",value:15,useVariable:"randomSeed"},{name:"distortionVal",value:0,useVariable:"distortionVal"},{name:"distortionVal2",value:0,useVariable:"distortionVal2"},{name:"angleIN",value:-3,useVariable:"angleIN"},{name:"jointX",value:0,useVariable:"jointX"},{name:"jointY",value:0,useVariable:"jointY"},{name:"contraction",value:1.08,useVariable:"contraction"},{name:"rotateEach",value:78.203,useVariable:"rotateEach"},{name:"jitterIN",value:2.5,useVariable:"jitterIN"},{name:"jitterSpeed",value:2,useVariable:"jitterSpeed"}],portsOut:[{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"a6c7db36-3966-413c-83e3-52fa8c9f6779",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"scale",value:5.81},{name:"scrollX",value:2.6},{name:"repeat",value:1},{name:"aspect",value:1},{name:"Layer 1",value:true},{name:"Layer 2",value:true},{name:"Layer 3",value:true},{name:"Layer 4",value:true},{name:"Tileable",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"6f149f4f-ba5a-481e-8681-f0534e891968",objOut:"a6c7db36-3966-413c-83e3-52fa8c9f6779"}]}],objName:"Ops.Gl.TextureEffects.Noise.FBMNoise"},{id:"c3162f87-13c0-457c-a774-8ac65296a217",uiAttribs:{},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:600},{name:"Height",value:600},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"a6c7db36-3966-413c-83e3-52fa8c9f6779",objOut:"c3162f87-13c0-457c-a774-8ac65296a217"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"099d01e3-b909-46ed-aa50-0411506c74a1",objOut:"c3162f87-13c0-457c-a774-8ac65296a217"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"b3490361-796e-4bdb-a0ee-03bf2ddb350a",uiAttribs:{},portsIn:[{name:"Speed",value:3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"anim",portOut:"Time",objIn:"a6c7db36-3966-413c-83e3-52fa8c9f6779",objOut:"b3490361-796e-4bdb-a0ee-03bf2ddb350a"}]}],objName:"Ops.Anim.Timer_v2"},{id:"05808aae-aeae-4ba3-974b-e9210aa3a238",uiAttribs:{},portsIn:[{name:"Speed",value:.07},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"scrollY",portOut:"Time",objIn:"a6c7db36-3966-413c-83e3-52fa8c9f6779",objOut:"05808aae-aeae-4ba3-974b-e9210aa3a238"},{portIn:"Time",portOut:"Time",objIn:"6f149f4f-ba5a-481e-8681-f0534e891968",objOut:"05808aae-aeae-4ba3-974b-e9210aa3a238"}]}],objName:"Ops.Anim.Timer_v2"},{id:"6f149f4f-ba5a-481e-8681-f0534e891968",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:.485},{name:"Movement",value:.403},{name:"Num",value:71.79},{name:"seed",value:0},{name:"Fill index",value:1},{name:"Fill",value:"Random"},{name:"Draw Isolines",value:true},{name:"Draw Distance",value:false},{name:"Draw Center",value:0}],objName:"Ops.Gl.TextureEffects.Noise.Voronoise"},{id:"6cd334f4-8f39-4d08-bc67-0d0fe1c6da7a",uiAttribs:{},portsIn:[{name:"Variable",value:"maskk"}],objName:"Ops.Vars.VarSetTexture_v2"},{id:"7a3ce484-a0ad-41cb-9a59-9845bca7ab74",uiAttribs:{},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"099d01e3-b909-46ed-aa50-0411506c74a1",objOut:"7a3ce484-a0ad-41cb-9a59-9845bca7ab74"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"f5f3a926-b087-46da-929a-5a4af111a60c",objOut:"7a3ce484-a0ad-41cb-9a59-9845bca7ab74"},{portIn:"Image",portOut:"texture_out",objIn:"5e957658-f6c7-4955-ac96-8a0038730146",objOut:"7a3ce484-a0ad-41cb-9a59-9845bca7ab74"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"099d01e3-b909-46ed-aa50-0411506c74a1",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"bbca3a15-f573-41ec-af48-90317eaed879",objOut:"099d01e3-b909-46ed-aa50-0411506c74a1"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"5d722dbe-9b1d-43bc-b9b9-ab143254fcea",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:.888},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"f5f3a926-b087-46da-929a-5a4af111a60c",uiAttribs:{},portsIn:[{name:"use original size",value:true},{name:"width",value:640},{name:"height",value:640},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"A"},{name:"Convert Greyscale index",value:0},{name:"Convert Greyscale",value:"Off"},{name:"Invert R",value:false},{name:"Invert G",value:false},{name:"Invert B",value:false},{name:"Invert A",value:false}],portsOut:[{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"5d722dbe-9b1d-43bc-b9b9-ab143254fcea",objOut:"f5f3a926-b087-46da-929a-5a4af111a60c"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.Textures.CopyTexture"},{id:"bbca3a15-f573-41ec-af48-90317eaed879",uiAttribs:{},portsIn:[{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"scale",value:1.005},{name:"rotX",value:0},{name:"rotY",value:-4.26},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"cef66228-8937-4723-8131-2b723817cbcc",objOut:"bbca3a15-f573-41ec-af48-90317eaed879"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"cef66228-8937-4723-8131-2b723817cbcc",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Strength",value:6},{name:"Width",value:.041},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"3748c2c0-dbfe-4744-98cd-428fa2b2ce58",objOut:"cef66228-8937-4723-8131-2b723817cbcc"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"16f19392-0657-4382-b023-42ade7251c3a",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:.287},{name:"Strength",value:25},{name:"Width",value:0},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"5d722dbe-9b1d-43bc-b9b9-ab143254fcea",objOut:"16f19392-0657-4382-b023-42ade7251c3a"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"f0bf4c58-425e-4655-9bad-ea2531116d99",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:.5},{name:"Strength",value:4},{name:"Width",value:.028},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"757c6214-34ca-4aa2-9c74-4a81de79682a",objOut:"f0bf4c58-425e-4655-9bad-ea2531116d99"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"d2e0bbce-2969-4956-afd3-c2883932d30d",uiAttribs:{},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"5e957658-f6c7-4955-ac96-8a0038730146",objOut:"d2e0bbce-2969-4956-afd3-c2883932d30d"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"760461ab-11fb-4989-9f81-096079338555",objOut:"d2e0bbce-2969-4956-afd3-c2883932d30d"},{portIn:"Texture",portOut:"texture_out",objIn:"cf477bc8-5a74-4dda-8bc8-7356d1a35089",objOut:"d2e0bbce-2969-4956-afd3-c2883932d30d"},{portIn:"Image",portOut:"texture_out",objIn:"adb423db-54eb-4415-ae7f-b47b9c6ce880",objOut:"d2e0bbce-2969-4956-afd3-c2883932d30d"},{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"778fd33c-9190-4f47-bd6f-a11b177417c7",objOut:"d2e0bbce-2969-4956-afd3-c2883932d30d"},{portIn:"Image",portOut:"texture_out",objIn:"871fc9fe-b12d-463c-a033-3854157c7e65",objOut:"d2e0bbce-2969-4956-afd3-c2883932d30d"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"5e957658-f6c7-4955-ac96-8a0038730146",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"f0bf4c58-425e-4655-9bad-ea2531116d99",objOut:"5e957658-f6c7-4955-ac96-8a0038730146"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"757c6214-34ca-4aa2-9c74-4a81de79682a",uiAttribs:{},portsIn:[{name:"span index",value:0},{name:"span",value:"16"},{name:"reduceMin",value:128.17},{name:"reduceMul",value:8},{name:"use viewport size",value:true},{name:"width",value:0},{name:"height",value:0}],objName:"Ops.Gl.TextureEffects.FXAA"},{id:"bf1c6ab5-c1c3-43bf-bf58-a689348adbe6",uiAttribs:{},portsIn:[{name:"Strength",value:4}],objName:"Ops.Gl.TextureEffects.ToNormalMap"},{id:"654ea0b9-d0c4-413e-8211-37db694e21f3",uiAttribs:{},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"760461ab-11fb-4989-9f81-096079338555",objOut:"654ea0b9-d0c4-413e-8211-37db694e21f3"}]},{name:"texture_out",links:[{portIn:"Normal Map",portOut:"texture_out",objIn:"778fd33c-9190-4f47-bd6f-a11b177417c7",objOut:"654ea0b9-d0c4-413e-8211-37db694e21f3"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"760461ab-11fb-4989-9f81-096079338555",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"bf1c6ab5-c1c3-43bf-bf58-a689348adbe6",objOut:"760461ab-11fb-4989-9f81-096079338555"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"69f1a674-9d6b-4d31-aa23-d298d9d2c75d",uiAttribs:{},portsIn:[{name:"posX",value:-1.4},{name:"posY",value:.6},{name:"posZ",value:0},{name:"scale",value:1.75},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"c8fd2e59-7e41-4940-a384-c3c13902ebd2",objOut:"69f1a674-9d6b-4d31-aa23-d298d9d2c75d"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"86579980-c684-46e6-a975-005b0108a751",uiAttribs:{},portsIn:[{name:"use viewport size",value:true},{name:"texture width",value:833},{name:"texture height",value:447},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"2x"},{name:"HDR",value:false,title:"Pixelformat Float 32bit"},{name:"Depth",value:false},{name:"Clear",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"9c75130a-d6f1-48fd-87df-99589934810e",objOut:"86579980-c684-46e6-a975-005b0108a751"}]},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"4b8ade56-bbbe-4a0e-882c-d01137795609",objOut:"86579980-c684-46e6-a975-005b0108a751"}]}],objName:"Ops.Gl.RenderToTexture"},{id:"778fd33c-9190-4f47-bd6f-a11b177417c7",uiAttribs:{},portsIn:[{name:"R",value:.901846578794093},{name:"G",value:.9959996744195572},{name:"B",value:.9538190827418381},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:1},{name:"Roughness",value:1},{name:"Active",value:true},{name:"Fresnel Intensity",value:.262},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.192},{name:"Emissive R",value:.30306337573044023},{name:"Emissive G",value:.6226663355231237},{name:"Emissive B",value:.5408479623096425},{name:"Shininess",value:5.16},{name:"Specular Amount",value:.303},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.303},{name:"AO Intensity",value:1},{name:"AO UV Channel index",value:0},{name:"AO UV Channel",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"Render",portOut:"Trigger Out",objIn:"cf477bc8-5a74-4dda-8bc8-7356d1a35089",objOut:"778fd33c-9190-4f47-bd6f-a11b177417c7"}]}],objName:"Ops.Gl.Phong.PhongMaterial_v6"},{id:"cf477bc8-5a74-4dda-8bc8-7356d1a35089",uiAttribs:{},portsIn:[{name:"Mode index",value:0},{name:"Mode",value:"Norm"},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Coordinates index",value:0},{name:"Coordinates",value:"Tex Coords"},{name:"Channel index",value:0},{name:"Channel",value:"Luminance"},{name:"Flip index",value:0},{name:"Flip",value:"None"},{name:"Range index",value:0},{name:"Range",value:"0-1"},{name:"Offset X",value:0},{name:"Offset Y",value:0},{name:"Scale",value:1},{name:"Calc Normals",value:false},{name:"Normal Axis index",value:2},{name:"Normal Axis",value:"Z"},{name:"Discard Zero Values",value:false},{name:"colorize",value:false},{name:"Colorize Min",value:0},{name:"Colorize Max",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"ef912e1d-abc8-4fa5-b34b-b9e94a22cee2",objOut:"cf477bc8-5a74-4dda-8bc8-7356d1a35089"}]}],objName:"Ops.Gl.ShaderEffects.VertexDisplacementMap_v4"},{id:"c8fd2e59-7e41-4940-a384-c3c13902ebd2",uiAttribs:{},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.83},{name:"Radius",value:7.67},{name:"X",value:-1.35},{name:"Y",value:3.04},{name:"Z",value:.45},{name:"R",value:.48623007962450515},{name:"G",value:.6330214854460751},{name:"B",value:1},{name:"Specular R",value:.3057815379338912},{name:"Specular G",value:.4100902594355548},{name:"Specular B",value:.9266666655739149},{name:"Falloff",value:.383},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"ee4259a6-5f20-48c1-9ec0-e7efb850d1aa",objOut:"c8fd2e59-7e41-4940-a384-c3c13902ebd2"}]},{name:"World Position X",value:-3.762500047683716},{name:"World Position Y",value:5.920000076293945},{name:"World Position Z",value:.7874999642372131}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"ee4259a6-5f20-48c1-9ec0-e7efb850d1aa",uiAttribs:{},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.71},{name:"Radius",value:40.62},{name:"X",value:-1.34},{name:"Y",value:-1.39},{name:"Z",value:.78},{name:"R",value:.9959996744195572},{name:"G",value:.8110593251417859},{name:"B",value:.7687872453068667},{name:"Specular R",value:1},{name:"Specular G",value:1},{name:"Specular B",value:1},{name:"Falloff",value:.49},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"07002a1d-036f-4491-8aba-91e760cb42a6",objOut:"ee4259a6-5f20-48c1-9ec0-e7efb850d1aa"}]},{name:"World Position X",value:-3.745000123977661},{name:"World Position Y",value:-1.8324999809265137},{name:"World Position Z",value:1.3650000095367432}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"07002a1d-036f-4491-8aba-91e760cb42a6",uiAttribs:{},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.55},{name:"Radius",value:23.56},{name:"X",value:2.07},{name:"Y",value:-.2},{name:"Z",value:1.9},{name:"R",value:.8357590921577018},{name:"G",value:.9746666662891705},{name:"B",value:.8241834609800793},{name:"Specular R",value:.7213291625519593},{name:"Specular G",value:.9639755625300043},{name:"Specular B",value:.9906666665275892},{name:"Falloff",value:0},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"778fd33c-9190-4f47-bd6f-a11b177417c7",objOut:"07002a1d-036f-4491-8aba-91e760cb42a6"}]},{name:"World Position X",value:2.2224998474121094},{name:"World Position Y",value:.2500000298023224},{name:"World Position Z",value:3.325000047683716}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"e347a803-554e-4a01-acf5-d154558d71fd",uiAttribs:{},portsIn:[{name:"Type index",value:0},{name:"Type",value:"sine"},{name:"Phase",value:0},{name:"Amplitude",value:.02}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"b0f3d92e-30d6-4061-b98b-88ea703fadbf",objOut:"e347a803-554e-4a01-acf5-d154558d71fd"}]}],objName:"Ops.Anim.LFO"},{id:"468e0c65-23b0-43f8-905e-96f77541b29c",uiAttribs:{},portsIn:[{name:"Speed",value:.3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Time",portOut:"Time",objIn:"e347a803-554e-4a01-acf5-d154558d71fd",objOut:"468e0c65-23b0-43f8-905e-96f77541b29c"}]}],objName:"Ops.Anim.Timer_v2"},{id:"b0f3d92e-30d6-4061-b98b-88ea703fadbf",uiAttribs:{},portsIn:[{name:"number2",value:.01}],portsOut:[{name:"result",links:[{portIn:"Extrude",portOut:"result",objIn:"cf477bc8-5a74-4dda-8bc8-7356d1a35089",objOut:"b0f3d92e-30d6-4061-b98b-88ea703fadbf"}]}],objName:"Ops.Math.Sum"},{id:"9c75130a-d6f1-48fd-87df-99589934810e",uiAttribs:{},portsIn:[{name:"r",value:.023621637220568887},{name:"g",value:.010050449739482093},{name:"b",value:.02533331880966827},{name:"a",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"69f1a674-9d6b-4d31-aa23-d298d9d2c75d",objOut:"9c75130a-d6f1-48fd-87df-99589934810e"}]}],objName:"Ops.Gl.ClearColor"},{id:"14c4c58d-3b51-4379-a204-9a57f0453760",uiAttribs:{},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.002,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.15,"r":0.30588235294117655,"g":0.3935058951120749,"b":0.6901960784313725},{"pos":0.196,"r":0.16078431372549018,"g":0.4627450980392157,"b":0.3286744943074153},{"pos":0.432,"r":0.363691178443945,"g":0.20357707594403382,"b":0.468666658749183},{"pos":0.492,"r":0.5372549019607843,"g":0.27843137254901956,"b":0.4906667962078974},{"pos":0.524,"r":0.676666580468415,"g":0.31930203733338675,"b":0.3721919905054923},{"pos":0.582,"r":0.29411764705882354,"g":0.3803921568627451,"b":0.3669332450235579},{"pos":0.894,"r":0.21176470588235294,"g":0.34858096860858423,"b":0.596078431372549},{"pos":0.97,"r":0.42352941176470593,"g":1,"b":0.9100699981654309},{"pos":1,"r":0.42352941176470593,"g":1,"b":0.9100699981654309}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Gradient Array",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"a3e611e7-aa37-43d7-b0a4-02de936c1860",objOut:"14c4c58d-3b51-4379-a204-9a57f0453760"}]}],objName:"Ops.Gl.GradientTexture"},{id:"6a501dff-55db-40f8-90d6-892c53c1750b",uiAttribs:{},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"adb423db-54eb-4415-ae7f-b47b9c6ce880",objOut:"6a501dff-55db-40f8-90d6-892c53c1750b"}]},{name:"texture_out",links:[{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"778fd33c-9190-4f47-bd6f-a11b177417c7",objOut:"6a501dff-55db-40f8-90d6-892c53c1750b"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"adb423db-54eb-4415-ae7f-b47b9c6ce880",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"a3e611e7-aa37-43d7-b0a4-02de936c1860",objOut:"adb423db-54eb-4415-ae7f-b47b9c6ce880"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"a3e611e7-aa37-43d7-b0a4-02de936c1860",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"871fc9fe-b12d-463c-a033-3854157c7e65",objOut:"a3e611e7-aa37-43d7-b0a4-02de936c1860"}]}],objName:"Ops.Gl.TextureEffects.ColorMap"},{id:"871fc9fe-b12d-463c-a033-3854157c7e65",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:true},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"a102e81c-a83c-4602-b3be-55468e2f1711",uiAttribs:{},portsIn:[{name:"amount",value:2.5},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"direction index",value:0},{name:"direction",value:"horizontal"}],objName:"Ops.Gl.TextureEffects.FastBlur"},{id:"01b15a97-e8cb-465a-9dd0-228c90de109a",uiAttribs:{},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"a7cca56d-d6b0-4ca7-806c-2c6935b0c8fe",objOut:"01b15a97-e8cb-465a-9dd0-228c90de109a"}]},{name:"texture_out",links:[{portIn:"Mask",portOut:"texture_out",objIn:"871fc9fe-b12d-463c-a033-3854157c7e65",objOut:"01b15a97-e8cb-465a-9dd0-228c90de109a"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"a7cca56d-d6b0-4ca7-806c-2c6935b0c8fe",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"a102e81c-a83c-4602-b3be-55468e2f1711",objOut:"a7cca56d-d6b0-4ca7-806c-2c6935b0c8fe"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"e541e890-60fd-4525-92ca-362c42d8d084",uiAttribs:{subPatch:"53fe52bf-7e14-4395-8540-8fd6933a628b"},portsIn:[{name:"Variable",value:"lungLevel"}],portsOut:[{name:"Value",value:10}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"c5412925-7fc8-479a-a7f7-3c6386964e36",uiAttribs:{},portsIn:[{name:"File",value:"assets/61eb0ee05dc6775955719066_Portada.png",display:"file"},{name:"Filter index",value:0},{name:"Filter",value:"mipmap"},{name:"Wrap index",value:2},{name:"Wrap",value:"repeat"},{name:"Anisotropic index",value:0},{name:"Anisotropic",value:0},{name:"Data Format index",value:3},{name:"Data Format",value:"RGBA"},{name:"Flip",value:false},{name:"Pre Multiplied Alpha",value:false},{name:"Active",value:true},{name:"Save Memory",value:true}],portsOut:[{name:"Texture",links:[{portIn:"Texture",portOut:"Texture",objIn:"f2de87f6-2683-4c85-984b-f1c0ad256056",objOut:"c5412925-7fc8-479a-a7f7-3c6386964e36"}]},{name:"Width",value:640},{name:"Height",value:640},{name:"Aspect Ratio",value:1},{name:"Loaded",value:true},{name:"Loading",value:false}],objName:"Ops.Gl.Texture_v2"},{id:"b4318ace-24c1-4f57-973e-3cedcc669321",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"exclusion"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:.99},{name:"Scale Y",value:.99},{name:"Position X",value:.001},{name:"Position Y",value:.001},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"16f19392-0657-4382-b023-42ade7251c3a",objOut:"b4318ace-24c1-4f57-973e-3cedcc669321"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"3748c2c0-dbfe-4744-98cd-428fa2b2ce58",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"amount",value:.932},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"b3303e58-3ef0-4b51-94c2-1aa63bfce2b5",objOut:"3748c2c0-dbfe-4744-98cd-428fa2b2ce58"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"b3303e58-3ef0-4b51-94c2-1aa63bfce2b5",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"hardlight"},{name:"amount",value:.252},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:1.05},{name:"Scale Y",value:1.05},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"b4318ace-24c1-4f57-973e-3cedcc669321",objOut:"b3303e58-3ef0-4b51-94c2-1aa63bfce2b5"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"ef912e1d-abc8-4fa5-b34b-b9e94a22cee2",uiAttribs:{},portsIn:[{name:"radius",value:.2},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v2"},{id:"e2dd6138-a9ca-4fa6-af86-26f7007908d5",uiAttribs:{},portsIn:[{name:"PreRender Ops",value:false},{name:"Play Timeline",value:true}],portsOut:[{name:"Finished Initial Loading",value:1},{name:"Loading",value:0},{name:"Progress",value:1}],objName:"Ops.Cables.LoadingStatus_v2"},{id:"3261db96-2b41-4f37-8f19-403e30c0ed27",uiAttribs:{},portsIn:[{name:"URL",value:"wss://bauplan-socket.onrender.com"}],portsOut:[{name:"Result",links:[{portIn:"Data",portOut:"Result",objIn:"539da7a1-966a-47a4-a59a-1e735d36dc08",objOut:"3261db96-2b41-4f37-8f19-403e30c0ed27"},{portIn:"Object",portOut:"Result",objIn:"0230d382-f534-4aa3-94f1-d1ca95edacaf",objOut:"3261db96-2b41-4f37-8f19-403e30c0ed27"},{portIn:"Object",portOut:"Result",objIn:"a270301b-2733-4b3d-aeaf-979cb43a7c5f",objOut:"3261db96-2b41-4f37-8f19-403e30c0ed27"}]},{name:"Connected",value:0},{name:"Valid JSON",value:0},{name:"Received Data",links:[{portIn:"exe",portOut:"Received Data",objIn:"2e448380-4dbf-43bf-ab1d-bc5072c86eb3",objOut:"3261db96-2b41-4f37-8f19-403e30c0ed27"}]},{name:"Raw Data",value:"ping"}],objName:"Ops.Net.WebSocket.WebSocket_v2"},{id:"539da7a1-966a-47a4-a59a-1e735d36dc08",uiAttribs:{},portsIn:[{name:"Key",value:"bestiary"}],portsOut:[{name:"Found",links:[{portIn:"boolean",portOut:"Found",objIn:"2e448380-4dbf-43bf-ab1d-bc5072c86eb3",objOut:"539da7a1-966a-47a4-a59a-1e735d36dc08"}]}],objName:"Ops.Json.ObjectGetNumber_v2"},{id:"cfde3052-fba7-4949-b354-d7e69f95dc94",uiAttribs:{},portsIn:[{name:"title",value:"C"},{name:"text",value:"Var get is bugged, it slows down performance"}],objName:"Ops.Ui.Comment_v2"},{id:"c4fb5858-3199-4a25-aa06-97c34f218a3e",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"hardlight"},{name:"amount",value:.252},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:1.05},{name:"Scale Y",value:1.05},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"c9c54575-d9f4-4705-a8ab-91c546e1b892",objOut:"c4fb5858-3199-4a25-aa06-97c34f218a3e"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"ee288fe7-da95-4fec-8e7f-8ed4234905c0",uiAttribs:{},portsIn:[{name:"Variable",value:"maskk"}],portsOut:[{name:"Value",links:[{portIn:"Mask",portOut:"Value",objIn:"c4fb5858-3199-4a25-aa06-97c34f218a3e",objOut:"ee288fe7-da95-4fec-8e7f-8ed4234905c0"},{portIn:"Image",portOut:"Value",objIn:"c4fb5858-3199-4a25-aa06-97c34f218a3e",objOut:"ee288fe7-da95-4fec-8e7f-8ed4234905c0"},{portIn:"Image",portOut:"Value",objIn:"2aef623d-5e76-4b67-8b67-07255ec16b3b",objOut:"ee288fe7-da95-4fec-8e7f-8ed4234905c0"},{portIn:"Mask",portOut:"Value",objIn:"c9c54575-d9f4-4705-a8ab-91c546e1b892",objOut:"ee288fe7-da95-4fec-8e7f-8ed4234905c0"},{portIn:"Image",portOut:"Value",objIn:"c9c54575-d9f4-4705-a8ab-91c546e1b892",objOut:"ee288fe7-da95-4fec-8e7f-8ed4234905c0"}]}],objName:"Ops.Vars.VarGetTexture_v2"},{id:"2aef623d-5e76-4b67-8b67-07255ec16b3b",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"amount",value:.932},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"c4fb5858-3199-4a25-aa06-97c34f218a3e",objOut:"2aef623d-5e76-4b67-8b67-07255ec16b3b"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"c9c54575-d9f4-4705-a8ab-91c546e1b892",uiAttribs:{},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"exclusion"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:.99},{name:"Scale Y",value:.99},{name:"Position X",value:.001},{name:"Position Y",value:.001},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"4l8x6ffyp",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsOut:[{name:"create port",value:0},{name:"in0 Sequence exe",links:[{portIn:"exe",portOut:"in0 Sequence exe",objIn:"nwb29izxf",objOut:"4l8x6ffyp"}]},{name:"in1 BauShader metaBlur",links:[{portIn:"metaBlur",portOut:"in1 BauShader metaBlur",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in2 BauShader complexityA",links:[{portIn:"complexityA",portOut:"in2 BauShader complexityA",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in3 BauShader complexityB",links:[{portIn:"complexityB",portOut:"in3 BauShader complexityB",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in4 BauShader complexityC",links:[{portIn:"complexityC",portOut:"in4 BauShader complexityC",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in5 BauShader bauScale",links:[{portIn:"bauScale",portOut:"in5 BauShader bauScale",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in6 BauShader boneWeight",links:[{portIn:"boneWeight",portOut:"in6 BauShader boneWeight",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in7 BauShader jointWeight",links:[{portIn:"jointWeight",portOut:"in7 BauShader jointWeight",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in8 BauShader randomSeed",links:[{portIn:"randomSeed",portOut:"in8 BauShader randomSeed",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in9 BauShader distortionVal",links:[{portIn:"distortionVal",portOut:"in9 BauShader distortionVal",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in10 BauShader distortionVal2",links:[{portIn:"distortionVal2",portOut:"in10 BauShader distortionVal2",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in11 BauShader angleIN",links:[{portIn:"angleIN",portOut:"in11 BauShader angleIN",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in12 BauShader jointX",links:[{portIn:"jointX",portOut:"in12 BauShader jointX",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in13 BauShader jointY",links:[{portIn:"jointY",portOut:"in13 BauShader jointY",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in14 BauShader contraction",links:[{portIn:"contraction",portOut:"in14 BauShader contraction",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in15 BauShader rotateEach",links:[{portIn:"rotateEach",portOut:"in15 BauShader rotateEach",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in16 BauShader jitterIN",links:[{portIn:"jitterIN",portOut:"in16 BauShader jitterIN",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in17 BauShader jitterSpeed",links:[{portIn:"jitterSpeed",portOut:"in17 BauShader jitterSpeed",objIn:"nykzzwzwu",objOut:"4l8x6ffyp"}]},{name:"in18 Ops.Gl.Matrix.Transform posX"},{name:"in19 Ops.Gl.Matrix.Transform posY"}],objName:"Ops.Ui.PatchInput"},{id:"zndmo9ag0",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"create port",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"xxedzm42u",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Sequence exe","type":1},{"name":"in1 BauShader metaBlur","type":0,"value":0.3},{"name":"in2 BauShader complexityA","type":0,"value":1.65},{"name":"in3 BauShader complexityB","type":0,"value":0.85},{"name":"in4 BauShader complexityC","type":0,"value":4.09},{"name":"in5 BauShader bauScale","type":0,"value":0.38},{"name":"in6 BauShader boneWeight","type":0,"value":0.01},{"name":"in7 BauShader jointWeight","type":0,"value":6.48},{"name":"in8 BauShader randomSeed","type":0,"value":0.92},{"name":"in9 BauShader distortionVal","type":0,"value":0.92},{"name":"in10 BauShader distortionVal2","type":0},{"name":"in11 BauShader angleIN","type":0,"value":0.42},{"name":"in12 BauShader jointX","type":0},{"name":"in13 BauShader jointY","type":0},{"name":"in14 BauShader contraction","type":0,"value":1.07},{"name":"in15 BauShader rotateEach","type":0,"value":-4.39},{"name":"in16 BauShader jitterIN","type":0,"value":5.07},{"name":"in17 BauShader jitterSpeed","type":0,"value":11.64},{"name":"in18 Ops.Gl.Matrix.Transform posX","type":0,"value":0},{"name":"in19 Ops.Gl.Matrix.Transform posY","type":0,"value":0}],"portsOut":[{"name":"out0 ImageCompose texture_out","type":2,"objType":"texture"}]}'},{name:"patchId",value:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"}],portsOut:[{name:"create port out",value:0},{name:"out0 ImageCompose texture_out",links:[{portIn:"Texture 2",portOut:"out0 ImageCompose texture_out",objIn:"5672d089-99d0-49c9-97cf-43a0455c1a46",objOut:"xxedzm42u"}]}],objName:"Ops.Ui.SubPatch"},{id:"nwb29izxf",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsOut:[{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"nykzzwzwu",objOut:"nwb29izxf"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"raht5eca6",objOut:"nwb29izxf"}]},{name:"trigger 6",links:[{portIn:"render",portOut:"trigger 6",objIn:"qiv7iiq17",objOut:"nwb29izxf"}]},{name:"trigger 7",links:[{portIn:"Render",portOut:"trigger 7",objIn:"qe4949fdb",objOut:"nwb29izxf"}]},{name:"trigger 8",links:[{portIn:"Render",portOut:"trigger 8",objIn:"e34f4hc9b",objOut:"nwb29izxf"}]},{name:"trigger 9",links:[{portIn:"Render",portOut:"trigger 9",objIn:"rko73vc0o",objOut:"nwb29izxf"}]},{name:"trigger 10",links:[{portIn:"Render",portOut:"trigger 10",objIn:"ds2f2t7n3",objOut:"nwb29izxf"}]},{name:"trigger 11",links:[{portIn:"render",portOut:"trigger 11",objIn:"hpsz6xz60",objOut:"nwb29izxf"}]},{name:"trigger 13",links:[{portIn:"Render",portOut:"trigger 13",objIn:"zf76voat2",objOut:"nwb29izxf"}]}],objName:"Ops.Trigger.Sequence"},{id:"zf76voat2",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"tv6ndc4xx",objOut:"zf76voat2"}]},{name:"texture_out",links:[{portIn:"out0 ImageCompose texture_out",portOut:"texture_out",objIn:"zndmo9ag0",objOut:"zf76voat2"}]},{name:"Aspect Ratio",value:1.8635346756152125}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"to2iqy0qw",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use Viewport Size",value:false},{name:"Width",value:360},{name:"Height",value:360},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"vsrbba17l",objOut:"to2iqy0qw"}]},{name:"Texture",links:[{portIn:"Image",portOut:"Texture",objIn:"l239s8kjh",objOut:"to2iqy0qw"},{portIn:"Image",portOut:"Texture",objIn:"picx5sco3",objOut:"to2iqy0qw"},{portIn:"Mask",portOut:"Texture",objIn:"picx5sco3",objOut:"to2iqy0qw"},{portIn:"Image",portOut:"Texture",objIn:"ywqnfqtwk",objOut:"to2iqy0qw"},{portIn:"Mask",portOut:"Texture",objIn:"ywqnfqtwk",objOut:"to2iqy0qw"},{portIn:"Image",portOut:"Texture",objIn:"4xtcnizce",objOut:"to2iqy0qw"}]}],objName:"Ops.Gl.Shader.ShaderToTexture"},{id:"tv6ndc4xx",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:.06},{name:"Position Y",value:.06},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"nykzzwzwu",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float distortionVal2;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\nUNI float jitterIN;\nUNI float jitterSpeed;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,\n    \t4.,float(complexityB))); // map rand float to 4-complexityB as maxnumber\n    \t\n        for(int v=0;v< exLength;v++){ // extremity joint no.\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse jitter\n            a += smoothstep(.1,1.,sin(iTime*(srand(i++)*jitterSpeed))) // \n            * srand(i++)*jitterIN // JitterIN controls jitterRange\n            *map(float(v),0.,float(exLength),0.1,1.); // maps 0-exlength to 0.1-1 so that there's more jitterRange in tip joints\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                vec2 tempuv = _uv;\n                \n                //distorting whole uv\n                float x1 = tempuv.x;\n                \n                float mx1 = x1 < 0. ?  // stich x distortion in in half\n                sin(-2.*iTime+x1*distortionVal2)*.1 :\n                sin(2.*iTime+x1*distortionVal2)*-.1;\n                \n                float y1 = tempuv.y;\n                y1 += mx1*(distortionVal2/60.);   // higher y distortion for swimming effect\n                //y1 += mx1*.4;\n                float my1 = sin(5.*iTime+y1*10.)*.1;\n                x1 += my1*.01;  // low x distortion for watery effect\n                tempuv = vec2(x1,y1);\n                \n \n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                } \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting rotated uv\n                 float x = uv.x;\n                // //float m = (x-.1)*(x+.1); // this makes symmetry drift\n                 float mx = x*x;\n                 float y = uv.y + (mx*distortionVal);\n                 float my = y*y;\n                 x = x + (my*distortionVal); // distorts only Y axis bc of symmetyr\n                 uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",useVariable:"metaBlur"},{name:"complexityA",useVariable:"complexityA"},{name:"complexityB",useVariable:"complexityB"},{name:"complexityC",useVariable:"complexityC"},{name:"bauScale",useVariable:"bauScale"},{name:"boneWeight",useVariable:"boneWeight"},{name:"jointWeight",useVariable:"jointWeight"},{name:"distortionVal",useVariable:"distortionVal"},{name:"distortionVal2",useVariable:"distortionVal2"},{name:"angleIN",useVariable:"angleIN"},{name:"jointX",useVariable:"jointX"},{name:"jointY",useVariable:"jointY"},{name:"contraction",useVariable:"contraction"},{name:"rotateEach",useVariable:"rotateEach"},{name:"jitterIN",useVariable:"jitterIN"},{name:"jitterSpeed",useVariable:"jitterSpeed"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"to2iqy0qw",objOut:"nykzzwzwu"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"to2iqy0qw",objOut:"nykzzwzwu"}]},{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"nhp3jrpv4",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"scale",value:5.81},{name:"scrollX",value:2.6},{name:"repeat",value:1},{name:"aspect",value:1},{name:"Layer 1",value:true},{name:"Layer 2",value:true},{name:"Layer 3",value:true},{name:"Layer 4",value:true},{name:"Tileable",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"dvn6ws1fg",objOut:"nhp3jrpv4"}]}],objName:"Ops.Gl.TextureEffects.Noise.FBMNoise"},{id:"vsrbba17l",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:600},{name:"Height",value:600},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"nhp3jrpv4",objOut:"vsrbba17l"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"3nyo6o51b",objOut:"vsrbba17l"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"aoncgocvi",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Speed",value:3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"anim",portOut:"Time",objIn:"nhp3jrpv4",objOut:"aoncgocvi"}]}],objName:"Ops.Anim.Timer_v2"},{id:"zojdpmx7r",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Speed",value:.07},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"scrollY",portOut:"Time",objIn:"nhp3jrpv4",objOut:"zojdpmx7r"},{portIn:"Time",portOut:"Time",objIn:"dvn6ws1fg",objOut:"zojdpmx7r"}]}],objName:"Ops.Anim.Timer_v2"},{id:"dvn6ws1fg",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:.485},{name:"Movement",value:.403},{name:"Num",value:71.79},{name:"seed",value:0},{name:"Fill index",value:1},{name:"Fill",value:"Random"},{name:"Draw Isolines",value:true},{name:"Draw Distance",value:false},{name:"Draw Center",value:0}],objName:"Ops.Gl.TextureEffects.Noise.Voronoise"},{id:"o9m1824yr",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Variable",value:"maskk"}],objName:"Ops.Vars.VarSetTexture_v2"},{id:"raht5eca6",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"3nyo6o51b",objOut:"raht5eca6"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"qiv7iiq17",objOut:"raht5eca6"},{portIn:"Image",portOut:"texture_out",objIn:"xtrzu76x1",objOut:"raht5eca6"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"3nyo6o51b",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"6dgom0nwt",objOut:"3nyo6o51b"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"f7xn2lj3o",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:.888},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"qiv7iiq17",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"use original size",value:true},{name:"width",value:640},{name:"height",value:640},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"A"},{name:"Convert Greyscale index",value:0},{name:"Convert Greyscale",value:"Off"},{name:"Invert R",value:false},{name:"Invert G",value:false},{name:"Invert B",value:false},{name:"Invert A",value:false}],portsOut:[{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"f7xn2lj3o",objOut:"qiv7iiq17"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.Textures.CopyTexture"},{id:"6dgom0nwt",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"scale",value:1.005},{name:"rotX",value:0},{name:"rotY",value:-4.26},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"26or5626o",objOut:"6dgom0nwt"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"26or5626o",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Strength",value:6},{name:"Width",value:.041},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"l239s8kjh",objOut:"26or5626o"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"kdta6awvg",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:.287},{name:"Strength",value:25},{name:"Width",value:0},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"f7xn2lj3o",objOut:"kdta6awvg"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"op2907x3s",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:.5},{name:"Strength",value:4},{name:"Width",value:.028},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"o24km8fzi",objOut:"op2907x3s"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"qe4949fdb",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"xtrzu76x1",objOut:"qe4949fdb"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"f7gi8aqae",objOut:"qe4949fdb"},{portIn:"Texture",portOut:"texture_out",objIn:"umsb42lth",objOut:"qe4949fdb"},{portIn:"Image",portOut:"texture_out",objIn:"rhs6v22j9",objOut:"qe4949fdb"},{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"326kuv4ue",objOut:"qe4949fdb"},{portIn:"Image",portOut:"texture_out",objIn:"zkutif3so",objOut:"qe4949fdb"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"xtrzu76x1",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"op2907x3s",objOut:"xtrzu76x1"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"o24km8fzi",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"span index",value:0},{name:"span",value:"16"},{name:"reduceMin",value:128},{name:"reduceMul",value:8},{name:"use viewport size",value:true},{name:"width",value:0},{name:"height",value:0}],objName:"Ops.Gl.TextureEffects.FXAA"},{id:"xy3m41pse",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Strength",value:4}],objName:"Ops.Gl.TextureEffects.ToNormalMap"},{id:"e34f4hc9b",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"f7gi8aqae",objOut:"e34f4hc9b"}]},{name:"texture_out",links:[{portIn:"Normal Map",portOut:"texture_out",objIn:"326kuv4ue",objOut:"e34f4hc9b"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"f7gi8aqae",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"xy3m41pse",objOut:"f7gi8aqae"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"en77aqst2",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"posX",value:-.7},{name:"posY",value:-.2},{name:"posZ",value:0},{name:"scale",value:1.75},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"egxq020nt",objOut:"en77aqst2"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"hpsz6xz60",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"use viewport size",value:true},{name:"texture width",value:833},{name:"texture height",value:447},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"2x"},{name:"HDR",value:false,title:"Pixelformat Float 32bit"},{name:"Depth",value:false},{name:"Clear",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"en77aqst2",objOut:"hpsz6xz60"}]},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"tv6ndc4xx",objOut:"hpsz6xz60"}]}],objName:"Ops.Gl.RenderToTexture"},{id:"326kuv4ue",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"R",value:.901846578794093},{name:"G",value:.9959996744195572},{name:"B",value:.9538190827418381},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:1},{name:"Roughness",value:1},{name:"Active",value:true},{name:"Fresnel Intensity",value:.262},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.192},{name:"Emissive R",value:.30306337573044023},{name:"Emissive G",value:.6226663355231237},{name:"Emissive B",value:.5408479623096425},{name:"Shininess",value:3},{name:"Specular Amount",value:.658},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.303},{name:"AO Intensity",value:1},{name:"AO UV Channel index",value:0},{name:"AO UV Channel",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"Render",portOut:"Trigger Out",objIn:"umsb42lth",objOut:"326kuv4ue"}]}],objName:"Ops.Gl.Phong.PhongMaterial_v6"},{id:"umsb42lth",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Mode index",value:0},{name:"Mode",value:"Norm"},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Coordinates index",value:0},{name:"Coordinates",value:"Tex Coords"},{name:"Channel index",value:0},{name:"Channel",value:"Luminance"},{name:"Flip index",value:0},{name:"Flip",value:"None"},{name:"Range index",value:0},{name:"Range",value:"0-1"},{name:"Offset X",value:0},{name:"Offset Y",value:0},{name:"Scale",value:1},{name:"Calc Normals",value:false},{name:"Normal Axis index",value:2},{name:"Normal Axis",value:"Z"},{name:"Discard Zero Values",value:false},{name:"colorize",value:false},{name:"Colorize Min",value:0},{name:"Colorize Max",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"b49wdpbdb",objOut:"umsb42lth"}]}],objName:"Ops.Gl.ShaderEffects.VertexDisplacementMap_v4"},{id:"egxq020nt",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.83},{name:"Radius",value:7.67},{name:"X",value:-1.35},{name:"Y",value:3.04},{name:"Z",value:.45},{name:"R",value:.48623007962450515},{name:"G",value:.6330214854460751},{name:"B",value:1},{name:"Specular R",value:.3057815379338912},{name:"Specular G",value:.4100902594355548},{name:"Specular B",value:.9266666655739149},{name:"Falloff",value:.383},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"pn722hqen",objOut:"egxq020nt"}]},{name:"World Position X",value:-3.0625},{name:"World Position Y",value:5.119999885559082},{name:"World Position Z",value:.7874999642372131}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"pn722hqen",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.71},{name:"Radius",value:40.62},{name:"X",value:-1.34},{name:"Y",value:-1.39},{name:"Z",value:.78},{name:"R",value:.9959996744195572},{name:"G",value:.8110593251417859},{name:"B",value:.7687872453068667},{name:"Specular R",value:1},{name:"Specular G",value:1},{name:"Specular B",value:1},{name:"Falloff",value:.49},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"0sgmyxqrc",objOut:"pn722hqen"}]},{name:"World Position X",value:-3.0450000762939453},{name:"World Position Y",value:-2.632499933242798},{name:"World Position Z",value:1.3650000095367432}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"0sgmyxqrc",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.55},{name:"Radius",value:23.56},{name:"X",value:2.07},{name:"Y",value:-.2},{name:"Z",value:1.9},{name:"R",value:.8357590921577018},{name:"G",value:.9746666662891705},{name:"B",value:.8241834609800793},{name:"Specular R",value:.7213291625519593},{name:"Specular G",value:.9639755625300043},{name:"Specular B",value:.9906666665275892},{name:"Falloff",value:0},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"326kuv4ue",objOut:"0sgmyxqrc"}]},{name:"World Position X",value:2.922499895095825},{name:"World Position Y",value:-.550000011920929},{name:"World Position Z",value:3.325000047683716}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"c8r0fp3ih",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Type index",value:0},{name:"Type",value:"sine"},{name:"Phase",value:0},{name:"Amplitude",value:.02}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"9lpmg3s48",objOut:"c8r0fp3ih"}]}],objName:"Ops.Anim.LFO"},{id:"mccxwxn68",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Speed",value:.3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Time",portOut:"Time",objIn:"c8r0fp3ih",objOut:"mccxwxn68"}]}],objName:"Ops.Anim.Timer_v2"},{id:"9lpmg3s48",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"number2",value:.01}],portsOut:[{name:"result",links:[{portIn:"Extrude",portOut:"result",objIn:"umsb42lth",objOut:"9lpmg3s48"}]}],objName:"Ops.Math.Sum"},{id:"yj99qpa1r",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.002,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.15,"r":0.30588235294117655,"g":0.3935058951120749,"b":0.6901960784313725},{"pos":0.196,"r":0.16078431372549018,"g":0.4627450980392157,"b":0.3286744943074153},{"pos":0.432,"r":0.363691178443945,"g":0.20357707594403382,"b":0.468666658749183},{"pos":0.492,"r":0.5372549019607843,"g":0.27843137254901956,"b":0.4906667962078974},{"pos":0.524,"r":0.676666580468415,"g":0.31930203733338675,"b":0.3721919905054923},{"pos":0.582,"r":0.29411764705882354,"g":0.3803921568627451,"b":0.3669332450235579},{"pos":0.894,"r":0.21176470588235294,"g":0.34858096860858423,"b":0.596078431372549},{"pos":0.97,"r":0.42352941176470593,"g":1,"b":0.9100699981654309},{"pos":1,"r":0.42352941176470593,"g":1,"b":0.9100699981654309}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Gradient Array",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"0je32k353",objOut:"yj99qpa1r"}]}],objName:"Ops.Gl.GradientTexture"},{id:"ds2f2t7n3",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"rhs6v22j9",objOut:"ds2f2t7n3"}]},{name:"texture_out",links:[{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"326kuv4ue",objOut:"ds2f2t7n3"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"rhs6v22j9",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"0je32k353",objOut:"rhs6v22j9"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"0je32k353",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"zkutif3so",objOut:"0je32k353"}]}],objName:"Ops.Gl.TextureEffects.ColorMap"},{id:"zkutif3so",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:true},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"aitu32ohj",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"amount",value:2.5},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"direction index",value:0},{name:"direction",value:"horizontal"}],objName:"Ops.Gl.TextureEffects.FastBlur"},{id:"rko73vc0o",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"4xtcnizce",objOut:"rko73vc0o"}]},{name:"texture_out",links:[{portIn:"Mask",portOut:"texture_out",objIn:"zkutif3so",objOut:"rko73vc0o"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"4xtcnizce",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"aitu32ohj",objOut:"4xtcnizce"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"ywqnfqtwk",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"exclusion"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:.99},{name:"Scale Y",value:.99},{name:"Position X",value:.001},{name:"Position Y",value:.001},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"kdta6awvg",objOut:"ywqnfqtwk"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"l239s8kjh",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"amount",value:.932},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"picx5sco3",objOut:"l239s8kjh"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"picx5sco3",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"hardlight"},{name:"amount",value:.252},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:1.05},{name:"Scale Y",value:1.05},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"ywqnfqtwk",objOut:"picx5sco3"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"b49wdpbdb",uiAttribs:{subPatch:"4d7e6434-43f0-4fc3-89b9-c6d3ca9da115"},portsIn:[{name:"radius",value:.2},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v2"},{id:"43432dc4-d352-490e-90d8-971ee1da7eb4",uiAttribs:{},portsIn:[{name:"contrast",value:.5},{name:"brightness",value:.931}],objName:"Ops.Gl.TextureEffects.BrightnessContrast"},{id:"2f56ef7d-53c3-40f9-af22-75d81f846b5e",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Alpha Mask index",value:0},{name:"Alpha Mask",value:"Off"},{name:"Amount",value:1},{name:"Width",value:20},{name:"Height",value:20},{name:"Aspect",value:true},{name:"Mul",value:1},{name:"X",value:0},{name:"Y",value:0},{name:"Time",value:1},{name:"Greyscale",value:true},{name:"Offset Multiply",value:1},{name:"Offset X index",value:0},{name:"Offset X",value:"None"},{name:"Offset Y index",value:0},{name:"Offset Y",value:"None"},{name:"Offset Time index",value:1},{name:"Offset Time",value:"R"}],objName:"Ops.Gl.TextureEffects.Plasma_v2"},{id:"0a0c894d-6bf2-456e-a789-86d7b0cd409f",uiAttribs:{},portsIn:[{name:"In Min",value:0},{name:"Midpoint",value:.5},{name:"In Max",value:1},{name:"Out Min",value:0},{name:"Out Max",value:1}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"isvmtdayg",objOut:"0a0c894d-6bf2-456e-a789-86d7b0cd409f"}]}],objName:"Ops.Gl.TextureEffects.Levels"},{id:"isvmtdayg",uiAttribs:{},portsIn:[{name:"contrast",value:.5},{name:"brightness",value:.74}],objName:"Ops.Gl.TextureEffects.BrightnessContrast"},{id:"267d14bd-57d8-4d8b-9e53-6698fc0c140e",uiAttribs:{},portsIn:[{name:"Amount",value:1}],objName:"Ops.Gl.TextureEffects.LUTMap"},{id:"5c97ccdc-87f9-4876-8253-81d0aca65772",uiAttribs:{},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Multiply texture",value:1.41},{name:"Gamma correction",value:2.2}],objName:"Ops.Gl.TextureEffects.GammaCorrection_v2"},{id:"0230d382-f534-4aa3-94f1-d1ca95edacaf",uiAttribs:{},portsOut:[{name:"Num Keys",value:18}],objName:"Ops.Json.ObjectKeys"},{id:"a270301b-2733-4b3d-aeaf-979cb43a7c5f",uiAttribs:{},portsOut:[{name:"Values",links:[{portIn:"Array",portOut:"Values",objIn:"bf7deb28-e382-4a14-9f4a-d2060af67b2d",objOut:"a270301b-2733-4b3d-aeaf-979cb43a7c5f"}]},{name:"Num values",value:18}],objName:"Ops.Json.ObjectValues"},{id:"2e448380-4dbf-43bf-ab1d-bc5072c86eb3",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Exec",portOut:"then",objIn:"bf7deb28-e382-4a14-9f4a-d2060af67b2d",objOut:"2e448380-4dbf-43bf-ab1d-bc5072c86eb3"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"bf7deb28-e382-4a14-9f4a-d2060af67b2d",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"01985e23-3ef2-450f-9583-53afcacb0c99",objOut:"bf7deb28-e382-4a14-9f4a-d2060af67b2d"}]}],objName:"Ops.Array.ArrayTrigger"},{id:"01985e23-3ef2-450f-9583-53afcacb0c99",uiAttribs:{},portsOut:[{name:"New Array",links:[{portIn:"Array",portOut:"New Array",objIn:"f5f0ad78-7c06-4c0b-bde3-7edc2ca0ec34",objOut:"01985e23-3ef2-450f-9583-53afcacb0c99"},{portIn:"In",portOut:"New Array",objIn:"vg5ym0e77",objOut:"01985e23-3ef2-450f-9583-53afcacb0c99"}]}],objName:"Ops.Array.ArrayChangedTrigger"},{id:"bdd8b05a-749a-4ec8-9046-cb216d70e5a4",uiAttribs:{},portsIn:[{name:"In",value:0}],portsOut:[{name:"Result1",value:0},{name:"Result2",value:0},{name:"Result3",value:0},{name:"Result4",value:0},{name:"Result5",value:0},{name:"Result6",value:0},{name:"Result7",value:0},{name:"Result8",value:0},{name:"Result9",value:0},{name:"Result10",value:0},{name:"Result11",value:0},{name:"Result12",value:0},{name:"Result13",value:0},{name:"Result14",value:0},{name:"Result15",value:0},{name:"Result16",value:0},{name:"Result17",value:0},{name:"Result18",value:0},{name:"Result19",value:0}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"a5212d83-5e97-40a7-90cb-fc933baf2afa",uiAttribs:{},portsIn:[{name:"In",value:0}],portsOut:[{name:"Result1",value:0},{name:"Result2",value:0},{name:"Result3",value:0},{name:"Result4",value:0},{name:"Result5",value:0},{name:"Result6",value:0},{name:"Result7",value:0},{name:"Result8",value:0},{name:"Result9",value:0},{name:"Result10",value:0},{name:"Result11",value:0},{name:"Result12",value:0},{name:"Result13",value:0},{name:"Result14",value:0},{name:"Result15",value:0},{name:"Result16",value:0},{name:"Result17",value:0},{name:"Result18",value:0},{name:"Result19",value:0}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"ee794201-6fde-4869-ba8a-1936b23c02cc",uiAttribs:{},portsIn:[{name:"In",value:[0,1,2,3,4,5,6,7,8,9]}],portsOut:[{name:"Result1",value:1},{name:"Result2",value:2},{name:"Result3",value:3},{name:"Result4",value:4},{name:"Result5",value:5},{name:"Result6",value:6},{name:"Result7",value:7},{name:"Result8",value:8},{name:"Result9",value:9},{name:"Result10"},{name:"Result11"},{name:"Result12"},{name:"Result13"},{name:"Result14"},{name:"Result15"},{name:"Result16"},{name:"Result17"},{name:"Result18"},{name:"Result19"}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"5b0523ea-ed4b-465f-9b54-974bad4f771b",uiAttribs:{},portsIn:[{name:"In",value:0}],portsOut:[{name:"Result1",value:0},{name:"Result2",value:0},{name:"Result3",value:0},{name:"Result4",value:0},{name:"Result5",value:0},{name:"Result6",value:0},{name:"Result7",value:0},{name:"Result8",value:0},{name:"Result9",value:0},{name:"Result10",value:0},{name:"Result11",value:0},{name:"Result12",value:0},{name:"Result13",value:0},{name:"Result14",value:0},{name:"Result15",value:0},{name:"Result16",value:0},{name:"Result17",value:0},{name:"Result18",value:0},{name:"Result19",value:0}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a",uiAttribs:{},portsOut:[{name:"Result1",links:[{portIn:"in1 BauShader metaBlur",portOut:"Result1",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result2",links:[{portIn:"in2 BauShader complexityA",portOut:"Result2",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result3",links:[{portIn:"in3 BauShader complexityB",portOut:"Result3",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result4",links:[{portIn:"in4 BauShader complexityC",portOut:"Result4",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result5",links:[{portIn:"in5 BauShader bauScale",portOut:"Result5",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result6",links:[{portIn:"in6 BauShader boneWeight",portOut:"Result6",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result7",links:[{portIn:"in7 BauShader jointWeight",portOut:"Result7",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result8",links:[{portIn:"in8 BauShader randomSeed",portOut:"Result8",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result9",links:[{portIn:"in9 BauShader distortionVal",portOut:"Result9",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result10",links:[{portIn:"in10 BauShader distortionVal2",portOut:"Result10",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result11",links:[{portIn:"in11 BauShader angleIN",portOut:"Result11",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result12",links:[{portIn:"in12 BauShader jointX",portOut:"Result12",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result13",links:[{portIn:"in13 BauShader jointY",portOut:"Result13",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result14",links:[{portIn:"in14 BauShader contraction",portOut:"Result14",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result15",links:[{portIn:"in15 BauShader rotateEach",portOut:"Result15",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result16",links:[{portIn:"in16 BauShader jitterIN",portOut:"Result16",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result17",links:[{portIn:"in17 BauShader jitterSpeed",portOut:"Result17",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result18",links:[{portIn:"in18 Ops.Gl.Matrix.Transform posX",portOut:"Result18",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]},{name:"Result19",links:[{portIn:"in19 Ops.Gl.Matrix.Transform posY",portOut:"Result19",objIn:"xxedzm42u",objOut:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a"}]}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"f5f0ad78-7c06-4c0b-bde3-7edc2ca0ec34",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"In",portOut:"Result",objIn:"01dcef84-fd97-4ce1-97c4-1bc90b56db6a",objOut:"f5f0ad78-7c06-4c0b-bde3-7edc2ca0ec34"},{portIn:"Array",portOut:"Result",objIn:"8yl4yiscn",objOut:"f5f0ad78-7c06-4c0b-bde3-7edc2ca0ec34"}]}],objName:"Ops.User.paramuno.ArrayPreviousStore"},{id:"l2z1yvqtb",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsOut:[{name:"create port",value:0},{name:"in0 Sequence exe",links:[{portIn:"exe",portOut:"in0 Sequence exe",objIn:"wdmsxml2d",objOut:"l2z1yvqtb"}]},{name:"in1 BauShader metaBlur",links:[{portIn:"metaBlur",portOut:"in1 BauShader metaBlur",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in2 BauShader complexityA",links:[{portIn:"complexityA",portOut:"in2 BauShader complexityA",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in3 BauShader complexityB",links:[{portIn:"complexityB",portOut:"in3 BauShader complexityB",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in4 BauShader complexityC",links:[{portIn:"complexityC",portOut:"in4 BauShader complexityC",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in5 BauShader bauScale",links:[{portIn:"bauScale",portOut:"in5 BauShader bauScale",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in6 BauShader boneWeight",links:[{portIn:"boneWeight",portOut:"in6 BauShader boneWeight",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in7 BauShader jointWeight",links:[{portIn:"jointWeight",portOut:"in7 BauShader jointWeight",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in8 BauShader randomSeed",links:[{portIn:"randomSeed",portOut:"in8 BauShader randomSeed",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in9 BauShader distortionVal",links:[{portIn:"distortionVal",portOut:"in9 BauShader distortionVal",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in10 BauShader distortionVal2",links:[{portIn:"distortionVal2",portOut:"in10 BauShader distortionVal2",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in11 BauShader angleIN",links:[{portIn:"angleIN",portOut:"in11 BauShader angleIN",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in12 BauShader jointX",links:[{portIn:"jointX",portOut:"in12 BauShader jointX",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in13 BauShader jointY",links:[{portIn:"jointY",portOut:"in13 BauShader jointY",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in14 BauShader contraction",links:[{portIn:"contraction",portOut:"in14 BauShader contraction",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in15 BauShader rotateEach",links:[{portIn:"rotateEach",portOut:"in15 BauShader rotateEach",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in16 BauShader jitterIN",links:[{portIn:"jitterIN",portOut:"in16 BauShader jitterIN",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in17 BauShader jitterSpeed",links:[{portIn:"jitterSpeed",portOut:"in17 BauShader jitterSpeed",objIn:"1uz80tvbj",objOut:"l2z1yvqtb"}]},{name:"in18 Ops.Gl.Matrix.Transform posX"},{name:"in19 Ops.Gl.Matrix.Transform posY"}],objName:"Ops.Ui.PatchInput"},{id:"gj7fh0uv2",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"create port",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"x0bytsnd0",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Sequence exe","type":1},{"name":"in1 BauShader metaBlur","type":0,"value":0.3},{"name":"in2 BauShader complexityA","type":0,"value":1.65},{"name":"in3 BauShader complexityB","type":0,"value":0.85},{"name":"in4 BauShader complexityC","type":0,"value":4.09},{"name":"in5 BauShader bauScale","type":0,"value":0.38},{"name":"in6 BauShader boneWeight","type":0,"value":0.01},{"name":"in7 BauShader jointWeight","type":0,"value":6.48},{"name":"in8 BauShader randomSeed","type":0,"value":0.92},{"name":"in9 BauShader distortionVal","type":0,"value":0.92},{"name":"in10 BauShader distortionVal2","type":0},{"name":"in11 BauShader angleIN","type":0,"value":0.42},{"name":"in12 BauShader jointX","type":0},{"name":"in13 BauShader jointY","type":0},{"name":"in14 BauShader contraction","type":0,"value":1.07},{"name":"in15 BauShader rotateEach","type":0,"value":-4.39},{"name":"in16 BauShader jitterIN","type":0,"value":5.07},{"name":"in17 BauShader jitterSpeed","type":0,"value":11.64},{"name":"in18 Ops.Gl.Matrix.Transform posX","type":0,"value":0},{"name":"in19 Ops.Gl.Matrix.Transform posY","type":0,"value":0}],"portsOut":[{"name":"out0 ImageCompose texture_out","type":2,"objType":"texture"}]}'},{name:"patchId",value:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"}],portsOut:[{name:"create port out",value:0},{name:"out0 ImageCompose texture_out",links:[{portIn:"Texture 3",portOut:"out0 ImageCompose texture_out",objIn:"5672d089-99d0-49c9-97cf-43a0455c1a46",objOut:"x0bytsnd0"}]}],objName:"Ops.Ui.SubPatch"},{id:"wdmsxml2d",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsOut:[{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"1uz80tvbj",objOut:"wdmsxml2d"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"kmyp0bgoa",objOut:"wdmsxml2d"}]},{name:"trigger 6",links:[{portIn:"render",portOut:"trigger 6",objIn:"foovnv04u",objOut:"wdmsxml2d"}]},{name:"trigger 7",links:[{portIn:"Render",portOut:"trigger 7",objIn:"06y2mzkmh",objOut:"wdmsxml2d"}]},{name:"trigger 8",links:[{portIn:"Render",portOut:"trigger 8",objIn:"x8c8jogph",objOut:"wdmsxml2d"}]},{name:"trigger 9",links:[{portIn:"Render",portOut:"trigger 9",objIn:"iwdx9iq42",objOut:"wdmsxml2d"}]},{name:"trigger 10",links:[{portIn:"Render",portOut:"trigger 10",objIn:"mt2r5y0ka",objOut:"wdmsxml2d"}]},{name:"trigger 11",links:[{portIn:"render",portOut:"trigger 11",objIn:"96mqgdx6y",objOut:"wdmsxml2d"}]},{name:"trigger 13",links:[{portIn:"Render",portOut:"trigger 13",objIn:"m4gfx0w0b",objOut:"wdmsxml2d"}]}],objName:"Ops.Trigger.Sequence"},{id:"m4gfx0w0b",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"r3g41nnfh",objOut:"m4gfx0w0b"}]},{name:"texture_out",links:[{portIn:"out0 ImageCompose texture_out",portOut:"texture_out",objIn:"gj7fh0uv2",objOut:"m4gfx0w0b"}]},{name:"Aspect Ratio",value:1.8635346756152125}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"c0xq2m4xv",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use Viewport Size",value:false},{name:"Width",value:360},{name:"Height",value:360},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"wourt3ok3",objOut:"c0xq2m4xv"}]},{name:"Texture",links:[{portIn:"Image",portOut:"Texture",objIn:"7bewh2rjt",objOut:"c0xq2m4xv"},{portIn:"Image",portOut:"Texture",objIn:"55625xf72",objOut:"c0xq2m4xv"},{portIn:"Mask",portOut:"Texture",objIn:"55625xf72",objOut:"c0xq2m4xv"},{portIn:"Image",portOut:"Texture",objIn:"fh7ly2p6l",objOut:"c0xq2m4xv"},{portIn:"Mask",portOut:"Texture",objIn:"fh7ly2p6l",objOut:"c0xq2m4xv"},{portIn:"Image",portOut:"Texture",objIn:"gnqhd1ecv",objOut:"c0xq2m4xv"}]}],objName:"Ops.Gl.Shader.ShaderToTexture"},{id:"r3g41nnfh",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:.06},{name:"Position Y",value:.06},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"1uz80tvbj",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float distortionVal2;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\nUNI float jitterIN;\nUNI float jitterSpeed;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,\n    \t4.,float(complexityB))); // map rand float to 4-complexityB as maxnumber\n    \t\n        for(int v=0;v< exLength;v++){ // extremity joint no.\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse jitter\n            a += smoothstep(.1,1.,sin(iTime*(srand(i++)*jitterSpeed))) // \n            * srand(i++)*jitterIN // JitterIN controls jitterRange\n            *map(float(v),0.,float(exLength),0.1,1.); // maps 0-exlength to 0.1-1 so that there's more jitterRange in tip joints\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                vec2 tempuv = _uv;\n                \n                //distorting whole uv\n                float x1 = tempuv.x;\n                \n                float mx1 = x1 < 0. ?  // stich x distortion in in half\n                sin(-2.*iTime+x1*distortionVal2)*.1 :\n                sin(2.*iTime+x1*distortionVal2)*-.1;\n                \n                float y1 = tempuv.y;\n                y1 += mx1*(distortionVal2/60.);   // higher y distortion for swimming effect\n                //y1 += mx1*.4;\n                float my1 = sin(5.*iTime+y1*10.)*.1;\n                x1 += my1*.01;  // low x distortion for watery effect\n                tempuv = vec2(x1,y1);\n                \n \n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                } \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting rotated uv\n                 float x = uv.x;\n                // //float m = (x-.1)*(x+.1); // this makes symmetry drift\n                 float mx = x*x;\n                 float y = uv.y + (mx*distortionVal);\n                 float my = y*y;\n                 x = x + (my*distortionVal); // distorts only Y axis bc of symmetyr\n                 uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",useVariable:"metaBlur"},{name:"complexityA",useVariable:"complexityA"},{name:"complexityB",useVariable:"complexityB"},{name:"complexityC",useVariable:"complexityC"},{name:"bauScale",useVariable:"bauScale"},{name:"boneWeight",useVariable:"boneWeight"},{name:"jointWeight",useVariable:"jointWeight"},{name:"distortionVal",useVariable:"distortionVal"},{name:"distortionVal2",useVariable:"distortionVal2"},{name:"angleIN",useVariable:"angleIN"},{name:"jointX",useVariable:"jointX"},{name:"jointY",useVariable:"jointY"},{name:"contraction",useVariable:"contraction"},{name:"rotateEach",useVariable:"rotateEach"},{name:"jitterIN",useVariable:"jitterIN"},{name:"jitterSpeed",useVariable:"jitterSpeed"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"c0xq2m4xv",objOut:"1uz80tvbj"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"c0xq2m4xv",objOut:"1uz80tvbj"}]},{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"6zfd44p9x",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"scale",value:5.81},{name:"scrollX",value:2.6},{name:"repeat",value:1},{name:"aspect",value:1},{name:"Layer 1",value:true},{name:"Layer 2",value:true},{name:"Layer 3",value:true},{name:"Layer 4",value:true},{name:"Tileable",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"66o9fufp9",objOut:"6zfd44p9x"}]}],objName:"Ops.Gl.TextureEffects.Noise.FBMNoise"},{id:"wourt3ok3",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:600},{name:"Height",value:600},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"6zfd44p9x",objOut:"wourt3ok3"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"jn9gp5h5w",objOut:"wourt3ok3"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"lehi3cknj",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Speed",value:3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"anim",portOut:"Time",objIn:"6zfd44p9x",objOut:"lehi3cknj"}]}],objName:"Ops.Anim.Timer_v2"},{id:"g338h20yz",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Speed",value:.07},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"scrollY",portOut:"Time",objIn:"6zfd44p9x",objOut:"g338h20yz"},{portIn:"Time",portOut:"Time",objIn:"66o9fufp9",objOut:"g338h20yz"}]}],objName:"Ops.Anim.Timer_v2"},{id:"66o9fufp9",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:.485},{name:"Movement",value:.403},{name:"Num",value:71.79},{name:"seed",value:0},{name:"Fill index",value:1},{name:"Fill",value:"Random"},{name:"Draw Isolines",value:true},{name:"Draw Distance",value:false},{name:"Draw Center",value:0}],objName:"Ops.Gl.TextureEffects.Noise.Voronoise"},{id:"9t68gr814",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Variable",value:"maskk"}],objName:"Ops.Vars.VarSetTexture_v2"},{id:"kmyp0bgoa",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"jn9gp5h5w",objOut:"kmyp0bgoa"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"foovnv04u",objOut:"kmyp0bgoa"},{portIn:"Image",portOut:"texture_out",objIn:"cvxg574a1",objOut:"kmyp0bgoa"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"jn9gp5h5w",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"hgo43mlh1",objOut:"jn9gp5h5w"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"tv3r9r28n",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:.888},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"foovnv04u",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"use original size",value:true},{name:"width",value:640},{name:"height",value:640},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"A"},{name:"Convert Greyscale index",value:0},{name:"Convert Greyscale",value:"Off"},{name:"Invert R",value:false},{name:"Invert G",value:false},{name:"Invert B",value:false},{name:"Invert A",value:false}],portsOut:[{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"tv3r9r28n",objOut:"foovnv04u"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.Textures.CopyTexture"},{id:"hgo43mlh1",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"scale",value:1.005},{name:"rotX",value:0},{name:"rotY",value:-4.26},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"w8pb84c9h",objOut:"hgo43mlh1"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"w8pb84c9h",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Strength",value:6},{name:"Width",value:.041},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"7bewh2rjt",objOut:"w8pb84c9h"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"6tb8wuaol",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:.287},{name:"Strength",value:25},{name:"Width",value:0},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"tv3r9r28n",objOut:"6tb8wuaol"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"d4blihahr",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:.5},{name:"Strength",value:4},{name:"Width",value:.028},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"ailg7t6f0",objOut:"d4blihahr"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"06y2mzkmh",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"cvxg574a1",objOut:"06y2mzkmh"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"e4a8ta3to",objOut:"06y2mzkmh"},{portIn:"Texture",portOut:"texture_out",objIn:"trxf1i16d",objOut:"06y2mzkmh"},{portIn:"Image",portOut:"texture_out",objIn:"xa43uahjn",objOut:"06y2mzkmh"},{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"as20m1mwu",objOut:"06y2mzkmh"},{portIn:"Image",portOut:"texture_out",objIn:"x5uolkonw",objOut:"06y2mzkmh"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"cvxg574a1",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"d4blihahr",objOut:"cvxg574a1"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"ailg7t6f0",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"span index",value:0},{name:"span",value:"16"},{name:"reduceMin",value:128},{name:"reduceMul",value:8},{name:"use viewport size",value:true},{name:"width",value:0},{name:"height",value:0}],objName:"Ops.Gl.TextureEffects.FXAA"},{id:"q7pmzfwf5",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Strength",value:4}],objName:"Ops.Gl.TextureEffects.ToNormalMap"},{id:"x8c8jogph",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"e4a8ta3to",objOut:"x8c8jogph"}]},{name:"texture_out",links:[{portIn:"Normal Map",portOut:"texture_out",objIn:"as20m1mwu",objOut:"x8c8jogph"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"e4a8ta3to",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"q7pmzfwf5",objOut:"e4a8ta3to"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"x5szaokfe",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"posX",value:0},{name:"posY",value:.6},{name:"posZ",value:0},{name:"scale",value:1.75},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"mzrp7z0rv",objOut:"x5szaokfe"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"96mqgdx6y",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"use viewport size",value:true},{name:"texture width",value:833},{name:"texture height",value:447},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"2x"},{name:"HDR",value:false,title:"Pixelformat Float 32bit"},{name:"Depth",value:false},{name:"Clear",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"x5szaokfe",objOut:"96mqgdx6y"}]},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"r3g41nnfh",objOut:"96mqgdx6y"}]}],objName:"Ops.Gl.RenderToTexture"},{id:"as20m1mwu",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"R",value:.901846578794093},{name:"G",value:.9959996744195572},{name:"B",value:.9538190827418381},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:1},{name:"Roughness",value:1},{name:"Active",value:true},{name:"Fresnel Intensity",value:.262},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.192},{name:"Emissive R",value:.30306337573044023},{name:"Emissive G",value:.6226663355231237},{name:"Emissive B",value:.5408479623096425},{name:"Shininess",value:3},{name:"Specular Amount",value:.658},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.303},{name:"AO Intensity",value:1},{name:"AO UV Channel index",value:0},{name:"AO UV Channel",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"Render",portOut:"Trigger Out",objIn:"trxf1i16d",objOut:"as20m1mwu"}]}],objName:"Ops.Gl.Phong.PhongMaterial_v6"},{id:"trxf1i16d",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Mode index",value:0},{name:"Mode",value:"Norm"},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Coordinates index",value:0},{name:"Coordinates",value:"Tex Coords"},{name:"Channel index",value:0},{name:"Channel",value:"Luminance"},{name:"Flip index",value:0},{name:"Flip",value:"None"},{name:"Range index",value:0},{name:"Range",value:"0-1"},{name:"Offset X",value:0},{name:"Offset Y",value:0},{name:"Scale",value:1},{name:"Calc Normals",value:false},{name:"Normal Axis index",value:2},{name:"Normal Axis",value:"Z"},{name:"Discard Zero Values",value:false},{name:"colorize",value:false},{name:"Colorize Min",value:0},{name:"Colorize Max",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"1ng5x3p1l",objOut:"trxf1i16d"}]}],objName:"Ops.Gl.ShaderEffects.VertexDisplacementMap_v4"},{id:"mzrp7z0rv",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.83},{name:"Radius",value:7.67},{name:"X",value:-1.35},{name:"Y",value:3.04},{name:"Z",value:.45},{name:"R",value:.48623007962450515},{name:"G",value:.6330214854460751},{name:"B",value:1},{name:"Specular R",value:.3057815379338912},{name:"Specular G",value:.4100902594355548},{name:"Specular B",value:.9266666655739149},{name:"Falloff",value:.383},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"in88jmsct",objOut:"mzrp7z0rv"}]},{name:"World Position X",value:-2.362499952316284},{name:"World Position Y",value:5.920000076293945},{name:"World Position Z",value:.7874999642372131}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"in88jmsct",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.71},{name:"Radius",value:40.62},{name:"X",value:-1.34},{name:"Y",value:-1.39},{name:"Z",value:.78},{name:"R",value:.9959996744195572},{name:"G",value:.8110593251417859},{name:"B",value:.7687872453068667},{name:"Specular R",value:1},{name:"Specular G",value:1},{name:"Specular B",value:1},{name:"Falloff",value:.49},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"ltg6265wz",objOut:"in88jmsct"}]},{name:"World Position X",value:-2.3450000286102295},{name:"World Position Y",value:-1.8324999809265137},{name:"World Position Z",value:1.3650000095367432}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"ltg6265wz",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.55},{name:"Radius",value:23.56},{name:"X",value:2.07},{name:"Y",value:-.2},{name:"Z",value:1.9},{name:"R",value:.8357590921577018},{name:"G",value:.9746666662891705},{name:"B",value:.8241834609800793},{name:"Specular R",value:.7213291625519593},{name:"Specular G",value:.9639755625300043},{name:"Specular B",value:.9906666665275892},{name:"Falloff",value:0},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"as20m1mwu",objOut:"ltg6265wz"}]},{name:"World Position X",value:3.622499942779541},{name:"World Position Y",value:.2500000298023224},{name:"World Position Z",value:3.325000047683716}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"t2ay6bwmo",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Type index",value:0},{name:"Type",value:"sine"},{name:"Phase",value:0},{name:"Amplitude",value:.02}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"oe4sezwct",objOut:"t2ay6bwmo"}]}],objName:"Ops.Anim.LFO"},{id:"hiyvc4mwu",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Speed",value:.3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Time",portOut:"Time",objIn:"t2ay6bwmo",objOut:"hiyvc4mwu"}]}],objName:"Ops.Anim.Timer_v2"},{id:"oe4sezwct",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"number2",value:.01}],portsOut:[{name:"result",links:[{portIn:"Extrude",portOut:"result",objIn:"trxf1i16d",objOut:"oe4sezwct"}]}],objName:"Ops.Math.Sum"},{id:"taph3i2lv",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.002,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.15,"r":0.30588235294117655,"g":0.3935058951120749,"b":0.6901960784313725},{"pos":0.196,"r":0.16078431372549018,"g":0.4627450980392157,"b":0.3286744943074153},{"pos":0.432,"r":0.363691178443945,"g":0.20357707594403382,"b":0.468666658749183},{"pos":0.492,"r":0.5372549019607843,"g":0.27843137254901956,"b":0.4906667962078974},{"pos":0.524,"r":0.676666580468415,"g":0.31930203733338675,"b":0.3721919905054923},{"pos":0.582,"r":0.29411764705882354,"g":0.3803921568627451,"b":0.3669332450235579},{"pos":0.894,"r":0.21176470588235294,"g":0.34858096860858423,"b":0.596078431372549},{"pos":0.97,"r":0.42352941176470593,"g":1,"b":0.9100699981654309},{"pos":1,"r":0.42352941176470593,"g":1,"b":0.9100699981654309}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Gradient Array",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"jdshxr1ng",objOut:"taph3i2lv"}]}],objName:"Ops.Gl.GradientTexture"},{id:"mt2r5y0ka",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"xa43uahjn",objOut:"mt2r5y0ka"}]},{name:"texture_out",links:[{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"as20m1mwu",objOut:"mt2r5y0ka"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"xa43uahjn",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"jdshxr1ng",objOut:"xa43uahjn"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"jdshxr1ng",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"x5uolkonw",objOut:"jdshxr1ng"}]}],objName:"Ops.Gl.TextureEffects.ColorMap"},{id:"x5uolkonw",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:true},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"yaho05cxu",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"amount",value:2.5},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"direction index",value:0},{name:"direction",value:"horizontal"}],objName:"Ops.Gl.TextureEffects.FastBlur"},{id:"iwdx9iq42",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"gnqhd1ecv",objOut:"iwdx9iq42"}]},{name:"texture_out",links:[{portIn:"Mask",portOut:"texture_out",objIn:"x5uolkonw",objOut:"iwdx9iq42"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"gnqhd1ecv",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"yaho05cxu",objOut:"gnqhd1ecv"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"fh7ly2p6l",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"exclusion"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:.99},{name:"Scale Y",value:.99},{name:"Position X",value:.001},{name:"Position Y",value:.001},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"6tb8wuaol",objOut:"fh7ly2p6l"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"7bewh2rjt",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"amount",value:.932},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"55625xf72",objOut:"7bewh2rjt"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"55625xf72",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"hardlight"},{name:"amount",value:.252},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:1.05},{name:"Scale Y",value:1.05},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"fh7ly2p6l",objOut:"55625xf72"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"1ng5x3p1l",uiAttribs:{subPatch:"5a3e48ef-f3a7-4dec-8320-c5993f58e214"},portsIn:[{name:"radius",value:.2},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v2"},{id:"xxid38b0r",uiAttribs:{},portsOut:[{name:"Result1",links:[{portIn:"in1 BauShader metaBlur",portOut:"Result1",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result2",links:[{portIn:"in2 BauShader complexityA",portOut:"Result2",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result3",links:[{portIn:"in3 BauShader complexityB",portOut:"Result3",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result4",links:[{portIn:"in4 BauShader complexityC",portOut:"Result4",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result5",links:[{portIn:"in5 BauShader bauScale",portOut:"Result5",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result6",links:[{portIn:"in6 BauShader boneWeight",portOut:"Result6",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result7",links:[{portIn:"in7 BauShader jointWeight",portOut:"Result7",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result8",links:[{portIn:"in8 BauShader randomSeed",portOut:"Result8",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result9",links:[{portIn:"in9 BauShader distortionVal",portOut:"Result9",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result10",links:[{portIn:"in10 BauShader distortionVal2",portOut:"Result10",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result11",links:[{portIn:"in11 BauShader angleIN",portOut:"Result11",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result12",links:[{portIn:"in12 BauShader jointX",portOut:"Result12",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result13",links:[{portIn:"in13 BauShader jointY",portOut:"Result13",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result14",links:[{portIn:"in14 BauShader contraction",portOut:"Result14",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result15",links:[{portIn:"in15 BauShader rotateEach",portOut:"Result15",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result16",links:[{portIn:"in16 BauShader jitterIN",portOut:"Result16",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result17",links:[{portIn:"in17 BauShader jitterSpeed",portOut:"Result17",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result18",links:[{portIn:"in18 Ops.Gl.Matrix.Transform posX",portOut:"Result18",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]},{name:"Result19",links:[{portIn:"in19 Ops.Gl.Matrix.Transform posY",portOut:"Result19",objIn:"x0bytsnd0",objOut:"xxid38b0r"}]}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"gwel1t0ri",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsOut:[{name:"create port",value:0},{name:"in0 Sequence exe",links:[{portIn:"exe",portOut:"in0 Sequence exe",objIn:"qb1fypjku",objOut:"gwel1t0ri"}]},{name:"in1 BauShader metaBlur",links:[{portIn:"metaBlur",portOut:"in1 BauShader metaBlur",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in2 BauShader complexityA",links:[{portIn:"complexityA",portOut:"in2 BauShader complexityA",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in3 BauShader complexityB",links:[{portIn:"complexityB",portOut:"in3 BauShader complexityB",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in4 BauShader complexityC",links:[{portIn:"complexityC",portOut:"in4 BauShader complexityC",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in5 BauShader bauScale",links:[{portIn:"bauScale",portOut:"in5 BauShader bauScale",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in6 BauShader boneWeight",links:[{portIn:"boneWeight",portOut:"in6 BauShader boneWeight",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in7 BauShader jointWeight",links:[{portIn:"jointWeight",portOut:"in7 BauShader jointWeight",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in8 BauShader randomSeed",links:[{portIn:"randomSeed",portOut:"in8 BauShader randomSeed",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in9 BauShader distortionVal",links:[{portIn:"distortionVal",portOut:"in9 BauShader distortionVal",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in10 BauShader distortionVal2",links:[{portIn:"distortionVal2",portOut:"in10 BauShader distortionVal2",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in11 BauShader angleIN",links:[{portIn:"angleIN",portOut:"in11 BauShader angleIN",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in12 BauShader jointX",links:[{portIn:"jointX",portOut:"in12 BauShader jointX",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in13 BauShader jointY",links:[{portIn:"jointY",portOut:"in13 BauShader jointY",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in14 BauShader contraction",links:[{portIn:"contraction",portOut:"in14 BauShader contraction",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in15 BauShader rotateEach",links:[{portIn:"rotateEach",portOut:"in15 BauShader rotateEach",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in16 BauShader jitterIN",links:[{portIn:"jitterIN",portOut:"in16 BauShader jitterIN",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in17 BauShader jitterSpeed",links:[{portIn:"jitterSpeed",portOut:"in17 BauShader jitterSpeed",objIn:"xm73jquh9",objOut:"gwel1t0ri"}]},{name:"in18 Ops.Gl.Matrix.Transform posX"},{name:"in19 Ops.Gl.Matrix.Transform posY"}],objName:"Ops.Ui.PatchInput"},{id:"ngxartx7d",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"create port",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"50cblxqco",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Sequence exe","type":1},{"name":"in1 BauShader metaBlur","type":0,"value":0.3},{"name":"in2 BauShader complexityA","type":0,"value":1.65},{"name":"in3 BauShader complexityB","type":0,"value":0.85},{"name":"in4 BauShader complexityC","type":0,"value":4.09},{"name":"in5 BauShader bauScale","type":0,"value":0.38},{"name":"in6 BauShader boneWeight","type":0,"value":0.01},{"name":"in7 BauShader jointWeight","type":0,"value":6.48},{"name":"in8 BauShader randomSeed","type":0,"value":0.92},{"name":"in9 BauShader distortionVal","type":0,"value":0.92},{"name":"in10 BauShader distortionVal2","type":0},{"name":"in11 BauShader angleIN","type":0,"value":0.42},{"name":"in12 BauShader jointX","type":0},{"name":"in13 BauShader jointY","type":0},{"name":"in14 BauShader contraction","type":0,"value":1.07},{"name":"in15 BauShader rotateEach","type":0,"value":-4.39},{"name":"in16 BauShader jitterIN","type":0,"value":5.07},{"name":"in17 BauShader jitterSpeed","type":0,"value":11.64},{"name":"in18 Ops.Gl.Matrix.Transform posX","type":0,"value":0},{"name":"in19 Ops.Gl.Matrix.Transform posY","type":0,"value":0}],"portsOut":[{"name":"out0 ImageCompose texture_out","type":2,"objType":"texture"}]}'},{name:"patchId",value:"de5f5263-7ca2-43c7-9000-629b45bae15d"}],portsOut:[{name:"create port out",value:0},{name:"out0 ImageCompose texture_out",links:[{portIn:"Texture 4",portOut:"out0 ImageCompose texture_out",objIn:"5672d089-99d0-49c9-97cf-43a0455c1a46",objOut:"50cblxqco"}]}],objName:"Ops.Ui.SubPatch"},{id:"qb1fypjku",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsOut:[{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"xm73jquh9",objOut:"qb1fypjku"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"nhm799s19",objOut:"qb1fypjku"}]},{name:"trigger 6",links:[{portIn:"render",portOut:"trigger 6",objIn:"6z8rcnxkf",objOut:"qb1fypjku"}]},{name:"trigger 7",links:[{portIn:"Render",portOut:"trigger 7",objIn:"7t9sy3cal",objOut:"qb1fypjku"}]},{name:"trigger 8",links:[{portIn:"Render",portOut:"trigger 8",objIn:"kyf21oyvo",objOut:"qb1fypjku"}]},{name:"trigger 9",links:[{portIn:"Render",portOut:"trigger 9",objIn:"xss9y3cq3",objOut:"qb1fypjku"}]},{name:"trigger 10",links:[{portIn:"Render",portOut:"trigger 10",objIn:"is4e08otf",objOut:"qb1fypjku"}]},{name:"trigger 11",links:[{portIn:"render",portOut:"trigger 11",objIn:"6lp5x2ehq",objOut:"qb1fypjku"}]},{name:"trigger 13",links:[{portIn:"Render",portOut:"trigger 13",objIn:"qq57f9rc2",objOut:"qb1fypjku"}]}],objName:"Ops.Trigger.Sequence"},{id:"qq57f9rc2",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"izsq17zoc",objOut:"qq57f9rc2"}]},{name:"texture_out",links:[{portIn:"out0 ImageCompose texture_out",portOut:"texture_out",objIn:"ngxartx7d",objOut:"qq57f9rc2"}]},{name:"Aspect Ratio",value:1.8635346756152125}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"orvrfiuaz",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use Viewport Size",value:false},{name:"Width",value:360},{name:"Height",value:360},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"hvlvyax34",objOut:"orvrfiuaz"}]},{name:"Texture",links:[{portIn:"Image",portOut:"Texture",objIn:"je7xbwagq",objOut:"orvrfiuaz"},{portIn:"Image",portOut:"Texture",objIn:"wlby6k0xr",objOut:"orvrfiuaz"},{portIn:"Mask",portOut:"Texture",objIn:"wlby6k0xr",objOut:"orvrfiuaz"},{portIn:"Image",portOut:"Texture",objIn:"41fx6cv7h",objOut:"orvrfiuaz"},{portIn:"Mask",portOut:"Texture",objIn:"41fx6cv7h",objOut:"orvrfiuaz"},{portIn:"Image",portOut:"Texture",objIn:"1aacvkqub",objOut:"orvrfiuaz"}]}],objName:"Ops.Gl.Shader.ShaderToTexture"},{id:"izsq17zoc",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:.06},{name:"Position Y",value:.06},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"xm73jquh9",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float distortionVal2;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\nUNI float jitterIN;\nUNI float jitterSpeed;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,\n    \t4.,float(complexityB))); // map rand float to 4-complexityB as maxnumber\n    \t\n        for(int v=0;v< exLength;v++){ // extremity joint no.\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse jitter\n            a += smoothstep(.1,1.,sin(iTime*(srand(i++)*jitterSpeed))) // \n            * srand(i++)*jitterIN // JitterIN controls jitterRange\n            *map(float(v),0.,float(exLength),0.1,1.); // maps 0-exlength to 0.1-1 so that there's more jitterRange in tip joints\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                vec2 tempuv = _uv;\n                \n                //distorting whole uv\n                float x1 = tempuv.x;\n                \n                float mx1 = x1 < 0. ?  // stich x distortion in in half\n                sin(-2.*iTime+x1*distortionVal2)*.1 :\n                sin(2.*iTime+x1*distortionVal2)*-.1;\n                \n                float y1 = tempuv.y;\n                y1 += mx1*(distortionVal2/60.);   // higher y distortion for swimming effect\n                //y1 += mx1*.4;\n                float my1 = sin(5.*iTime+y1*10.)*.1;\n                x1 += my1*.01;  // low x distortion for watery effect\n                tempuv = vec2(x1,y1);\n                \n \n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                } \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting rotated uv\n                 float x = uv.x;\n                // //float m = (x-.1)*(x+.1); // this makes symmetry drift\n                 float mx = x*x;\n                 float y = uv.y + (mx*distortionVal);\n                 float my = y*y;\n                 x = x + (my*distortionVal); // distorts only Y axis bc of symmetyr\n                 uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",useVariable:"metaBlur"},{name:"complexityA",useVariable:"complexityA"},{name:"complexityB",useVariable:"complexityB"},{name:"complexityC",useVariable:"complexityC"},{name:"bauScale",useVariable:"bauScale"},{name:"boneWeight",useVariable:"boneWeight"},{name:"jointWeight",useVariable:"jointWeight"},{name:"distortionVal",useVariable:"distortionVal"},{name:"distortionVal2",useVariable:"distortionVal2"},{name:"angleIN",useVariable:"angleIN"},{name:"jointX",useVariable:"jointX"},{name:"jointY",useVariable:"jointY"},{name:"contraction",useVariable:"contraction"},{name:"rotateEach",useVariable:"rotateEach"},{name:"jitterIN",useVariable:"jitterIN"},{name:"jitterSpeed",useVariable:"jitterSpeed"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"orvrfiuaz",objOut:"xm73jquh9"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"orvrfiuaz",objOut:"xm73jquh9"}]},{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"atvciid0y",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"scale",value:5.81},{name:"scrollX",value:2.6},{name:"repeat",value:1},{name:"aspect",value:1},{name:"Layer 1",value:true},{name:"Layer 2",value:true},{name:"Layer 3",value:true},{name:"Layer 4",value:true},{name:"Tileable",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"j6xyavdmv",objOut:"atvciid0y"}]}],objName:"Ops.Gl.TextureEffects.Noise.FBMNoise"},{id:"hvlvyax34",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:600},{name:"Height",value:600},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"atvciid0y",objOut:"hvlvyax34"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"njuphwrfu",objOut:"hvlvyax34"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"7uglaa91t",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Speed",value:3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"anim",portOut:"Time",objIn:"atvciid0y",objOut:"7uglaa91t"}]}],objName:"Ops.Anim.Timer_v2"},{id:"3hstcjxd2",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Speed",value:.07},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"scrollY",portOut:"Time",objIn:"atvciid0y",objOut:"3hstcjxd2"},{portIn:"Time",portOut:"Time",objIn:"j6xyavdmv",objOut:"3hstcjxd2"}]}],objName:"Ops.Anim.Timer_v2"},{id:"j6xyavdmv",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:.485},{name:"Movement",value:.403},{name:"Num",value:71.79},{name:"seed",value:0},{name:"Fill index",value:1},{name:"Fill",value:"Random"},{name:"Draw Isolines",value:true},{name:"Draw Distance",value:false},{name:"Draw Center",value:0}],objName:"Ops.Gl.TextureEffects.Noise.Voronoise"},{id:"tz4915as3",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Variable",value:"maskk"}],objName:"Ops.Vars.VarSetTexture_v2"},{id:"nhm799s19",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"njuphwrfu",objOut:"nhm799s19"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"6z8rcnxkf",objOut:"nhm799s19"},{portIn:"Image",portOut:"texture_out",objIn:"ombgxc3ol",objOut:"nhm799s19"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"njuphwrfu",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"ma6vxkmwk",objOut:"njuphwrfu"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"2uax5lm5b",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:.888},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"6z8rcnxkf",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"use original size",value:true},{name:"width",value:640},{name:"height",value:640},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"A"},{name:"Convert Greyscale index",value:0},{name:"Convert Greyscale",value:"Off"},{name:"Invert R",value:false},{name:"Invert G",value:false},{name:"Invert B",value:false},{name:"Invert A",value:false}],portsOut:[{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"2uax5lm5b",objOut:"6z8rcnxkf"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.Textures.CopyTexture"},{id:"ma6vxkmwk",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"scale",value:1.005},{name:"rotX",value:0},{name:"rotY",value:-4.26},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"betyivg2w",objOut:"ma6vxkmwk"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"betyivg2w",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Strength",value:6},{name:"Width",value:.041},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"je7xbwagq",objOut:"betyivg2w"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"g6cv71dkd",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:.287},{name:"Strength",value:25},{name:"Width",value:0},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"2uax5lm5b",objOut:"g6cv71dkd"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"93dnm75qf",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:.5},{name:"Strength",value:4},{name:"Width",value:.028},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"v4oozqwe3",objOut:"93dnm75qf"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"7t9sy3cal",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"ombgxc3ol",objOut:"7t9sy3cal"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"6b44aabms",objOut:"7t9sy3cal"},{portIn:"Texture",portOut:"texture_out",objIn:"63y1oj72q",objOut:"7t9sy3cal"},{portIn:"Image",portOut:"texture_out",objIn:"lcl6mnc9j",objOut:"7t9sy3cal"},{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"vv5syjvd8",objOut:"7t9sy3cal"},{portIn:"Image",portOut:"texture_out",objIn:"p8ebnx9yw",objOut:"7t9sy3cal"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"ombgxc3ol",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"93dnm75qf",objOut:"ombgxc3ol"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"v4oozqwe3",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"span index",value:0},{name:"span",value:"16"},{name:"reduceMin",value:128},{name:"reduceMul",value:8},{name:"use viewport size",value:true},{name:"width",value:0},{name:"height",value:0}],objName:"Ops.Gl.TextureEffects.FXAA"},{id:"8q09uq1up",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Strength",value:4}],objName:"Ops.Gl.TextureEffects.ToNormalMap"},{id:"kyf21oyvo",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"6b44aabms",objOut:"kyf21oyvo"}]},{name:"texture_out",links:[{portIn:"Normal Map",portOut:"texture_out",objIn:"vv5syjvd8",objOut:"kyf21oyvo"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"6b44aabms",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"8q09uq1up",objOut:"6b44aabms"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"ccbo9mlvb",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"posX",value:.7},{name:"posY",value:-.2},{name:"posZ",value:0},{name:"scale",value:1.75},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"cnyl7fl1h",objOut:"ccbo9mlvb"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"6lp5x2ehq",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"use viewport size",value:true},{name:"texture width",value:833},{name:"texture height",value:447},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"2x"},{name:"HDR",value:false,title:"Pixelformat Float 32bit"},{name:"Depth",value:false},{name:"Clear",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"ccbo9mlvb",objOut:"6lp5x2ehq"}]},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"izsq17zoc",objOut:"6lp5x2ehq"}]}],objName:"Ops.Gl.RenderToTexture"},{id:"vv5syjvd8",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"R",value:.901846578794093},{name:"G",value:.9959996744195572},{name:"B",value:.9538190827418381},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:1},{name:"Roughness",value:1},{name:"Active",value:true},{name:"Fresnel Intensity",value:.262},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.192},{name:"Emissive R",value:.30306337573044023},{name:"Emissive G",value:.6226663355231237},{name:"Emissive B",value:.5408479623096425},{name:"Shininess",value:3},{name:"Specular Amount",value:.658},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.303},{name:"AO Intensity",value:1},{name:"AO UV Channel index",value:0},{name:"AO UV Channel",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"Render",portOut:"Trigger Out",objIn:"63y1oj72q",objOut:"vv5syjvd8"}]}],objName:"Ops.Gl.Phong.PhongMaterial_v6"},{id:"63y1oj72q",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Mode index",value:0},{name:"Mode",value:"Norm"},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Coordinates index",value:0},{name:"Coordinates",value:"Tex Coords"},{name:"Channel index",value:0},{name:"Channel",value:"Luminance"},{name:"Flip index",value:0},{name:"Flip",value:"None"},{name:"Range index",value:0},{name:"Range",value:"0-1"},{name:"Offset X",value:0},{name:"Offset Y",value:0},{name:"Scale",value:1},{name:"Calc Normals",value:false},{name:"Normal Axis index",value:2},{name:"Normal Axis",value:"Z"},{name:"Discard Zero Values",value:false},{name:"colorize",value:false},{name:"Colorize Min",value:0},{name:"Colorize Max",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"sq9mqto0r",objOut:"63y1oj72q"}]}],objName:"Ops.Gl.ShaderEffects.VertexDisplacementMap_v4"},{id:"cnyl7fl1h",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.83},{name:"Radius",value:7.67},{name:"X",value:-1.35},{name:"Y",value:3.04},{name:"Z",value:.45},{name:"R",value:.48623007962450515},{name:"G",value:.6330214854460751},{name:"B",value:1},{name:"Specular R",value:.3057815379338912},{name:"Specular G",value:.4100902594355548},{name:"Specular B",value:.9266666655739149},{name:"Falloff",value:.383},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"lyxvbqnsl",objOut:"cnyl7fl1h"}]},{name:"World Position X",value:-1.662500023841858},{name:"World Position Y",value:5.119999885559082},{name:"World Position Z",value:.7874999642372131}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"lyxvbqnsl",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.71},{name:"Radius",value:40.62},{name:"X",value:-1.34},{name:"Y",value:-1.39},{name:"Z",value:.78},{name:"R",value:.9959996744195572},{name:"G",value:.8110593251417859},{name:"B",value:.7687872453068667},{name:"Specular R",value:1},{name:"Specular G",value:1},{name:"Specular B",value:1},{name:"Falloff",value:.49},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"irs7v52nw",objOut:"lyxvbqnsl"}]},{name:"World Position X",value:-1.6450001001358032},{name:"World Position Y",value:-2.632499933242798},{name:"World Position Z",value:1.3650000095367432}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"irs7v52nw",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.55},{name:"Radius",value:23.56},{name:"X",value:2.07},{name:"Y",value:-.2},{name:"Z",value:1.9},{name:"R",value:.8357590921577018},{name:"G",value:.9746666662891705},{name:"B",value:.8241834609800793},{name:"Specular R",value:.7213291625519593},{name:"Specular G",value:.9639755625300043},{name:"Specular B",value:.9906666665275892},{name:"Falloff",value:0},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"vv5syjvd8",objOut:"irs7v52nw"}]},{name:"World Position X",value:4.322499752044678},{name:"World Position Y",value:-.550000011920929},{name:"World Position Z",value:3.325000047683716}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"pfnwzkq53",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Type index",value:0},{name:"Type",value:"sine"},{name:"Phase",value:0},{name:"Amplitude",value:.02}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"uim77488u",objOut:"pfnwzkq53"}]}],objName:"Ops.Anim.LFO"},{id:"z7mnot1dw",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Speed",value:.3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Time",portOut:"Time",objIn:"pfnwzkq53",objOut:"z7mnot1dw"}]}],objName:"Ops.Anim.Timer_v2"},{id:"uim77488u",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"number2",value:.01}],portsOut:[{name:"result",links:[{portIn:"Extrude",portOut:"result",objIn:"63y1oj72q",objOut:"uim77488u"}]}],objName:"Ops.Math.Sum"},{id:"v0nw24bsi",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.002,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.15,"r":0.30588235294117655,"g":0.3935058951120749,"b":0.6901960784313725},{"pos":0.196,"r":0.16078431372549018,"g":0.4627450980392157,"b":0.3286744943074153},{"pos":0.432,"r":0.363691178443945,"g":0.20357707594403382,"b":0.468666658749183},{"pos":0.492,"r":0.5372549019607843,"g":0.27843137254901956,"b":0.4906667962078974},{"pos":0.524,"r":0.676666580468415,"g":0.31930203733338675,"b":0.3721919905054923},{"pos":0.582,"r":0.29411764705882354,"g":0.3803921568627451,"b":0.3669332450235579},{"pos":0.894,"r":0.21176470588235294,"g":0.34858096860858423,"b":0.596078431372549},{"pos":0.97,"r":0.42352941176470593,"g":1,"b":0.9100699981654309},{"pos":1,"r":0.42352941176470593,"g":1,"b":0.9100699981654309}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Gradient Array",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"5519431xt",objOut:"v0nw24bsi"}]}],objName:"Ops.Gl.GradientTexture"},{id:"is4e08otf",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"lcl6mnc9j",objOut:"is4e08otf"}]},{name:"texture_out",links:[{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"vv5syjvd8",objOut:"is4e08otf"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"lcl6mnc9j",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"5519431xt",objOut:"lcl6mnc9j"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"5519431xt",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"p8ebnx9yw",objOut:"5519431xt"}]}],objName:"Ops.Gl.TextureEffects.ColorMap"},{id:"p8ebnx9yw",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:true},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"xa67d2brn",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"amount",value:2.5},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"direction index",value:0},{name:"direction",value:"horizontal"}],objName:"Ops.Gl.TextureEffects.FastBlur"},{id:"xss9y3cq3",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"1aacvkqub",objOut:"xss9y3cq3"}]},{name:"texture_out",links:[{portIn:"Mask",portOut:"texture_out",objIn:"p8ebnx9yw",objOut:"xss9y3cq3"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"1aacvkqub",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"xa67d2brn",objOut:"1aacvkqub"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"41fx6cv7h",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"exclusion"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:.99},{name:"Scale Y",value:.99},{name:"Position X",value:.001},{name:"Position Y",value:.001},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"g6cv71dkd",objOut:"41fx6cv7h"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"je7xbwagq",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"amount",value:.932},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"wlby6k0xr",objOut:"je7xbwagq"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"wlby6k0xr",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"hardlight"},{name:"amount",value:.252},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:1.05},{name:"Scale Y",value:1.05},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"41fx6cv7h",objOut:"wlby6k0xr"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"sq9mqto0r",uiAttribs:{subPatch:"de5f5263-7ca2-43c7-9000-629b45bae15d"},portsIn:[{name:"radius",value:.2},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v2"},{id:"lrz9axbna",uiAttribs:{},portsOut:[{name:"Result1",links:[{portIn:"in1 BauShader metaBlur",portOut:"Result1",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result2",links:[{portIn:"in2 BauShader complexityA",portOut:"Result2",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result3",links:[{portIn:"in3 BauShader complexityB",portOut:"Result3",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result4",links:[{portIn:"in4 BauShader complexityC",portOut:"Result4",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result5",links:[{portIn:"in5 BauShader bauScale",portOut:"Result5",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result6",links:[{portIn:"in6 BauShader boneWeight",portOut:"Result6",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result7",links:[{portIn:"in7 BauShader jointWeight",portOut:"Result7",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result8",links:[{portIn:"in8 BauShader randomSeed",portOut:"Result8",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result9",links:[{portIn:"in9 BauShader distortionVal",portOut:"Result9",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result10",links:[{portIn:"in10 BauShader distortionVal2",portOut:"Result10",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result11",links:[{portIn:"in11 BauShader angleIN",portOut:"Result11",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result12",links:[{portIn:"in12 BauShader jointX",portOut:"Result12",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result13",links:[{portIn:"in13 BauShader jointY",portOut:"Result13",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result14",links:[{portIn:"in14 BauShader contraction",portOut:"Result14",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result15",links:[{portIn:"in15 BauShader rotateEach",portOut:"Result15",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result16",links:[{portIn:"in16 BauShader jitterIN",portOut:"Result16",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result17",links:[{portIn:"in17 BauShader jitterSpeed",portOut:"Result17",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result18",links:[{portIn:"in18 Ops.Gl.Matrix.Transform posX",portOut:"Result18",objIn:"50cblxqco",objOut:"lrz9axbna"}]},{name:"Result19",links:[{portIn:"in19 Ops.Gl.Matrix.Transform posY",portOut:"Result19",objIn:"50cblxqco",objOut:"lrz9axbna"}]}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"y03bzzf5c",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsOut:[{name:"create port",value:0},{name:"in0 Sequence exe",links:[{portIn:"exe",portOut:"in0 Sequence exe",objIn:"rkv7x01ic",objOut:"y03bzzf5c"}]},{name:"in1 BauShader metaBlur",links:[{portIn:"metaBlur",portOut:"in1 BauShader metaBlur",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in2 BauShader complexityA",links:[{portIn:"complexityA",portOut:"in2 BauShader complexityA",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in3 BauShader complexityB",links:[{portIn:"complexityB",portOut:"in3 BauShader complexityB",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in4 BauShader complexityC",links:[{portIn:"complexityC",portOut:"in4 BauShader complexityC",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in5 BauShader bauScale",links:[{portIn:"bauScale",portOut:"in5 BauShader bauScale",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in6 BauShader boneWeight",links:[{portIn:"boneWeight",portOut:"in6 BauShader boneWeight",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in7 BauShader jointWeight",links:[{portIn:"jointWeight",portOut:"in7 BauShader jointWeight",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in8 BauShader randomSeed",links:[{portIn:"randomSeed",portOut:"in8 BauShader randomSeed",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in9 BauShader distortionVal",links:[{portIn:"distortionVal",portOut:"in9 BauShader distortionVal",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in10 BauShader distortionVal2",links:[{portIn:"distortionVal2",portOut:"in10 BauShader distortionVal2",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in11 BauShader angleIN",links:[{portIn:"angleIN",portOut:"in11 BauShader angleIN",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in12 BauShader jointX",links:[{portIn:"jointX",portOut:"in12 BauShader jointX",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in13 BauShader jointY",links:[{portIn:"jointY",portOut:"in13 BauShader jointY",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in14 BauShader contraction",links:[{portIn:"contraction",portOut:"in14 BauShader contraction",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in15 BauShader rotateEach",links:[{portIn:"rotateEach",portOut:"in15 BauShader rotateEach",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in16 BauShader jitterIN",links:[{portIn:"jitterIN",portOut:"in16 BauShader jitterIN",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in17 BauShader jitterSpeed",links:[{portIn:"jitterSpeed",portOut:"in17 BauShader jitterSpeed",objIn:"ct7r8f3p1",objOut:"y03bzzf5c"}]},{name:"in18 Ops.Gl.Matrix.Transform posX"},{name:"in19 Ops.Gl.Matrix.Transform posY"}],objName:"Ops.Ui.PatchInput"},{id:"j4td6uiir",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"create port",value:0}],objName:"Ops.Ui.PatchOutput"},{id:"daypqvfci",uiAttribs:{},storage:{subPatchVer:1},portsIn:[{name:"create port",value:0},{name:"dataStr",value:'{"ports":[{"name":"in0 Sequence exe","type":1},{"name":"in1 BauShader metaBlur","type":0,"value":0.3},{"name":"in2 BauShader complexityA","type":0,"value":1.65},{"name":"in3 BauShader complexityB","type":0,"value":0.85},{"name":"in4 BauShader complexityC","type":0,"value":4.09},{"name":"in5 BauShader bauScale","type":0,"value":0.38},{"name":"in6 BauShader boneWeight","type":0,"value":0.01},{"name":"in7 BauShader jointWeight","type":0,"value":6.48},{"name":"in8 BauShader randomSeed","type":0,"value":0.92},{"name":"in9 BauShader distortionVal","type":0,"value":0.92},{"name":"in10 BauShader distortionVal2","type":0},{"name":"in11 BauShader angleIN","type":0,"value":0.42},{"name":"in12 BauShader jointX","type":0},{"name":"in13 BauShader jointY","type":0},{"name":"in14 BauShader contraction","type":0,"value":1.07},{"name":"in15 BauShader rotateEach","type":0,"value":-4.39},{"name":"in16 BauShader jitterIN","type":0,"value":5.07},{"name":"in17 BauShader jitterSpeed","type":0,"value":11.64},{"name":"in18 Ops.Gl.Matrix.Transform posX","type":0,"value":0},{"name":"in19 Ops.Gl.Matrix.Transform posY","type":0,"value":0}],"portsOut":[{"name":"out0 ImageCompose texture_out","type":2,"objType":"texture"}]}'},{name:"patchId",value:"3891e995-089c-4c9f-9211-0ece18d25ca9"}],portsOut:[{name:"create port out",value:0},{name:"out0 ImageCompose texture_out",links:[{portIn:"Texture 5",portOut:"out0 ImageCompose texture_out",objIn:"5672d089-99d0-49c9-97cf-43a0455c1a46",objOut:"daypqvfci"}]}],objName:"Ops.Ui.SubPatch"},{id:"rkv7x01ic",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsOut:[{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"ct7r8f3p1",objOut:"rkv7x01ic"}]},{name:"trigger 5",links:[{portIn:"Render",portOut:"trigger 5",objIn:"pxgjz5f78",objOut:"rkv7x01ic"}]},{name:"trigger 6",links:[{portIn:"render",portOut:"trigger 6",objIn:"kj5uqv8wa",objOut:"rkv7x01ic"}]},{name:"trigger 7",links:[{portIn:"Render",portOut:"trigger 7",objIn:"ue65xtvqn",objOut:"rkv7x01ic"}]},{name:"trigger 8",links:[{portIn:"Render",portOut:"trigger 8",objIn:"bgn7yhq2i",objOut:"rkv7x01ic"}]},{name:"trigger 9",links:[{portIn:"Render",portOut:"trigger 9",objIn:"d13rdu6lx",objOut:"rkv7x01ic"}]},{name:"trigger 10",links:[{portIn:"Render",portOut:"trigger 10",objIn:"cpd6nca12",objOut:"rkv7x01ic"}]},{name:"trigger 11",links:[{portIn:"render",portOut:"trigger 11",objIn:"i7z0ozm1z",objOut:"rkv7x01ic"}]},{name:"trigger 13",links:[{portIn:"Render",portOut:"trigger 13",objIn:"9ai8brfvo",objOut:"rkv7x01ic"}]}],objName:"Ops.Trigger.Sequence"},{id:"9ai8brfvo",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:true},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"jywvbq7pq",objOut:"9ai8brfvo"}]},{name:"texture_out",links:[{portIn:"out0 ImageCompose texture_out",portOut:"texture_out",objIn:"j4td6uiir",objOut:"9ai8brfvo"}]},{name:"Aspect Ratio",value:1.8635346756152125}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"dzku9w80h",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use Viewport Size",value:false},{name:"Width",value:360},{name:"Height",value:360},{name:"filter index",value:0},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"Floating Point",value:false},{name:"Num Textures index",value:0},{name:"Num Textures",value:"1"}],portsOut:[{name:"Next",links:[{portIn:"Render",portOut:"Next",objIn:"pzd4tv5cw",objOut:"dzku9w80h"}]},{name:"Texture",links:[{portIn:"Image",portOut:"Texture",objIn:"d79l8u9g5",objOut:"dzku9w80h"},{portIn:"Image",portOut:"Texture",objIn:"b1um907wd",objOut:"dzku9w80h"},{portIn:"Mask",portOut:"Texture",objIn:"b1um907wd",objOut:"dzku9w80h"},{portIn:"Image",portOut:"Texture",objIn:"klee25a36",objOut:"dzku9w80h"},{portIn:"Mask",portOut:"Texture",objIn:"klee25a36",objOut:"dzku9w80h"},{portIn:"Image",portOut:"Texture",objIn:"dv5gef003",objOut:"dzku9w80h"}]}],objName:"Ops.Gl.Shader.ShaderToTexture"},{id:"jywvbq7pq",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:.06},{name:"Position Y",value:.06},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"ct7r8f3p1",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Fragment Code",value:"\nIN vec2 texCoord;\nUNI vec2 iResolution;\nUNI float iTime;\nUNI float metaBlur;\nUNI int complexityA;\nUNI int complexityB;\nUNI int complexityC;\nUNI float bauScale;\nUNI float boneWeight;\nUNI float jointWeight;\nUNI float randomSeed;\nUNI float distortionVal;\nUNI float distortionVal2;\nUNI float angleIN;\nUNI float jointX;\nUNI float jointY;\nUNI float contraction;\nUNI float rotateEach;\nUNI float jitterIN;\nUNI float jitterSpeed;\n\n//-----\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec3 draw_line(float d, float thickness) {\n  const float aa = 3.0; //3.0; // base line gradient\n  \n  //float aa = smoothstep(1.0,10.0,1.);// base line gradient\n  \n  //return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n  return vec3(smoothstep(0.0, aa / iResolution.y, max(0.0, abs(d) - thickness)));\n}\nvec3 draw_line(float d) {\n  return draw_line(d, .002); // base line gradient\n}\n\nfloat draw_solid(float d) {\n  return smoothstep(0.0, 3. / iResolution.y, max(0.0, d)); // outergradient\n}\n\nvec3 draw_distance(float d, vec2 p) { // this doesn't need uv\n//vec3 draw_distance(float d) {\n\n  float t = clamp(d * 0.85, 0.0, 1.0);\n  \n  //vec3 grad = mix(vec3(1, 0.8, 0.5), vec3(0.3, 0.8, 1), t); // ramp colors\n  vec3 grad = mix(vec3(1.), vec3(.1), t); // ramp colors inside / outside\n\n  float d0 = abs(1.0 - draw_line(mod(d + 0.1, 0.2) - 0.1).x);\n  float d1 = abs(1.0 - draw_line(mod(d + 0.025, 0.05) - 0.025).x);\n  float d2 = abs(1.0 - draw_line(d).x);\n  \n  vec3 rim = vec3(max(d2 * 0.85, max(d0 * 0.25, d1 * 0.06125))); // drawrim\n  grad -= rim; // antialias\n  //grad -= mix(vec3(0.05, 0.35, 0.35), vec3(0.0), draw_solid(d));\n  grad -= mix(vec3(.0, .0, .0), vec3(.92), draw_solid(d)); // masks the outside\n\n  return grad;\n}\n\nfloat rand(float n) {\n    return fract(sin(n) * 43758.5453123);\n}\n\nfloat srand(float n) {\n    return rand(n)*2.-1.;\n}\n\nfloat lineDist(vec2 p, vec2 start, vec2 end, float width)\n{\n\n\tvec2 dir = start - end;\n\tfloat lngth = length(dir);\n\tdir /= lngth;\n\t\n\tvec2 proj = max(0.0, min(lngth, dot((start - p), dir))) * dir;\n\t\n\treturn length( (start - p) - proj ) - (width / 2.);\n}\n\nfloat smoothMerge(float d1, float d2, float k) // merge lines\n{\n    float h = clamp(0.5 + 0.5*(d2 - d1)/k, 0.0, 1.0);\n    return mix(d2, d1, h) - k * h * (1.0-h);\n}\n\nvec2 rotate2D(vec2 p, float theta)\n{\n    return p * mat2(cos(theta), -sin(theta), sin(theta), cos(theta));\n}\n\n#define PI (3.1415*2.)\n{{MODULES_HEAD}}\n\n//void mainImage( out vec4 fragColor, in vec2 fragCoord ) // cables main takes no inputs\nvoid main()\n{\n    vec2 _uv = (2.*gl_FragCoord.xy-iResolution.xy)/iResolution.y; // iFragCoord is replaced by cables gl_FragCoord\n\n    float d = 10000000.;\n    //float i = float(int(iTime/10.)); // new creature time loop\n    float i = randomSeed; // rand(randomSeed) was bugged\n    \n    \n\n    for(int b=0;b< complexityA;b++){ // extremity sets\n\t    vec2 last = vec2(0.0);\n    \t//float la = 0.0; // last a value\n    \t//float la = angleIN; // could rotate whole arm\n    \t\n    \tfloat iniexLength = rand(i++); //initialize random float\n    \tint exLength = int(map(iniexLength, 0.,1.,\n    \t4.,float(complexityB))); // map rand float to 4-complexityB as maxnumber\n    \t\n        for(int v=0;v< exLength;v++){ // extremity joint no.\n            float a = srand(i++)*2.1415;\n            float s = .5+.5*rand(i++);\n            s *= bauScale; // size\n            // move\n            //a += smoothstep(-.5,.5,sin(iTime*1.5))* srand(i++)*.2;\n            // preparation\n            //a += sin(iTime*3.0)* srand(i++)*.25;\n            // breathe\n            //a += sin(iTime*1.0)* srand(i++)*.04;\n            // pulse jitter\n            a += smoothstep(.1,1.,sin(iTime*(srand(i++)*jitterSpeed))) // \n            * srand(i++)*jitterIN // JitterIN controls jitterRange\n            *map(float(v),0.,float(exLength),0.1,1.); // maps 0-exlength to 0.1-1 so that there's more jitterRange in tip joints\n            //a += la;\n            \n            a += angleIN; // this moves whole arm directly\n            a += rotateEach*srand(i++); // this moves all randomly\n            \n            \n            vec2 opos = last + vec2(sin(a),cos(a))*s;\n            opos = opos*contraction; // * stretch\n            opos = opos+vec2(jointX,jointY); // xy pos\n            //opos = opos+vec2(noiseVal*.1,noiseVal*.1); // 1D strech\n        \n        \n            // this rotates the wholearm again\n            // vec2 oposR = vec2(sin(a),cos(a))*s;\n            // oposR = rotate2D(oposR,angleIN2*PI);\n            // vec2 opos = last + oposR; \n            \n            \n            //float bs = rand(i++); // ballthick randomness\n            float ls = rand(i++); // linethick randomness\n            float ma = rand(i++); // mergethick randomness\n            \n            float anglePie = (2.*PI)/float(complexityC); // odd number of symmetries require dividing full circle by no. of symmetries\n            vec2 uv = _uv;\n\n            for(int k=1;k<=complexityC;k++){ // symmetry loop\n                \n                vec2 tempuv = _uv;\n                \n                //distorting whole uv\n                float x1 = tempuv.x;\n                \n                float mx1 = x1 < 0. ?  // stich x distortion in in half\n                sin(-2.*iTime+x1*distortionVal2)*.1 :\n                sin(2.*iTime+x1*distortionVal2)*-.1;\n                \n                float y1 = tempuv.y;\n                y1 += mx1*(distortionVal2/60.);   // higher y distortion for swimming effect\n                //y1 += mx1*.4;\n                float my1 = sin(5.*iTime+y1*10.)*.1;\n                x1 += my1*.01;  // low x distortion for watery effect\n                tempuv = vec2(x1,y1);\n                \n \n                \n                if ((complexityC%2) == 0){ // if even then uv redefined every loop, if odd then just rotate\n                     uv = rotate2D(tempuv,1.163*PI); // reset uv every loop and rotate to center symmetry axis\n                     if ((k%2)==1){ // Invert axis every 2 symmetries\n                         uv = tempuv*vec2(-1.,1.);\n                     }\n                     uv = rotate2D(uv,.833 * PI * float(k)); // 6symmetries:0.833 , multiply with K to rotate\n                } else {\n                    uv = rotate2D(uv,anglePie);\n                } \n            \n                //uv = _uv; // this just removes rotations\n                // //distorting rotated uv\n                 float x = uv.x;\n                // //float m = (x-.1)*(x+.1); // this makes symmetry drift\n                 float mx = x*x;\n                 float y = uv.y + (mx*distortionVal);\n                 float my = y*y;\n                 x = x + (my*distortionVal); // distorts only Y axis bc of symmetyr\n                 uv = vec2(x,y);\n                \n                ///Drawing part\n                float o1 = lineDist(uv,opos,last,.02+ls*boneWeight); // bone lines\n                //float o1 = lineDist( uv,rotate2D(opos,angleIN*PI),rotate2D(last,angleIN*PI),.02+ls*boneWeight); // rotate wholearm\n                //float o2 = length( uv - opos) - (.01+bs*jointWeight); // joint balls\n                //float o = min(o1,o2);\n                float o = o1;\n                d = smoothMerge(d,o,.01 + ma * metaBlur);   // Merge shapes    \n                d = min(d,o);\n                \n\n            } \n            //la = a;\n            last = opos;        \n        }\n    }\n\n    \n    vec3 col = draw_distance(d,_uv); // doesn't use uv\n    //vec3 col = draw_distance(d);\n\n    outColor = vec4(col,1.0); // Output\n}"},{name:"Vertex Code",value:"\n{{MODULES_HEAD}}\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\nIN float attrVertIndex;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    {{MODULE_VERTEX_POSITION}}\n    gl_Position = projMatrix * (viewMatrix*mMatrix) * pos;\n}"},{name:"Use As Material",value:true},{name:"iResolution X",value:360},{name:"iResolution Y",value:360},{name:"iTime",value:6918.197199999989,useVariable:"newBauplan loop"},{name:"metaBlur",useVariable:"metaBlur"},{name:"complexityA",useVariable:"complexityA"},{name:"complexityB",useVariable:"complexityB"},{name:"complexityC",useVariable:"complexityC"},{name:"bauScale",useVariable:"bauScale"},{name:"boneWeight",useVariable:"boneWeight"},{name:"jointWeight",useVariable:"jointWeight"},{name:"distortionVal",useVariable:"distortionVal"},{name:"distortionVal2",useVariable:"distortionVal2"},{name:"angleIN",useVariable:"angleIN"},{name:"jointX",useVariable:"jointX"},{name:"jointY",useVariable:"jointY"},{name:"contraction",useVariable:"contraction"},{name:"rotateEach",useVariable:"rotateEach"},{name:"jitterIN",useVariable:"jitterIN"},{name:"jitterSpeed",useVariable:"jitterSpeed"}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"dzku9w80h",objOut:"ct7r8f3p1"}]},{name:"Shader",links:[{portIn:"Shader",portOut:"Shader",objIn:"dzku9w80h",objOut:"ct7r8f3p1"}]},{name:"Has Errors",value:false}],objName:"Ops.Gl.Shader.CustomShader_v2"},{id:"0rhzrd44s",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"scale",value:5.81},{name:"scrollX",value:2.6},{name:"repeat",value:1},{name:"aspect",value:1},{name:"Layer 1",value:true},{name:"Layer 2",value:true},{name:"Layer 3",value:true},{name:"Layer 4",value:true},{name:"Tileable",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"4xo56zili",objOut:"0rhzrd44s"}]}],objName:"Ops.Gl.TextureEffects.Noise.FBMNoise"},{id:"pzd4tv5cw",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:600},{name:"Height",value:600},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"0rhzrd44s",objOut:"pzd4tv5cw"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"41rn7m52d",objOut:"pzd4tv5cw"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"s84dsa096",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Speed",value:3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"anim",portOut:"Time",objIn:"0rhzrd44s",objOut:"s84dsa096"}]}],objName:"Ops.Anim.Timer_v2"},{id:"lwr7qbkms",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Speed",value:.07},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"scrollY",portOut:"Time",objIn:"0rhzrd44s",objOut:"lwr7qbkms"},{portIn:"Time",portOut:"Time",objIn:"4xo56zili",objOut:"lwr7qbkms"}]}],objName:"Ops.Anim.Timer_v2"},{id:"4xo56zili",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"color dodge"},{name:"Amount",value:.485},{name:"Movement",value:.403},{name:"Num",value:71.79},{name:"seed",value:0},{name:"Fill index",value:1},{name:"Fill",value:"Random"},{name:"Draw Isolines",value:true},{name:"Draw Distance",value:false},{name:"Draw Center",value:0}],objName:"Ops.Gl.TextureEffects.Noise.Voronoise"},{id:"31cvzjat1",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Variable",value:"maskk"}],objName:"Ops.Vars.VarSetTexture_v2"},{id:"pxgjz5f78",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"41rn7m52d",objOut:"pxgjz5f78"}]},{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"kj5uqv8wa",objOut:"pxgjz5f78"},{portIn:"Image",portOut:"texture_out",objIn:"jmke2upe9",objOut:"pxgjz5f78"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"41rn7m52d",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"3jg8l4yjm",objOut:"41rn7m52d"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"z6coc4ddh",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:.888},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"kj5uqv8wa",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"use original size",value:true},{name:"width",value:640},{name:"height",value:640},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"clamp to edge"},{name:"HDR",value:false},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"A"},{name:"Convert Greyscale index",value:0},{name:"Convert Greyscale",value:"Off"},{name:"Invert R",value:false},{name:"Invert G",value:false},{name:"Invert B",value:false},{name:"Invert A",value:false}],portsOut:[{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"z6coc4ddh",objOut:"kj5uqv8wa"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.Textures.CopyTexture"},{id:"3jg8l4yjm",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"scale",value:1.005},{name:"rotX",value:0},{name:"rotY",value:-4.26},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"p82cdzpll",objOut:"3jg8l4yjm"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"p82cdzpll",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Strength",value:6},{name:"Width",value:.041},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"d79l8u9g5",objOut:"p82cdzpll"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"3vhmfnlgv",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:.287},{name:"Strength",value:25},{name:"Width",value:0},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"z6coc4ddh",objOut:"3vhmfnlgv"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"1av1fc5z6",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"lighten"},{name:"Amount",value:.5},{name:"Strength",value:4},{name:"Width",value:.028},{name:"Mul Color",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"6vlwtb80i",objOut:"1av1fc5z6"}]}],objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"},{id:"ue65xtvqn",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"jmke2upe9",objOut:"ue65xtvqn"}]},{name:"texture_out",links:[{portIn:"Image",portOut:"texture_out",objIn:"zo6rkbpe0",objOut:"ue65xtvqn"},{portIn:"Texture",portOut:"texture_out",objIn:"8dhhzdwq3",objOut:"ue65xtvqn"},{portIn:"Image",portOut:"texture_out",objIn:"pb30htizd",objOut:"ue65xtvqn"},{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"t8i4h3qav",objOut:"ue65xtvqn"},{portIn:"Image",portOut:"texture_out",objIn:"w5vh6safe",objOut:"ue65xtvqn"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"jmke2upe9",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"1av1fc5z6",objOut:"jmke2upe9"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"6vlwtb80i",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"span index",value:0},{name:"span",value:"16"},{name:"reduceMin",value:128},{name:"reduceMul",value:8},{name:"use viewport size",value:true},{name:"width",value:0},{name:"height",value:0}],objName:"Ops.Gl.TextureEffects.FXAA"},{id:"jk6gk1pqz",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Strength",value:4}],objName:"Ops.Gl.TextureEffects.ToNormalMap"},{id:"bgn7yhq2i",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"zo6rkbpe0",objOut:"bgn7yhq2i"}]},{name:"texture_out",links:[{portIn:"Normal Map",portOut:"texture_out",objIn:"t8i4h3qav",objOut:"bgn7yhq2i"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"zo6rkbpe0",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"jk6gk1pqz",objOut:"zo6rkbpe0"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"b5p4r1l4i",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"posX",value:1.4},{name:"posY",value:.6},{name:"posZ",value:0},{name:"scale",value:1.75},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Trigger In",portOut:"trigger",objIn:"8favwokcz",objOut:"b5p4r1l4i"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"i7z0ozm1z",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"use viewport size",value:true},{name:"texture width",value:833},{name:"texture height",value:447},{name:"Auto Aspect",value:false},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:0},{name:"MSAA",value:"2x"},{name:"HDR",value:false,title:"Pixelformat Float 32bit"},{name:"Depth",value:false},{name:"Clear",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"b5p4r1l4i",objOut:"i7z0ozm1z"}]},{name:"texture",links:[{portIn:"Image",portOut:"texture",objIn:"jywvbq7pq",objOut:"i7z0ozm1z"}]}],objName:"Ops.Gl.RenderToTexture"},{id:"t8i4h3qav",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"R",value:.901846578794093},{name:"G",value:.9959996744195572},{name:"B",value:.9538190827418381},{name:"A",value:1},{name:"Enable",value:true},{name:"Albedo",value:1},{name:"Roughness",value:1},{name:"Active",value:true},{name:"Fresnel Intensity",value:.262},{name:"Fresnel Width",value:1},{name:"Fresnel Exponent",value:6},{name:"Fresnel R",value:1},{name:"Fresnel G",value:1},{name:"Fresnel B",value:1},{name:"Emissive Active",value:false},{name:"Color Intensity",value:.192},{name:"Emissive R",value:.30306337573044023},{name:"Emissive G",value:.6226663355231237},{name:"Emissive B",value:.5408479623096425},{name:"Shininess",value:3},{name:"Specular Amount",value:.658},{name:"Specular Model index",value:0},{name:"Specular Model",value:"Phong"},{name:"Energy Conservation",value:false},{name:"Double Sided Material",value:false},{name:"Falloff Mode index",value:0},{name:"Falloff Mode",value:"A"},{name:"Colorize Texture",value:false},{name:"Diffuse Repeat X",value:1},{name:"Diffuse Repeat Y",value:1},{name:"Texture Offset X",value:0},{name:"Texture Offset Y",value:0},{name:"Specular Intensity",value:1},{name:"Normal Map Intensity",value:.303},{name:"AO Intensity",value:1},{name:"AO UV Channel index",value:0},{name:"AO UV Channel",value:1},{name:"Emissive Intensity",value:1},{name:"Emissive Mask Intensity",value:1},{name:"Env Map Intensity",value:1},{name:"Env Map Blend index",value:0},{name:"Env Map Blend",value:"Add"},{name:"Env Mask Intensity",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Discard Transparent Pixels",value:false}],portsOut:[{name:"Trigger Out",links:[{portIn:"Render",portOut:"Trigger Out",objIn:"8dhhzdwq3",objOut:"t8i4h3qav"}]}],objName:"Ops.Gl.Phong.PhongMaterial_v6"},{id:"8dhhzdwq3",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Mode index",value:0},{name:"Mode",value:"Norm"},{name:"Axis index",value:0},{name:"Axis",value:"XYZ"},{name:"Coordinates index",value:0},{name:"Coordinates",value:"Tex Coords"},{name:"Channel index",value:0},{name:"Channel",value:"Luminance"},{name:"Flip index",value:0},{name:"Flip",value:"None"},{name:"Range index",value:0},{name:"Range",value:"0-1"},{name:"Offset X",value:0},{name:"Offset Y",value:0},{name:"Scale",value:1},{name:"Calc Normals",value:false},{name:"Normal Axis index",value:2},{name:"Normal Axis",value:"Z"},{name:"Discard Zero Values",value:false},{name:"colorize",value:false},{name:"Colorize Min",value:0},{name:"Colorize Max",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"8wne4y25m",objOut:"8dhhzdwq3"}]}],objName:"Ops.Gl.ShaderEffects.VertexDisplacementMap_v4"},{id:"8favwokcz",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.83},{name:"Radius",value:7.67},{name:"X",value:-1.35},{name:"Y",value:3.04},{name:"Z",value:.45},{name:"R",value:.48623007962450515},{name:"G",value:.6330214854460751},{name:"B",value:1},{name:"Specular R",value:.3057815379338912},{name:"Specular G",value:.4100902594355548},{name:"Specular B",value:.9266666655739149},{name:"Falloff",value:.383},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"2tx8ee53m",objOut:"8favwokcz"}]},{name:"World Position X",value:-.9625000953674316},{name:"World Position Y",value:5.920000076293945},{name:"World Position Z",value:.7874999642372131}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"2tx8ee53m",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.71},{name:"Radius",value:40.62},{name:"X",value:-1.34},{name:"Y",value:-1.39},{name:"Z",value:.78},{name:"R",value:.9959996744195572},{name:"G",value:.8110593251417859},{name:"B",value:.7687872453068667},{name:"Specular R",value:1},{name:"Specular G",value:1},{name:"Specular B",value:1},{name:"Falloff",value:.49},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"bvkh33ib3",objOut:"2tx8ee53m"}]},{name:"World Position X",value:-.9450000524520874},{name:"World Position Y",value:-1.8324999809265137},{name:"World Position Z",value:1.3650000095367432}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"bvkh33ib3",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Cast Light",value:true},{name:"Intensity",value:.55},{name:"Radius",value:23.56},{name:"X",value:2.07},{name:"Y",value:-.2},{name:"Z",value:1.9},{name:"R",value:.8357590921577018},{name:"G",value:.9746666662891705},{name:"B",value:.8241834609800793},{name:"Specular R",value:.7213291625519593},{name:"Specular G",value:.9639755625300043},{name:"Specular B",value:.9906666665275892},{name:"Falloff",value:0},{name:"Cast Shadow",value:false},{name:"Rendering Active",value:true},{name:"Map Size index",value:1},{name:"Map Size",value:512},{name:"Shadow Strength",value:1},{name:"Near",value:.1},{name:"Far",value:30},{name:"Bias",value:.004},{name:"Polygon Offset",value:0}],portsOut:[{name:"Trigger Out",links:[{portIn:"Trigger In",portOut:"Trigger Out",objIn:"t8i4h3qav",objOut:"bvkh33ib3"}]},{name:"World Position X",value:5.022500038146973},{name:"World Position Y",value:.2500000298023224},{name:"World Position Z",value:3.325000047683716}],objName:"Ops.Gl.Phong.PointLight_v5"},{id:"yfsodxmin",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Type index",value:0},{name:"Type",value:"sine"},{name:"Phase",value:0},{name:"Amplitude",value:.02}],portsOut:[{name:"Result",links:[{portIn:"number1",portOut:"Result",objIn:"j0vld7yig",objOut:"yfsodxmin"}]}],objName:"Ops.Anim.LFO"},{id:"8fxr72uem",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Speed",value:.3},{name:"Play",value:true},{name:"Sync to timeline",value:false}],portsOut:[{name:"Time",links:[{portIn:"Time",portOut:"Time",objIn:"yfsodxmin",objOut:"8fxr72uem"}]}],objName:"Ops.Anim.Timer_v2"},{id:"j0vld7yig",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"number2",value:.01}],portsOut:[{name:"result",links:[{portIn:"Extrude",portOut:"result",objIn:"8dhhzdwq3",objOut:"j0vld7yig"}]}],objName:"Ops.Math.Sum"},{id:"cizr7fi5g",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Gradient",value:'{"keys":[{"pos":0,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.002,"r":0.0745098039215686,"g":0.4768160987617981,"b":0.47843137254901963},{"pos":0.15,"r":0.30588235294117655,"g":0.3935058951120749,"b":0.6901960784313725},{"pos":0.196,"r":0.16078431372549018,"g":0.4627450980392157,"b":0.3286744943074153},{"pos":0.432,"r":0.363691178443945,"g":0.20357707594403382,"b":0.468666658749183},{"pos":0.492,"r":0.5372549019607843,"g":0.27843137254901956,"b":0.4906667962078974},{"pos":0.524,"r":0.676666580468415,"g":0.31930203733338675,"b":0.3721919905054923},{"pos":0.582,"r":0.29411764705882354,"g":0.3803921568627451,"b":0.3669332450235579},{"pos":0.894,"r":0.21176470588235294,"g":0.34858096860858423,"b":0.596078431372549},{"pos":0.97,"r":0.42352941176470593,"g":1,"b":0.9100699981654309},{"pos":1,"r":0.42352941176470593,"g":1,"b":0.9100699981654309}]}'},{name:"Direction index",value:0},{name:"Direction",value:"X"},{name:"Smoothstep",value:false},{name:"Step",value:false},{name:"Flip",value:false},{name:"sRGB",value:false},{name:"Oklab",value:false},{name:"Size",value:256},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"wrap index",value:0},{name:"wrap",value:"repeat"},{name:"Gradient Array",value:0}],portsOut:[{name:"Texture",links:[{portIn:"Gradient",portOut:"Texture",objIn:"4ykmzfhoz",objOut:"cizr7fi5g"}]}],objName:"Ops.Gl.GradientTexture"},{id:"cpd6nca12",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:true},{name:"Transparent",value:true}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"pb30htizd",objOut:"cpd6nca12"}]},{name:"texture_out",links:[{portIn:"Diffuse Texture",portOut:"texture_out",objIn:"t8i4h3qav",objOut:"cpd6nca12"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"pb30htizd",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"4ykmzfhoz",objOut:"pb30htizd"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"4ykmzfhoz",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Blend Mode index",value:0},{name:"Blend Mode",value:"normal"},{name:"Amount",value:1},{name:"Method index",value:0},{name:"Method",value:"Luminance"},{name:"Min",value:0},{name:"Max",value:1},{name:"Position",value:.5}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"w5vh6safe",objOut:"4ykmzfhoz"}]}],objName:"Ops.Gl.TextureEffects.ColorMap"},{id:"w5vh6safe",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:true},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"vh51rfqhs",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"amount",value:2.5},{name:"Clamp",value:false},{name:"Mask Invert",value:false},{name:"direction index",value:0},{name:"direction",value:"horizontal"}],objName:"Ops.Gl.TextureEffects.FastBlur"},{id:"d13rdu6lx",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"Use viewport size",value:false},{name:"Width",value:640},{name:"Height",value:640},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"HDR",value:false},{name:"Transparent",value:false}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"dv5gef003",objOut:"d13rdu6lx"}]},{name:"texture_out",links:[{portIn:"Mask",portOut:"texture_out",objIn:"w5vh6safe",objOut:"d13rdu6lx"}]},{name:"Aspect Ratio",value:1}],objName:"Ops.Gl.TextureEffects.ImageCompose_v2"},{id:"dv5gef003",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"normal"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"alpha channel"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"vh51rfqhs",objOut:"dv5gef003"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"klee25a36",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"exclusion"},{name:"amount",value:1},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:.99},{name:"Scale Y",value:.99},{name:"Position X",value:.001},{name:"Position Y",value:.001},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"3vhmfnlgv",objOut:"klee25a36"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"d79l8u9g5",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"multiply"},{name:"amount",value:.932},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:false},{name:"Scale X",value:1},{name:"Scale Y",value:1},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"b1um907wd",objOut:"d79l8u9g5"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"b1um907wd",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"blendMode index",value:0},{name:"blendMode",value:"hardlight"},{name:"amount",value:.252},{name:"Premultiplied",value:false},{name:"Alpha Mask",value:false},{name:"removeAlphaSrc",value:false},{name:"Mask Src index",value:1},{name:"Mask Src",value:"luminance"},{name:"Invert alpha channel",value:false},{name:"Aspect Ratio",value:false},{name:"Stretch Axis index",value:0},{name:"Stretch Axis",value:"X"},{name:"Position",value:0},{name:"Crop",value:false},{name:"flip x",value:false},{name:"flip y",value:false},{name:"Transform",value:true},{name:"Scale X",value:1.05},{name:"Scale Y",value:1.05},{name:"Position X",value:0},{name:"Position Y",value:0},{name:"Rotation",value:0},{name:"Clip Repeat",value:false}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"klee25a36",objOut:"b1um907wd"}]}],objName:"Ops.Gl.TextureEffects.DrawImage_v3"},{id:"8wne4y25m",uiAttribs:{subPatch:"3891e995-089c-4c9f-9211-0ece18d25ca9"},portsIn:[{name:"radius",value:.2},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:false},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:false},{name:"Draw",value:true,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v2"},{id:"smzcrere3",uiAttribs:{},portsOut:[{name:"Result1",links:[{portIn:"in1 BauShader metaBlur",portOut:"Result1",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result2",links:[{portIn:"in2 BauShader complexityA",portOut:"Result2",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result3",links:[{portIn:"in3 BauShader complexityB",portOut:"Result3",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result4",links:[{portIn:"in4 BauShader complexityC",portOut:"Result4",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result5",links:[{portIn:"in5 BauShader bauScale",portOut:"Result5",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result6",links:[{portIn:"in6 BauShader boneWeight",portOut:"Result6",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result7",links:[{portIn:"in7 BauShader jointWeight",portOut:"Result7",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result8",links:[{portIn:"in8 BauShader randomSeed",portOut:"Result8",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result9",links:[{portIn:"in9 BauShader distortionVal",portOut:"Result9",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result10",links:[{portIn:"in10 BauShader distortionVal2",portOut:"Result10",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result11",links:[{portIn:"in11 BauShader angleIN",portOut:"Result11",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result12",links:[{portIn:"in12 BauShader jointX",portOut:"Result12",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result13",links:[{portIn:"in13 BauShader jointY",portOut:"Result13",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result14",links:[{portIn:"in14 BauShader contraction",portOut:"Result14",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result15",links:[{portIn:"in15 BauShader rotateEach",portOut:"Result15",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result16",links:[{portIn:"in16 BauShader jitterIN",portOut:"Result16",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result17",links:[{portIn:"in17 BauShader jitterSpeed",portOut:"Result17",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result18",links:[{portIn:"in18 Ops.Gl.Matrix.Transform posX",portOut:"Result18",objIn:"daypqvfci",objOut:"smzcrere3"}]},{name:"Result19",links:[{portIn:"in19 Ops.Gl.Matrix.Transform posY",portOut:"Result19",objIn:"daypqvfci",objOut:"smzcrere3"}]}],objName:"Ops.User.paramuno.ArrayToChannel"},{id:"8yl4yiscn",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"In",portOut:"Result",objIn:"xxid38b0r",objOut:"8yl4yiscn"},{portIn:"Array",portOut:"Result",objIn:"ftsl132n5",objOut:"8yl4yiscn"}]}],objName:"Ops.User.paramuno.ArrayPreviousStore"},{id:"ftsl132n5",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"In",portOut:"Result",objIn:"lrz9axbna",objOut:"ftsl132n5"},{portIn:"Array",portOut:"Result",objIn:"lptc5vb0p",objOut:"ftsl132n5"}]}],objName:"Ops.User.paramuno.ArrayPreviousStore"},{id:"lptc5vb0p",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"In",portOut:"Result",objIn:"smzcrere3",objOut:"lptc5vb0p"}]}],objName:"Ops.User.paramuno.ArrayPreviousStore"},{id:"vg5ym0e77",uiAttribs:{},portsOut:[{name:"Result1",links:[{portIn:"metaBlur",portOut:"Result1",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result2",links:[{portIn:"complexityA",portOut:"Result2",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result3",links:[{portIn:"complexityB",portOut:"Result3",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result4",links:[{portIn:"complexityC",portOut:"Result4",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result5",links:[{portIn:"bauScale",portOut:"Result5",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result6",links:[{portIn:"boneWeight",portOut:"Result6",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result7",links:[{portIn:"jointWeight",portOut:"Result7",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result8",links:[{portIn:"randomSeed",portOut:"Result8",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result9",links:[{portIn:"distortionVal",portOut:"Result9",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result10",links:[{portIn:"distortionVal2",portOut:"Result10",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result11",links:[{portIn:"angleIN",portOut:"Result11",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result12",links:[{portIn:"jointX",portOut:"Result12",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result13",links:[{portIn:"jointY",portOut:"Result13",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result14",links:[{portIn:"contraction",portOut:"Result14",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result15",links:[{portIn:"rotateEach",portOut:"Result15",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result16",links:[{portIn:"jitterIN",portOut:"Result16",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result17",links:[{portIn:"jitterSpeed",portOut:"Result17",objIn:"3daf69a7-6308-40f9-bceb-8a92f8e72127",objOut:"vg5ym0e77"}]},{name:"Result18"},{name:"Result19"}],objName:"Ops.User.paramuno.ArrayToChannel"}],_id:"654ba651770dad577f13e4bf",export:{time:"2023-11-09 23:12:51",service:"github",exportNumber:1}};if(!CABLES.exportedPatch){CABLES.exportedPatch=CABLES.exportedPatches["fZqwLK"]}"use strict";var CABLES=CABLES||{};CABLES.OPS=CABLES.OPS||{};var Ops=Ops||{};Ops.Gl=Ops.Gl||{};Ops.Ui=Ops.Ui||{};Ops.Net=Ops.Net||{};Ops.Anim=Ops.Anim||{};Ops.Html=Ops.Html||{};Ops.Json=Ops.Json||{};Ops.Math=Ops.Math||{};Ops.User=Ops.User||{};Ops.Vars=Ops.Vars||{};Ops.Array=Ops.Array||{};Ops.Value=Ops.Value||{};Ops.Cables=Ops.Cables||{};Ops.Boolean=Ops.Boolean||{};Ops.Devices=Ops.Devices||{};Ops.Trigger=Ops.Trigger||{};Ops.Gl.Phong=Ops.Gl.Phong||{};Ops.Gl.Matrix=Ops.Gl.Matrix||{};Ops.Gl.Meshes=Ops.Gl.Meshes||{};Ops.Gl.Shader=Ops.Gl.Shader||{};Ops.Deprecated=Ops.Deprecated||{};Ops.Gl.Textures=Ops.Gl.Textures||{};Ops.Math.Compare=Ops.Math.Compare||{};Ops.Net.WebSocket=Ops.Net.WebSocket||{};Ops.User.paramuno=Ops.User.paramuno||{};Ops.Devices.Keyboard=Ops.Devices.Keyboard||{};Ops.Gl.ShaderEffects=Ops.Gl.ShaderEffects||{};Ops.Deprecated.Cables=Ops.Deprecated.Cables||{};Ops.Gl.TextureEffects=Ops.Gl.TextureEffects||{};Ops.Gl.TextureEffects.Noise=Ops.Gl.TextureEffects.Noise||{};Ops.Gl.MainLoop=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inValue("FPS Limit",0),a=n.outTrigger("trigger"),r=n.outNumber("width"),o=n.outNumber("height"),i=n.inValueBool("Reduce FPS not focussed",true),l=n.inValueBool("Reduce FPS loading"),s=n.inValueBool("Clear",true),u=n.inValueBool("ClearAlpha",true),m=n.inValueBool("Fullscreen Button",false),c=n.inValueBool("Active",true),d=n.inValueBool("Hires Displays",false),f=n.inSwitch("Pixel Unit",["Display","CSS"],"Display");n.onAnimFrame=A;d.onChange=function(){if(d.get())n.patch.cgl.pixelDensity=window.devicePixelRatio;else n.patch.cgl.pixelDensity=1;n.patch.cgl.updateSize();if(CABLES.UI)gui.setLayout()};c.onChange=function(){n.patch.removeOnAnimFrame(n);if(c.get()){n.setUiAttrib({extendTitle:""});n.onAnimFrame=A;n.patch.addOnAnimFrame(n);n.log("adding again!")}else{n.setUiAttrib({extendTitle:"Inactive"})}};const p=n.patch.cgl;let b=0;let v=0;if(!n.patch.cgl)n.uiAttr({error:"No webgl cgl context"});const g=vec3.create();vec3.set(g,0,0,0);const h=vec3.create();vec3.set(h,0,0,-2);m.onChange=T;setTimeout(T,100);let x=null;let O=true;let I=true;window.addEventListener("blur",()=>{O=false});window.addEventListener("focus",()=>{O=true});document.addEventListener("visibilitychange",()=>{I=!document.hidden});S();f.onChange=()=>{r.set(0);o.set(0)};function _(){if(l.get()&&n.patch.loading.getProgress()<1)return 5;if(i.get()){if(!I)return 10;if(!O)return 30}return t.get()}function T(){function e(){if(x)x.style.display="block"}function t(){if(x)x.style.display="none"}n.patch.cgl.canvas.addEventListener("mouseleave",t);n.patch.cgl.canvas.addEventListener("mouseenter",e);if(m.get()){if(!x){x=document.createElement("div");const a=n.patch.cgl.canvas.parentElement;if(a)a.appendChild(x);x.addEventListener("mouseenter",e);x.addEventListener("click",function(e){if(CABLES.UI&&!e.shiftKey)gui.cycleFullscreen();else p.fullScreen()})}x.style.padding="10px";x.style.position="absolute";x.style.right="5px";x.style.top="5px";x.style.width="20px";x.style.height="20px";x.style.cursor="pointer";x.style["border-radius"]="40px";x.style.background="#444";x.style["z-index"]="9999";x.style.display="none";x.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 490 490" style="width:20px;height:20px;" xml:space="preserve" width="512px" height="512px"><g><path d="M173.792,301.792L21.333,454.251v-80.917c0-5.891-4.776-10.667-10.667-10.667C4.776,362.667,0,367.442,0,373.333V480     c0,5.891,4.776,10.667,10.667,10.667h106.667c5.891,0,10.667-4.776,10.667-10.667s-4.776-10.667-10.667-10.667H36.416     l152.459-152.459c4.093-4.237,3.975-10.99-0.262-15.083C184.479,297.799,177.926,297.799,173.792,301.792z" fill="#FFFFFF"/><path d="M480,0H373.333c-5.891,0-10.667,4.776-10.667,10.667c0,5.891,4.776,10.667,10.667,10.667h80.917L301.792,173.792     c-4.237,4.093-4.354,10.845-0.262,15.083c4.093,4.237,10.845,4.354,15.083,0.262c0.089-0.086,0.176-0.173,0.262-0.262     L469.333,36.416v80.917c0,5.891,4.776,10.667,10.667,10.667s10.667-4.776,10.667-10.667V10.667C490.667,4.776,485.891,0,480,0z" fill="#FFFFFF"/><path d="M36.416,21.333h80.917c5.891,0,10.667-4.776,10.667-10.667C128,4.776,123.224,0,117.333,0H10.667     C4.776,0,0,4.776,0,10.667v106.667C0,123.224,4.776,128,10.667,128c5.891,0,10.667-4.776,10.667-10.667V36.416l152.459,152.459     c4.237,4.093,10.99,3.975,15.083-0.262c3.992-4.134,3.992-10.687,0-14.82L36.416,21.333z" fill="#FFFFFF"/><path d="M480,362.667c-5.891,0-10.667,4.776-10.667,10.667v80.917L316.875,301.792c-4.237-4.093-10.99-3.976-15.083,0.261     c-3.993,4.134-3.993,10.688,0,14.821l152.459,152.459h-80.917c-5.891,0-10.667,4.776-10.667,10.667s4.776,10.667,10.667,10.667     H480c5.891,0,10.667-4.776,10.667-10.667V373.333C490.667,367.442,485.891,362.667,480,362.667z" fill="#FFFFFF"/></g></svg>'}else{if(x){x.style.display="none";x.remove();x=null}}}n.onDelete=function(){p.gl.clearColor(0,0,0,0);p.gl.clear(p.gl.COLOR_BUFFER_BIT|p.gl.DEPTH_BUFFER_BIT)};function A(e){if(!c.get())return;if(p.aborted||p.canvas.clientWidth===0||p.canvas.clientHeight===0)return;n.patch.cg=p;if(d.get())n.patch.cgl.pixelDensity=window.devicePixelRatio;const t=performance.now();n.patch.config.fpsLimit=_();if(p.canvasWidth==-1){p.setCanvas(n.patch.config.glCanvasId);return}if(p.canvasWidth!=r.get()||p.canvasHeight!=o.get()){let e=1;if(f.get()=="CSS")e=n.patch.cgl.pixelDensity;r.set(p.canvasWidth/e);o.set(p.canvasHeight/e)}if(CABLES.now()-v>1e3){CGL.fpsReport=CGL.fpsReport||[];if(n.patch.loading.getProgress()>=1&&v!==0)CGL.fpsReport.push(b);b=0;v=CABLES.now()}CGL.MESH.lastShader=null;CGL.MESH.lastMesh=null;p.renderStart(p,g,h);if(s.get()){p.gl.clearColor(0,0,0,1);p.gl.clear(p.gl.COLOR_BUFFER_BIT|p.gl.DEPTH_BUFFER_BIT)}a.trigger();if(CGL.MESH.lastMesh)CGL.MESH.lastMesh.unBind();if(CGL.Texture.previewTexture){if(!CGL.Texture.texturePreviewer)CGL.Texture.texturePreviewer=new CGL.Texture.texturePreview(p);CGL.Texture.texturePreviewer.render(CGL.Texture.previewTexture)}p.renderEnd(p);n.patch.cg=null;if(u.get()){p.gl.clearColor(1,1,1,1);p.gl.colorMask(false,false,false,true);p.gl.clear(p.gl.COLOR_BUFFER_BIT);p.gl.colorMask(true,true,true,true)}if(!p.frameStore.phong)p.frameStore.phong={};b++;n.patch.cgl.profileData.profileMainloopMs=performance.now()-t}function S(){setTimeout(()=>{if(n.patch.getOpsByObjName(n.name).length>1){n.setUiError("multimainloop","there should only be one mainloop op!");n.patch.addEventListener("onOpDelete",S)}else n.setUiError("multimainloop",null,1)},500)}};Ops.Gl.MainLoop.prototype=new CABLES.Op;CABLES.OPS["b0472a1d-db16-4ba6-8787-f300fbdc77bb"]={f:Ops.Gl.MainLoop,objName:"Ops.Gl.MainLoop"};Ops.Trigger.Sequence=function(){CABLES.Op.apply(this,arguments);const o=this;const e={};const t=o.inTrigger("exe"),a=o.inTriggerButton("Clean up connections");const n=[],i=[],r=16;let l=null,s=[];t.onTriggered=c;a.onTriggered=d;a.setUiAttribs({hideParam:true,hidePort:true});for(let t=0;t<r;t++){const f=o.outTrigger("trigger "+t);i.push(f);f.onLinkChanged=m;if(t<r-1){let e=o.inTrigger("exe "+t);e.onTriggered=c;n.push(e)}}u();function u(){s.length=0;for(let e=0;e<i.length;e++)if(i[e].links.length>0)s.push(i[e])}function m(){u();clearTimeout(l);l=setTimeout(()=>{let t=false;for(let e=0;e<i.length;e++)if(i[e].links.length>1)t=true;a.setUiAttribs({hideParam:!t});if(o.isCurrentUiOp())o.refreshParams()},60)}function c(){for(let e=0;e<s.length;e++)s[e].trigger()}function d(){let n=0;for(let a=0;a<i.length;a++){let t=[];if(i[a].links.length>1)for(let e=1;e<i[a].links.length;e++){while(i[n].links.length>0)n++;t.push(i[a].links[e]);const r=i[a].links[e].getOtherPort(i[a]);o.patch.link(o,"trigger "+n,r.op,r.name);n++}for(let e=0;e<t.length;e++)t[e].remove()}m();u()}};Ops.Trigger.Sequence.prototype=new CABLES.Op;CABLES.OPS["a466bc1f-06e9-4595-8849-bffb9fe22f99"]={f:Ops.Trigger.Sequence,objName:"Ops.Trigger.Sequence"};Ops.Gl.Meshes.FullscreenRectangle=function(){CABLES.Op.apply(this,arguments);const e=this;const t={shader_frag:"UNI sampler2D tex;\nIN vec2 texCoord;\n\nvoid main()\n{\n    outColor= texture(tex,texCoord);\n}\n\n",shader_vert:"{{MODULES_HEAD}}\n\nIN vec3 vPosition;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\nIN vec2 attrTexCoord;\n\nvoid main()\n{\n   vec4 pos=vec4(vPosition,  1.0);\n\n   texCoord=vec2(attrTexCoord.x,(1.0-attrTexCoord.y));\n\n   gl_Position = projMatrix * mvMatrix * pos;\n}\n"};const a=e.inTrigger("render"),n=e.inSwitch("Scale",["Stretch","Fit"],"Fit"),r=e.inValueBool("Flip Y"),o=e.inValueBool("Flip X"),i=e.inTexture("Texture"),l=e.outTrigger("trigger");const s=e.patch.cgl;let u=null;let m=new CGL.Geometry("fullscreen rectangle");let c=0,d=0,f=0,p=0,b=0;e.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);e.toWorkPortsNeedToBeLinked(a);o.onChange=S;r.onChange=S;a.onTriggered=A;i.onLinkChanged=I;n.onChange=T;const v=new CGL.Shader(s,"fullscreenrectangle");v.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);v.setSource(t.shader_vert,t.shader_frag);v.fullscreenRectUniform=new CGL.Uniform(v,"t","tex",0);v.aspectUni=new CGL.Uniform(v,"f","aspectTex",0);let g=false;let h=true;let x=false;let O=[];I();T();i.onChange=function(){h=true};function I(){if(!CABLES.UI)return;r.setUiAttribs({greyout:!i.isLinked()});o.setUiAttribs({greyout:!i.isLinked()});n.setUiAttribs({greyout:!i.isLinked()})}function _(){let e=i.get();if(e)g=true;else g=false}e.preRender=function(){_();v.bind();if(u)u.render(v);A()};function T(){x=n.get()=="Fit"}function A(){if(s.getViewPort()[2]!=p||s.getViewPort()[3]!=b||!u)E();if(h)_();s.pushPMatrix();mat4.identity(s.pMatrix);mat4.ortho(s.pMatrix,0,p,b,0,-10,1e3);s.pushModelMatrix();mat4.identity(s.mMatrix);s.pushViewMatrix();mat4.identity(s.vMatrix);if(x&&i.get()){const a=i.get().width/i.get().height;let e=b;let t=b*a;if(t>p){e=p*1/a;t=p}O[0]=s.getViewPort()[0];O[1]=s.getViewPort()[1];O[2]=s.getViewPort()[2];O[3]=s.getViewPort()[3];s.setViewPort((p-t)/2,(b-e)/2,t,e)}if(g){if(i.get())s.setTexture(0,i.get().tex);u.render(v)}else{u.render(s.getShader())}s.gl.clear(s.gl.DEPTH_BUFFER_BIT);s.popPMatrix();s.popModelMatrix();s.popViewMatrix();if(x&&i.get())s.setViewPort(O[0],O[1],O[2],O[3]);l.trigger()}function S(){u=null}function E(){const e=s.getViewPort();if(e[2]==p&&e[3]==b&&u)return;let t=0,a=0;p=e[2];b=e[3];m.vertices=new Float32Array([t+p,a+b,0,t,a+b,0,t+p,a,0,t,a,0]);let n=null;if(r.get())n=new Float32Array([1,0,0,0,1,1,0,1]);else n=new Float32Array([1,1,0,1,1,0,0,0]);if(o.get()){n[0]=0;n[2]=1;n[4]=0;n[6]=1}m.setTexCoords(n);m.verticesIndices=new Uint16Array([2,1,0,3,1,2]);m.vertexNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);m.tangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0]);m.biTangents==new Float32Array([0,-1,0,0,-1,0,0,-1,0,0,-1,0]);if(!u)u=new CGL.Mesh(s,m);else u.setGeom(m)}};Ops.Gl.Meshes.FullscreenRectangle.prototype=new CABLES.Op;CABLES.OPS["255bd15b-cc91-4a12-9b4e-53c710cbb282"]={f:Ops.Gl.Meshes.FullscreenRectangle,objName:"Ops.Gl.Meshes.FullscreenRectangle"};Ops.Ui.Comment_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inString("title","New comment"),n=e.inTextarea("text");a.setUiAttribs({hidePort:true});n.setUiAttribs({hidePort:true});e.init=a.onChange=n.onChange=e.onLoaded=r;r();function r(){if(CABLES.UI){e.uiAttr({comment_title:a.get(),comment_text:n.get()});e.name=a.get()}}};Ops.Ui.Comment_v2.prototype=new CABLES.Op;CABLES.OPS["93492eeb-bf35-4a62-98f7-d85b0b79bfe5"]={f:Ops.Ui.Comment_v2,objName:"Ops.Ui.Comment_v2"};Ops.Gl.TextureEffects.ImageCompose_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={imgcomp_frag:"UNI float a;\nvoid main()\n{\n   outColor= vec4(0.0,0.0,0.0,a);\n}\n"};const a=e.inTrigger("Render"),n=e.inBool("Use viewport size",true),r=e.inValueInt("Width",640),o=e.inValueInt("Height",480),i=e.inSwitch("Filter",["nearest","linear","mipmap"],"linear"),l=e.inValueSelect("Wrap",["clamp to edge","repeat","mirrored repeat"],"repeat"),s=e.inValueBool("HDR"),u=e.inValueBool("Transparent",false),m=e.outTrigger("Next"),c=e.outTexture("texture_out"),d=e.outValue("Aspect Ratio");const f=e.patch.cgl;e.setPortGroup("Texture Size",[n,r,o]);e.setPortGroup("Texture Settings",[l,i,s,u]);c.set(CGL.Texture.getEmptyTexture(f,s.get()));let p=null;let b=null;let v=8,g=8;const h=[0,0,0,0];let x=true;let O=CGL.Texture.FILTER_LINEAR;let I=CGL.Texture.WRAP_CLAMP_TO_EDGE;const _=0;const T=0;l.onChange=y;i.onChange=N;a.onTriggered=e.preRender=C;N();y();E();function A(){if(p)p.delete();if(b)b.delete();if(s.get()&&i.get()=="mipmap")e.setUiError("fpmipmap","Don't use mipmap and HDR at the same time, many systems do not support this.");else e.setUiError("fpmipmap",null);p=new CGL.TextureEffect(f,{isFloatingPointTexture:s.get()});b=new CGL.Texture(f,{name:"image_compose_v2_"+e.id,isFloatingPointTexture:s.get(),filter:O,wrap:I,width:Math.ceil(r.get()),height:Math.ceil(o.get())});p.setSourceTexture(b);c.set(CGL.Texture.getEmptyTexture(f,s.get()));x=false}s.onChange=function(){x=true};function S(){if(!p)A();if(n.get()){v=f.getViewPort()[2];g=f.getViewPort()[3]}else{v=Math.ceil(r.get());g=Math.ceil(o.get())}d.set(v/g);if((v!=b.width||g!=b.height)&&(v!==0&&g!==0)){b.setSize(v,g);p.setSourceTexture(b);c.set(CGL.Texture.getEmptyTexture(f,s.get()));c.set(b)}}function E(){r.setUiAttribs({greyout:n.get()});o.setUiAttribs({greyout:n.get()})}n.onChange=function(){E()};e.preRender=function(){C()};function C(){if(!p||x)A();const e=f.getViewPort();h[0]=e[0];h[1]=e[1];h[2]=e[2];h[3]=e[3];f.pushBlend(false);S();const t=f.currentTextureEffect;f.currentTextureEffect=p;f.currentTextureEffect.width=r.get();f.currentTextureEffect.height=o.get();p.setSourceTexture(b);let a=CGL.Texture.getBlackTexture(f);if(u.get())a=CGL.Texture.getEmptyTexture(f,s.get());p.startEffect(a);m.trigger();c.set(p.getCurrentSourceTexture());p.endEffect();f.setViewPort(h[0],h[1],h[2],h[3]);f.popBlend(false);f.currentTextureEffect=t}function y(){if(l.get()=="repeat")I=CGL.Texture.WRAP_REPEAT;if(l.get()=="mirrored repeat")I=CGL.Texture.WRAP_MIRRORED_REPEAT;if(l.get()=="clamp to edge")I=CGL.Texture.WRAP_CLAMP_TO_EDGE;x=true}function N(){if(i.get()=="nearest")O=CGL.Texture.FILTER_NEAREST;if(i.get()=="linear")O=CGL.Texture.FILTER_LINEAR;if(i.get()=="mipmap")O=CGL.Texture.FILTER_MIPMAP;x=true}};Ops.Gl.TextureEffects.ImageCompose_v2.prototype=new CABLES.Op;CABLES.OPS["a5b43d4c-a9ea-4eaf-9ed0-f257d222659d"]={f:Ops.Gl.TextureEffects.ImageCompose_v2,objName:"Ops.Gl.TextureEffects.ImageCompose_v2"};Ops.Gl.TextureEffects.MultiDrawImage=function(){CABLES.Op.apply(this,arguments);const a=this;const t={invert_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D tex1;\nUNI sampler2D tex2;\nUNI sampler2D tex3;\nUNI sampler2D tex4;\nUNI sampler2D tex5;\nUNI sampler2D tex6;\nUNI sampler2D tex7;\nUNI sampler2D tex8;\n\n\nUNI sampler2D texMask1;\nUNI sampler2D texMask2;\nUNI sampler2D texMask3;\nUNI sampler2D texMask4;\nUNI sampler2D texMask5;\nUNI sampler2D texMask6;\nUNI sampler2D texMask7;\nUNI sampler2D texMask8;\n\nUNI float amount1;\nUNI float amount2;\nUNI float amount3;\nUNI float amount4;\nUNI float amount5;\nUNI float amount6;\nUNI float amount7;\nUNI float amount8;\n\n{{BLENDCODE}}\n\nvoid main()\n{\n    vec4 col=texture(tex,texCoord);\n\n\n    #ifdef USE_TEX_1\n        vec4 col1=texture(tex1,texCoord);\n        col=cgl_blend1(col,col1,amount1);\n    #endif\n    #ifdef USE_TEX_2\n        vec4 col2=texture(tex2,texCoord);\n        col=cgl_blend2(col,col2,amount2);\n    #endif\n    #ifdef USE_TEX_3\n        vec4 col3=texture(tex3,texCoord);\n        col=cgl_blend3(col,col3,amount3);\n    #endif\n    #ifdef USE_TEX_4\n        vec4 col4=texture(tex4,texCoord);\n        col=cgl_blend4(col,col4,amount4);\n    #endif\n    #ifdef USE_TEX_5\n        vec4 col5=texture(tex5,texCoord);\n        col=cgl_blend5(col,col5,amount5);\n    #endif\n    #ifdef USE_TEX_6\n        vec4 col6=texture(tex6,texCoord);\n        col=cgl_blend6(col,col6,amount6);\n    #endif\n    #ifdef USE_TEX_7\n        vec4 col7=texture(tex7,texCoord);\n        col=cgl_blend7(col,col7,amount7);\n    #endif\n    #ifdef USE_TEX_8\n        vec4 col8=texture(tex8,texCoord);\n        col=cgl_blend8(col,col8,amount8);\n    #endif\n\n    outColor=col;\n\n}\n"};const n=["normal","lighten","darken","multiply","multiply invert","average","add","substract","difference","negation","exclusion","overlay","screen","color dodge","color burn","softlight","hardlight"];const e=a.inTrigger("render"),r=a.inBool("Mask Invert",false),o=a.outTrigger("trigger");const i=8,l=a.patch.cgl,s=new CGL.Shader(l,a.name),u=[],m=[],c=[],d=[],f=[],p=[];let b=true;for(let e=0;e<i;e++){const x=a.inTexture("Texture "+(e+1));const O=a.inDropDown("Blendmode "+(e+1),n,"normal");const I=a.inTexture("Mask "+(e+1));const _=a.inSwitch("Mask Source "+(e+1),["R","R inv","A","A inv"],"R");const T=a.inSwitch("Opacity "+(e+1),["Normal","Prev A","Prev R"],"Normal");const A=a.inValueSlider("Amount "+(e+1),1);O.onChange=T.onChange=_.onChange=I.onLinkChanged=x.onLinkChanged=()=>{b=true};p.push(x);d.push(I);c.push(T);m.push(O);u.push(A);f.push(_);a.setPortGroup("Image "+(e+1),[x,O,A,T,I,_]);new CGL.Uniform(s,"t","tex"+(e+1),e*2+1);new CGL.Uniform(s,"t","texMask"+(e+1),e*2+2);new CGL.Uniform(s,"f","amount"+(e+1),A)}const v=new CGL.Uniform(s,"t","tex",0);function g(){let a="";let n="";for(let t=0;t<i;t++){let e=p[t].isLinked();u[t].setUiAttribs({greyout:!e});m[t].setUiAttribs({greyout:!e});c[t].setUiAttribs({greyout:!e});if(e){a+="#define USE_TEX_"+(t+1)+"".endl();n+=h(t+1,m[t].get(),c[t].get(),d[t].get(),f[t].get())}}let e=a.endl()+t.invert_frag;e=e.replace("{{BLENDCODE}}",n);s.setSource(s.getDefaultVertexShader(),e);b=false}function h(e,t,a,n,r){let o=""+"vec3 _blend"+e+"(vec3 base,vec3 blend)".endl()+"{".endl()+"   vec3 colNew=blend;".endl();if(t=="multiply")o+="       colNew=base*blend;".endl();else if(t=="multiply invert")o+="       colNew=base* vec3(1.0)-blend;".endl();else if(t=="average")o+="       colNew=((base + blend) / 2.0);".endl();else if(t=="add")o+="       colNew=min(base + blend, vec3(1.0));".endl();else if(t=="substract")o+="       colNew=max(base + blend - vec3(1.0), vec3(0.0));".endl();else if(t=="difference")o+="       colNew=abs(base - blend);".endl();else if(t=="negation")o+="       colNew=(vec3(1.0) - abs(vec3(1.0) - base - blend));".endl();else if(t=="exclusion")o+="       colNew=(base + blend - 2.0 * base * blend);".endl();else if(t=="lighten")o+="       colNew=max(blend, base);".endl();else if(t=="darken")o+="       colNew=min(blend, base);".endl();else if(t=="overlay"){o+=""+"      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()}else if(t=="screen"){o+=""+"      #define BlendScreenf(base, blend)       (1.0 - ((1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendScreenf(base.r, blend.r),BlendScreenf(base.g, blend.g),BlendScreenf(base.b, blend.b));".endl()}else if(t=="softlight"){o+=""+"      #define BlendSoftLightf(base, blend)    ((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))".endl()+"      colNew=vec3(BlendSoftLightf(base.r, blend.r),BlendSoftLightf(base.g, blend.g),BlendSoftLightf(base.b, blend.b));".endl()}else if(t=="hardlight"){o+=""+"      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))".endl()+"      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()}else if(t=="color dodge"){o+=""+"      #define BlendColorDodgef(base, blend)   ((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))".endl()+"      colNew=vec3(BlendColorDodgef(base.r, blend.r),BlendColorDodgef(base.g, blend.g),BlendColorDodgef(base.b, blend.b));".endl()}else if(t=="color burn"){o+=""+"      #define BlendColorBurnf(base, blend)    ((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))".endl()+"      colNew=vec3(BlendColorBurnf(base.r, blend.r),BlendColorBurnf(base.g, blend.g),BlendColorBurnf(base.b, blend.b));".endl()}o+=""+"   return colNew;".endl()+"}".endl()+"vec4 cgl_blend"+e+"(vec4 oldColor,vec4 newColor,float amount)".endl()+"{".endl()+"float a=(amount*newColor.a);".endl();if(a==="Prev A")o+="a*=oldColor.a;";if(a==="Prev R")o+="a*=oldColor.r;";o=o+"vec4 col = vec4( _blend"+e+"(oldColor.rgb, newColor.rgb), 1.0);".endl()+"col = vec4( mix( col.rgb,oldColor.rgb, col.a * 1.0-amount), 1.0);".endl();if(n)if(r==="R")o=o+"newColor.a *= texture(texMask"+e+",texCoord).r;".endl();else if(r==="R inv")o=o+"newColor.a *= 1.0-texture(texMask"+e+",texCoord).r;".endl();else if(r==="A")o=o+"newColor.a *= texture(texMask"+e+",texCoord).a;".endl();else if(r==="A inv")o=o+"newColor.a *= 1.0-texture(texMask"+e+",texCoord).a;".endl();o=o+"col = vec4( mix( oldColor,col, newColor.a));".endl()+"return col;".endl()+"}".endl().endl();return o}e.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(a))return;if(b)g();l.pushShader(s);l.currentTextureEffect.bind();l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex);let t=1;for(let e=0;e<p.length;e++){if(p[e].get()){l.setTexture(e*2+1,p[e].get().tex);t++}if(d[e].get()){l.setTexture(e*2+2,d[e].get().tex);t++}}if(t>l.maxTextureUnits)a.setUiError("manytex","Too many textures bound");else a.setUiError("manytex",null);l.pushBlendMode(CGL.BLEND_NONE,true);l.currentTextureEffect.finish();l.popBlendMode();l.popShader();o.trigger()}};Ops.Gl.TextureEffects.MultiDrawImage.prototype=new CABLES.Op;CABLES.OPS["4df51ead-c46c-471d-ac5e-1872219a3174"]={f:Ops.Gl.TextureEffects.MultiDrawImage,objName:"Ops.Gl.TextureEffects.MultiDrawImage"};Ops.Ui.PatchInput=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.addOutPort(new CABLES.Port(r,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));function i(){for(let e in r.patch.ops){if(r.patch.ops[e].patchId){if(r.patch.ops[e].patchId.get()==r.uiAttribs.subPatch){return r.patch.ops[e]}}}}o.onLinkChanged=()=>{const e=i();if(!o.links.length||!e||!e.addNewInPort)return;const t=o.links[0].getOtherPort(o);o.removeLinks();const a=e.addNewInPort(t);const n=gui.scene().link(t.parent,t.getName(),r,a);e.saveData()}};Ops.Ui.PatchInput.prototype=new CABLES.Op;CABLES.OPS["e3f68bc3-892a-4c78-9974-aca25c27025d"]={f:Ops.Ui.PatchInput,objName:"Ops.Ui.PatchInput"};Ops.Ui.PatchOutput=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.addInPort(new CABLES.Port(r,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));function i(){for(let e in r.patch.ops){if(r.patch.ops[e].patchId){if(r.patch.ops[e].patchId.get()==r.uiAttribs.subPatch){return r.patch.ops[e]}}}}o.onLinkChanged=()=>{const e=i();if(!o.links.length)return;const t=o.links[0].getOtherPort(o);o.removeLinks();const a=e.addNewOutPort(t);const n=gui.scene().link(t.parent,t.getName(),r,a);e.saveData()}};Ops.Ui.PatchOutput.prototype=new CABLES.Op;CABLES.OPS["851b44cb-5667-4140-9800-5aeb7031f1d7"]={f:Ops.Ui.PatchOutput,objName:"Ops.Ui.PatchOutput"};Ops.Ui.SubPatch=function(){CABLES.Op.apply(this,arguments);const u=this;const e={};u.dyn=u.addInPort(new CABLES.Port(u,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));u.dynOut=u.addOutPort(new CABLES.Port(u,"create port out",CABLES.OP_PORT_TYPE_DYNAMIC));const t=u.addInPort(new CABLES.Port(u,"dataStr",CABLES.OP_PORT_TYPE_VALUE,{display:"readonly"}));u.patchId=u.addInPort(new CABLES.Port(u,"patchId",CABLES.OP_PORT_TYPE_VALUE,{display:"readonly"}));t.setUiAttribs({hideParam:true});u.patchId.setUiAttribs({hideParam:true});let m={ports:[],portsOut:[]};let a=CABLES.generateUUID();u.patchId.set(a);p();f();let c=false;u.saveData=i;u.init=()=>{u.setStorage({subPatchVer:1})};u.patchId.onChange=function(){const t=u.patch.getSubPatchOps(a);if(t.length===2){if(u.patch.isEditorMode()&&CABLES.UI.DEFAULTOPS.isInBlueprint(u))CABLES.UI.undo.pause();for(let e=0;e<t.length;e++){u.patch.deleteOp(t[e].id)}if(u.patch.isEditorMode()&&CABLES.UI.DEFAULTOPS.isInBlueprint(u))CABLES.UI.undo.resume()}};u.onLoaded=function(){};u.onLoadedValueSet=function(){m=JSON.parse(t.get());if(!m){m={ports:[],portsOut:[]}}o()};function n(){}t.onChange=function(){if(c)return;if(!t.get())return;try{n()}catch(e){u.logError("cannot load subpatch data...");u.logError(e)}};function i(){try{t.set(JSON.stringify(m))}catch(e){u.log(e)}}u.addPortListener=d;function d(a,e){if(!a.hasSubpatchLstener){a.hasSubpatchLstener=true;a.addEventListener("onUiAttrChange",function(t){if(t.title){let e=0;for(e=0;e<m.portsOut.length;e++)if(m.portsOut[e].name==a.name)m.portsOut[e].title=t.title;for(e=0;e<m.ports.length;e++)if(m.ports[e].name==a.name)m.ports[e].title=t.title;i()}})}if(a.direction==CABLES.PORT_DIR_IN){if(a.type==CABLES.OP_PORT_TYPE_FUNCTION){a.onTriggered=function(){if(e.isLinked())e.trigger()}}else{a.onChange=function(){e.set(a.get());if(!a.isLinked()){for(let e=0;e<m.ports.length;e++){if(m.ports[e].name===a.name){m.ports[e].value=a.get()}}i()}}}}}u.setupPorts=o;function o(){if(!u.patchId.get())return;const e=m.ports||[];const t=m.portsOut||[];let a=0;for(a=0;a<e.length;a++){if(!u.getPortByName(e[a].name)){const n=u.addInPort(new CABLES.Port(u,e[a].name,e[a].type));const r=p();const o=r.addOutPort(new CABLES.Port(r,e[a].name,e[a].type));n.ignoreValueSerialize=true;n.setUiAttribs({editableTitle:true});if(e[a].title){n.setUiAttribs({title:e[a].title});o.setUiAttribs({title:e[a].title})}if(e[a].objType){n.setUiAttribs({objType:e[a].objType});o.setUiAttribs({objType:e[a].objType})}if(e[a].value){n.set(e[a].value);o.set(e[a].value)}d(n,o)}}for(a=0;a<t.length;a++){if(!u.getPortByName(t[a].name)){const i=u.addOutPort(new CABLES.Port(u,t[a].name,t[a].type));const l=f();const s=l.addInPort(new CABLES.Port(l,t[a].name,t[a].type));i.ignoreValueSerialize=true;i.setUiAttribs({editableTitle:true});if(t[a].title){i.setUiAttribs({title:t[a].title});s.setUiAttribs({title:t[a].title})}if(t[a].objType){i.setUiAttribs({objType:t[a].objType});s.setUiAttribs({objType:t[a].objType})}d(s,i)}}c=true}u.addNewInPort=function(e,t,a){const n="in"+m.ports.length+" "+e.parent.name+" "+e.name;const r={name:n,type:e.type};if(e.uiAttribs.objType)r.objType=e.uiAttribs.objType;m.ports.push(r);o();return n};u.dyn.onLinkChanged=function(){if(u.dyn.isLinked()){const e=u.dyn.links[0].getOtherPort(u.dyn);u.dyn.removeLinks();e.removeLinkTo(u.dyn);u.log("dyn link changed!!!");const t=u.addNewInPort(e);const a=gui.scene().link(e.parent,e.getName(),u,t);c=true;i()}else{setTimeout(function(){u.dyn.removeLinks()},100)}};u.addNewOutPort=function(e,t,a){const n="out"+m.portsOut.length+" "+e.parent.name+" "+e.name;const r={name:n,type:e.type};if(e.uiAttribs.objType)r.objType=e.uiAttribs.objType;m.portsOut.push(r);o();return n};u.dynOut.onLinkChanged=function(){if(u.dynOut.isLinked()){const e=u.dynOut.links[0].getOtherPort(u.dynOut);u.dynOut.removeLinks();e.removeLinkTo(u.dynOut);const t=u.addNewOutPort(e);gui.scene().link(e.parent,e.getName(),u,t);c=true;i()}else{setTimeout(function(){u.dynOut.removeLinks()},100);u.log("dynOut unlinked...")}};function f(){let e=u.patch.getSubPatchOp(u.patchId.get(),"Ops.Ui.PatchOutput");if(!e){u.patch.addOp("Ops.Ui.PatchOutput",{subPatch:u.patchId.get(),translate:{x:0,y:0}});e=u.patch.getSubPatchOp(u.patchId.get(),"Ops.Ui.PatchOutput");if(!e)u.warn("no patchoutput!")}return e}function p(){let e=u.patch.getSubPatchOp(u.patchId.get(),"Ops.Ui.PatchInput");if(!e){u.patch.addOp("Ops.Ui.PatchInput",{subPatch:u.patchId.get(),translate:{x:0,y:0}});e=u.patch.getSubPatchOp(u.patchId.get(),"Ops.Ui.PatchInput");if(!e)u.warn("no patchinput2!")}return e}u.addSubLink=function(e,t){const a=m.ports.length;const n="in"+(a-1)+" "+t.parent.name+" "+t.name;if(e.direction==CABLES.PORT_DIR_IN){gui.scene().link(e.parent,e.getName(),p(),n)}else{const o=m.portsOut.length;gui.scene().link(e.parent,e.getName(),f(),"out"+(o-1)+" "+t.parent.name+" "+t.name)}const r=gui.patchView.getSubPatchBounds(u.patchId.get());p().uiAttr({translate:{x:r.minx,y:r.miny-100}});f().uiAttr({translate:{x:r.minx,y:r.maxy+100}});i();return n};u.onDelete=function(){for(let e=u.patch.ops.length-1;e>=0;e--){if(u.patch.ops[e]&&u.patch.ops[e].uiAttribs&&u.patch.ops[e].uiAttribs.subPatch==u.patchId.get()){u.patch.deleteOp(u.patch.ops[e].id)}}};function r(){let e={pasted:true,translate:{x:u.uiAttribs.translate.x-150,y:u.uiAttribs.translate.y}};if(CABLES.UI)e.subPatch=gui.patchView.getCurrentSubPatch();const t=u.patch.addOp(CABLES.UI.DEFAULTOPNAMES.blueprint,e);t.createBlueprint(gui.patchId,u.patchId.get(),true)}u.rebuildListeners=()=>{u.log("rebuild listeners...");const t=f();for(let e=0;e<t.portsIn.length;e++){if(t.portsIn[e].isLinked()){d(t.portsIn[e],this.portsOut[e])}}}};Ops.Ui.SubPatch.prototype=new CABLES.Op;CABLES.OPS["84d9a6f0-ed7a-466d-b386-225ed9e89c60"]={f:Ops.Ui.SubPatch,objName:"Ops.Ui.SubPatch"};Ops.Math.Multiply=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueFloat("number1",1),n=e.inValueFloat("number2",2),r=e.outNumber("result");e.setTitle("*");a.onChange=n.onChange=o;o();function o(){const e=a.get();const t=n.get();r.set(e*t)}};Ops.Math.Multiply.prototype=new CABLES.Op;CABLES.OPS["1bbdae06-fbb2-489b-9bcc-36c9d65bd441"]={f:Ops.Math.Multiply,objName:"Ops.Math.Multiply"};Ops.Math.Pow=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueFloat("Base"),n=e.inValueFloat("Exponent"),r=e.outNumber("Result");n.set(2);a.onChange=o;n.onChange=o;function o(){let e=Math.pow(a.get(),n.get());if(isNaN(e))e=0;r.set(e)}};Ops.Math.Pow.prototype=new CABLES.Op;CABLES.OPS["3bb3f98f-27d6-44c4-b4e5-186e10f0809d"]={f:Ops.Math.Pow,objName:"Ops.Math.Pow"};Ops.Math.Sum=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueFloat("number1",1),n=e.inValueFloat("number2",1),r=e.outNumber("result");e.setTitle("+");a.onChange=n.onChange=o;o();function o(){const e=a.get()+n.get();if(!isNaN(e))r.set(e)}};Ops.Math.Sum.prototype=new CABLES.Op;CABLES.OPS["c8fb181e-0b03-4b41-9e55-06b6267bc634"]={f:Ops.Math.Sum,objName:"Ops.Math.Sum"};Ops.Anim.Timer_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const o=e.inValue("Speed",1),a=e.inValueBool("Play",true),n=e.inTriggerButton("Reset"),r=e.inValueBool("Sync to timeline",false),i=e.outNumber("Time");e.setPortGroup("Controls",[a,n,o]);const l=new CABLES.Timer;let s=null;let u=0;let m=false;a.onChange=c;c();function c(){if(a.get()){l.play();e.patch.addOnAnimFrame(e)}else{l.pause();e.patch.removeOnAnimFrame(e)}}n.onTriggered=d;function d(){u=0;s=null;l.setTime(0);i.set(0)}r.onChange=function(){m=r.get();a.setUiAttribs({greyout:m});n.setUiAttribs({greyout:m})};e.onAnimFrame=function(e,t,a){if(l.isPlaying()){if(CABLES.overwriteTime!==undefined){i.set(CABLES.overwriteTime*o.get())}else if(m){i.set(e*o.get())}else{l.update();const n=l.get();if(s===null){s=n;return}const r=Math.abs(n-s);s=n;u+=r*o.get();if(u!=u)u=0;i.set(u)}}}};Ops.Anim.Timer_v2.prototype=new CABLES.Op;CABLES.OPS["aac7f721-208f-411a-adb3-79adae2e471a"]={f:Ops.Anim.Timer_v2,objName:"Ops.Anim.Timer_v2"};Ops.Gl.Shader.BasicMaterial_v3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={basicmaterial_frag:"{{MODULES_HEAD}}\n\nIN vec2 texCoord;\n\n#ifdef VERTEX_COLORS\nIN vec4 vertCol;\n#endif\n\n#ifdef HAS_TEXTURES\n    IN vec2 texCoordOrig;\n    #ifdef HAS_TEXTURE_DIFFUSE\n        UNI sampler2D tex;\n    #endif\n    #ifdef HAS_TEXTURE_OPACITY\n        UNI sampler2D texOpacity;\n   #endif\n#endif\n\n\n\nvoid main()\n{\n    {{MODULE_BEGIN_FRAG}}\n    vec4 col=color;\n\n\n    #ifdef HAS_TEXTURES\n        vec2 uv=texCoord;\n\n        #ifdef CROP_TEXCOORDS\n            if(uv.x<0.0 || uv.x>1.0 || uv.y<0.0 || uv.y>1.0) discard;\n        #endif\n\n        #ifdef HAS_TEXTURE_DIFFUSE\n            col=texture(tex,uv);\n\n            #ifdef COLORIZE_TEXTURE\n                col.r*=color.r;\n                col.g*=color.g;\n                col.b*=color.b;\n            #endif\n        #endif\n        col.a*=color.a;\n        #ifdef HAS_TEXTURE_OPACITY\n            #ifdef TRANSFORMALPHATEXCOORDS\n                uv=texCoordOrig;\n            #endif\n            #ifdef ALPHA_MASK_IALPHA\n                col.a*=1.0-texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_ALPHA\n                col.a*=texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_LUMI\n                col.a*=dot(vec3(0.2126,0.7152,0.0722), texture(texOpacity,uv).rgb);\n            #endif\n            #ifdef ALPHA_MASK_R\n                col.a*=texture(texOpacity,uv).r;\n            #endif\n            #ifdef ALPHA_MASK_G\n                col.a*=texture(texOpacity,uv).g;\n            #endif\n            #ifdef ALPHA_MASK_B\n                col.a*=texture(texOpacity,uv).b;\n            #endif\n            // #endif\n        #endif\n    #endif\n\n    {{MODULE_COLOR}}\n\n    #ifdef DISCARDTRANS\n        if(col.a<0.2) discard;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        col*=vertCol;\n    #endif\n\n    outColor = col;\n}\n",basicmaterial_vert:"\n{{MODULES_HEAD}}\n\nOUT vec2 texCoord;\nOUT vec2 texCoordOrig;\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\n#ifdef HAS_TEXTURES\n    UNI float diffuseRepeatX;\n    UNI float diffuseRepeatY;\n    UNI float texOffsetX;\n    UNI float texOffsetY;\n#endif\n\n#ifdef VERTEX_COLORS\n    in vec4 attrVertColor;\n    out vec4 vertCol;\n\n#endif\n\n\nvoid main()\n{\n    mat4 mMatrix=modelMatrix;\n    mat4 mvMatrix;\n\n    norm=attrVertNormal;\n    texCoordOrig=attrTexCoord;\n    texCoord=attrTexCoord;\n    #ifdef HAS_TEXTURES\n        texCoord.x=texCoord.x*diffuseRepeatX+texOffsetX;\n        texCoord.y=(1.0-texCoord.y)*diffuseRepeatY+texOffsetY;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        vertCol=attrVertColor;\n    #endif\n\n    vec4 pos = vec4(vPosition, 1.0);\n\n    #ifdef BILLBOARD\n       vec3 position=vPosition;\n       mvMatrix=viewMatrix*modelMatrix;\n\n       gl_Position = projMatrix * mvMatrix * vec4((\n           position.x * vec3(\n               mvMatrix[0][0],\n               mvMatrix[1][0],\n               mvMatrix[2][0] ) +\n           position.y * vec3(\n               mvMatrix[0][1],\n               mvMatrix[1][1],\n               mvMatrix[2][1]) ), 1.0);\n    #endif\n\n    {{MODULE_VERTEX_POSITION}}\n\n    #ifndef BILLBOARD\n        mvMatrix=viewMatrix * mMatrix;\n    #endif\n\n\n    #ifndef BILLBOARD\n        // gl_Position = projMatrix * viewMatrix * modelMatrix * pos;\n        gl_Position = projMatrix * mvMatrix * pos;\n    #endif\n}\n"};const a=e.inTrigger("render");const n=e.outTrigger("trigger");const r=e.outObject("shader",null,"shader");r.ignoreValueSerialize=true;e.toWorkPortsNeedToBeLinked(a);e.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);const o=e.patch.cgl;const i=new CGL.Shader(o,"basicmaterialnew");i.addAttribute({type:"vec3",name:"vPosition"});i.addAttribute({type:"vec2",name:"attrTexCoord"});i.addAttribute({type:"vec3",name:"attrVertNormal",nameFrag:"norm"});i.addAttribute({type:"float",name:"attrVertIndex"});i.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);i.setSource(t.basicmaterial_vert,t.basicmaterial_frag);r.setRef(i);a.onTriggered=C;const l=e.inValueSlider("r",Math.random());const s=e.inValueSlider("g",Math.random());const u=e.inValueSlider("b",Math.random());const m=e.inValueSlider("a",1);l.setUiAttribs({colorPick:true});const c=i.addUniformFrag("4f","color",l,s,u,m);i.uniformColorDiffuse=c;const d=e.inTexture("texture");let f=null;d.onChange=N;const p=e.inValueBool("colorizeTexture",false);const b=e.inValueBool("Vertex Colors",false);const v=e.inTexture("textureOpacity");let g=null;const h=e.inSwitch("Alpha Mask Source",["Luminance","R","G","B","A","1-A"],"Luminance");h.setUiAttribs({greyout:true});v.onChange=y;const x=e.inValueBool("Opacity TexCoords Transform",false);const O=e.inValueBool("Discard Transparent Pixels");const I=e.inValue("diffuseRepeatX",1),_=e.inValue("diffuseRepeatY",1),T=e.inValue("Tex Offset X",0),A=e.inValue("Tex Offset Y",0),S=e.inBool("Crop TexCoords",false);i.addUniformFrag("f","diffuseRepeatX",I);i.addUniformFrag("f","diffuseRepeatY",_);i.addUniformFrag("f","texOffsetX",T);i.addUniformFrag("f","texOffsetY",A);const E=e.inValueBool("billboard",false);h.onChange=E.onChange=O.onChange=x.onChange=S.onChange=b.onChange=p.onChange=j;e.setPortGroup("Color",[l,s,u,m]);e.setPortGroup("Color Texture",[d,b,p]);e.setPortGroup("Opacity",[v,h,O,x]);e.setPortGroup("Texture Transform",[I,_,T,A,S]);y();N();e.preRender=function(){i.bind();C()};function C(){if(!i)return;o.pushShader(i);i.popTextures();if(f&&d.get())i.pushTexture(f,d.get());if(g&&v.get())i.pushTexture(g,v.get());n.trigger();o.popShader()}function y(){if(v.get()){if(g!==null)return;i.removeUniform("texOpacity");i.define("HAS_TEXTURE_OPACITY");if(!g)g=new CGL.Uniform(i,"t","texOpacity")}else{i.removeUniform("texOpacity");i.removeDefine("HAS_TEXTURE_OPACITY");g=null}j()}function N(){if(d.get()){if(!i.hasDefine("HAS_TEXTURE_DIFFUSE"))i.define("HAS_TEXTURE_DIFFUSE");if(!f)f=new CGL.Uniform(i,"t","texDiffuse")}else{i.removeUniform("texDiffuse");i.removeDefine("HAS_TEXTURE_DIFFUSE");f=null}M()}function M(){I.setUiAttribs({greyout:!d.get()});_.setUiAttribs({greyout:!d.get()});T.setUiAttribs({greyout:!d.get()});A.setUiAttribs({greyout:!d.get()});p.setUiAttribs({greyout:!d.get()});h.setUiAttribs({greyout:!v.get()});x.setUiAttribs({greyout:!v.get()});let e=true;e=d.get()&&!p.get();l.setUiAttribs({greyout:e});s.setUiAttribs({greyout:e});u.setUiAttribs({greyout:e})}function j(){i.toggleDefine("VERTEX_COLORS",b.get());i.toggleDefine("CROP_TEXCOORDS",S.get());i.toggleDefine("COLORIZE_TEXTURE",p.get());i.toggleDefine("TRANSFORMALPHATEXCOORDS",x.get());i.toggleDefine("DISCARDTRANS",O.get());i.toggleDefine("BILLBOARD",E.get());i.toggleDefine("ALPHA_MASK_ALPHA",h.get()=="A");i.toggleDefine("ALPHA_MASK_IALPHA",h.get()=="1-A");i.toggleDefine("ALPHA_MASK_LUMI",h.get()=="Luminance");i.toggleDefine("ALPHA_MASK_R",h.get()=="R");i.toggleDefine("ALPHA_MASK_G",h.get()=="G");i.toggleDefine("ALPHA_MASK_B",h.get()=="B");M()}};Ops.Gl.Shader.BasicMaterial_v3.prototype=new CABLES.Op;CABLES.OPS["ec55d252-3843-41b1-b731-0482dbd9e72b"]={f:Ops.Gl.Shader.BasicMaterial_v3,objName:"Ops.Gl.Shader.BasicMaterial_v3"};Ops.Gl.Meshes.Circle=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTrigger("render"),M=e.inValue("radius",.5),j=e.inValueSlider("innerRadius",0),P=e.inValueInt("segments",40),R=e.inValueSlider("percent",1),L=e.inValue("steps",0),w=e.inValueBool("invertSteps",false),D=e.inSwitch("mapping",["flat","round"]),U=e.inValueBool("Spline",false),n=e.inValueBool("Draw",true),r=e.outTrigger("trigger"),B=e.outObject("geometry",null,"geometry");e.setPortGroup("Size",[M,j]);e.setPortGroup("Display",[R,L,w]);D.set("flat");D.onChange=P.onChange=M.onChange=j.onChange=R.onChange=L.onChange=w.onChange=U.onChange=m;B.ignoreValueSerialize=true;const k=e.patch.cgl;let V=new CGL.Geometry("circle");let G=null;const o=-1;let i=0;let l=null;let F=true;a.onTriggered=s;e.preRender=()=>{s()};function s(){if(!CGL.TextureEffect.checkOpNotInTextureEffect(e))return;if(F)u();l=k.getShader();if(!l)return;i=l.glPrimitive;if(U.get())l.glPrimitive=k.gl.LINE_STRIP;if(n.get())G.render(l);r.trigger();l.glPrimitive=i}function u(){const a=Math.max(3,Math.floor(P.get()));V.clear();const t=[];const n=[];const r=[];const o=[];const i=[];let l=0,s=0;let u=0,m=0;let c=0,d=0;let f=0,p=0;let b=0,v=0;let g=0,h=0;let x=0,O=0;let I=0,_=0;const T=Math.max(0,R.get());const A=[];if(U.get()){let e=0;let t=0;const S=[];for(l=0;l<=a*T;l++){s=360/a*l*CGL.DEG2RAD;I=Math.cos(s)*M.get();_=Math.sin(s)*M.get();O=.5;if(l>0){A.push(e);A.push(t);A.push(0);x=1-(l-1)/a;S.push(x,O)}A.push(I);A.push(_);A.push(0);e=I;t=_}V.setPointVertices(A)}else if(j.get()<=0){for(l=0;l<=a*T;l++){s=360/a*l*CGL.DEG2RAD;I=Math.cos(s)*M.get();_=Math.sin(s)*M.get();if(D.get()=="flat"){x=(Math.cos(s)+1)/2;O=1-(Math.sin(s)+1)/2;g=.5;h=.5}else if(D.get()=="round"){x=1-l/a;O=0;g=x;h=1}t.push([I,_,0],[u,m,0],[0,0,0]);n.push(x,O,c,d,g,h);r.push(0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0);i.push(0,1,0,0,1,0,0,1,0);c=x;d=O;u=I;m=_}V=CGL.Geometry.buildFromFaces(t,"circle");V.vertexNormals=r;V.tangents=o;V.biTangents=i;V.texCoords=n}else{let e=0;const E=a*T;const C=0;for(l=0;l<=E;l++){e++;s=360/a*l*CGL.DEG2RAD;I=Math.cos(s)*M.get();_=Math.sin(s)*M.get();const y=Math.cos(s)*j.get()*M.get();const N=Math.sin(s)*j.get()*M.get();if(D.get()=="round"){x=1-l/a;O=0;g=x;h=1}if(L.get()===0||e%parseInt(L.get(),10)===0&&!w.get()||e%parseInt(L.get(),10)!==0&&w.get()){t.push([I,_,0],[u,m,0],[y,N,0]);t.push([y,N,0],[u,m,0],[f,p,0]);n.push(x,0,c,0,g,1,x,1,c,0,b,1);r.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0);i.push(0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0)}b=g;v=h;c=x;d=O;u=I;m=_;f=y;p=N}V=CGL.Geometry.buildFromFaces(t,"circle");V.vertexNormals=r;V.tangents=o;V.biTangents=i;if(D.get()=="flat")V.mapTexCoords2d();else V.texCoords=n}B.set(null);B.set(V);if(V.vertices.length==0)return;if(G)G.dispose();G=null;G=new CGL.Mesh(k,V);F=false}function m(){F=true}e.onDelete=function(){if(G)G.dispose()}};Ops.Gl.Meshes.Circle.prototype=new CABLES.Op;CABLES.OPS["4db917cc-2cef-43f4-83d5-38c4572fe943"]={f:Ops.Gl.Meshes.Circle,objName:"Ops.Gl.Meshes.Circle"};Ops.Gl.ShaderEffects.TextureProjection=function(){CABLES.Op.apply(this,arguments);const e=this;const t={maptexture_frag:"IN vec2 MOD_tc;\n\n#ifdef MOD_MAP_TRIPLANAR\n    IN vec2 MOD_tc1;\n    IN vec2 MOD_tc2;\n    IN vec3 MOD_blendingTri;\n#endif\n\n",maptexture_vert:"vec3 MOD_pos;\n\n#ifndef MOD_WORLDSPACE\n   MOD_pos=(vec4(vPosition,1.0)*1.0/MOD_scale).xyz;\n#endif\n#ifdef MOD_WORLDSPACE\n   MOD_pos=(mMatrix*pos).xyz*1.0/MOD_scale;\n#endif\n\nMOD_pos=(vec4(MOD_pos,1.0)*MOD_rotationX(MOD_rotX*MOD_DEG2RAD)).xyz;\nMOD_pos=(vec4(MOD_pos,1.0)*MOD_rotationY(MOD_rotY*MOD_DEG2RAD)).xyz;\nMOD_pos=(vec4(MOD_pos,1.0)*MOD_rotationZ(MOD_rotZ*MOD_DEG2RAD)).xyz;\n\n#ifdef MOD_MAP_XY\n    MOD_tc=MOD_pos.xy;\n#endif\n#ifdef MOD_MAP_XZ\n    MOD_tc=MOD_pos.xz;\n#endif\n#ifdef MOD_MAP_YZ\n    MOD_tc=MOD_pos.yz;\n#endif\n\nMOD_tc.xy+=vec2(0.5,0.5);\nMOD_tc.xy+=MOD_offset;\n\n\n#ifdef MOD_TARGET_POINTSIZE\n\n    gl_PointSize+=texture(MOD_tex,MOD_tc).x*MOD_amount;\n\n#endif\n\n\n#ifdef MOD_MAP_TRIPLANAR\n    mapTriplanar((mMatrix*vec4(attrVertNormal,1.0)).xyz,MOD_pos);\n#endif",maptexture_body_frag:"#ifdef MOD_TARGET_COLOR\n\n    vec4 MOD_color;\n\n    #ifdef MOD_MAP_TRIPLANAR\n        vec4 xaxis = texture( MOD_tex, MOD_tc);\n        vec4 yaxis = texture( MOD_tex, MOD_tc1);\n        vec4 zaxis = texture( MOD_tex, MOD_tc2);\n        MOD_color = xaxis *MOD_blendingTri.x + yaxis *MOD_blendingTri.y + zaxis *MOD_blendingTri.z;\n        MOD_color.a=1.0;\n    #endif\n\n\n    vec2 MOD_ntc=MOD_tc;\n\n    #ifdef MOD_MAP_SCREEN\n        // MOD_ntc.y-=0.5;\n\n        MOD_ntc=(vec2(gl_FragCoord.x,gl_FragCoord.y)/vec2(MOD_viewPortW,MOD_viewPortH));\n\n        // tc+=MOD_pos;\n        MOD_ntc-=vec2(0.5,0.5);\n        MOD_ntc*=1.0/MOD_scale;\n        MOD_ntc+=vec2(0.5,0.5);\n        MOD_ntc-=MOD_offset;\n        // tc.y=1.0-tc.y-0.5;\n    #endif\n\n\n    #ifdef MOD_DISCARD\n    if(MOD_ntc.x>0.0 && MOD_ntc.x<1.0 && MOD_ntc.y>0.0 && MOD_ntc.y<1.0)\n    {\n    #endif\n\n        #ifndef MOD_MAP_TRIPLANAR\n            MOD_color=texture(MOD_tex,MOD_ntc);\n        #endif\n\n        #ifdef MOD_USE_IMGALPHA\n            col.a=MOD_color.a;\n        #endif\n\n        #ifdef MOD_BLEND_NORMAL\n            col.rgb=mix(col.rgb,MOD_color.rgb,MOD_amount);\n        #endif\n        #ifdef MOD_BLEND_ADD\n            col.rgb+=MOD_color.rgb*MOD_amount;\n        #endif\n        #ifdef MOD_BLEND_MUL\n            // col.rgb*=MOD_color.rgb*MOD_amount;\n            col.rgb=mix(col.rgb,col.rgb*MOD_color.rgb,MOD_amount);\n\n        #endif\n\n    #ifdef MOD_DISCARD\n    }\n\n    #endif\n#endif\n",maptexture_body_vert:"// OUT vec4 MOD_pos;\n// UNI vec2 MOD_offset;\n// UNI float MOD_scale;\n// UNI float MOD_amount;\nOUT vec2 MOD_tc;\n\nconst float MOD_DEG2RAD = 0.017453292519943;\n\n#ifdef MOD_MAP_TRIPLANAR\n\n    OUT vec2 MOD_tc1;\n    OUT vec2 MOD_tc2;\n    OUT vec3 MOD_blendingTri;\n\n    void mapTriplanar(vec3 wNorm,vec3 pos)\n    {\n        vec3 blending = abs( wNorm );\n        blending = normalize(max(blending, 0.1));\n        float b = (blending.x + blending.y + blending.z);\n        blending /= vec3(b);\n        MOD_blendingTri=blending;\n\n        MOD_tc = pos.yz;\n        MOD_tc1 = pos.xz;\n        MOD_tc2 = pos.xy;\n    }\n\n#endif\n\nmat4 MOD_rotationX( in float angle ) {\n\treturn mat4(\t1.0,\t\t0,\t\t\t0,\t\t\t0,\n\t\t\t \t\t0, \tcos(angle),\t-sin(angle),\t\t0,\n\t\t\t\t\t0, \tsin(angle),\t cos(angle),\t\t0,\n\t\t\t\t\t0, \t\t\t0,\t\t\t  0, \t\t1);\n}\n\nmat4 MOD_rotationY( in float angle ) {\n\treturn mat4(\tcos(angle),\t\t0,\t\tsin(angle),\t0,\n\t\t\t \t\t\t\t0,\t\t1.0,\t\t\t 0,\t0,\n\t\t\t\t\t-sin(angle),\t0,\t\tcos(angle),\t0,\n\t\t\t\t\t\t\t0, \t\t0,\t\t\t\t0,\t1);\n}\n\nmat4 MOD_rotationZ( in float angle ) {\n\treturn mat4(\tcos(angle),\t\t-sin(angle),\t0,\t0,\n\t\t\t \t\tsin(angle),\t\tcos(angle),\t\t0,\t0,\n\t\t\t\t\t\t\t0,\t\t\t\t0,\t\t1,\t0,\n\t\t\t\t\t\t\t0,\t\t\t\t0,\t\t0,\t1);\n}\n"};const a=e.inTrigger("render"),n=e.outTrigger("trigger"),r=e.inValue("Scale",10),o=e.inSwitch("Blendmode",["Normal","Mul","Add"],"Normal"),i=e.inSwitch("Target",["Color","Pointsize"],"Color"),l=e.inValueSlider("Amount",.3),s=e.inBool("Use Texture Alpha",false),u=e.inFloat("Pos X",0),m=e.inFloat("Pos Y",0),c=e.inFloat("Rot X",0),d=e.inFloat("Rot Y",0),f=e.inFloat("Rot Z",0),p=e.inTexture("Texture"),b=e.inValueSelect("Mapping",["Triplanar","XY","XZ","YZ","Screen"],"XY"),v=e.inValueBool("Discard"),g=e.inValueBool("WorldSpace");const h=e.patch.cgl;s.onChange=i.onChange=o.onChange=v.onChange=g.onChange=b.onChange=_;e.setPortGroup("Rotation",[c,d,f]);e.setPortGroup("Position",[u,m]);const x=new CGL.ShaderModifier(h,e.name);x.addModule({title:e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:t.maptexture_body_vert,srcBodyVert:t.maptexture_vert});x.addModule({title:e.name,name:"MODULE_COLOR",srcHeadFrag:t.maptexture_frag,srcBodyFrag:t.maptexture_body_frag});x.addUniformBoth("f","MOD_rotX",c);x.addUniformBoth("f","MOD_rotY",d);x.addUniformBoth("f","MOD_rotZ",f);x.addUniformBoth("t","MOD_tex");x.addUniformBoth("f","MOD_scale",r);x.addUniformBoth("f","MOD_amount",l);x.addUniformBoth("2f","MOD_offset",u,m);const O=x.addUniformFrag("f","MOD_viewPortW");const I=x.addUniformFrag("f","MOD_viewPortH");_();function _(){x.toggleDefine("MOD_USE_IMGALPHA",s.get());x.toggleDefine("MOD_WORLDSPACE",g.get());x.toggleDefine("MOD_MAP_XY",b.get()=="XY");x.toggleDefine("MOD_MAP_XZ",b.get()=="XZ");x.toggleDefine("MOD_MAP_YZ",b.get()=="YZ");x.toggleDefine("MOD_MAP_SCREEN",b.get()=="Screen");x.toggleDefine("MOD_MAP_TRIPLANAR",b.get()=="Triplanar");x.toggleDefine("MOD_DISCARD",v.get());x.toggleDefine("MOD_BLEND_NORMAL",o.get()=="Normal");x.toggleDefine("MOD_BLEND_ADD",o.get()=="Add");x.toggleDefine("MOD_BLEND_MUL",o.get()=="Mul");x.toggleDefine("MOD_BLEND_MUL",o.get()=="Mul");x.toggleDefine("MOD_TARGET_COLOR",i.get()=="Color");x.toggleDefine("MOD_TARGET_POINTSIZE",i.get()=="Pointsize")}a.onTriggered=function(){const e=h.getViewPort();x.setUniformValue("MOD_viewPortW",e[2]);x.setUniformValue("MOD_viewPortH",e[3]);x.bind();let t=p.get();if(!t)t=CGL.Texture.getEmptyTexture(h).tex;else t=t.tex;x.pushTexture("MOD_tex",t);n.trigger();x.unbind()}};Ops.Gl.ShaderEffects.TextureProjection.prototype=new CABLES.Op;CABLES.OPS["e22f8347-a88b-47fc-a01e-6b8414b0ba26"]={f:Ops.Gl.ShaderEffects.TextureProjection,objName:"Ops.Gl.ShaderEffects.TextureProjection"};Ops.Gl.Phong.PointLight_v5=function(){CABLES.Op.apply(this,arguments);const e=this;const w={};const t=e.patch.cgl;const D=t.gl;const U=CGL.MESHES.getSimpleRect(t,"fullscreenRectangle");function B(e){this.type=e.type||"point";this.color=e.color||[1,1,1];this.specular=e.specular||[0,0,0];this.position=e.position||null;this.intensity=e.intensity||1;this.radius=e.radius||1;this.falloff=e.falloff||1;this.spotExponent=e.spotExponent||1;this.cosConeAngle=Math.cos(CGL.DEG2RAD*this.coneAngle);this.conePointAt=e.conePointAt||[0,0,0];this.castShadow=e.castShadow||false;return this}const a=e.inTrigger("Trigger In");const n=e.inBool("Cast Light",true);const r=e.inFloat("Intensity",2);const o=e.inFloat("Radius",15);const i=e.inFloat("X",0);const l=e.inFloat("Y",2);const s=e.inFloat("Z",.75);const u=[i,l,s];e.setPortGroup("Position",u);const m=e.inFloat("R",.8);const c=e.inFloat("G",.8);const d=e.inFloat("B",.8);m.setUiAttribs({colorPick:true});const f=[m,c,d];e.setPortGroup("Color",f);const p=e.inFloat("Specular R",1);const b=e.inFloat("Specular G",1);const v=e.inFloat("Specular B",1);p.setUiAttribs({colorPick:true});const g=[p,b,v];e.setPortGroup("Specular Color",g);const h=e.inFloatSlider("Falloff",.5);const k=[r,n,o];e.setPortGroup("Light Attributes",k);const x=e.inBool("Cast Shadow",false);const O=e.inBool("Rendering Active",true);const I=e.inSwitch("Map Size",[256,512,1024,2048],512);const _=e.inFloatSlider("Shadow Strength",1);const T=e.inFloat("Near",.1);const A=e.inFloat("Far",30);const S=e.inFloatSlider("Bias",.004);const E=e.inInt("Polygon Offset",0);e.setPortGroup("",[x]);e.setPortGroup("Shadow Map Settings",[I,O,_,T,A,S,E]);const V=[T,A];I.setUiAttribs({greyout:!x.get()});O.setUiAttribs({greyout:!x.get()});_.setUiAttribs({greyout:!x.get()});T.setUiAttribs({greyout:!x.get()});S.setUiAttribs({greyout:!x.get()});A.setUiAttribs({greyout:!x.get()});E.setUiAttribs({greyout:!x.get()});let C=false;x.onChange=function(){C=true;j=true;I.setUiAttribs({greyout:!x.get()});O.setUiAttribs({greyout:!x.get()});_.setUiAttribs({greyout:!x.get()});T.setUiAttribs({greyout:!x.get()});A.setUiAttribs({greyout:!x.get()});S.setUiAttribs({greyout:!x.get()});E.setUiAttribs({greyout:!x.get()})};const y=e.outTrigger("Trigger Out");const N=e.outObject("Cubemap",null,"texture");const G=e.outNumber("World Position X");const F=e.outNumber("World Position Y");const X=e.outNumber("World Position Z");const M=new CGL.Light(t,{type:"point",position:[0,1,2].map(function(e){return u[e].get()}),color:[0,1,2].map(function(e){return f[e].get()}),specular:[0,1,2].map(function(e){return g[e].get()}),intensity:r.get(),radius:o.get(),falloff:h.get(),shadowStrength:_.get(),shadowBias:S.get()});M.castLight=n.get();let j=false;i.onChange=l.onChange=s.onChange=m.onChange=c.onChange=d.onChange=p.onChange=b.onChange=v.onChange=r.onChange=n.onChange=o.onChange=h.onChange=T.onChange=A.onChange=_.onChange=function(){j=true};I.onChange=function(){C=true};function z(){if(x.get()){const e=I.get();M.createFramebuffer(e,e,{});M.createShadowMapShader()}C=false}const H=vec3.create();const W=vec3.create();const P=vec3.create();const R=vec3.create();function Y(){if(t.frameStore.shadowPass)return;if(t.shouldDrawHelpers(e)){gui.setTransformGizmo({posX:i,posY:l,posZ:s});t.pushModelMatrix();mat4.translate(t.mMatrix,t.mMatrix,R);CABLES.GL_MARKER.drawSphere(e,o.get());t.popModelMatrix()}}let L=false;a.onTriggered=function(){if(C){if(t.frameStore.shadowPass)return;z()}if(!t.frameStore.shadowPass){if(!M.isUsed&&!L){e.setUiError("lightUsed","No operator is using this light. Make sure this op is positioned before an operator that uses lights. Also make sure there is an operator that uses lights after this.",1);L=true}else if(!M.isUsed&&L){}else if(M.isUsed&&L){e.setUiError("lightUsed",null);L=false}else if(M.isUsed&&!L){}M.isUsed=false}if(j){M.position=[0,1,2].map(function(e){return u[e].get()});M.color=[0,1,2].map(function(e){return f[e].get()});M.specular=[0,1,2].map(function(e){return g[e].get()});M.intensity=r.get();M.radius=o.get();M.falloff=h.get();M.castShadow=x.get();M.castLight=n.get();M.updateProjectionMatrix(null,T.get(),A.get(),null);j=false}if(!t.frameStore.lightStack)t.frameStore.lightStack=[];vec3.set(R,i.get(),l.get(),s.get());vec3.transformMat4(P,R,t.mMatrix);M.position=P;G.set(M.position[0]);F.set(M.position[1]);X.set(M.position[2]);if(!t.frameStore.shadowPass)Y();t.frameStore.lightStack.push(M);if(x.get()){if(O.get())M.renderPasses(E.get(),null,function(){y.trigger()});if(!t.frameStore.shadowPass){t.frameStore.lightStack.pop();M.castShadow=x.get();M.shadowBias=S.get();M.shadowStrength=_.get();if(M.shadowCubeMap){if(M.shadowCubeMap.cubemap){N.set(null);N.set(M.shadowCubeMap);if(O.get()){M.positionForShadowMap=[M.position[0],M.position[1],M.position[2]]}}}t.frameStore.lightStack.push(M)}}else{N.set(null)}y.trigger();t.frameStore.lightStack.pop()}};Ops.Gl.Phong.PointLight_v5.prototype=new CABLES.Op;CABLES.OPS["54e5d3f5-e3f4-4381-990d-d5e32b9a2d39"]={f:Ops.Gl.Phong.PointLight_v5,objName:"Ops.Gl.Phong.PointLight_v5"};Ops.Gl.Phong.PhongMaterial_v6=function(){CABLES.Op.apply(this,arguments);const e=this;const l={phong_frag:'IN vec3 viewDirection;\nIN vec3 normInterpolated;\nIN vec2 texCoord;\n\n#ifdef AO_CHAN_1\n    #ifndef ATTRIB_texCoord1\n        #define ATTRIB_texCoord1\n\n        IN vec2 texCoord1;\n    #endif\n#endif\n\n#ifdef HAS_TEXTURE_AO\nvec2 tcAo;\n#endif\n\n\n\n#ifdef ENABLE_FRESNEL\n    IN vec4 cameraSpace_pos;\n#endif\n\n// IN mat3 normalMatrix; // when instancing...\n\n#ifdef HAS_TEXTURE_NORMAL\n    IN mat3 TBN_Matrix; // tangent bitangent normal space transform matrix\n#endif\n\nIN vec3 fragPos;\nIN vec3 v_viewDirection;\n\nUNI vec4 inDiffuseColor;\nUNI vec4 inMaterialProperties;\n\n#ifdef ADD_EMISSIVE_COLOR\n    UNI vec4 inEmissiveColor; // .w = intensity\n#endif\n\n#ifdef ENABLE_FRESNEL\n    UNI mat4 viewMatrix;\n    UNI vec4 inFresnel;\n    UNI vec2 inFresnelWidthExponent;\n#endif\n\n#ifdef ENVMAP_MATCAP\n    IN vec3 viewSpaceNormal;\n    IN vec3 viewSpacePosition;\n#endif\n\nstruct Light {\n    vec3 color;\n    vec3 position;\n    vec3 specular;\n\n\n    // * SPOT LIGHT * //\n    #ifdef HAS_SPOT\n        vec3 conePointAt;\n        #define COSCONEANGLE x\n        #define COSCONEANGLEINNER y\n        #define SPOTEXPONENT z\n        vec3 spotProperties;\n    #endif\n\n    #define INTENSITY x\n    #define ATTENUATION y\n    #define FALLOFF z\n    #define RADIUS w\n    vec4 lightProperties;\n\n    int castLight;\n};\n\n/* CONSTANTS */\n#define NONE -1\n#define ALBEDO x\n#define ROUGHNESS y\n#define SHININESS z\n#define SPECULAR_AMT w\n#define NORMAL x\n#define AO y\n#define SPECULAR z\n#define EMISSIVE w\nconst float PI = 3.1415926535897932384626433832795;\nconst float TWO_PI = (2. * PI);\nconst float EIGHT_PI = (8. * PI);\n\n#define RECIPROCAL_PI 1./PI\n#define RECIPROCAL_PI2 RECIPROCAL_PI/2.\n\n// TEXTURES\n// #ifdef HAS_TEXTURES\n    UNI vec4 inTextureIntensities;\n\n    #ifdef HAS_TEXTURE_ENV\n        #ifdef TEX_FORMAT_CUBEMAP\n            UNI samplerCube texEnv;\n            #ifndef WEBGL1\n                #define SAMPLETEX textureLod\n            #endif\n            #ifdef WEBGL1\n                #define SAMPLETEX textureCubeLodEXT\n            #endif\n        #endif\n\n        #ifdef TEX_FORMAT_EQUIRECT\n            UNI sampler2D texEnv;\n            #ifdef WEBGL1\n                // #extension GL_EXT_shader_texture_lod : enable\n                #ifdef GL_EXT_shader_texture_lod\n                    #define textureLod texture2DLodEXT\n                #endif\n                // #define textureLod texture2D\n            #endif\n\n            #define SAMPLETEX sampleEquirect\n\n            const vec2 invAtan = vec2(0.1591, 0.3183);\n            vec4 sampleEquirect(sampler2D tex,vec3 direction,float lod)\n            {\n                #ifndef WEBGL1\n                    vec3 newDirection = normalize(direction);\n            \t\tvec2 sampleUV;\n            \t\tsampleUV.x = -1. * (atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.75);\n            \t\tsampleUV.y = asin( clamp(direction.y, -1., 1.) ) * RECIPROCAL_PI + 0.5;\n                #endif\n\n                #ifdef WEBGL1\n                    vec3 newDirection = normalize(direction);\n                \t\tvec2 sampleUV = vec2(atan(newDirection.z, newDirection.x), asin(newDirection.y+1e-6));\n                        sampleUV *= vec2(0.1591, 0.3183);\n                        sampleUV += 0.5;\n                #endif\n                return textureLod(tex, sampleUV, lod);\n            }\n        #endif\n        #ifdef ENVMAP_MATCAP\n            UNI sampler2D texEnv;\n            #ifdef WEBGL1\n                // #extension GL_EXT_shader_texture_lod : enable\n                #ifdef GL_EXT_shader_texture_lod\n                    #define textureLod texture2DLodEXT\n                #endif\n                // #define textureLod texture2D\n            #endif\n\n\n            // * taken & modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderLib/meshmatcap_frag.glsl.js\n            vec2 getMatCapUV(vec3 viewSpacePosition, vec3 viewSpaceNormal) {\n                vec3 viewDir = normalize(-viewSpacePosition);\n            \tvec3 x = normalize(vec3(viewDir.z, 0.0, - viewDir.x));\n            \tvec3 y = normalize(cross(viewDir, x));\n            \tvec2 uv = vec2(dot(x, viewSpaceNormal), dot(y, viewSpaceNormal)) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n            \treturn uv;\n            }\n        #endif\n\n        UNI float inEnvMapIntensity;\n        UNI float inEnvMapWidth;\n    #endif\n\n    #ifdef HAS_TEXTURE_LUMINANCE_MASK\n        UNI sampler2D texLuminance;\n        UNI float inLuminanceMaskIntensity;\n    #endif\n\n    #ifdef HAS_TEXTURE_DIFFUSE\n        UNI sampler2D texDiffuse;\n    #endif\n\n    #ifdef HAS_TEXTURE_SPECULAR\n        UNI sampler2D texSpecular;\n    #endif\n\n    #ifdef HAS_TEXTURE_NORMAL\n        UNI sampler2D texNormal;\n    #endif\n\n    #ifdef HAS_TEXTURE_AO\n        UNI sampler2D texAO;\n    #endif\n\n    #ifdef HAS_TEXTURE_EMISSIVE\n        UNI sampler2D texEmissive;\n    #endif\n\n    #ifdef HAS_TEXTURE_EMISSIVE_MASK\n        UNI sampler2D texMaskEmissive;\n        UNI float inEmissiveMaskIntensity;\n    #endif\n    #ifdef HAS_TEXTURE_ALPHA\n        UNI sampler2D texAlpha;\n    #endif\n// #endif\n\n{{MODULES_HEAD}}\n\nfloat when_gt(float x, float y) { return max(sign(x - y), 0.0); } // comparator function\nfloat when_lt(float x, float y) { return max(sign(y - x), 0.0); }\nfloat when_eq(float x, float y) { return 1. - abs(sign(x - y)); } // comparator function\nfloat when_neq(float x, float y) { return abs(sign(x - y)); } // comparator function\nfloat when_ge(float x, float y) { return 1.0 - when_lt(x, y); }\nfloat when_le(float x, float y) { return 1.0 - when_gt(x, y); }\n\n#ifdef FALLOFF_MODE_A\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        // * original falloff\n        float denom = distance / radius + 1.0;\n        float attenuation = 1.0 / (denom*denom);\n        float t = (attenuation - falloff) / (1.0 - falloff);\n        return max(t, 0.0);\n    }\n#endif\n\n#ifdef FALLOFF_MODE_B\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        float distanceSquared = dot(lightDirection, lightDirection);\n        float factor = distanceSquared * falloff;\n        float smoothFactor = clamp(1. - factor * factor, 0., 1.);\n        float attenuation = smoothFactor * smoothFactor;\n\n        return attenuation * 1. / max(distanceSquared, 0.00001);\n    }\n#endif\n\n#ifdef FALLOFF_MODE_C\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        // https://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\n        float falloffNumerator = 1. - pow(distance/radius, 4.);\n        falloffNumerator = clamp(falloffNumerator, 0., 1.);\n        falloffNumerator *= falloffNumerator;\n\n        float denominator = distance*distance + falloff;\n\n        return falloffNumerator/denominator;\n    }\n#endif\n\n#ifdef FALLOFF_MODE_D\n    float CalculateFalloff(float distance, vec3 lightDirection, float falloff, float radius) {\n        // inverse square falloff, "physically correct"\n        return 1.0 / max(distance * distance, 0.0001);\n    }\n#endif\n\n#ifdef ENABLE_FRESNEL\n    float CalculateFresnel(vec3 direction, vec3 normal)\n    {\n        vec3 nDirection = normalize( direction );\n        vec3 nNormal = normalize( mat3(viewMatrix) * normal );\n        vec3 halfDirection = normalize( nNormal + nDirection );\n\n        float cosine = dot( halfDirection, nDirection );\n        float product = max( cosine, 0.0 );\n        float factor = pow(product, inFresnelWidthExponent.y);\n\n        return 5. * factor;\n    }\n#endif\n\n#ifdef CONSERVE_ENERGY\n    // http://www.rorydriscoll.com/2009/01/25/energy-conservation-in-games/\n    // http://www.farbrausch.de/~fg/articles/phong.pdf\n    float EnergyConservation(float shininess) {\n        #ifdef SPECULAR_PHONG\n            return (shininess + 2.)/TWO_PI;\n        #endif\n        #ifdef SPECULAR_BLINN\n            return (shininess + 8.)/EIGHT_PI;\n        #endif\n\n        #ifdef SPECULAR_SCHLICK\n            return (shininess + 8.)/EIGHT_PI;\n        #endif\n\n        #ifdef SPECULAR_GAUSS\n            return (shininess + 8.)/EIGHT_PI;\n        #endif\n    }\n#endif\n\n#ifdef ENABLE_OREN_NAYAR_DIFFUSE\n    float CalculateOrenNayar(vec3 lightDirection, vec3 viewDirection, vec3 normal) {\n        float LdotV = dot(lightDirection, viewDirection);\n        float NdotL = dot(lightDirection, normal);\n        float NdotV = dot(normal, viewDirection);\n\n        float albedo = inMaterialProperties.ALBEDO;\n        albedo *= 1.8;\n        float s = LdotV - NdotL * NdotV;\n        float t = mix(1., max(NdotL, NdotV), step(0., s));\n\n        float roughness = inMaterialProperties.ROUGHNESS;\n        float sigma2 = roughness * roughness;\n        float A = 1. + sigma2 * (albedo / (sigma2 + 0.13) + 0.5 / (sigma2 + 0.33));\n        float B = 0.45 * sigma2 / (sigma2 + 0.09);\n\n        float factor = albedo * max(0., NdotL) * (A + B * s / t) / PI;\n\n        return factor;\n\n    }\n#endif\n\nvec3 CalculateDiffuseColor(\n    vec3 lightDirection,\n    vec3 viewDirection,\n    vec3 normal,\n    vec3 lightColor,\n    vec3 materialColor,\n    inout float lambert\n) {\n    #ifndef ENABLE_OREN_NAYAR_DIFFUSE\n        lambert = clamp(dot(lightDirection, normal), 0., 1.);\n    #endif\n\n    #ifdef ENABLE_OREN_NAYAR_DIFFUSE\n        lambert = CalculateOrenNayar(lightDirection, viewDirection, normal);\n    #endif\n\n    vec3 diffuseColor = lambert * lightColor * materialColor;\n    return diffuseColor;\n}\n\nvec3 CalculateSpecularColor(\n    vec3 specularColor,\n    float specularCoefficient,\n    float shininess,\n    vec3 lightDirection,\n    vec3 viewDirection,\n    vec3 normal,\n    float lambertian\n) {\n    vec3 resultColor = vec3(0.);\n\n    #ifdef SPECULAR_PHONG\n        vec3 reflectDirection = reflect(-lightDirection, normal);\n        float specularAngle = max(dot(reflectDirection, viewDirection), 0.);\n        float specularFactor = pow(specularAngle, max(0., shininess));\n    resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef SPECULAR_BLINN\n        vec3 halfDirection = normalize(lightDirection + viewDirection);\n        float specularAngle = max(dot(halfDirection, normal), 0.);\n        float specularFactor = pow(specularAngle, max(0., shininess));\n        resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef SPECULAR_SCHLICK\n        vec3 halfDirection = normalize(lightDirection + viewDirection);\n        float specularAngle = dot(halfDirection, normal);\n        float schlickShininess = max(0., shininess);\n        float specularFactor = specularAngle / (schlickShininess - schlickShininess*specularAngle + specularAngle);\n        resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef SPECULAR_GAUSS\n        vec3 halfDirection = normalize(lightDirection + viewDirection);\n        float specularAngle = acos(max(dot(halfDirection, normal), 0.));\n        float exponent = specularAngle * shininess * 0.17;\n        exponent = -(exponent*exponent);\n        float specularFactor = exp(exponent);\n\n        resultColor = lambertian * specularFactor * specularCoefficient * specularColor;\n    #endif\n\n    #ifdef CONSERVE_ENERGY\n        float conserveEnergyFactor = EnergyConservation(shininess);\n        resultColor = conserveEnergyFactor * resultColor;\n    #endif\n\n    return resultColor;\n}\n\n#ifdef HAS_SPOT\n    float CalculateSpotLightEffect(vec3 lightPosition, vec3 conePointAt, float cosConeAngle, float cosConeAngleInner, float spotExponent, vec3 lightDirection) {\n        vec3 spotLightDirection = normalize(lightPosition-conePointAt);\n        float spotAngle = dot(-lightDirection, spotLightDirection);\n        float epsilon = cosConeAngle - cosConeAngleInner;\n\n        float spotIntensity = clamp((spotAngle - cosConeAngle)/epsilon, 0.0, 1.0);\n        spotIntensity = pow(spotIntensity, max(0.01, spotExponent));\n\n        return max(0., spotIntensity);\n    }\n#endif\n\n\n\n{{PHONG_FRAGMENT_HEAD}}\n\n\nvoid main()\n{\n    {{MODULE_BEGIN_FRAG}}\n\n    vec4 col=vec4(0., 0., 0., inDiffuseColor.a);\n    vec3 calculatedColor = vec3(0.);\n    vec3 normal = normalize(normInterpolated);\n    vec3 baseColor = inDiffuseColor.rgb;\n\n    {{MODULE_BASE_COLOR}}\n\n\n\n    #ifdef AO_CHAN_0\n        vec2 tcAo=texCoord;\n    #endif\n    #ifdef AO_CHAN_1\n        vec2 tcAo=texCoord1;\n    #endif\n\n\n    vec3 viewDirection = normalize(v_viewDirection);\n\n    #ifdef DOUBLE_SIDED\n        if(!gl_FrontFacing) normal = normal * -1.0;\n    #endif\n\n    #ifdef HAS_TEXTURES\n        #ifdef HAS_TEXTURE_DIFFUSE\n            baseColor = texture(texDiffuse, texCoord).rgb;\n\n            #ifdef COLORIZE_TEXTURE\n                baseColor *= inDiffuseColor.rgb;\n            #endif\n        #endif\n\n        #ifdef HAS_TEXTURE_NORMAL\n            normal = texture(texNormal, texCoord).rgb;\n            normal = normalize(normal * 2. - 1.);\n            float normalIntensity = inTextureIntensities.NORMAL;\n            normal = normalize(mix(vec3(0., 0., 1.), normal, 2. * normalIntensity));\n            normal = normalize(TBN_Matrix * normal);\n        #endif\n    #endif\n\n    {{PHONG_FRAGMENT_BODY}}\n\n\n\n\n\n\n    #ifdef ENABLE_FRESNEL\n        calculatedColor += inFresnel.rgb * (CalculateFresnel(vec3(cameraSpace_pos), normal) * inFresnel.w * inFresnelWidthExponent.x);\n    #endif\n\n     #ifdef HAS_TEXTURE_ALPHA\n        #ifdef ALPHA_MASK_ALPHA\n            col.a*=texture(texAlpha,texCoord).a;\n        #endif\n        #ifdef ALPHA_MASK_LUMI\n            col.a*= dot(vec3(0.2126,0.7152,0.0722), texture(texAlpha,texCoord).rgb);\n        #endif\n        #ifdef ALPHA_MASK_R\n            col.a*=texture(texAlpha,texCoord).r;\n        #endif\n        #ifdef ALPHA_MASK_G\n            col.a*=texture(texAlpha,texCoord).g;\n        #endif\n        #ifdef ALPHA_MASK_B\n            col.a*=texture(texAlpha,texCoord).b;\n        #endif\n    #endif\n\n    #ifdef DISCARDTRANS\n        if(col.a<0.2) discard;\n    #endif\n\n\n    #ifdef HAS_TEXTURE_ENV\n        vec3 luminanceColor = vec3(0.);\n\n        #ifndef ENVMAP_MATCAP\n            float environmentMapWidth = inEnvMapWidth;\n            float glossyExponent = inMaterialProperties.SHININESS;\n            float glossyCoefficient = inMaterialProperties.SPECULAR_AMT;\n\n            vec3 envMapNormal =  normal;\n            vec3 reflectDirection = reflect(normalize(-viewDirection), normal);\n\n            float lambertianCoefficient = dot(viewDirection, reflectDirection); //0.44; // TODO: need prefiltered map for this\n            // lambertianCoefficient = 1.;\n            float specularAngle = max(dot(reflectDirection, viewDirection), 0.);\n            float specularFactor = pow(specularAngle, max(0., inMaterialProperties.SHININESS));\n\n            glossyExponent = specularFactor;\n\n            float maxMIPLevel = 10.;\n            float MIPlevel = log2(environmentMapWidth / 1024. * sqrt(3.)) - 0.5 * log2(glossyExponent + 1.);\n\n            luminanceColor = inEnvMapIntensity * (\n                inDiffuseColor.rgb *\n                SAMPLETEX(texEnv, envMapNormal, maxMIPLevel).rgb\n                +\n                glossyCoefficient * SAMPLETEX(texEnv, reflectDirection, MIPlevel).rgb\n            );\n        #endif\n        #ifdef ENVMAP_MATCAP\n            luminanceColor = inEnvMapIntensity * (\n                texture(texEnv, getMatCapUV(viewSpacePosition, viewSpaceNormal)).rgb\n                //inDiffuseColor.rgb\n                //* textureLod(texEnv, getMatCapUV(envMapNormal), maxMIPLevel).rgb\n                //+\n                //glossyCoefficient * textureLod(texEnv, getMatCapUV(reflectDirection), MIPlevel).rgb\n            );\n        #endif\n\n\n\n        #ifdef HAS_TEXTURE_LUMINANCE_MASK\n            luminanceColor *= texture(texLuminance, texCoord).r * inLuminanceMaskIntensity;\n        #endif\n\n        #ifdef HAS_TEXTURE_AO\n            luminanceColor *= texture(texAO, tcAo).r*inTextureIntensities.AO;\n        #endif\n\n        #ifdef ENV_BLEND_ADD\n            calculatedColor.rgb += luminanceColor;\n        #endif\n        #ifdef ENV_BLEND_MUL\n            calculatedColor.rgb *= luminanceColor;\n        #endif\n\n        #ifdef ENV_BLEND_MIX\n            calculatedColor.rgb=mix(luminanceColor,calculatedColor.rgb,luminanceColor);\n        #endif\n\n\n    #endif\n\n    #ifdef ADD_EMISSIVE_COLOR\n        vec3 emissiveRadiance = mix(calculatedColor, inEmissiveColor.rgb, inEmissiveColor.w); // .w = intensity of color;\n\n        #ifdef HAS_TEXTURE_EMISSIVE\n            float emissiveIntensity = inTextureIntensities.EMISSIVE;\n            emissiveRadiance = mix(calculatedColor, texture(texEmissive, texCoord).rgb, emissiveIntensity);\n        #endif\n\n        #ifdef HAS_TEXTURE_EMISSIVE_MASK\n           float emissiveMixValue = mix(1., texture(texMaskEmissive, texCoord).r, inEmissiveMaskIntensity);\n           calculatedColor = mix(calculatedColor, emissiveRadiance, emissiveMixValue);\n        #endif\n\n        #ifndef HAS_TEXTURE_EMISSIVE_MASK\n            calculatedColor = emissiveRadiance;\n        #endif\n    #endif\n\n    col.rgb = clamp(calculatedColor, 0., 1.);\n\n\n    {{MODULE_COLOR}}\n\n    outColor = col;\n\n}\n',phong_vert:"\n{{MODULES_HEAD}}\n\n#define NONE -1\n#define AMBIENT 0\n#define POINT 1\n#define DIRECTIONAL 2\n#define SPOT 3\n\n#define TEX_REPEAT_X x;\n#define TEX_REPEAT_Y y;\n#define TEX_OFFSET_X z;\n#define TEX_OFFSET_Y w;\n\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN float attrVertIndex;\nIN vec3 attrTangent;\nIN vec3 attrBiTangent;\n\nOUT vec2 texCoord;\nOUT vec3 normInterpolated;\nOUT vec3 fragPos;\n\n#ifdef AO_CHAN_1\n    #ifndef ATTRIB_attrTexCoord1\n        IN vec2 attrTexCoord1;\n        OUT vec2 texCoord1;\n        #define ATTRIB_attrTexCoord1\n        #define ATTRIB_texCoord1\n    #endif\n#endif\n\n#ifdef HAS_TEXTURE_NORMAL\n    OUT mat3 TBN_Matrix; // tangent bitangent normal space transform matrix\n#endif\n\n#ifdef ENABLE_FRESNEL\n    OUT vec4 cameraSpace_pos;\n#endif\n\nOUT vec3 v_viewDirection;\nOUT mat3 normalMatrix;\nOUT mat4 mvMatrix;\n\n#ifdef HAS_TEXTURES\n    UNI vec4 inTextureRepeatOffset;\n#endif\n\nUNI vec3 camPos;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\n#ifdef ENVMAP_MATCAP\n    OUT vec3 viewSpaceNormal;\n    OUT vec3 viewSpacePosition;\n#endif\n\n\nmat3 transposeMat3(mat3 m)\n{\n    return mat3(m[0][0], m[1][0], m[2][0],\n        m[0][1], m[1][1], m[2][1],\n        m[0][2], m[1][2], m[2][2]);\n}\n\nmat3 inverseMat3(mat3 m)\n{\n    float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n    float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n    float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n    float b01 = a22 * a11 - a12 * a21;\n    float b11 = -a22 * a10 + a12 * a20;\n    float b21 = a21 * a10 - a11 * a20;\n\n    float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n    return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n        b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n        b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nvoid main()\n{\n    mat4 mMatrix=modelMatrix;\n    vec4 pos=vec4(vPosition,  1.0);\n\n    texCoord=attrTexCoord;\n    texCoord.y = 1. - texCoord.y;\n\n    #ifdef ATTRIB_texCoord1\n        texCoord1=attrTexCoord1;\n    #endif\n\n    vec3 norm=attrVertNormal;\n    vec3 tangent = attrTangent;\n    vec3 bitangent = attrBiTangent;\n\n    {{MODULE_VERTEX_POSITION}}\n\n    normalMatrix = transposeMat3(inverseMat3(mat3(mMatrix)));\n    mvMatrix = (viewMatrix * mMatrix);\n\n\n\n    #ifdef ENABLE_FRESNEL\n        cameraSpace_pos = mvMatrix * pos;\n    #endif\n\n    #ifdef HAS_TEXTURES\n        float repeatX = inTextureRepeatOffset.TEX_REPEAT_X;\n        float offsetX = inTextureRepeatOffset.TEX_OFFSET_X;\n        float repeatY = inTextureRepeatOffset.TEX_REPEAT_Y;\n        float offsetY = inTextureRepeatOffset.TEX_OFFSET_Y;\n\n        texCoord.x *= repeatX;\n        texCoord.x += offsetX;\n        texCoord.y *= repeatY;\n        texCoord.y += offsetY;\n    #endif\n\n   normInterpolated = vec3(normalMatrix*norm);\n\n    #ifdef HAS_TEXTURE_NORMAL\n        vec3 normCameraSpace = normalize((vec4(normInterpolated, 0.0)).xyz);\n        vec3 tangCameraSpace = normalize((mMatrix * vec4(tangent, 0.0)).xyz);\n        vec3 bitangCameraSpace = normalize((mMatrix * vec4(bitangent, 0.0)).xyz);\n\n        // re orthogonalization for smoother normals\n        tangCameraSpace = normalize(tangCameraSpace - dot(tangCameraSpace, normCameraSpace) * normCameraSpace);\n        bitangCameraSpace = cross(normCameraSpace, tangCameraSpace);\n\n        TBN_Matrix = mat3(tangCameraSpace, bitangCameraSpace, normCameraSpace);\n    #endif\n\n    fragPos = vec3((mMatrix) * pos);\n    v_viewDirection = normalize(camPos - fragPos);\n    // modelPos=mMatrix*pos;\n\n    #ifdef ENVMAP_MATCAP\n        mat3 viewSpaceNormalMatrix = normalMatrix = transposeMat3(inverseMat3(mat3(mvMatrix)));\n        viewSpaceNormal = normalize(viewSpaceNormalMatrix * norm);\n        viewSpacePosition = vec3(mvMatrix * pos);\n    #endif\n    gl_Position = projMatrix * mvMatrix * pos;\n}\n",snippet_body_ambient_frag:"    // * AMBIENT LIGHT {{LIGHT_INDEX}} *\n    vec3 diffuseColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY*phongLight{{LIGHT_INDEX}}.color;\n    calculatedColor += diffuseColor{{LIGHT_INDEX}};\n",snippet_body_directional_frag:"    // * DIRECTIONAL LIGHT {{LIGHT_INDEX}} *\n\n    if (phongLight{{LIGHT_INDEX}}.castLight == 1) {\n        vec3 phongLightDirection{{LIGHT_INDEX}} = normalize(phongLight{{LIGHT_INDEX}}.position);\n\n        float phongLambert{{LIGHT_INDEX}} = 1.; // inout variable\n\n        vec3 lightColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.color;\n        vec3 lightSpecular{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.specular;\n\n        #ifdef HAS_TEXTURES\n            #ifdef HAS_TEXTURE_AO\n                // lightColor{{LIGHT_INDEX}} *= mix(vec3(1.), texture(texAO, texCoord).rgb, inTextureIntensities.AO);\n                lightColor{{LIGHT_INDEX}} *= texture(texAO, tcAo).g, inTextureIntensities.AO;\n\n            #endif\n\n            #ifdef HAS_TEXTURE_SPECULAR\n                lightSpecular{{LIGHT_INDEX}} *= mix(1., texture(texSpecular, texCoord).r, inTextureIntensities.SPECULAR);\n            #endif\n        #endif\n\n        vec3 diffuseColor{{LIGHT_INDEX}} = CalculateDiffuseColor(phongLightDirection{{LIGHT_INDEX}}, viewDirection, normal, lightColor{{LIGHT_INDEX}}, baseColor, phongLambert{{LIGHT_INDEX}});\n        vec3 specularColor{{LIGHT_INDEX}} = CalculateSpecularColor(\n            lightSpecular{{LIGHT_INDEX}},\n            inMaterialProperties.SPECULAR_AMT,\n            inMaterialProperties.SHININESS,\n            phongLightDirection{{LIGHT_INDEX}},\n            viewDirection,\n            normal,\n            phongLambert{{LIGHT_INDEX}}\n        );\n\n        vec3 combinedColor{{LIGHT_INDEX}} = (diffuseColor{{LIGHT_INDEX}} + specularColor{{LIGHT_INDEX}});\n\n        vec3 lightModelDiff{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n\n        combinedColor{{LIGHT_INDEX}} *= phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY;\n        calculatedColor += combinedColor{{LIGHT_INDEX}};\n    }",snippet_body_point_frag:"// * POINT LIGHT {{LIGHT_INDEX}} *\n    if (phongLight{{LIGHT_INDEX}}.castLight == 1) {\n        vec3 phongLightDirection{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n        // * get length before normalization for falloff calculation\n        phongLightDirection{{LIGHT_INDEX}} = normalize(phongLightDirection{{LIGHT_INDEX}});\n        float phongLightDistance{{LIGHT_INDEX}} = length(phongLightDirection{{LIGHT_INDEX}});\n\n        float phongLambert{{LIGHT_INDEX}} = 1.; // inout variable\n\n        vec3 lightColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.color;\n        vec3 lightSpecular{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.specular;\n\n        #ifdef HAS_TEXTURES\n            #ifdef HAS_TEXTURE_AO\n                lightColor{{LIGHT_INDEX}} -= (1.0-texture(texAO, tcAo).g)* (inTextureIntensities.AO);\n            #endif\n\n            #ifdef HAS_TEXTURE_SPECULAR\n                lightSpecular{{LIGHT_INDEX}} *= mix(1., texture(texSpecular, texCoord).r, inTextureIntensities.SPECULAR);\n            #endif\n        #endif\n\n        vec3 diffuseColor{{LIGHT_INDEX}} = CalculateDiffuseColor(phongLightDirection{{LIGHT_INDEX}}, viewDirection, normal, lightColor{{LIGHT_INDEX}}, baseColor, phongLambert{{LIGHT_INDEX}});\n        vec3 specularColor{{LIGHT_INDEX}} = CalculateSpecularColor(\n            lightSpecular{{LIGHT_INDEX}},\n            inMaterialProperties.SPECULAR_AMT,\n            inMaterialProperties.SHININESS,\n            phongLightDirection{{LIGHT_INDEX}},\n            viewDirection,\n            normal,\n            phongLambert{{LIGHT_INDEX}}\n        );\n\n        vec3 combinedColor{{LIGHT_INDEX}} = (diffuseColor{{LIGHT_INDEX}} + specularColor{{LIGHT_INDEX}});\n\n        combinedColor{{LIGHT_INDEX}} *= phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY;\n\n        float attenuation{{LIGHT_INDEX}} = CalculateFalloff(\n            phongLightDistance{{LIGHT_INDEX}},\n            phongLightDirection{{LIGHT_INDEX}},\n            phongLight{{LIGHT_INDEX}}.lightProperties.FALLOFF,\n            phongLight{{LIGHT_INDEX}}.lightProperties.RADIUS\n        );\n\n        attenuation{{LIGHT_INDEX}} *= when_gt(phongLambert{{LIGHT_INDEX}}, 0.);\n        combinedColor{{LIGHT_INDEX}} *= attenuation{{LIGHT_INDEX}};\n\n        calculatedColor += combinedColor{{LIGHT_INDEX}};\n    }\n",snippet_body_spot_frag:"    // * SPOT LIGHT {{LIGHT_INDEX}} *\n    if (phongLight{{LIGHT_INDEX}}.castLight == 1) {\n        vec3 phongLightDirection{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n        phongLightDirection{{LIGHT_INDEX}} = normalize( phongLightDirection{{LIGHT_INDEX}});\n        float phongLightDistance{{LIGHT_INDEX}} = length(phongLightDirection{{LIGHT_INDEX}});\n\n        float phongLambert{{LIGHT_INDEX}} = 1.; // inout variable\n\n        vec3 lightColor{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.color;\n        vec3 lightSpecular{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.specular;\n\n        #ifdef HAS_TEXTURES\n            #ifdef HAS_TEXTURE_AO\n                // lightColor{{LIGHT_INDEX}} *= mix(vec3(1.), texture(texAO, texCoord).rgb, inTextureIntensities.AO);\n                lightColor{{LIGHT_INDEX}} *= texture(texAO, texCoord).g, inTextureIntensities.AO;\n\n            #endif\n\n            #ifdef HAS_TEXTURE_SPECULAR\n                lightSpecular{{LIGHT_INDEX}} *= mix(1., texture(texSpecular, texCoord).r, inTextureIntensities.SPECULAR);\n            #endif\n        #endif\n\n        vec3 diffuseColor{{LIGHT_INDEX}} = CalculateDiffuseColor(phongLightDirection{{LIGHT_INDEX}}, viewDirection, normal, lightColor{{LIGHT_INDEX}}, baseColor, phongLambert{{LIGHT_INDEX}});\n        vec3 specularColor{{LIGHT_INDEX}} = CalculateSpecularColor(\n            lightSpecular{{LIGHT_INDEX}},\n            inMaterialProperties.SPECULAR_AMT,\n            inMaterialProperties.SHININESS,\n            phongLightDirection{{LIGHT_INDEX}},\n            viewDirection,\n            normal,\n            phongLambert{{LIGHT_INDEX}}\n        );\n\n        vec3 combinedColor{{LIGHT_INDEX}} = (diffuseColor{{LIGHT_INDEX}} + specularColor{{LIGHT_INDEX}});\n\n        float spotIntensity{{LIGHT_INDEX}} = CalculateSpotLightEffect(\n            phongLight{{LIGHT_INDEX}}.position, phongLight{{LIGHT_INDEX}}.conePointAt, phongLight{{LIGHT_INDEX}}.spotProperties.COSCONEANGLE,\n            phongLight{{LIGHT_INDEX}}.spotProperties.COSCONEANGLEINNER, phongLight{{LIGHT_INDEX}}.spotProperties.SPOTEXPONENT,\n            phongLightDirection{{LIGHT_INDEX}}\n        );\n\n        combinedColor{{LIGHT_INDEX}} *= spotIntensity{{LIGHT_INDEX}};\n\n        vec3 lightModelDiff{{LIGHT_INDEX}} = phongLight{{LIGHT_INDEX}}.position - fragPos.xyz;\n\n        float attenuation{{LIGHT_INDEX}} = CalculateFalloff(\n            phongLightDistance{{LIGHT_INDEX}},\n            phongLightDirection{{LIGHT_INDEX}},\n            phongLight{{LIGHT_INDEX}}.lightProperties.FALLOFF,\n            phongLight{{LIGHT_INDEX}}.lightProperties.RADIUS\n        );\n\n        attenuation{{LIGHT_INDEX}} *= when_gt(phongLambert{{LIGHT_INDEX}}, 0.);\n\n        combinedColor{{LIGHT_INDEX}} *= attenuation{{LIGHT_INDEX}};\n\n        combinedColor{{LIGHT_INDEX}} *= phongLight{{LIGHT_INDEX}}.lightProperties.INTENSITY;\n        calculatedColor += combinedColor{{LIGHT_INDEX}};\n    }",snippet_head_frag:"UNI Light phongLight{{LIGHT_INDEX}};\n"};const t=e.patch.cgl;const D=l.snippet_head_frag;const U={point:l.snippet_body_point_frag,spot:l.snippet_body_spot_frag,ambient:l.snippet_body_ambient_frag,directional:l.snippet_body_directional_frag,area:l.snippet_body_area_frag};const B=new RegExp("{{LIGHT_INDEX}}","g");const k=e=>{return D.replace("{{LIGHT_INDEX}}",e)};const V=(e,t)=>{return U[t].replace(B,e)};function G(){const e=l.phong_vert;let t=l.phong_frag;let a=k(0);let n=V(0,rt[0].type);t=t.replace(_e,a);t=t.replace(Te,n);N.setSource(e,t);N.define("HAS_POINT");N.removeDefine("HAS_SPOT");N.removeDefine("HAS_DIRECTIONAL");N.removeDefine("HAS_AMBIENT")}const F=e.inTrigger("Trigger In");const X=e.inFloat("R",Math.random());const z=e.inFloat("G",Math.random());const H=e.inFloat("B",Math.random());const W=e.inFloatSlider("A",1);const Y=[X,z,H,W];e.setPortGroup("Diffuse Color",Y);const a=e.inBool("Enable",false);const n=e.inFloatSlider("Albedo",.707);const r=e.inFloatSlider("Roughness",.835);a.setUiAttribs({hidePort:true});n.setUiAttribs({greyout:true});r.setUiAttribs({greyout:true});X.setUiAttribs({colorPick:true});e.setPortGroup("Oren-Nayar Diffuse",[a,n,r]);e.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);a.onChange=function(){N.toggleDefine("ENABLE_OREN_NAYAR_DIFFUSE",a);n.setUiAttribs({greyout:!a.get()});r.setUiAttribs({greyout:!a.get()})};const o=e.inValueBool("Active",false);o.setUiAttribs({hidePort:true});const q=e.inValueSlider("Fresnel Intensity",.7);const Z=e.inFloat("Fresnel Width",1);const K=e.inFloat("Fresnel Exponent",6);const J=e.inFloat("Fresnel R",1);const $=e.inFloat("Fresnel G",1);const Q=e.inFloat("Fresnel B",1);J.setUiAttribs({colorPick:true});const ee=[q,Z,K,J,$,Q];ee.forEach(function(e){e.setUiAttribs({greyout:true})});e.setPortGroup("Fresnel",ee.concat([o]));let i=null;let te=null;o.onChange=function(){N.toggleDefine("ENABLE_FRESNEL",o);if(o.get()){if(!i)i=new CGL.Uniform(N,"4f","inFresnel",J,$,Q,q);if(!te)te=new CGL.Uniform(N,"2f","inFresnelWidthExponent",Z,K)}else{if(i){N.removeUniform("inFresnel");i=null}if(te){N.removeUniform("inFresnelWidthExponent");te=null}}ee.forEach(function(e){e.setUiAttribs({greyout:!o.get()})})};const s=e.inBool("Emissive Active",false);const u=e.inFloatSlider("Color Intensity",.3);const m=e.inFloatSlider("Emissive R",Math.random());const c=e.inFloatSlider("Emissive G",Math.random());const d=e.inFloatSlider("Emissive B",Math.random());m.setUiAttribs({colorPick:true});e.setPortGroup("Emissive Color",[s,u,m,c,d]);u.setUiAttribs({greyout:!s.get()});m.setUiAttribs({greyout:!s.get()});c.setUiAttribs({greyout:!s.get()});d.setUiAttribs({greyout:!s.get()});let ae=null;s.onChange=()=>{N.toggleDefine("ADD_EMISSIVE_COLOR",s);if(s.get()){ae=new CGL.Uniform(N,"4f","inEmissiveColor",m,c,d,u);x.setUiAttribs({greyout:false});O.setUiAttribs({greyout:false});if(x.get())A.setUiAttribs({greyout:false});if(O.get())S.setUiAttribs({greyout:false})}else{e.log("ayayay");x.setUiAttribs({greyout:true});O.setUiAttribs({greyout:true});A.setUiAttribs({greyout:true});S.setUiAttribs({greyout:true});N.removeUniform("inEmissiveColor");ae=null}if(x.get()){u.setUiAttribs({greyout:true});m.setUiAttribs({greyout:true});c.setUiAttribs({greyout:true});d.setUiAttribs({greyout:true})}else{if(s.get()){u.setUiAttribs({greyout:false});m.setUiAttribs({greyout:false});c.setUiAttribs({greyout:false});d.setUiAttribs({greyout:false})}else{u.setUiAttribs({greyout:true});m.setUiAttribs({greyout:true});c.setUiAttribs({greyout:true});d.setUiAttribs({greyout:true})}}};const ne=e.inFloat("Shininess",4);const re=e.inFloatSlider("Specular Amount",.5);const f=e.inSwitch("Specular Model",["Blinn","Schlick","Phong","Gauss"],"Blinn");f.setUiAttribs({hidePort:true});const oe=[ne,re,f];e.setPortGroup("Specular",oe);const ie=e.inValueBool("Energy Conservation",false);const le=e.inBool("Double Sided Material",false);const p=e.inSwitch("Falloff Mode",["A","B","C","D"],"A");ie.setUiAttribs({hidePort:true});le.setUiAttribs({hidePort:true});p.setUiAttribs({hidePort:true});p.onChange=()=>{const e=["A","B","C","D"];N.define("FALLOFF_MODE_"+p.get());e.filter(e=>{return e!==p.get()}).forEach(e=>{return N.removeDefine("FALLOFF_MODE_"+e)})};const se=[ie,le,p];e.setPortGroup("Light Options",se);const b=e.inTexture("Diffuse Texture");const v=e.inTexture("Specular Texture");const g=e.inTexture("Normal Map");const h=e.inTexture("AO Texture");const x=e.inTexture("Emissive Texture");const O=e.inTexture("Emissive Mask");const I=e.inTexture("Opacity Texture");const _=e.inTexture("Environment Map");const T=e.inTexture("Env Map Mask");e.setPortGroup("Textures",[b,v,g,h,x,O,I,_,T]);const ue=e.inBool("Colorize Texture",false);const me=e.inFloat("Diffuse Repeat X",1);const ce=e.inFloat("Diffuse Repeat Y",1);const de=e.inFloat("Texture Offset X",0);const fe=e.inFloat("Texture Offset Y",0);const pe=e.inFloatSlider("Specular Intensity",1);const be=e.inFloatSlider("Normal Map Intensity",.5);const ve=e.inFloatSlider("AO Intensity",1);const ge=e.inSwitch("AO UV Channel",["1","2"],1);const A=e.inFloatSlider("Emissive Intensity",1);const S=e.inFloatSlider("Emissive Mask Intensity",1);const he=e.inFloatSlider("Env Map Intensity",1);const E=e.inSwitch("Env Map Blend",["Add","Multiply","Mix"],"Add");const xe=e.inFloatSlider("Env Mask Intensity",1);ue.setUiAttribs({hidePort:true});e.setPortGroup("Texture Transforms",[ue,ce,me,fe,de]);e.setPortGroup("Texture Intensities",[be,ve,pe,A,E,S,he,xe]);const C=e.inSwitch("Alpha Mask Source",["Luminance","R","G","B","A"],"Luminance");C.setUiAttribs({greyout:true});const y=e.inValueBool("Discard Transparent Pixels");y.setUiAttribs({hidePort:true});e.setPortGroup("Opacity Texture",[C,y]);ge.onChange=E.onChange=C.onChange=ze;const Oe=e.outTrigger("Trigger Out");const Ie=e.outObject("Shader",null,"shader");Ie.ignoreValueSerialize=true;const N=new CGL.Shader(t,"phongmaterial_"+e.id);N.op=this;N.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG","MODULE_BASE_COLOR"]);N.setSource(l.simosphong_vert,l.simosphong_frag);N.define("FALLOFF_MODE_A");if(t.glVersion<2){N.enableExtension("GL_OES_standard_derivatives");if(t.enableExtension("OES_texture_float"))N.enableExtension("GL_OES_texture_float");else e.log("error loading extension OES_texture_float");if(t.enableExtension("OES_texture_float_linear"))N.enableExtension("GL_OES_texture_float_linear");else e.log("error loading extention OES_texture_float_linear");if(t.enableExtension("GL_OES_texture_half_float"))N.enableExtension("GL_OES_texture_half_float");else e.log("error loading extention GL_OES_texture_half_float");if(t.enableExtension("GL_OES_texture_half_float_linear"))N.enableExtension("GL_OES_texture_half_float_linear");else e.log("error loading extention GL_OES_texture_half_float_linear")}const _e=new RegExp("{{PHONG_FRAGMENT_HEAD}}","g");const Te=new RegExp("{{PHONG_FRAGMENT_BODY}}","g");const M={directional:false,spot:false,ambient:false,point:false};function Ae(t){let e=l.phong_frag;let a="";let n="";M.directional=false;M.spot=false;M.ambient=false;M.point=false;for(let e=0;e<t.length;e+=1){const r=t[e];const o=r.type;if(!M[o]){M[o]=true}a=a.concat(k(e));n=n.concat(V(e,r.type))}e=e.replace(_e,a);e=e.replace(Te,n);N.setSource(l.phong_vert,e);for(let e=0,t=Object.keys(M);e<t.length;e+=1){const i=t[e];if(M[i]){if(!N.hasDefine("HAS_"+i.toUpperCase())){N.define("HAS_"+i.toUpperCase())}}else{if(N.hasDefine("HAS_"+i.toUpperCase())){N.removeDefine("HAS_"+i.toUpperCase())}}}}Ie.set(N);let Se=null;let Ee=null;let Ce=null;let ye=null;let Ne=null;let Me=null;let je=null;let j=null;let P=null;let R=null;let Pe=null;let Re=null;let Le=null;ue.onChange=function(){N.toggleDefine("COLORIZE_TEXTURE",ue.get())};function we(){if(b.get()){if(!N.hasDefine("HAS_TEXTURE_DIFFUSE")){N.define("HAS_TEXTURE_DIFFUSE");if(!Se)Se=new CGL.Uniform(N,"t","texDiffuse",0)}}else{N.removeUniform("texDiffuse");N.removeDefine("HAS_TEXTURE_DIFFUSE");Se=null}}function De(){if(v.get()){pe.setUiAttribs({greyout:false});if(!N.hasDefine("HAS_TEXTURE_SPECULAR")){N.define("HAS_TEXTURE_SPECULAR");if(!Ee)Ee=new CGL.Uniform(N,"t","texSpecular",0)}}else{pe.setUiAttribs({greyout:true});N.removeUniform("texSpecular");N.removeDefine("HAS_TEXTURE_SPECULAR");Ee=null}}function Ue(){if(g.get()){be.setUiAttribs({greyout:false});if(!N.hasDefine("HAS_TEXTURE_NORMAL")){N.define("HAS_TEXTURE_NORMAL");if(!Ce)Ce=new CGL.Uniform(N,"t","texNormal",0)}}else{be.setUiAttribs({greyout:true});N.removeUniform("texNormal");N.removeDefine("HAS_TEXTURE_NORMAL");Ce=null}}ye=new CGL.Uniform(N,"t","texAO");function Be(){N.toggleDefine("HAS_TEXTURE_AO",h.get());ve.setUiAttribs({greyout:!h.get()})}function ke(){if(x.get()){m.setUiAttribs({greyout:true});c.setUiAttribs({greyout:true});d.setUiAttribs({greyout:true});u.setUiAttribs({greyout:true});if(s.get()){A.setUiAttribs({greyout:false})}if(!N.hasDefine("HAS_TEXTURE_EMISSIVE")){N.define("HAS_TEXTURE_EMISSIVE");if(!Ne)Ne=new CGL.Uniform(N,"t","texEmissive",0)}}else{A.setUiAttribs({greyout:true});if(s.get()){m.setUiAttribs({greyout:false});c.setUiAttribs({greyout:false});d.setUiAttribs({greyout:false});u.setUiAttribs({greyout:false})}else{x.setUiAttribs({greyout:true})}N.removeUniform("texEmissive");N.removeDefine("HAS_TEXTURE_EMISSIVE");Ne=null}}function Ve(){if(O.get()){if(s.get()){S.setUiAttribs({greyout:false})}if(!N.hasDefine("HAS_TEXTURE_EMISSIVE_MASK")){N.define("HAS_TEXTURE_EMISSIVE_MASK");if(!Me)Me=new CGL.Uniform(N,"t","texMaskEmissive",0);if(!je)je=new CGL.Uniform(N,"f","inEmissiveMaskIntensity",S)}}else{if(!s.get()){O.setUiAttribs({greyout:true})}S.setUiAttribs({greyout:true});N.removeUniform("texMaskEmissive");N.removeUniform("inEmissiveMaskIntensity");N.removeDefine("HAS_TEXTURE_EMISSIVE_MASK");Me=null;je=null}}let Ge=false;function Fe(){N.toggleDefine("HAS_TEXTURE_ENV",_.get());he.setUiAttribs({greyout:!_.get()});if(_.get()){if(!P)P=new CGL.Uniform(N,"t","texEnv",0);N.toggleDefine("TEX_FORMAT_CUBEMAP",_.get().cubemap);if(_.get().cubemap){N.removeDefine("TEX_FORMAT_EQUIRECT");N.removeDefine("ENVMAP_MATCAP");if(!R)R=new CGL.Uniform(N,"f","inEnvMapIntensity",he);if(!Pe)Pe=new CGL.Uniform(N,"f","inEnvMapWidth",_.get().cubemap.width)}else{const e=_.get().width===_.get().height;N.toggleDefine("TEX_FORMAT_EQUIRECT",!e);N.toggleDefine("ENVMAP_MATCAP",e);if(!R)R=new CGL.Uniform(N,"f","inEnvMapIntensity",he);if(!Pe)Pe=new CGL.Uniform(N,"f","inEnvMapWidth",_.get().width)}}else{N.removeUniform("inEnvMapIntensity");N.removeUniform("inEnvMapWidth");N.removeUniform("texEnv");N.removeDefine("HAS_TEXTURE_ENV");N.removeDefine("ENVMAP_MATCAP");P=null;R=null}Ge=false}function Xe(){if(T.get()){xe.setUiAttribs({greyout:false});if(!Re){N.define("HAS_TEXTURE_LUMINANCE_MASK");Re=new CGL.Uniform(N,"t","texLuminance",0);Le=new CGL.Uniform(N,"f","inLuminanceMaskIntensity",xe)}}else{xe.setUiAttribs({greyout:true});N.removeDefine("HAS_TEXTURE_LUMINANCE_MASK");N.removeUniform("inLuminanceMaskIntensity");N.removeUniform("texLuminance");Re=null;Le=null}}function ze(){N.toggleDefine("ENV_BLEND_ADD",E.get()=="Add");N.toggleDefine("ENV_BLEND_MUL",E.get()=="Multiply");N.toggleDefine("ENV_BLEND_MIX",E.get()=="Mix");N.toggleDefine("ALPHA_MASK_ALPHA",C.get()=="Alpha Channel");N.toggleDefine("ALPHA_MASK_LUMI",C.get()=="Luminance");N.toggleDefine("ALPHA_MASK_R",C.get()=="R");N.toggleDefine("ALPHA_MASK_G",C.get()=="G");N.toggleDefine("ALPHA_MASK_B",C.get()=="B");N.toggleDefine("AO_CHAN_0",ge.get()=="1");N.toggleDefine("AO_CHAN_1",ge.get()=="2")}function He(){if(I.get()){if(j!==null)return;N.removeUniform("texAlpha");N.define("HAS_TEXTURE_ALPHA");if(!j)j=new CGL.Uniform(N,"t","texAlpha",0);C.setUiAttribs({greyout:false});y.setUiAttribs({greyout:false})}else{N.removeUniform("texAlpha");N.removeDefine("HAS_TEXTURE_ALPHA");j=null;C.setUiAttribs({greyout:true});y.setUiAttribs({greyout:true})}ze()}y.onChange=function(){N.toggleDefine("DISCARDTRANS",y.get())};b.onChange=we;v.onChange=De;g.onChange=Ue;h.onChange=Be;x.onChange=ke;O.onChange=Ve;I.onChange=He;_.onChange=()=>{Ge=true};T.onChange=Xe;const We=t.maxUniformsFrag;const Ye=We===64?6:16;N.define("MAX_LIGHTS",Ye.toString());N.define("SPECULAR_PHONG");f.onChange=function(){if(f.get()==="Phong"){N.define("SPECULAR_PHONG");N.removeDefine("SPECULAR_BLINN");N.removeDefine("SPECULAR_GAUSS");N.removeDefine("SPECULAR_SCHLICK")}else if(f.get()==="Blinn"){N.define("SPECULAR_BLINN");N.removeDefine("SPECULAR_PHONG");N.removeDefine("SPECULAR_GAUSS");N.removeDefine("SPECULAR_SCHLICK")}else if(f.get()==="Gauss"){N.define("SPECULAR_GAUSS");N.removeDefine("SPECULAR_BLINN");N.removeDefine("SPECULAR_PHONG");N.removeDefine("SPECULAR_SCHLICK")}else if(f.get()==="Schlick"){N.define("SPECULAR_SCHLICK");N.removeDefine("SPECULAR_BLINN");N.removeDefine("SPECULAR_PHONG");N.removeDefine("SPECULAR_GAUSS")}};ie.onChange=function(){N.toggleDefine("CONSERVE_ENERGY",ie.get())};le.onChange=function(){N.toggleDefine("DOUBLE_SIDED",le.get())};const qe=new CGL.Uniform(N,"4f","inMaterialProperties",n,r,ne,re);const Ze=new CGL.Uniform(N,"4f","inDiffuseColor",X,z,H,W);const Ke=new CGL.Uniform(N,"4f","inTextureIntensities",be,ve,pe,A);const Je=new CGL.Uniform(N,"4f","inTextureRepeatOffset",me,ce,de,fe);N.uniformColorDiffuse=Ze;const L=[];let $e=0;function Qe(t){for(let e=0;e<L.length;e+=1){L[e]=null}for(let e=0;e<t;e+=1){L[e]=null;if(!L[e]){L[e]={color:new CGL.Uniform(N,"3f","phongLight"+e+".color",[1,1,1]),position:new CGL.Uniform(N,"3f","phongLight"+e+".position",[0,11,0]),specular:new CGL.Uniform(N,"3f","phongLight"+e+".specular",[1,1,1]),lightProperties:new CGL.Uniform(N,"4f","phongLight"+e+".lightProperties",[1,1,1,1]),conePointAt:new CGL.Uniform(N,"3f","phongLight"+e+".conePointAt",vec3.create()),spotProperties:new CGL.Uniform(N,"3f","phongLight"+e+".spotProperties",[0,0,0,0]),castLight:new CGL.Uniform(N,"i","phongLight"+e+".castLight",1)}}}}function et(e){w.position.setValue(e.position);w.color.setValue(e.color);w.specular.setValue(e.specular);w.lightProperties.setValue([e.intensity,e.attenuation,e.falloff,e.radius]);w.conePointAt.setValue(e.conePointAt);w.spotProperties.setValue([e.cosConeAngle,e.cosConeAngleInner,e.spotExponent])}function tt(t){for(let e=0;e<t.length;e+=1){const a=t[e];a.isUsed=true;L[e].position.setValue(a.position);L[e].color.setValue(a.color);L[e].specular.setValue(a.specular);L[e].lightProperties.setValue([a.intensity,a.attenuation,a.falloff,a.radius]);L[e].conePointAt.setValue(a.conePointAt);L[e].spotProperties.setValue([a.cosConeAngle,a.cosConeAngleInner,a.spotExponent]);L[e].castLight.setValue(a.castLight)}}function at(e){if(e.length!==$e){Ae(e);Qe(e.length);$e=e.length;tt(e)}else{tt(e)}}let w=null;function nt(){w={color:new CGL.Uniform(N,"3f","phongLight"+0+".color",[1,1,1]),specular:new CGL.Uniform(N,"3f","phongLight"+0+".specular",[1,1,1]),position:new CGL.Uniform(N,"3f","phongLight"+0+".position",[0,11,0]),lightProperties:new CGL.Uniform(N,"4f","phongLight"+0+".lightProperties",[1,1,1,1]),conePointAt:new CGL.Uniform(N,"3f","phongLight"+0+".conePointAt",vec3.create()),spotProperties:new CGL.Uniform(N,"3f","phongLight"+0+".spotProperties",[0,0,0,0]),castLight:new CGL.Uniform(N,"i","phongLight"+0+".castLight",1)}}const rt=[{type:"point",position:[5,5,5],color:[1,1,1],specular:[1,1,1],intensity:1,attenuation:0,falloff:.5,radius:80,castLight:1}];const ot=mat4.create();function it(){if(t.frameStore.lightStack){if(t.frameStore.lightStack.length===0){e.setUiError("deflight","Default light is enabled. Please add lights to your patch to make this warning disappear.",1)}else e.setUiError("deflight",null)}if(!t.frameStore.lightStack||!t.frameStore.lightStack.length){if(!w){G();nt()}mat4.invert(ot,t.vMatrix);rt[0].position=[ot[12],ot[13],ot[14]];et(rt[0]);$e=-1}else{if(N){if(t.frameStore.lightStack){if(t.frameStore.lightStack.length){w=null;at(t.frameStore.lightStack)}}}}}const lt=function(){if(!N){e.log("NO SHADER");return}t.pushShader(N);N.popTextures();Oe.trigger();t.popShader()};e.preRender=function(){N.bind();lt()};const st=mat4.create();const ut=vec3.create();const mt=vec3.create();F.onTriggered=function(){if(!N){e.log("phong has no shader...");return}if(Ge)Fe();t.pushShader(N);N.popTextures();if(b.get())N.pushTexture(Se,b.get());if(v.get())N.pushTexture(Ee,v.get());if(g.get())N.pushTexture(Ce,g.get());if(h.get())N.pushTexture(ye,h.get());if(x.get())N.pushTexture(Ne,x.get());if(O.get())N.pushTexture(Me,O.get());if(I.get())N.pushTexture(j,I.get());if(_.get()){if(_.get().cubemap)N.pushTexture(P,_.get().cubemap,t.gl.TEXTURE_CUBE_MAP);else N.pushTexture(P,_.get())}if(T.get()){N.pushTexture(Re,T.get())}it();Oe.trigger();t.popShader()};if(t.glVersion==1){if(!t.enableExtension("EXT_shader_texture_lod")){e.log("no EXT_shader_texture_lod texture extension")}else{N.enableExtension("GL_EXT_shader_texture_lod");t.enableExtension("OES_texture_float");t.enableExtension("OES_texture_float_linear");t.enableExtension("OES_texture_half_float");t.enableExtension("OES_texture_half_float_linear");N.enableExtension("GL_OES_standard_derivatives");N.enableExtension("GL_OES_texture_float");N.enableExtension("GL_OES_texture_float_linear");N.enableExtension("GL_OES_texture_half_float");N.enableExtension("GL_OES_texture_half_float_linear")}}we();De();Ue();Be();He();ke();Ve();Fe();Xe()};Ops.Gl.Phong.PhongMaterial_v6.prototype=new CABLES.Op;CABLES.OPS["0d83ed06-cdbe-4fe0-87bb-0ccece7fb6e1"]={f:Ops.Gl.Phong.PhongMaterial_v6,objName:"Ops.Gl.Phong.PhongMaterial_v6"};Ops.Vars.VarSetNumber_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueFloat("Value",0);e.varName=e.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(e,"number",a,e.varName)};Ops.Vars.VarSetNumber_v2.prototype=new CABLES.Op;CABLES.OPS["b5249226-6095-4828-8a1c-080654e192fa"]={f:Ops.Vars.VarSetNumber_v2,objName:"Ops.Vars.VarSetNumber_v2"};Ops.Value.Number=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueFloat("value"),n=e.outNumber("result");a.onChange=r;function r(){n.set(Number(a.get()))}};Ops.Value.Number.prototype=new CABLES.Op;CABLES.OPS["8fb2bb5d-665a-4d0a-8079-12710ae453be"]={f:Ops.Value.Number,objName:"Ops.Value.Number"};Ops.Math.Ceil=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValue("Number");const n=e.outNumber("Result");function r(){n.set(Math.ceil(a.get()))}a.onChange=r};Ops.Math.Ceil.prototype=new CABLES.Op;CABLES.OPS["15ba7aa9-b1c3-4b20-b6bf-b52a3ba8c8c5"]={f:Ops.Math.Ceil,objName:"Ops.Math.Ceil"};Ops.Ui.VizNumber=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const n=a.inFloat("Number",0);const r=a.outNumber("Result");a.setUiAttrib({widthOnlyGrow:true});n.onChange=()=>{let t=n.get();if(a.patch.isEditorMode()){let e="";if(t===null)e="null";else if(t===undefined)e="undefined";else{e=""+Math.round(t*1e4)/1e4;if(e[0]!="-")e=" "+e}a.setUiAttribs({extendTitle:e})}r.set(t)}};Ops.Ui.VizNumber.prototype=new CABLES.Op;CABLES.OPS["2b60d12d-2884-4ad0-bda4-0caeb6882f5c"]={f:Ops.Ui.VizNumber,objName:"Ops.Ui.VizNumber"};Ops.Math.Abs=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValue("number"),n=e.outNumber("result");a.onChange=function(){n.set(Math.abs(a.get()))}};Ops.Math.Abs.prototype=new CABLES.Op;CABLES.OPS["6b5af21d-065f-44d2-9442-8b7a254753f6"]={f:Ops.Math.Abs,objName:"Ops.Math.Abs"};Ops.Vars.VarGetNumber_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.outNumber("Value");e.varName=e.inValueSelect("Variable",[],"",true);new CABLES.VarGetOpWrapper(e,"number",e.varName,a)};Ops.Vars.VarGetNumber_v2.prototype=new CABLES.Op;CABLES.OPS["421f5b52-c0fa-47c4-8b7a-012b9e1c864a"]={f:Ops.Vars.VarGetNumber_v2,objName:"Ops.Vars.VarGetNumber_v2"};Ops.Boolean.BoolToNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueBool("bool"),n=e.outNumber("number");a.onChange=function(){if(a.get())n.set(1);else n.set(0)}};Ops.Boolean.BoolToNumber.prototype=new CABLES.Op;CABLES.OPS["2591c495-fceb-4f6e-937f-11b190c72ee5"]={f:Ops.Boolean.BoolToNumber,objName:"Ops.Boolean.BoolToNumber"};Ops.Value.SwitchNumber=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const t=a.inValueInt("Index");const n=[];const r=a.outNumber("Result");t.onChange=o;for(let t=0;t<16;t++){let e=a.inValue("Value "+t);n.push(e);e.onChange=o}function o(){if(t.get()>=0&&n[t.get()]){r.set(n[t.get()].get())}}};Ops.Value.SwitchNumber.prototype=new CABLES.Op;CABLES.OPS["fbb89f72-f2e3-4d34-ad01-7d884a1bcdc0"]={f:Ops.Value.SwitchNumber,objName:"Ops.Value.SwitchNumber"};Ops.Anim.AnimNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTrigger("exe"),n=e.inValue("Value"),r=e.inValueFloat("duration"),o=e.outTrigger("Next"),i=e.outNumber("result"),l=e.outTrigger("Finished");const s=new CABLES.Anim;s.createPort(e,"easing",f);s.loop=false;r.set(.5);r.onChange=n.onChange=f;let u=0;let m=0;let c=0;let d=true;function f(){m=performance.now();s.clear(CABLES.now()/1e3);if(d)s.setValue(CABLES.now()/1e3,n.get());s.setValue(r.get()+CABLES.now()/1e3,n.get(),p);d=false}function p(){l.trigger()}a.onTriggered=function(){let e=CABLES.now()/1e3;if(performance.now()-u>300){d=true;f()}u=performance.now();let t=s.getValue(e);i.set(t);o.trigger()}};Ops.Anim.AnimNumber.prototype=new CABLES.Op;CABLES.OPS["e5b0b016-9663-4c9d-9365-f54ae3c5fbb6"]={f:Ops.Anim.AnimNumber,objName:"Ops.Anim.AnimNumber"};Ops.Trigger.TriggerSend=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inTriggerButton("Trigger");n.varName=n.inValueSelect("Named Trigger",[],"",true);n.varName.onChange=r;t.onTriggered=o;n.patch.addEventListener("namedTriggersChanged",a);a();function a(){if(CABLES.UI){const e=[];const t=n.patch.namedTriggers;e.push("+ create new one");for(const a in t)e.push(a);n.varName.uiAttribs.values=e}}function r(){if(CABLES.UI){if(n.varName.get()=="+ create new one"){new CABLES.UI.ModalDialog({prompt:true,title:"New Trigger",text:"Enter a name for the new trigger",promptValue:"",promptOk:e=>{n.varName.set(e);n.patch.namedTriggers[e]=n.patch.namedTriggers[e]||[];a()}});return}n.refreshParams()}if(!n.patch.namedTriggers[n.varName.get()]){n.patch.namedTriggers[n.varName.get()]=n.patch.namedTriggers[n.varName.get()]||[];n.patch.emitEvent("namedTriggersChanged")}n.setTitle(">"+n.varName.get());n.refreshParams();n.patch.emitEvent("opTriggerNameChanged",n,n.varName.get())}function o(){const t=n.patch.namedTriggers[n.varName.get()];n.patch.emitEvent("namedTriggerSent",n.varName.get());if(!t){n.setUiError("unknowntrigger","unknown trigger");return}else n.setUiError("unknowntrigger",null);for(let e=0;e<t.length;e++){t[e]()}}};Ops.Trigger.TriggerSend.prototype=new CABLES.Op;CABLES.OPS["ce1eaf2b-943b-4dc0-ab5e-ee11b63c9ed0"]={f:Ops.Trigger.TriggerSend,objName:"Ops.Trigger.TriggerSend"};Ops.Trigger.TriggerReceive=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.outTrigger("Triggered");n.varName=n.inValueSelect("Named Trigger",[],"",true);o();n.patch.addEventListener("namedTriggersChanged",o);let a=null;function r(){t.trigger()}function o(){if(CABLES.UI){let t=[];let a=n.patch.namedTriggers;for(let e in a)t.push(e);n.varName.uiAttribs.values=t}}n.varName.onChange=function(){if(a){let e=n.patch.namedTriggers[a];let t=e.indexOf(r);if(t!=-1)e.splice(t,1)}n.setTitle(">"+n.varName.get());n.patch.namedTriggers[n.varName.get()]=n.patch.namedTriggers[n.varName.get()]||[];let e=n.patch.namedTriggers[n.varName.get()];e.push(r);a=n.varName.get();i();n.patch.emitEvent("opTriggerNameChanged",n,n.varName.get())};n.on("uiParamPanel",i);function i(){if(!n.varName.get()){n.setUiError("unknowntrigger","unknown trigger")}else n.setUiError("unknowntrigger",null)}};Ops.Trigger.TriggerReceive.prototype=new CABLES.Op;CABLES.OPS["0816c999-f2db-466b-9777-2814573574c5"]={f:Ops.Trigger.TriggerReceive,objName:"Ops.Trigger.TriggerReceive"};Ops.Math.MapRange=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const d=e.inValueFloat("value",0),f=e.inValueFloat("old min",0),p=e.inValueFloat("old max",1),b=e.inValueFloat("new min",-1),v=e.inValueFloat("new max",1),a=e.inValueSelect("Easing",["Linear","Smoothstep","Smootherstep"],"Linear"),g=e.outNumber("result",0);e.setPortGroup("Input Range",[f,p]);e.setPortGroup("Output Range",[b,v]);let h=0;let x=0;d.onChange=f.onChange=p.onChange=b.onChange=v.onChange=n;n();a.onChange=function(){if(a.get()=="Smoothstep")h=1;else if(a.get()=="Smootherstep")h=2;else h=0};function n(){const e=b.get();const t=v.get();const a=f.get();const n=p.get();let r=d.get();if(r>=Math.max(n,a)){g.set(t);return}else if(r<=Math.min(n,a)){g.set(e);return}let o=false;const i=Math.min(a,n);const l=Math.max(a,n);if(i!=a)o=true;let s=false;const u=Math.min(e,t);const m=Math.max(e,t);if(u!=e)s=true;let c=0;if(o)c=(l-r)*(m-u)/(l-i);else c=(r-i)*(m-u)/(l-i);if(s)x=m-c;else x=c+u;if(h===0){g.set(x)}else if(h==1){r=Math.max(0,Math.min(1,(x-e)/(t-e)));g.set(e+r*r*(3-2*r)*(t-e))}else if(h==2){r=Math.max(0,Math.min(1,(x-e)/(t-e)));g.set(e+r*r*r*(r*(r*6-15)+10)*(t-e))}}};Ops.Math.MapRange.prototype=new CABLES.Op;CABLES.OPS["2617b407-60a0-4ff6-b4a7-18136cfa7817"]={f:Ops.Math.MapRange,objName:"Ops.Math.MapRange"};Ops.Devices.Keyboard.KeyPressLearn=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const n=a.inValueInt("key code");const t=a.inValueBool("canvas only",true);const r=a.inValueSelect("Mod Key",["none","alt"],"none");const o=a.inValueBool("Enabled",true);const i=a.inValueBool("Prevent Default");const l=a.inTriggerButton("learn");const s=a.outTrigger("on press");const u=a.outTrigger("on release");const m=a.outBoolNum("Pressed",false);const c=a.outString("Key");const d=a.patch.cgl;let f=false;r.onChange=n.onChange=O;function p(e){if(f){n.set(e.keyCode);if(CABLES.UI){a.refreshParams()}f=false;g();v();if(CABLES.UI)gui.emitEvent("portValueEdited",a,n,n.get())}else{if(e.keyCode==n.get()){if(r.get()=="alt"){if(e.altKey===true){s.trigger();m.set(true);if(i.get())e.preventDefault()}}else{s.trigger();m.set(true);if(i.get())e.preventDefault()}}}}function b(t){if(t.keyCode==n.get()){let e=true;if(r.get()=="alt"&&t.altKey!=true)e=false;if(e){u.trigger();m.set(false)}}}a.onDelete=function(){d.canvas.removeEventListener("keyup",b,false);d.canvas.removeEventListener("keydown",p,false);document.removeEventListener("keyup",b,false);document.removeEventListener("keydown",p,false)};l.onTriggered=function(){f=true;x();setTimeout(function(){f=false;g();v()},3e3)};function v(){if(t.get())h();else x()}function g(){document.removeEventListener("keydown",p,false);document.removeEventListener("keyup",b,false);d.canvas.removeEventListener("keydown",p,false);d.canvas.removeEventListener("keyup",b,false);m.set(false)}function h(){if(!CABLES.UTILS.isNumeric(d.canvas.getAttribute("tabindex")))d.canvas.setAttribute("tabindex",1);d.canvas.addEventListener("keydown",p,false);d.canvas.addEventListener("keyup",b,false)}function x(){document.addEventListener("keydown",p,false);document.addEventListener("keyup",b,false)}o.onChange=function(){if(!o.get()){g()}else{v()}};t.onChange=function(){g();v()};function O(){let e=CABLES.keyCodeToName(n.get());const t=r.get();if(t&&t!=="none"){e=t.charAt(0).toUpperCase()+t.slice(1)+"-"+e}a.setUiAttribs({extendTitle:e});c.set(e)}h()};Ops.Devices.Keyboard.KeyPressLearn.prototype=new CABLES.Op;CABLES.OPS["f069c0db-4051-4eae-989e-6ef7953787fd"]={f:Ops.Devices.Keyboard.KeyPressLearn,objName:"Ops.Devices.Keyboard.KeyPressLearn"};Ops.Devices.Keyboard.KeyPress=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};var a=e.patch.cgl;var n=e.addOutPort(new CABLES.Port(e,"on press",CABLES.OP_PORT_TYPE_FUNCTION));var r=e.addOutPort(new CABLES.Port(e,"key code",CABLES.OP_PORT_TYPE_VALUE));var o=e.outValue("Char");function i(e){o.set(e.key);r.set(e.keyCode);n.trigger()}e.onDelete=function(){a.canvas.removeEventListener("keypress",i)};a.canvas.addEventListener("keypress",i)};Ops.Devices.Keyboard.KeyPress.prototype=new CABLES.Op;CABLES.OPS["023d1e35-1231-4c50-a044-4a0e63609ba5"]={f:Ops.Devices.Keyboard.KeyPress,objName:"Ops.Devices.Keyboard.KeyPress"};Ops.Math.Compare.Equals=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValue("number1",1),n=e.inValue("number2",1),r=e.outBoolNum("result");a.onChange=n.onChange=o;o();function o(){r.set(a.get()==n.get())}};Ops.Math.Compare.Equals.prototype=new CABLES.Op;CABLES.OPS["4dd3cc55-eebc-4187-9d4e-2e053a956fab"]={f:Ops.Math.Compare.Equals,objName:"Ops.Math.Compare.Equals"};Ops.Boolean.And=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueBool("bool 1"),n=e.inValueBool("bool 2"),r=e.outBoolNum("result");a.onChange=n.onChange=o;function o(){r.set(n.get()&&a.get())}};Ops.Boolean.And.prototype=new CABLES.Op;CABLES.OPS["c26e6ce0-8047-44bb-9bc8-5a4f911ed8ad"]={f:Ops.Boolean.And,objName:"Ops.Boolean.And"};Ops.Boolean.Not=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueBool("Boolean"),n=e.outBoolNum("Result");a.changeAlways=true;a.onChange=function(){n.set(!a.get())}};Ops.Boolean.Not.prototype=new CABLES.Op;CABLES.OPS["6d123c9f-7485-4fd9-a5c2-76e59dcbeb34"]={f:Ops.Boolean.Not,objName:"Ops.Boolean.Not"};Ops.Gl.Shader.CustomShader_v2=function(){CABLES.Op.apply(this,arguments);const g=this;const e={};const t=g.inTrigger("render"),a=g.inStringEditor("Fragment Code"),n=g.inStringEditor("Vertex Code"),r=g.inValueBool("Use As Material",true),o=g.outTrigger("trigger"),i=g.outObject("Shader",null,"shader"),l=g.outBool("Has Errors");const h=g.patch.cgl;const x=[];const O=[];const I=[];g.toWorkPortsNeedToBeLinked(t);a.setUiAttribs({editorSyntax:"glsl"});n.setUiAttribs({editorSyntax:"glsl"});const _=new CGL.Shader(h,g.name);_.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);g.setPortGroup("Source Code",[a,n]);g.setPortGroup("Options",[r]);a.set(CGL.Shader.getDefaultFragmentShader());n.set(CGL.Shader.getDefaultVertexShader());a.onChange=n.onChange=function(){if(a.isLinked()&&!a.get())return;s=true};t.onTriggered=m;let s=true;g.onLoadedValueSet=u;function u(a){b();for(let t=0;t<x.length;t++)for(let e=0;e<a.portsIn.length;e++)if(x[t]&&x[t].name==a.portsIn[e].name){x[t].set(a.portsIn[e].value);x[t].deSerializeSettings(a.portsIn[e])}}g.init=function(){b()};function m(){v();if(s)b();if(r.get())h.pushShader(_);c();o.trigger();_.popTextures();if(r.get())h.popShader()}function c(){for(let e=0;e<O.length;e++)if(O[e]&&O[e].get()&&O[e].get().tex)_.pushTexture(O[e].uniform,O[e].get().tex);else _.pushTexture(O[e],CGL.Texture.getEmptyTexture(h))}function d(){for(let e=0;e<O.length;e++)if(O[e]&&O[e].get()&&O[e].get().tex)h.setTexture(0+e+3,O[e].get().tex)}function T(t){for(let e=0;e<x.length;e++)if(x[e]&&x[e].name==t)return true;for(let e=0;e<O.length;e++)if(O[e]&&O[e].name==t)return true;return false}const f=mat4.create();const A=["modelMatrix","viewMatrix","normalMatrix","mvMatrix","projMatrix","inverseViewMatrix","camPos"];let S=0;const E=[];function p(e){const t=e.split("\n");const r=[];for(let e=0;e<t.length;e++){const a=t[e].split(";");for(let e=0;e<a.length;e++){let n=a[e].split(" ");for(let e=0;e<n.length;e++)n[e]=(n[e]+"").trim();if(n[0]==="UNI"||n[0]==="uniform"){let t=n[2];if(n.length>4)for(let e=3;e<n.length;e++)t+=n[e];n=n.filter(function(e){return e!==""});const o=n[1];let a=[t];if(t.indexOf(",")>-1)a=t.split(",");for(let e=0;e<a.length;e++){if(A.indexOf(a[e])>-1)continue;const i=a[e].trim().replace(/\[\d+\]$/,"");if(o==="float"){E.push(i);if(!T(i)){const l=a[e].trim().match(/\[\d+\]$/);if(l){const s=parseInt(l[0].trim().slice(1,-1));const u=g.inArray(i,[]);u.uniform=new CGL.Uniform(_,"f[]",i,new Float32Array(s));x.push(u);r.push(u);const m={name:i,num:s,port:u,uni:u.uniform,changed:false};u.onChange=function(){this.changed=true}.bind(m);I.push(m)}else{const u=g.inFloat(i,0);u.uniform=new CGL.Uniform(_,"f",i,u);x.push(u);r.push(u)}}}else if(o==="int"){E.push(i);if(!T(i)){const u=g.inInt(i,0);u.uniform=new CGL.Uniform(_,"i",i,u);x.push(u);r.push(u)}}else if(o==="bool"){E.push(i);if(!T(i)){const u=g.inBool(i,false);u.uniform=new CGL.Uniform(_,"b",i,u);x.push(u);r.push(u)}}else if(o==="mat4"){E.push(i);if(!T(i)){const u=g.inArray(i,0);u.uniform=new CGL.Uniform(_,"m4",i,u);x.push(u);r.push(u);const m={name:i,num:16,port:u,uni:u.uniform,changed:false};u.onChange=function(){this.changed=true}.bind(m);I.push(m)}}else if(o==="sampler2D"||o==="samplerCube"){E.push(i);if(!T(i)){const c=g.inObject(i);let e="t";if(o==="samplerCube")e="tc";c.uniform=new CGL.Uniform(_,e,i,3+O.length);O.push(c);r.push(c);c.set(CGL.Texture.getTempTexture(h));c.on("change",(e,t)=>{if(!e)t.set(CGL.Texture.getTempTexture(h))});S++}}else if(o==="vec3"||o==="vec2"||o==="vec4"){let e=2;if(o==="vec4")e=4;if(o==="vec3")e=3;E.push(i+" X");E.push(i+" Y");if(e>2)E.push(i+" Z");if(e>3)E.push(i+" W");if(!T(i+" X")){const d=[];const m={name:i,num:e,changed:false};I.push(m);C(m);const f=g.inFloat(i+" X",0);f.onChange=function(){this.changed=true}.bind(m);x.push(f);d.push(f);m.x=f;const p=g.inFloat(i+" Y",0);p.onChange=function(){this.changed=true}.bind(m);x.push(p);d.push(p);m.y=p;if(e>2){const b=g.inFloat(i+" Z",0);b.onChange=function(){this.changed=true}.bind(m);x.push(b);d.push(b);m.z=b}if(e>3){const v=g.inFloat(i+" W",0);v.onChange=function(){this.changed=true}.bind(m);x.push(v);d.push(v);m.w=v}g.setPortGroup(i,d)}}}}}}g.setPortGroup("uniforms",r)}function b(){if(!_)return;_.bindTextures=d.bind(this);_.setSource(n.get(),a.get());if(h.glVersion==1){h.enableExtension("OES_standard_derivatives");_.enableExtension("GL_OES_standard_derivatives")}S=0;E.length=0;p(n.get());p(a.get());for(let t=0;t<O.length;t++)for(let e=0;e<E.length;e++)if(O[t]&&E.indexOf(O[t].name)==-1){O[t].remove();O[t]=null}for(let t=0;t<x.length;t++)for(let e=0;e<E.length;e++)if(x[t]&&E.indexOf(x[t].name)==-1){x[t].remove();x[t]=null}for(let e=0;e<I.length;e++){C(I[e]);I[e].changed=true}for(let e=0;e<x.length;e++)if(x[e]&&x[e].uniform)x[e].uniform.needsUpdate=true;_.compile();g.refreshParams();i.set(null);i.set(_);s=false;if(_.hasErrors())g.setUiError("compile","Shader has errors");else g.setUiError("compile",null);l.set(_.hasErrors())}function C(e){if(e.num==2)e.uni=new CGL.Uniform(_,"2f",e.name,[0,0]);else if(e.num==3)e.uni=new CGL.Uniform(_,"3f",e.name,[0,0,0]);else if(e.num==4)e.uni=new CGL.Uniform(_,"4f",e.name,[0,0,0,0])}function v(){for(let e=0;e<I.length;e++){const t=I[e];if(t.changed){if(t.num===2)t.uni.setValue([t.x.get(),t.y.get()]);else if(t.num===3)t.uni.setValue([t.x.get(),t.y.get(),t.z.get()]);else if(t.num===4)t.uni.setValue([t.x.get(),t.y.get(),t.z.get(),t.w.get()]);else if(t.num>4){t.uni.setValue(t.port.get())}t.changed=false}}}};Ops.Gl.Shader.CustomShader_v2.prototype=new CABLES.Op;CABLES.OPS["a165fc89-a35b-4d39-8930-7345b098bd9d"]={f:Ops.Gl.Shader.CustomShader_v2,objName:"Ops.Gl.Shader.CustomShader_v2"};Ops.Ui.VizGraph=function(){CABLES.Op.apply(this,arguments);const s=this;const e={};const t=s.inFloat("Number 1"),a=s.inFloat("Number 2"),n=s.inFloat("Number 3"),r=s.inFloat("Number 4"),o=s.inFloat("Number 5"),i=s.inFloat("Number 6"),l=s.inFloat("Number 7"),u=s.inFloat("Number 8"),m=s.inTriggerButton("Reset");s.setUiAttrib({height:150,resizable:true});let c=[];let d=-Number.MAX_VALUE;let f=Number.MAX_VALUE;t.onLinkChanged=a.onLinkChanged=n.onLinkChanged=r.onLinkChanged=o.onLinkChanged=i.onLinkChanged=l.onLinkChanged=u.onLinkChanged=m.onTriggered=()=>{d=-Number.MAX_VALUE;f=Number.MAX_VALUE;c=[]};s.renderVizLayer=(n,r)=>{const e=CABLES.UI.uiProfiler.start("previewlayer graph");const t=["#00ffff","#ffff00","#ff00ff","#0000ff","#00ff00","#ff0000","#ffffff","#888888"];n.fillStyle="#222";n.fillRect(r.x,r.y,r.width,r.height);for(let a=0;a<s.portsIn.length;a++){if(!s.portsIn[a].isLinked())continue;const o=s.portsIn[a].get();d=Math.max(s.portsIn[a].get(),d);f=Math.min(s.portsIn[a].get(),f);if(!c[a])c[a]=[];c[a].push(o);if(c[a].length>60)c[a].shift();const i=5;const l=r.width/60;n.lineWidth=2;n.strokeStyle="#555555";n.beginPath();n.moveTo(r.x,CABLES.map(0,f,d,r.height,0)+r.y);n.lineTo(r.x+r.width,CABLES.map(0,f,d,r.height,0)+r.y);n.stroke();n.strokeStyle=t[a];n.beginPath();for(let t=0;t<c[a].length;t++){let e=c[a][t];e=CABLES.map(e,f,d,r.height,0);e+=r.y;if(t===0)n.moveTo(r.x,e);else n.lineTo(r.x+t*l,e)}n.stroke()}n.fillStyle="#888";n.fillText("max:"+Math.round(d*100)/100,r.x+10,r.y+r.height-10);n.fillText("min:"+Math.round(f*100)/100,r.x+10,r.y+r.height-30);e.finish()}};Ops.Ui.VizGraph.prototype=new CABLES.Op;CABLES.OPS["13c54eb4-60ef-4b9c-8425-d52a431f5c87"]={f:Ops.Ui.VizGraph,objName:"Ops.Ui.VizGraph"};Ops.Boolean.TriggerOnChangeBoolean=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueBool("Value"),n=e.outTrigger("True"),r=e.outTrigger("False");a.onChange=function(){if(a.get())n.trigger();else r.trigger()}};Ops.Boolean.TriggerOnChangeBoolean.prototype=new CABLES.Op;CABLES.OPS["dba19c07-e3c4-4971-a991-c9e6212ca1c8"]={f:Ops.Boolean.TriggerOnChangeBoolean,objName:"Ops.Boolean.TriggerOnChangeBoolean"};Ops.Trigger.NumberByTrigger=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTriggerButton("0"),n=e.inTriggerButton("1"),r=e.inTriggerButton("2"),o=e.inTriggerButton("3"),i=e.inTriggerButton("4"),l=e.inTriggerButton("5"),s=e.inTriggerButton("6"),u=e.inTriggerButton("7"),m=e.outNumber("number");m.changeAlways=true;const c=e.outTrigger("Triggered");a.onTriggered=function(){m.set(0);c.trigger()};n.onTriggered=function(){m.set(1);c.trigger()};r.onTriggered=function(){m.set(2);c.trigger()};o.onTriggered=function(){m.set(3);c.trigger()};i.onTriggered=function(){m.set(4);c.trigger()};l.onTriggered=function(){m.set(5);c.trigger()};s.onTriggered=function(){m.set(6);c.trigger()};u.onTriggered=function(){m.set(7);c.trigger()}};Ops.Trigger.NumberByTrigger.prototype=new CABLES.Op;CABLES.OPS["43ed1123-1312-4383-b843-27b8ec540c09"]={f:Ops.Trigger.NumberByTrigger,objName:"Ops.Trigger.NumberByTrigger"};Ops.Trigger.TriggerIfIncreased=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inFloat("Value"),n=e.outTrigger("Trigger");let r=-Number.MAX_VALUE;a.onChange=function(){const e=a.get();if(e>r){n.trigger()}r=e}};Ops.Trigger.TriggerIfIncreased.prototype=new CABLES.Op;CABLES.OPS["bc820891-48c7-4287-9b5e-4196e192741b"]={f:Ops.Trigger.TriggerIfIncreased,objName:"Ops.Trigger.TriggerIfIncreased"};Ops.Deprecated.Cables.CustomOp_v2=function(){CABLES.Op.apply(this,arguments);const f=this;const e={};const t="// you can use custom javascript code here, it will be bound to the\n// scope of the current op, which is available as `op`.\n// \n// have a look at the documentation at:\n// https://docs.cables.gl/dev_hello_op/dev_hello_op.html\n\n";const p=f.inStringEditor("JavaScript");p.setUiAttribs({editorSyntax:"js"});p.set(t);const a=f.inUrl("Library",[".js"]);const r=f.inString("portsData","{}");r.setUiAttribs({hidePort:true});r.setUiAttribs({hideParam:true});const c=[p.id,a.id,r.id];let d=false;f.setUiError("error",null);const n=function(){if(f.uiAttribs){d=f.uiAttribs.pasted}s();o();a.onChange=p.onChange=o;if(d)d=false};f.onLoadedValueSet=n;f.patch.on("onOpAdd",(e,t)=>{if(f==e&&!t){n()}});f.onError=function(r){if(f.patch.isEditorMode()){f.setUiError("error",r);const o=p.get();const i=[];let t="";const l=o.match(/^.*((\r\n|\n|\r)|$)/gm);let a="";const s=r.stack.split("\n");for(let e=0;e<s.length;e++){if(s[e].includes("Function:")){a=s[e];break}if(s[e].includes("anonymous")){a=s[e];break}}let e=a.split(":");let n=e[e.length-2];i.push(n-2);for(const u in l){const m=parseInt(u,10)+1;const c=m+": "+l[u];let e=false;for(const d in i)if(i[d]==m)e=true;if(e)t+='<span class="error">';t+=c.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");if(e)t+="</span>"}r.customMessage=t;r.stack="";f.patch.emitEvent("exceptionOp",r,f.name)}};const b=()=>{f.setUiError("error",null);let t=document.getElementById("customop-error-"+f.id);if(t){t.remove()}try{return new Function("op",p.get())}catch(e){f.onError(e);if(f.patch.isEditorMode()){t=document.createElement("script");t.id="customop-error-"+f.id;t.type="text/javascript";t.innerHTML=p.get();document.body.appendChild(t)}else{f.logError("error creating javascript function",e)}return null}};function o(){if(a.get()){let e=document.getElementById("customop_lib_"+f.id);if(e){e.remove()}e=document.createElement("script");e.id="customlib_"+f.id;e.type="text/javascript";e.src=f.patch.getFilePath(String(a.get()));e.onload=function(){f.logVerbose("done loading library",a.get());i()};document.body.appendChild(e)}else if(p.get()&&p.get()!==t){i()}}const v=t=>{t.removeLinks();for(let e=0;e<f.portsIn.length;e++){if(f.portsIn[e]==t){f.portsIn.splice(e,1);return}}};const g=t=>{t.removeLinks();for(let e=0;e<f.portsOut.length;e++){if(f.portsOut[e]==t){f.portsOut.splice(e,1);return}}};const i=()=>{const e=b();if(e){try{const o={};const t={};const n={};const r=[];const i=[];f.portsIn.forEach(a=>{if(!c.includes(a.id)){o[a.name]=[];t[a.name]=a.get();a.links.forEach(e=>{const t={op:e.portOut.op,portName:e.portOut.name};o[a.name].push(t)});r.push(a)}});f.portsOut.forEach(a=>{n[a.name]=[];a.links.forEach(e=>{const t={op:e.portIn.op,portName:e.portIn.name};n[a.name].push(t)});i.push(a)});r.forEach(e=>{v(e)});i.forEach(e=>{g(e)});if(i.length>0||r.length>0){this.emitEvent("onUiAttribsChange",{});this.emitEvent("onPortRemoved",{})}e(this);f.portsIn.forEach(a=>{if(!c.includes(a.id)){a.onLinkChanged=h;if(o[a.name]){o[a.name].forEach(e=>{f.patch.link(f,a.name,e.op,e.portName)})}if(typeof a.onChange=="function"){const n=a.onChange;a.onChange=(e,t)=>{if(!a.isLinked())h();n(e,t)}}else{a.onChange=()=>{if(!a.isLinked())h()}}if(typeof a.onValueChanged=="function"){const r=a.onValueChanged;a.onValueChanged=(e,t)=>{if(!a.isLinked())h();r(e,t)}}if(t[a.name]){a.set(t[a.name])}}});f.portsOut.forEach(t=>{t.onLinkChanged=h;if(n[t.name]){n[t.name].forEach(e=>{f.patch.link(f,t.name,e.op,e.portName)})}});if(d){d=false}h()}catch(a){if(f.patch.isEditorMode()){f.onError(a);const l="Ops.Custom.CUSTOM"+f.id.replace(/-/g,"");const s=p.get();let e="Ops.Custom = Ops.Custom || {};\n";e+=l+" = "+l+" || {};\n";e+=l+" = function()\n{\nCABLES.Op.apply(this,arguments);\nconst op=this;\n";let t="\n\n};\n\n"+l+".prototype = new CABLES.Op();\n";t+="new "+l+"();\n";const u=e+s+t;const m=document.createElement("script");m.id="customop-error-"+f.id;m.type="text/javascript";m.innerHTML=u;document.body.appendChild(m)}else{f.logError("error executing javascript code",a)}}}};function h(){const n={portsIn:{},portsOut:{}};f.portsIn.forEach(t=>{if(!c.includes(t.id)){let e=t.get();if(t.ignoreValueSerialize)e=null;const a={name:t.name,title:t.title,value:e,type:t.type,links:[]};t.links.forEach(e=>{const t={objOut:e.portOut.op.id,portOut:e.portOut.name};a.links.push(t)});n.portsIn[t.name]=a}});f.portsOut.forEach(t=>{if(!c.includes(t.id)){let e=t.get();if(t.ignoreValueSerialize)e=null;const a={name:t.name,title:t.title,value:e,type:t.type,links:[]};t.links.forEach(e=>{const t={objIn:e.portIn.op.id,portIn:e.portIn.name};a.links.push(t)});n.portsOut[t.name]=a}});let e="{}";try{e=JSON.stringify(n)}catch(e){f.log("failed to stringify new port data",n)}r.set(e)}const l=()=>{const t=r.get();let e={};try{e=JSON.parse(t)}catch(e){f.log("failed to parse old port data",t)}let a={};let n={};if(e.portsOut){n=e.portsOut}if(e.portsIn){a=e.portsIn}return{portsIn:a,portsOut:n}};const s=()=>{const t=l();const a=Object.keys(t.portsIn);if(f.patch.isEditorMode())CABLES.UI.undo.pause();for(let e=0;e<a.length;e++){const r=t.portsIn[a[e]];const o=f.addInPort(new CABLES.Port(f,r.name,r.type));if(!d&&Array.isArray(r.links)){r.links.forEach(e=>{let t=f.patch.getOpById(e.objOut);if(t){f.patch.link(t,e.portOut,f,o.name)}})}if(!o.isLinked()){o.set(r.value)}o.onLinkChanged=h;if(r.title){o.setUiAttribs({title:r.title})}}const n=Object.keys(t.portsOut);for(let e=0;e<n.length;e++){const i=t.portsOut[n[e]];const o=f.addOutPort(new CABLES.Port(f,i.name,i.type));if(!d&&Array.isArray(i.links)){i.links.forEach(e=>{let t=f.patch.getOpById(e.objIn);if(t){f.patch.link(f,o.name,t,e.portIn)}});if(!o.isLinked()){o.set(i.value)}o.onLinkChanged=h;if(i.title){o.setUiAttribs({title:i.title})}}}if(f.patch.isEditorMode())CABLES.UI.undo.resume()}};Ops.Deprecated.Cables.CustomOp_v2.prototype=new CABLES.Op;CABLES.OPS["19166505-2619-4012-ad85-d2de60f27274"]={f:Ops.Deprecated.Cables.CustomOp_v2,objName:"Ops.Deprecated.Cables.CustomOp_v2"};Ops.User.paramuno.ValueBecameZeroTrigger2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};var a=-1;var n=e.inValue("Value",-1);var r=e.outTrigger("Became Zero Trigger");var o=e.outNumber("Last Value",0);n.onChange=function(){var e=n.get();if(a!==0&e===0){r.trigger();o.set(a)}a=e}};Ops.User.paramuno.ValueBecameZeroTrigger2.prototype=new CABLES.Op;CABLES.OPS["29651cd7-c7d8-480d-802b-73159cc5518b"]={f:Ops.User.paramuno.ValueBecameZeroTrigger2,objName:"Ops.User.paramuno.ValueBecameZeroTrigger2"};Ops.Array.Array_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const n=e.inValueInt("Array length",10),a=e.inSwitch("Mode select",["Number","1,2,3,4","0-1","1-0"],"Number"),r=e.inValueFloat("Default Value"),o=e.outArray("Array"),i=e.outNumber("Array length out");let l=[];let s=0;const u=0;const m=1;const c=2;const d=3;e.setUiAttrib({extendTitlePort:a.name});a.onChange=f;r.onChange=n.onChange=()=>{p()};f();p();function f(){let e=a.get();if(e==="Number")s=u;else if(e==="1,2,3,4")s=m;else if(e==="0-1")s=c;else if(e==="1-0")s=d;if(s===u){r.setUiAttribs({greyout:false})}else if(s===m){r.setUiAttribs({greyout:true})}else if(s===c){r.setUiAttribs({greyout:true})}else if(s===d){r.setUiAttribs({greyout:true})}p()}function p(){l.length=0;let e=n.get();let t=r.get();let a;if(s===u){for(a=0;a<e;a++){l[a]=t}}else if(s===m){for(a=0;a<e;a++){l[a]=a}}else if(s===c){for(a=0;a<e;a++){l[a]=a/e}}else if(s===d){for(a=0;a<e;a++){l[a]=1-a/e}}o.setRef(l);i.set(l.length)}};Ops.Array.Array_v2.prototype=new CABLES.Op;CABLES.OPS["ca9219d2-9f06-4516-9cf2-98e61f84d4bb"]={f:Ops.Array.Array_v2,objName:"Ops.Array.Array_v2"};Ops.User.paramuno.ArrayUnshiftNumber=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTriggerButton("Execute"),n=e.inArray("Array"),r=e.inFloat("Number",1),o=e.outTrigger("Next"),i=e.outArray("Result");let l=[];n.onChange=()=>{l=n.get()};a.onTriggered=()=>{if(!l){i.set(null);return}l.unshift(r.get());l.pop();i.set(null);i.set(l);o.trigger()}};Ops.User.paramuno.ArrayUnshiftNumber.prototype=new CABLES.Op;CABLES.OPS["753e9905-9a70-4509-9e0d-4ec4db31738d"]={f:Ops.User.paramuno.ArrayUnshiftNumber,objName:"Ops.User.paramuno.ArrayUnshiftNumber"};Ops.Array.InfoArray=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const o=e.inArray("Array"),i=e.outNumber("Min"),l=e.outNumber("Max"),s=e.outNumber("Average");o.onChange=function(){let t=o.get();let a=999999999;let n=-999999999;let r=0;if(t){for(let e=0;e<t.length;e++){r+=t[e];a=Math.min(a,t[e]);n=Math.max(n,t[e])}r/=t.length}i.set(a);l.set(n);s.set(r)}};Ops.Array.InfoArray.prototype=new CABLES.Op;CABLES.OPS["1db230c8-212f-4679-87d6-3531659363da"]={f:Ops.Array.InfoArray,objName:"Ops.Array.InfoArray"};Ops.Math.Floor=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValue("Number");const n=e.outNumber("Result");a.onChange=r;function r(){n.set(Math.floor(a.get()))}};Ops.Math.Floor.prototype=new CABLES.Op;CABLES.OPS["0c77617c-b688-4b55-addf-2cbcaabf98af"]={f:Ops.Math.Floor,objName:"Ops.Math.Floor"};Ops.User.paramuno.ArrayAdd=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};var n=e.inArray("In");var r=e.inArray("In2");var o=e.outArray("Result");var i=[];o.set(i);n.onChange=r.onChange=function(){var e=n.get();var t=r.get();if(!e||!t||e.length!=t.length)return;if(i.length!=e.length)i.length=e.length;for(var a=0;a<e.length;a++){i[a]=e[a]+t[a]}o.set(null);o.set(i)}};Ops.User.paramuno.ArrayAdd.prototype=new CABLES.Op;CABLES.OPS["c693396e-fb7f-4f15-9510-d996823ea2fb"]={f:Ops.User.paramuno.ArrayAdd,objName:"Ops.User.paramuno.ArrayAdd"};Ops.Trigger.TriggerButton=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTriggerButton("Trigger"),n=e.outTrigger("Next");a.onTriggered=function(){n.trigger()}};Ops.Trigger.TriggerButton.prototype=new CABLES.Op;CABLES.OPS["21630924-39e4-4df5-9965-b9136510d156"]={f:Ops.Trigger.TriggerButton,objName:"Ops.Trigger.TriggerButton"};Ops.User.paramuno.PreviousValueStore2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValueFloat("Value",1),n=e.inValueFloat("Max",20),r=e.outValue("Current Value"),o=e.outValue("Previous Value");let i=0;a.onChange=function(){let e=a.get();o.set(i);if(e<n.get())i=a.get();r.set(a.get())}};Ops.User.paramuno.PreviousValueStore2.prototype=new CABLES.Op;CABLES.OPS["6c338580-f057-4789-8bb8-077802ff31b7"]={f:Ops.User.paramuno.PreviousValueStore2,objName:"Ops.User.paramuno.PreviousValueStore2"};Ops.Html.FullscreenMode=function(){CABLES.Op.apply(this,arguments);const t=this;const e={};const a=t.inTriggerButton("Request Fullscreen"),n=t.inTriggerButton("Exit Fullscreen"),r=t.inSwitch("Element",["Canvas","Document"],"Canvas"),o=t.outBoolNum("Is Fullscreen");n.onTriggered=u;a.onTriggered=s;let i=0;function l(){const e=!window.screenTop&&!window.screenY;o.set(e)}function s(){i++;if(i>30){a.onTriggered=null;t.setUiAttrib({error:"Fullscreen Request shound not triggered that often: op disabled"});u()}let e=null;if(r=="Canvas")e=t.patch.cgl.canvas.parentElement;else e=t.patch.getDocument().documentElement;if(e.requestFullScreen)e.requestFullScreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.webkitRequestFullScreen)e.webkitRequestFullScreen();else if(e.msRequestFullScreen)e.msRequestFullScreen();setTimeout(l,100);setTimeout(l,500);setTimeout(l,1e3)}function u(){i--;if(t.patch.getDocument().exitFullscreen)t.patch.getDocument().exitFullscreen();else if(t.patch.getDocument().mozCancelFullScreen)t.patch.getDocument().mozCancelFullScreen();else if(t.patch.getDocument().webkitExitFullscreen)t.patch.getDocument().webkitExitFullscreen();else if(t.patch.getDocument().msExitFullscreen)t.patch.getDocument().msExitFullscreen();setTimeout(l,100);setTimeout(l,500);setTimeout(l,1e3)}};Ops.Html.FullscreenMode.prototype=new CABLES.Op;CABLES.OPS["fe933b35-696d-4738-be03-c0c011ed67a0"]={f:Ops.Html.FullscreenMode,objName:"Ops.Html.FullscreenMode"};Ops.Boolean.IfTrueThen_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTrigger("exe"),n=e.inValueBool("boolean",false),r=e.outTrigger("then"),o=e.outTrigger("else");a.onTriggered=i;function i(){if(n.get())r.trigger();else o.trigger()}};Ops.Boolean.IfTrueThen_v2.prototype=new CABLES.Op;CABLES.OPS["9549e2ed-a544-4d33-a672-05c7854ccf5d"]={f:Ops.Boolean.IfTrueThen_v2,objName:"Ops.Boolean.IfTrueThen_v2"};Ops.Trigger.TriggerOnce=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTriggerButton("Exec"),n=e.inTriggerButton("Reset"),r=e.outTrigger("Next"),o=e.outBoolNum("Was Triggered");let i=false;e.toWorkPortsNeedToBeLinked(a);n.onTriggered=function(){i=false;o.set(i)};a.onTriggered=function(){if(i)return;i=true;r.trigger();o.set(i)}};Ops.Trigger.TriggerOnce.prototype=new CABLES.Op;CABLES.OPS["cf3544e4-e392-432b-89fd-fcfb5c974388"]={f:Ops.Trigger.TriggerOnce,objName:"Ops.Trigger.TriggerOnce"};Ops.Gl.Shader.ShaderToTexture=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTrigger("Render"),n=e.inObject("Shader",null,"shader"),o=e.inValueBool("Use Viewport Size",true),i=e.inValueInt("Width",512),l=e.inValueInt("Height",512),s=e.inValueSelect("filter",["nearest","linear","mipmap"]),u=e.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),m=e.inValueBool("Floating Point",false),c=e.inSwitch("Num Textures",["1","4"],"1"),r=e.outTrigger("Next"),d=e.outTexture("Texture"),f=e.outTexture("Texture 2"),p=e.outTexture("Texture 3"),b=e.outTexture("Texture 4");e.setPortGroup("Texture Size",[o,i,l]);e.setPortGroup("Texture settings",[s,u,m]);let v=1;const g=e.patch.cgl;const h=[0,0,0,0];const x=null;const O=[];let I=null;let _=null;i.onChange=l.onChange=m.onChange=s.onChange=c.onChange=u.onChange=M;o.onChange=N;const T=false;let A=null;const S=null;let E=true;const C=CGL.MESHES.getSimpleRect(g,"shader2texture rect");e.toWorkPortsNeedToBeLinked(n);s.set("nearest");N();function y(){if(s.get()=="mipmap"&&m.get()){e.setUiError("warning","HDR and mipmap filtering at the same time is not possible")}else{e.setUiError("warning",null)}}function N(){i.setUiAttribs({greyout:o.get()});l.setUiAttribs({greyout:o.get()});i.set(g.getViewPort()[2]);l.set(g.getViewPort()[3])}function M(){E=true;y()}function j(){if(_)_.dispose();I=null;_=null}function P(){E=false;if(A)A.delete();const e=O.length;v=parseInt(c.get());O.length=0;for(let e=0;e<v;e++)O[e]=true;if(e!=O.length){j()}A=null;let t=i.get();let a=l.get();if(o.get()){t=g.getViewPort()[2];a=g.getViewPort()[3]}let n=CGL.Texture.FILTER_NEAREST;if(s.get()=="linear")n=CGL.Texture.FILTER_LINEAR;else if(s.get()=="mipmap")n=CGL.Texture.FILTER_MIPMAP;let r=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(u.get()=="repeat")r=CGL.Texture.WRAP_REPEAT;if(u.get()=="mirrored repeat")r=CGL.Texture.WRAP_MIRRORED_REPEAT;if(g.glVersion>=2){A=new CGL.Framebuffer2(g,t,a,{isFloatingPointTexture:m.get(),multisampling:false,numRenderBuffers:v,wrap:r,filter:n,depth:true,multisamplingSamples:0,clear:true})}else{A=new CGL.Framebuffer(g,i.get(),l.get(),{isFloatingPointTexture:m.get(),filter:n,wrap:r})}}a.onTriggered=function(){const e=g.getViewPort();if(!A||E)P();if(o.get()&&A&&(e[2]!=A.getTextureColor().width||e[3]!=A.getTextureColor().height))P();if(!n.get()||!n.get().setDrawBuffers)return;if(n.get()!=I){I=n.get();_=n.get().copy();_.setDrawBuffers(O)}if(!_){d.set(null);return}h[0]=e[0];h[1]=e[1];h[2]=e[2];h[3]=e[3];A.renderStart(g);g.pushPMatrix();mat4.identity(g.pMatrix);g.pushViewMatrix();mat4.identity(g.vMatrix);g.pushModelMatrix();mat4.identity(g.mMatrix);g.pushShader(n.get());if(_.bindTextures)_.bindTextures();g.pushBlend(false);C.render(n.get());g.popBlend();g.popPMatrix();g.popModelMatrix();g.popViewMatrix();A.renderEnd(g);if(v>=2){d.set(A.getTextureColorNum(0));f.set(A.getTextureColorNum(1));p.set(A.getTextureColorNum(2));b.set(A.getTextureColorNum(3))}else d.set(A.getTextureColor());g.popShader();g.gl.viewport(h[0],h[1],h[2],h[3]);r.trigger()}};Ops.Gl.Shader.ShaderToTexture.prototype=new CABLES.Op;CABLES.OPS["a3debb76-7d84-4548-9e7b-24891423dcce"]={f:Ops.Gl.Shader.ShaderToTexture,objName:"Ops.Gl.Shader.ShaderToTexture"};Ops.Gl.TextureEffects.DrawImage_v3=function(){CABLES.Op.apply(this,arguments);const n=this;const e={drawimage_frag:"#ifdef HAS_TEXTURES\n    IN vec2 texCoord;\n    UNI sampler2D tex;\n    UNI sampler2D image;\n#endif\n\n#ifdef TEX_TRANSFORM\n    IN mat3 transform;\n#endif\n// UNI float rotate;\n\n{{CGL.BLENDMODES}}\n\n#ifdef HAS_TEXTUREALPHA\n   UNI sampler2D imageAlpha;\n#endif\n\nUNI float amount;\n\n#ifdef ASPECT_RATIO\n    UNI float aspectTex;\n    UNI float aspectPos;\n#endif\n\nvoid main()\n{\n    vec4 blendRGBA=vec4(0.0,0.0,0.0,1.0);\n\n    #ifdef HAS_TEXTURES\n        vec2 tc=texCoord;\n\n        #ifdef TEX_FLIP_X\n            tc.x=1.0-tc.x;\n        #endif\n        #ifdef TEX_FLIP_Y\n            tc.y=1.0-tc.y;\n        #endif\n\n        #ifdef ASPECT_RATIO\n            #ifdef ASPECT_AXIS_X\n                tc.y=(1.0-aspectPos)-(((1.0-aspectPos)-tc.y)*aspectTex);\n            #endif\n            #ifdef ASPECT_AXIS_Y\n                tc.x=(1.0-aspectPos)-(((1.0-aspectPos)-tc.x)/aspectTex);\n            #endif\n        #endif\n\n        #ifdef TEX_TRANSFORM\n            vec3 coordinates=vec3(tc.x, tc.y,1.0);\n            tc=(transform * coordinates ).xy;\n        #endif\n\n        blendRGBA=texture(image,tc);\n\n        vec3 blend=blendRGBA.rgb;\n        vec4 baseRGBA=texture(tex,texCoord);\n        vec3 base=baseRGBA.rgb;\n\n\n        #ifdef PREMUL\n            blend.rgb = (blend.rgb) + (base.rgb * (1.0 - blendRGBA.a));\n        #endif\n\n        vec3 colNew=_blend(base,blend);\n\n\n\n\n        #ifdef REMOVE_ALPHA_SRC\n            blendRGBA.a=1.0;\n        #endif\n\n        #ifdef HAS_TEXTUREALPHA\n            vec4 colImgAlpha=texture(imageAlpha,tc);\n            float colImgAlphaAlpha=colImgAlpha.a;\n\n            #ifdef ALPHA_FROM_LUMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef ALPHA_FROM_INV_UMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=1.0-(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef INVERT_ALPHA\n                colImgAlphaAlpha=clamp(colImgAlphaAlpha,0.0,1.0);\n                colImgAlphaAlpha=1.0-colImgAlphaAlpha;\n            #endif\n\n            blendRGBA.a=colImgAlphaAlpha*blendRGBA.a;\n        #endif\n    #endif\n\n    float am=amount;\n\n    #ifdef CLIP_REPEAT\n        if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n        {\n            // colNew.rgb=vec3(0.0);\n            am=0.0;\n        }\n    #endif\n\n    #ifdef ASPECT_RATIO\n        #ifdef ASPECT_CROP\n            if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n            {\n                colNew.rgb=base.rgb;\n                am=0.0;\n            }\n\n        #endif\n    #endif\n\n\n\n    #ifndef PREMUL\n        blendRGBA.rgb=mix(colNew,base,1.0-(am*blendRGBA.a));\n        blendRGBA.a=clamp(baseRGBA.a+(blendRGBA.a*am),0.,1.);\n    #endif\n\n    #ifdef PREMUL\n        // premultiply\n        // blendRGBA.rgb = (blendRGBA.rgb) + (baseRGBA.rgb * (1.0 - blendRGBA.a));\n        blendRGBA=vec4(\n            mix(colNew.rgb,base,1.0-(am*blendRGBA.a)),\n            blendRGBA.a*am+baseRGBA.a\n            );\n    #endif\n\n    #ifdef ALPHA_MASK\n    blendRGBA.a=baseRGBA.a;\n    #endif\n\n    outColor=blendRGBA;\n}\n\n\n\n\n\n\n\n",drawimage_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\n\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\n// OUT vec3 norm;\n\n#ifdef TEX_TRANSFORM\n    UNI float posX;\n    UNI float posY;\n    UNI float scaleX;\n    UNI float scaleY;\n    UNI float rotate;\n    OUT mat3 transform;\n#endif\n\nvoid main()\n{\n   texCoord=attrTexCoord;\n//   norm=attrVertNormal;\n\n   #ifdef TEX_TRANSFORM\n        vec3 coordinates=vec3(attrTexCoord.x, attrTexCoord.y,1.0);\n        float angle = radians( rotate );\n        vec2 scale= vec2(scaleX,scaleY);\n        vec2 translate= vec2(posX,posY);\n\n        transform = mat3(   scale.x * cos( angle ), scale.x * sin( angle ), 0.0,\n            - scale.y * sin( angle ), scale.y * cos( angle ), 0.0,\n            - 0.5 * scale.x * cos( angle ) + 0.5 * scale.y * sin( angle ) - 0.5 * translate.x*2.0 + 0.5,  - 0.5 * scale.x * sin( angle ) - 0.5 * scale.y * cos( angle ) - 0.5 * translate.y*2.0 + 0.5, 1.0);\n   #endif\n\n   gl_Position = projMatrix * mvMatrix * vec4(vPosition,  1.0);\n}\n"};const t=n.inTrigger("render"),a=CGL.TextureEffect.AddBlendSelect(n,"blendMode"),r=n.inValueSlider("amount",1),o=n.inTexture("Image"),i=n.inValueBool("Premultiplied",false),l=n.inValueBool("Alpha Mask",false),s=n.inValueBool("removeAlphaSrc",false),u=n.inTexture("Mask"),m=n.inValueSelect("Mask Src",["alpha channel","luminance","luminance inv"],"luminance"),c=n.inValueBool("Invert alpha channel"),d=n.inValueBool("Aspect Ratio",false),f=n.inValueSelect("Stretch Axis",["X","Y"],"X"),p=n.inValueSlider("Position",0),b=n.inValueBool("Crop",false),v=n.outTrigger("trigger");a.set("normal");const g=n.patch.cgl;const h=new CGL.Shader(g,"drawimage");u.onLinkChanged=x;n.setPortGroup("Mask",[u,m,c]);n.setPortGroup("Aspect Ratio",[d,p,b,f]);function x(){if(u.isLinked()){s.setUiAttribs({greyout:true});m.setUiAttribs({greyout:false});c.setUiAttribs({greyout:false})}else{s.setUiAttribs({greyout:false});m.setUiAttribs({greyout:true});c.setUiAttribs({greyout:true})}}n.toWorkPortsNeedToBeLinked(o);h.setSource(e.drawimage_vert,e.drawimage_frag);const O=new CGL.Uniform(h,"t","tex",0),w=new CGL.Uniform(h,"t","image",1),D=new CGL.Uniform(h,"t","imageAlpha",2),I=new CGL.Uniform(h,"f","aspectTex",1),U=new CGL.Uniform(h,"f","aspectPos",p);d.onChange=b.onChange=f.onChange=_;function _(){h.removeDefine("ASPECT_AXIS_X");h.removeDefine("ASPECT_AXIS_Y");h.removeDefine("ASPECT_CROP");p.setUiAttribs({greyout:!d.get()});b.setUiAttribs({greyout:!d.get()});f.setUiAttribs({greyout:!d.get()});if(d.get()){h.define("ASPECT_RATIO");if(b.get())h.define("ASPECT_CROP");if(f.get()=="X")h.define("ASPECT_AXIS_X");if(f.get()=="Y")h.define("ASPECT_AXIS_Y")}else{h.removeDefine("ASPECT_RATIO");if(b.get())h.define("ASPECT_CROP");if(f.get()=="X")h.define("ASPECT_AXIS_X");if(f.get()=="Y")h.define("ASPECT_AXIS_Y")}}const T=n.inValueBool("flip x");const A=n.inValueBool("flip y");let S=n.inValueBool("Transform");let E=n.inValueSlider("Scale X",1);let C=n.inValueSlider("Scale Y",1);let y=n.inValue("Position X",0);let N=n.inValue("Position Y",0);let M=n.inValue("Rotation",0);const j=n.inValueBool("Clip Repeat",false);const B=new CGL.Uniform(h,"f","scaleX",E);const k=new CGL.Uniform(h,"f","scaleY",C);const V=new CGL.Uniform(h,"f","posX",y);const G=new CGL.Uniform(h,"f","posY",N);const F=new CGL.Uniform(h,"f","rotate",M);S.onChange=P;function P(){h.toggleDefine("TEX_TRANSFORM",S.get());E.setUiAttribs({greyout:!S.get()});C.setUiAttribs({greyout:!S.get()});y.setUiAttribs({greyout:!S.get()});N.setUiAttribs({greyout:!S.get()});M.setUiAttribs({greyout:!S.get()})}CGL.TextureEffect.setupBlending(n,h,a,r);const X=new CGL.Uniform(h,"f","amount",r);t.onTriggered=L;j.onChange=u.onChange=i.onChange=l.onChange=c.onChange=A.onChange=T.onChange=s.onChange=m.onChange=R;P();x();_();R();function R(){h.toggleDefine("REMOVE_ALPHA_SRC",s.get());h.toggleDefine("ALPHA_MASK",l.get());h.toggleDefine("CLIP_REPEAT",j.get());h.toggleDefine("HAS_TEXTUREALPHA",u.get()&&u.get().tex);h.toggleDefine("TEX_FLIP_X",T.get());h.toggleDefine("TEX_FLIP_Y",A.get());h.toggleDefine("INVERT_ALPHA",c.get());h.toggleDefine("ALPHA_FROM_LUMINANCE",m.get()=="luminance");h.toggleDefine("ALPHA_FROM_INV_UMINANCE",m.get()=="luminance_inv");h.toggleDefine("PREMUL",i.get())}function L(){if(!CGL.TextureEffect.checkOpInEffect(n))return;const e=o.get();if(e&&e.tex&&r.get()>0){g.pushShader(h);g.currentTextureEffect.bind();const t=g.currentTextureEffect.getCurrentSourceTexture();g.setTexture(0,t.tex);if(t&&e){if(e.textureType!=t.textureType&&e.textureType==CGL.Texture.TYPE_FLOAT)n.setUiError("textypediff","Drawing 32bit texture into an 8 bit can result in data/precision loss",1);else n.setUiError("textypediff",null)}const a=1/(g.currentTextureEffect.getWidth()/g.currentTextureEffect.getHeight())*(e.width/e.height);I.setValue(a);g.setTexture(1,e.tex);if(u.get()&&u.get().tex){g.setTexture(2,u.get().tex)}g.pushBlendMode(CGL.BLEND_NONE,true);g.currentTextureEffect.finish();g.popBlendMode();g.popShader()}v.trigger()}};Ops.Gl.TextureEffects.DrawImage_v3.prototype=new CABLES.Op;CABLES.OPS["8f6b2f15-fcb0-4597-90c0-e5173f2969fe"]={f:Ops.Gl.TextureEffects.DrawImage_v3,objName:"Ops.Gl.TextureEffects.DrawImage_v3"};Ops.Gl.TextureEffects.Noise.FBMNoise=function(){CABLES.Op.apply(this,arguments);const e=this;const t={fbmnoise_frag:"UNI sampler2D tex;\nUNI float anim;\n\nUNI float scale;\nUNI float repeat;\n\nUNI float scrollX;\nUNI float scrollY;\n\nUNI float amount;\n\nUNI bool layer1;\nUNI bool layer2;\nUNI bool layer3;\nUNI bool layer4;\nUNI vec3 color;\nUNI float aspect;\n\nIN vec2 texCoord;\n\n\n{{CGL.BLENDMODES}}\n\n// csdcsdcds\n// adapted from warp shader by inigo quilez/iq\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\n// See here for a tutorial on how to make this: http://www.iquilezles.org/www/articles/warp/warp.htm\n\nconst mat2 m = mat2( 0.80,  0.60, -0.60,  0.80 );\n\nfloat noise( in vec2 x )\n{\n\treturn sin(1.5*x.x)*sin(1.5*x.y);\n}\n\nfloat fbm4( vec2 p )\n{\n    float f = 0.0;\n    f += 0.5000*noise( p ); p = m*p*2.02;\n    f += 0.2500*noise( p ); p = m*p*2.03;\n    f += 0.1250*noise( p ); p = m*p*2.01;\n    f += 0.0625*noise( p );\n    return f/0.9375;\n}\n\nfloat fbm6( vec2 p )\n{\n    float f = 0.0;\n    f += 0.500000*(0.5+0.5*noise( p )); p = m*p*2.02;\n    f += 0.250000*(0.5+0.5*noise( p )); p = m*p*2.03;\n    f += 0.125000*(0.5+0.5*noise( p )); p = m*p*2.01;\n    f += 0.062500*(0.5+0.5*noise( p )); p = m*p*2.04;\n    f += 0.031250*(0.5+0.5*noise( p )); p = m*p*2.01;\n    f += 0.015625*(0.5+0.5*noise( p ));\n    return f/0.96875;\n}\n\nvoid main()\n{\n    // vec4 col=texture(tex,texCoord+2.0*fbm4(texCoord+2.0*fbm6(texCoord+anim)));\n\n    vec2 tc=texCoord;\n\t#ifdef DO_TILEABLE\n\t    tc=abs(texCoord-0.5);\n\t#endif\n\n\n    vec2 p=(tc-0.5)*scale;\n\n\n    p.y/=aspect;\n    vec2 q = vec2( fbm4( p + vec2(0.3+scrollX,0.20+scrollY) ),\n                   fbm4( p + vec2(3.1+scrollX,1.3+scrollY) ) );\n\n    vec2 q2 = vec2( fbm4( p + vec2(2.0+scrollX,1.0+scrollY) ),\n                   fbm4( p + vec2(3.1+scrollX,1.3+scrollY) ) );\n\n    vec2 q3 = vec2( fbm4( p + vec2(9.0+scrollX,4.0+scrollY) ),\n                   fbm4( p + vec2(3.1+scrollX,4.3+scrollY) ) );\n\n\n\n    float v= fbm4( ( p + 4.0*q +anim*0.1)*repeat);\n    float v2= fbm4( (p + 4.0*q2 +anim*0.1)*repeat );\n\n    float v3= fbm6( (p + 4.0*q3 +anim*0.1)*repeat );\n    float v4= fbm6( (p + 4.0*q2 +anim*0.1)*repeat );\n\n\n\n\n    vec4 base=texture(tex,texCoord);\n\n    vec4 finalColor;\n    float colVal=0.0;\n    float numLayers=0.0;\n\n    if(layer1)\n    {\n        colVal+=v;\n        numLayers++;\n    }\n\n    if(layer2)\n    {\n        colVal+=v2;\n        numLayers++;\n    }\n\n    if(layer3)\n    {\n        colVal+=v3;\n        numLayers++;\n    }\n\n    if(layer4)\n    {\n        colVal+=v4;\n        numLayers++;\n    }\n\n    finalColor=vec4( color*vec3(colVal/numLayers),1.0);\n\n    outColor = cgl_blend(base,finalColor,amount);;\n}\n"};const a=e.inTrigger("render"),n=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=e.inValueSlider("Amount",1),o=e.inValueSlider("r",1),i=e.inValueSlider("g",1),l=e.inValueSlider("b",1),s=e.outTrigger("trigger");o.setUiAttribs({colorPick:true});const u=e.patch.cgl;const m=new CGL.Shader(u,"fbmnoise");m.setSource(m.getDefaultVertexShader(),t.fbmnoise_frag);const c=new CGL.Uniform(m,"t","tex",0);const d=new CGL.Uniform(m,"f","scale",e.inValue("scale",2));const f=new CGL.Uniform(m,"f","anim",e.inValue("anim",0));const p=new CGL.Uniform(m,"f","scrollX",e.inValue("scrollX",9));const b=new CGL.Uniform(m,"f","scrollY",e.inValue("scrollY",0));const v=new CGL.Uniform(m,"f","repeat",e.inValue("repeat",1));const g=new CGL.Uniform(m,"f","aspect",e.inValue("aspect",1));const h=new CGL.Uniform(m,"b","layer1",e.inValueBool("Layer 1",true));const x=new CGL.Uniform(m,"b","layer2",e.inValueBool("Layer 2",true));const O=new CGL.Uniform(m,"b","layer3",e.inValueBool("Layer 3",true));const I=new CGL.Uniform(m,"b","layer4",e.inValueBool("Layer 4",true));const _=new CGL.Uniform(m,"3f","color",o,i,l);const T=new CGL.Uniform(m,"f","amount",r);const A=e.inValueBool("Tileable",false);A.onChange=S;function S(){if(A.get())m.define("DO_TILEABLE");else m.removeDefine("DO_TILEABLE")}CGL.TextureEffect.setupBlending(e,m,n,r);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;u.pushShader(m);u.currentTextureEffect.bind();g.set(u.currentTextureEffect.getCurrentSourceTexture().width/u.currentTextureEffect.getCurrentSourceTexture().height);u.setTexture(0,u.currentTextureEffect.getCurrentSourceTexture().tex);u.currentTextureEffect.finish();u.popShader();s.trigger()}};Ops.Gl.TextureEffects.Noise.FBMNoise.prototype=new CABLES.Op;CABLES.OPS["7073186c-b776-48c2-a01e-041df88ad88a"]={f:Ops.Gl.TextureEffects.Noise.FBMNoise,objName:"Ops.Gl.TextureEffects.Noise.FBMNoise"};Ops.Gl.TextureEffects.Noise.Voronoise=function(){CABLES.Op.apply(this,arguments);const e=this;const t={voronoise_frag:"// adapted from https://thebookofshaders.com/12/\n\nIN vec2 texCoord;\n\nUNI bool drawIsoLines;\nUNI bool drawDistance;\nUNI int fill;\nUNI float seed;\n\nUNI float time;\nUNI float movement;\nUNI float amount;\nUNI float centerSize;\nUNI sampler2D tex;\n\n{{CGL.BLENDMODES}}\n{{CGL.RANDOM_OLD}}\n\n//float rand(float n){return fract(sin(n) * 43758.5453123);}\nfloat rand(float n){return fract(sin(n) * 43.5453123);}\nvec2 random2( vec2 p )\n{\n    return vec2(rand(p.x),rand(p.x+p.y));\n}\n\nvoid main() {\n\n    vec3 color = vec3(.0);\n\n    // Cell positions\n    // vec2 point[5];\n    // point[0] = vec2(0.83,0.75);\n    // point[1] = vec2(0.60,0.07);\n    // point[2] = vec2(0.28,0.64);\n    // point[3] = vec2(0.31,0.26);\n    // point[4] = vec2(mouseX,mouseY);\n\n    float m_dist = 1.;  // minimun distance\n    vec2 m_point;        // minimum position\n    float indexColor=0.0;\n\n    // const float NUM=21.0;\n\n    // Iterate through the points positions\n    for (float i = 0.0; i < NUM; i++)\n    {\n        vec2 pos= random2(vec2(i+seed,i+seed));\n\n        pos.x+=sin(time+i)*movement;\n        pos.y+=cos(time+i)*movement;\n\n        if(i==0.0)\n        {\n            // pos=vec2(mouseX,mouseY);\n        }\n\n        float dist = distance(texCoord, pos);\n        if( dist < m_dist )\n        {\n            // Keep the closer distance\n            m_dist = dist;\n\n            // Kepp the position of the closer point\n            m_point = pos;\n            indexColor=(i)/NUM;\n        }\n    }\n\n    // tint acording the closest point position\n    if(fill==1) color.rgb = vec3( indexColor );\n    if(fill==2) color.rgb = vec3( m_point.x );\n    if(fill==3) color.rgb = vec3( 0.5 );\n\n    // Add distance field to closest point center\n    if(drawDistance) color += m_dist*2.;\n\n    // Show isolines\n    if(drawIsoLines) color -= abs(sin(120.0*m_dist))*0.07;\n\n    // Draw point center\n    if(centerSize>0.0)\n    color += 1.-step(centerSize/30.0, m_dist);\n\n    vec4 base=texture(tex,texCoord);\n\n    outColor= cgl_blend(base,vec4(color,1.0),amount);\n}"};const a=e.inTrigger("Render"),n=e.outTrigger("Trigger"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=e.inValueSlider("Amount",1),i=e.inValue("Time",0),l=e.inValueSlider("Movement",0),s=e.inValue("Num",50),u=e.inValue("seed",0),m=e.inValueSelect("Fill",["None","Random","Gradient","Gray"],"Random"),c=e.inValueBool("Draw Isolines",false),d=e.inValueBool("Draw Distance",false),f=e.inValueSlider("Draw Center",0);const p=e.patch.cgl;let b=new CGL.Shader(p,e.name);b.setSource(b.getDefaultVertexShader(),t.voronoise_frag);const v=new CGL.Uniform(b,"t","tex",0),g=new CGL.Uniform(b,"f","amount",o),h=new CGL.Uniform(b,"f","pX",1/1024),x=new CGL.Uniform(b,"f","pY",1/1024),O=new CGL.Uniform(b,"i","fill",1),I=new CGL.Uniform(b,"f","seed",u),_=new CGL.Uniform(b,"f","time",i),T=new CGL.Uniform(b,"f","movement",l),A=new CGL.Uniform(b,"b","drawIsoLines",c),S=new CGL.Uniform(b,"b","drawDistance",d),E=new CGL.Uniform(b,"f","centerSize",f);b.define("NUM",20.01);s.onChange=function(){b.define("NUM",s.get()+.001)};m.onChange=function(){if(m.get()=="Random")O.setValue(1);else if(m.get()=="Gradient")O.setValue(2);else if(m.get()=="Gray")O.setValue(3);else O.setValue(0)};CGL.TextureEffect.setupBlending(e,b,r,o);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;h.setValue(1/p.currentTextureEffect.getCurrentSourceTexture().width);x.setValue(1/p.currentTextureEffect.getCurrentSourceTexture().height);p.pushShader(b);p.currentTextureEffect.bind();p.setTexture(0,p.currentTextureEffect.getCurrentSourceTexture().tex);p.currentTextureEffect.finish();p.popShader();n.trigger()}};Ops.Gl.TextureEffects.Noise.Voronoise.prototype=new CABLES.Op;CABLES.OPS["dba476ec-d5c8-4d54-bd88-23fba59b7a96"]={f:Ops.Gl.TextureEffects.Noise.Voronoise,objName:"Ops.Gl.TextureEffects.Noise.Voronoise"};Ops.Vars.VarSetTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTexture("Value",null);e.varName=e.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(e,"object",a,e.varName)};Ops.Vars.VarSetTexture_v2.prototype=new CABLES.Op;CABLES.OPS["4fbfc71e-1429-439f-8591-ad35961252ed"]={f:Ops.Vars.VarSetTexture_v2,objName:"Ops.Vars.VarSetTexture_v2"};Ops.Gl.Textures.CopyTexture=function(){CABLES.Op.apply(this,arguments);const e=this;const D={copytexture_frag:"UNI float a;\nUNI sampler2D tex;\n\n#ifdef TEX_MASK\nUNI sampler2D texMask;\n#endif\n\nIN vec2 texCoord;\n\nvoid main()\n{\n    vec4 col=texture(tex,texCoord);\n\n    #ifdef TEX_MASK\n        col.a=texture(texMask,texCoord).r;\n    #endif\n\n\n    #ifdef GREY_R\n        col.rgb=vec3(col.r);\n    #endif\n\n    #ifdef GREY_G\n        col.rgb=vec3(col.g);\n    #endif\n\n    #ifdef GREY_B\n        col.rgb=vec3(col.b);\n    #endif\n\n    #ifdef GREY_A\n        col.rgb=vec3(col.a);\n    #endif\n\n    #ifdef GREY_LUMI\n        col.rgb=vec3( dot(vec3(0.2126,0.7152,0.0722), col.rgb) );\n    #endif\n\n\n    #ifdef INVERT_A\n        col.a=1.0-col.a;\n    #endif\n\n    #ifdef INVERT_R\n        col.r=1.0-col.r;\n    #endif\n\n    #ifdef INVERT_G\n        col.g=1.0-col.g;\n    #endif\n\n    #ifdef INVERT_B\n        col.b=1.0-col.b;\n    #endif\n\n    #ifdef ALPHA_1\n        col.a=1.0;\n    #endif\n\n\n\n\n    outColor= col;\n}"};const t=e.inTriggerButton("render"),a=e.inTexture("Texture"),n=e.inTexture("Alpha Mask"),r=e.inValueBool("use original size",true),o=e.inValueInt("width",640),i=e.inValueInt("height",360),l=e.inSwitch("filter",["nearest","linear","mipmap"],"linear"),s=e.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),u=e.inValueBool("HDR"),m=e.inSwitch("Alpha Mask Source",["A","1"],"A"),c=e.inSwitch("Convert Greyscale",["Off","R","G","B","A","Luminance"],"Off"),d=e.inBool("Invert R",false),f=e.inBool("Invert G",false),p=e.inBool("Invert B",false),U=e.inBool("Invert A",false),b=e.outTrigger("trigger"),v=e.outTexture("texture_out",null),B=e.outNumber("Aspect Ratio");m.setUiAttribs({hidePort:true});c.setUiAttribs({hidePort:true});d.setUiAttribs({hidePort:true});f.setUiAttribs({hidePort:true});p.setUiAttribs({hidePort:true});let g=null;const h=e.patch.cgl;let x=null;let O=null;let I=null;let _=true;let T=2,A=2;const S=[0,0,0,0];let E=true;e.setPortGroup("Size",[r,o,i]);const C=new CGL.Shader(h,"copytexture");C.setSource(C.getDefaultVertexShader(),D.copytexture_frag);const k=new CGL.Uniform(C,"t","tex",0);let V=new CGL.Uniform(C,"t","texMask",1);let y=CGL.Texture.FILTER_LINEAR;let N=CGL.Texture.WRAP_CLAMP_TO_EDGE;m.onChange=c.onChange=d.onChange=f.onChange=p.onChange=s.onChange=l.onChange=u.onChange=n.onChange=j;t.onLinkChanged=a.onLinkChanged=a.onChange=()=>{j()};t.onTriggered=w;R();function M(){if(O)O.delete();if(I){I.delete();I=null}O=new CGL.TextureEffect(h,{isFloatingPointTexture:u.get(),clear:false});if(!I||I.width!=Math.floor(o.get())||I.height!=Math.floor(i.get())||I.wrap!=N||I.isFloatingPoint()!=u.get()){if(I)I.delete();I=new CGL.Texture(h,{name:"copytexture_"+e.id,isFloatingPointTexture:u.get(),filter:y,wrap:N,width:Math.floor(o.get()),height:Math.floor(i.get())})}O.setSourceTexture(I);v.set(null);E=false}function j(){G();if(t.links.length===0){E=true;e.patch.cgl.off(g);g=e.patch.cgl.on("beginFrame",()=>{e.patch.cgl.off(g);if(_)P();if(!O)e.log("has no effect");if(!a.get())e.log("has no intexture");w()})}}function P(){if(!a.get()||a.get()==CGL.Texture.getEmptyTexture(h))return;if(!O)M();if(r.get()){T=a.get().width;A=a.get().height}else{T=Math.floor(o.get());A=Math.floor(i.get())}if((T!=I.width||A!=I.height)&&(T!==0&&A!==0)){i.set(A);o.set(T);I.filter=y;I.setSize(T,A);B.set(T/A);O.setSourceTexture(I)}if(v.get()&&y!=CGL.Texture.FILTER_NEAREST){if(!v.get().isPowerOfTwo())e.setUiError("hintnpot","texture dimensions not power of two! - texture filtering when scaling will not work on ios devices.",0);else e.setUiError("hintnpot",null,0)}else e.setUiError("hintnpot",null,0);_=false}function R(){o.setUiAttribs({greyout:r.get()});i.setUiAttribs({greyout:r.get()})}function L(){_=true;j()}r.onChange=function(){R();if(r.get()){o.onChange=null;i.onChange=null}else{o.onChange=L;i.onChange=L}P()};function w(){if(!a.get()||a.get()==CGL.Texture.getEmptyTexture(h))v.set(CGL.Texture.getEmptyTexture(h));if(!a.get()||a.get()==CGL.Texture.getEmptyTexture(h)){x=null;b.trigger();return}else if(!O||E||x!=a.get()){M()}const e=h.getViewPort();S[0]=e[0];S[1]=e[1];S[2]=e[2];S[3]=e[3];P();x=a.get();const t=h.currentTextureEffect;h.currentTextureEffect=O;O.setSourceTexture(I);O.startEffect();h.pushShader(C);h.currentTextureEffect.bind();h.setTexture(0,a.get().tex);if(n.get())h.setTexture(1,n.get().tex);h.pushBlend(false);h.currentTextureEffect.finish();h.popShader();h.popBlend();v.set(O.getCurrentSourceTexture());O.endEffect();h.setViewPort(S[0],S[1],S[2],S[3]);h.currentTextureEffect=t;h.setTexture(0,CGL.Texture.getEmptyTexture(h).tex);b.trigger()}function G(){C.toggleDefine("TEX_MASK",n.get());C.toggleDefine("GREY_R",c.get()==="R");C.toggleDefine("GREY_G",c.get()==="G");C.toggleDefine("GREY_B",c.get()==="B");C.toggleDefine("GREY_A",c.get()==="A");C.toggleDefine("GREY_LUMI",c.get()==="Luminance");C.toggleDefine("ALPHA_1",m.get()==="1");C.toggleDefine("ALPHA_A",m.get()==="A");C.toggleDefine("INVERT_R",d.get());C.toggleDefine("INVERT_G",f.get());C.toggleDefine("INVERT_B",p.get());C.toggleDefine("INVERT_A",U.get());if(s.get()=="repeat")N=CGL.Texture.WRAP_REPEAT;else if(s.get()=="mirrored repeat")N=CGL.Texture.WRAP_MIRRORED_REPEAT;else if(s.get()=="clamp to edge")N=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(l.get()=="nearest")y=CGL.Texture.FILTER_NEAREST;else if(l.get()=="linear")y=CGL.Texture.FILTER_LINEAR;else if(l.get()=="mipmap")y=CGL.Texture.FILTER_MIPMAP;if(C.needsRecompile()){E=true}if(I&&(I.width!=Math.floor(o.get())||I.height!=Math.floor(i.get())||I.wrap!=N||I.isFloatingPoint()!=u.get())){E=true}}};Ops.Gl.Textures.CopyTexture.prototype=new CABLES.Op;CABLES.OPS["18a6d1f4-a7f8-4a3e-ab1d-0c2d2efe3861"]={f:Ops.Gl.Textures.CopyTexture,objName:"Ops.Gl.Textures.CopyTexture"};Ops.Gl.Matrix.Transform=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const t=a.inTrigger("render"),n=a.inValue("posX",0),r=a.inValue("posY",0),o=a.inValue("posZ",0),i=a.inValue("scale",1),l=a.inValue("rotX",0),s=a.inValue("rotY",0),u=a.inValue("rotZ",0),m=a.outTrigger("trigger");a.setPortGroup("Rotation",[l,s,u]);a.setPortGroup("Position",[n,r,o]);a.setPortGroup("Scale",[i]);a.setUiAxisPorts(n,r,o);a.toWorkPortsNeedToBeLinked(t,m);const c=vec3.create();const d=vec3.create();const f=mat4.create();mat4.identity(f);let p=false,b=false,v=true,g=true,h=true;l.onChange=s.onChange=u.onChange=A;n.onChange=r.onChange=o.onChange=_;i.onChange=T;t.onTriggered=function(){let e=false;if(v){O();e=true}if(g){I();e=true}if(h)e=true;if(e)x();const t=a.patch.cg||a.patch.cgl;t.pushModelMatrix();mat4.multiply(t.mMatrix,t.mMatrix,f);m.trigger();t.popModelMatrix();if(CABLES.UI&&CABLES.UI.showCanvasTransforms)gui.setTransform(a.id,n.get(),r.get(),o.get());if(a.isCurrentUiOp())gui.setTransformGizmo({posX:n,posY:r,posZ:o})};a.transform3d=function(){return{pos:[n,r,o]}};function x(){mat4.identity(f);if(b)mat4.translate(f,f,c);if(l.get()!==0)mat4.rotateX(f,f,l.get()*CGL.DEG2RAD);if(s.get()!==0)mat4.rotateY(f,f,s.get()*CGL.DEG2RAD);if(u.get()!==0)mat4.rotateZ(f,f,u.get()*CGL.DEG2RAD);if(p)mat4.scale(f,f,d);h=false}function O(){b=false;if(n.get()!==0||r.get()!==0||o.get()!==0)b=true;vec3.set(c,n.get(),r.get(),o.get());v=false}function I(){p=true;vec3.set(d,i.get(),i.get(),i.get());g=false}function _(){v=true}function T(){g=true}function A(){h=true}x()};Ops.Gl.Matrix.Transform.prototype=new CABLES.Op;CABLES.OPS["650baeb1-db2d-4781-9af6-ab4e9d4277be"]={f:Ops.Gl.Matrix.Transform,objName:"Ops.Gl.Matrix.Transform"};Ops.Gl.TextureEffects.EdgeDetection_v3=function(){CABLES.Op.apply(this,arguments);const e=this;const t={edgedetect_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float width;\nUNI float strength;\nUNI float texWidth;\nUNI float texHeight;\nUNI float mulColor;\n\nconst vec4 lumcoeff = vec4(0.299,0.587,0.114, 0.);\n\nvec3 desaturate(vec3 color)\n{\n    return vec3(dot(vec3(0.2126,0.7152,0.0722), color));\n}\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    // vec4 col=vec4(1.0,0.0,0.0,1.0);\n\n    // float pixelX=0.27/texWidth;\n    // float pixelY=0.27/texHeight;\n    float pixelX=(width+0.01)*4.0/texWidth;\n    float pixelY=(width+0.01)*4.0/texHeight;\n\nvec2 tc=texCoord;\n// #ifdef OFFSETPIXEL\n    tc.x+=1.0/texWidth*0.5;\n    tc.y+=1.0/texHeight*0.5;\n// #endif\n    // col=texture(tex,texCoord);\n\n    float count=1.0;\n\n\tvec4 horizEdge = vec4( 0.0 );\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y - pixelY ) ) * 1.0;\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y     ) ) * 2.0;\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y + pixelY ) ) * 1.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y - pixelY ) ) * 1.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y     ) ) * 2.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y + pixelY ) ) * 1.0;\n\tvec4 vertEdge = vec4( 0.0 );\n\tvertEdge -= texture( tex, vec2( tc.x - pixelX, tc.y - pixelY ) ) * 1.0;\n\tvertEdge -= texture( tex, vec2( tc.x    , tc.y - pixelY ) ) * 2.0;\n\tvertEdge -= texture( tex, vec2( tc.x + pixelX, tc.y - pixelY ) ) * 1.0;\n\tvertEdge += texture( tex, vec2( tc.x - pixelX, tc.y + pixelY ) ) * 1.0;\n\tvertEdge += texture( tex, vec2( tc.x    , tc.y + pixelY ) ) * 2.0;\n\tvertEdge += texture( tex, vec2( tc.x + pixelX, tc.y + pixelY ) ) * 1.0;\n\n\n\tvec3 edge = sqrt((horizEdge.rgb/count * horizEdge.rgb/count) + (vertEdge.rgb/count * vertEdge.rgb/count));\n\n    edge=desaturate(edge);\n    edge*=strength;\n\n    if(mulColor>0.0) edge*=texture( tex, texCoord ).rgb*mulColor*4.0;\n    edge=max(min(edge,1.0),0.0);\n\n    //blend section\n    vec4 col=vec4(edge,1.0);\n    vec4 base=texture(tex,texCoord);\n\n    outColor=cgl_blend(base,col,amount);\n}\n\n"};const a=e.inTrigger("Render"),n=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=e.inValueSlider("Amount",1),o=e.inFloat("Strength",4),i=e.inValueSlider("Width",.1),l=e.inValueSlider("Mul Color",0),s=e.outTrigger("Trigger");const u=e.patch.cgl;const m=new CGL.Shader(u,e.name);m.setSource(m.getDefaultVertexShader(),t.edgedetect_frag);const c=new CGL.Uniform(m,"t","tex",0),d=new CGL.Uniform(m,"f","amount",r),f=new CGL.Uniform(m,"f","strength",o),p=new CGL.Uniform(m,"f","width",i),b=new CGL.Uniform(m,"f","texWidth",128),v=new CGL.Uniform(m,"f","texHeight",128),g=new CGL.Uniform(m,"f","mulColor",l);CGL.TextureEffect.setupBlending(e,m,n,r);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;u.pushShader(m);u.currentTextureEffect.bind();u.setTexture(0,u.currentTextureEffect.getCurrentSourceTexture().tex);b.setValue(u.currentTextureEffect.getCurrentSourceTexture().width);v.setValue(u.currentTextureEffect.getCurrentSourceTexture().height);u.currentTextureEffect.finish();u.popShader();s.trigger()}};Ops.Gl.TextureEffects.EdgeDetection_v3.prototype=new CABLES.Op;CABLES.OPS["3cdc351c-8d6e-4d3d-8da0-0777a6062c0d"]={f:Ops.Gl.TextureEffects.EdgeDetection_v3,objName:"Ops.Gl.TextureEffects.EdgeDetection_v3"};Ops.Gl.TextureEffects.FXAA=function(){CABLES.Op.apply(this,arguments);const e=this;const t={fxaa_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float FXAA_SPAN_MAX;\nUNI float FXAA_REDUCE_MUL;\nUNI float FXAA_REDUCE_MIN;\nUNI float width;\nUNI float height;\n\nvec4 getColorFXAA(vec2 coord)\n{\n    vec2 invtexsize=vec2(1.0/width,1.0/height);\n\n    float step=1.0;\n\n    vec3 rgbNW = texture(tex, coord.xy + (vec2(-step, -step)*invtexsize )).xyz;\n    vec3 rgbNE = texture(tex, coord.xy + (vec2(+step, -step)*invtexsize )).xyz;\n    vec3 rgbSW = texture(tex, coord.xy + (vec2(-step, +step)*invtexsize )).xyz;\n    vec3 rgbSE = texture(tex, coord.xy + (vec2(+step, +step)*invtexsize )).xyz;\n    vec3 rgbM  = texture(tex, coord.xy).xyz;\n\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot( rgbM, luma);\n\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0/(min(abs(dir.x), abs(dir.y)) + dirReduce);\n\n    dir = min(vec2(FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\n          max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin))*invtexsize ;\n\n    vec3 rgbA = (1.0/2.0) * (\n                texture(tex, coord.xy + dir * (1.0/3.0 - 0.5)).xyz +\n                texture(tex, coord.xy + dir * (2.0/3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\n                texture(tex, coord.xy + dir * (0.0/3.0 - 0.5)).xyz +\n                texture(tex, coord.xy + dir * (3.0/3.0 - 0.5)).xyz);\n    float lumaB = dot(rgbB, luma);\n\n    vec4 color=texture(tex,coord).rgba;\n\n    if((lumaB < lumaMin) || (lumaB > lumaMax)){\n      color.xyz=rgbA;\n    } else {\n      color.xyz=rgbB;\n    }\n    return color;\n}\n\nvoid main()\n{\n   vec4 col=vec4(1.0,0.0,0.0,1.0);\n   outColor= getColorFXAA(texCoord);\n}"};let a=e.inTrigger("render");let n=e.outTrigger("trigger");let r=e.inValueSelect("span",[0,2,4,8,16,32,64]);let o=e.inValueFloat("reduceMin");let i=e.inValueFloat("reduceMul");let l=e.inValueBool("use viewport size",true);let s=e.inValueInt("width");let u=e.inValueInt("height");let m=e.patch.cgl;let c=new CGL.Shader(m,e.name);c.setSource(c.getDefaultVertexShader(),t.fxaa_frag);let d=new CGL.Uniform(c,"t","tex",0);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;m.pushShader(c);if(m.getViewPort()[2]!=s.get()||m.getViewPort()[3]!=u.get()){h()}m.currentTextureEffect.bind();m.setTexture(0,m.currentTextureEffect.getCurrentSourceTexture().tex);m.currentTextureEffect.finish();m.popShader();n.trigger()};let f=new CGL.Uniform(c,"f","FXAA_SPAN_MAX",0);let p=new CGL.Uniform(c,"f","FXAA_REDUCE_MUL",0);let b=new CGL.Uniform(c,"f","FXAA_REDUCE_MIN",0);r.onChange=function(){f.setValue(parseInt(r.get(),10))};let v=new CGL.Uniform(c,"f","width",0);let g=new CGL.Uniform(c,"f","height",0);function h(){if(l.get()){let e=m.getViewPort()[2];let t=m.getViewPort()[3];v.setValue(e);g.setValue(t)}else{v.setValue(s.get());g.setValue(u.get())}}s.onChange=h;u.onChange=h;l.onChange=h;e.onResize=h;r.set(8);i.onChange=function(){p.setValue(1/i.get())};o.onChange=function(){b.setValue(1/o.get())};i.set(8);o.set(128)};Ops.Gl.TextureEffects.FXAA.prototype=new CABLES.Op;CABLES.OPS["3e679c17-f050-4bc8-bfe5-5b9190e7ce40"]={f:Ops.Gl.TextureEffects.FXAA,objName:"Ops.Gl.TextureEffects.FXAA"};Ops.Gl.TextureEffects.ToNormalMap=function(){CABLES.Op.apply(this,arguments);const e=this;const t={tonormal_frag:"#ifdef HAS_TEXTURES\n  IN vec2 texCoord;\n  UNI sampler2D tex;\n#endif\n\nUNI float strength;\n\nvoid main()\n{\n\n    float texelSize=1.0/1024.0;\n\n    float tl = abs(texture(tex, texCoord + texelSize * vec2(-1.0, -1.0)).x);   // top left\n    float  l = abs(texture(tex, texCoord + texelSize * vec2(-1.0,  0.0)).x);   // left\n    float bl = abs(texture(tex, texCoord + texelSize * vec2(-1.0,  1.0)).x);   // bottom left\n    float  t = abs(texture(tex, texCoord + texelSize * vec2( 0.0, -1.0)).x);   // top\n    float  b = abs(texture(tex, texCoord + texelSize * vec2( 0.0,  1.0)).x);   // bottom\n    float tr = abs(texture(tex, texCoord + texelSize * vec2( 1.0, -1.0)).x);   // top right\n    float  r = abs(texture(tex, texCoord + texelSize * vec2( 1.0,  0.0)).x);   // right\n    float br = abs(texture(tex, texCoord + texelSize * vec2( 1.0,  1.0)).x);   // bottom right\n\n    //     // Compute dx using Sobel:\n    //     //           -1 0 1\n    //     //           -2 0 2\n    //     //           -1 0 1\n    float dX = tr + 2.0*r + br -tl - 2.0*l - bl;\n\n    //     // Compute dy using Sobel:\n    //     //           -1 -2 -1\n    //     //            0  0  0\n    //     //            1  2  1\n    float dY = bl + 2.0*b + br -tl - 2.0*t - tr;\n\n    //     // Build the normalized normal\n\n    vec4 N = vec4(normalize(vec3(dX,dY, 1.0 / strength)), 1.0);\n\n    //     //convert (-1.0 , 1.0) to (0.0 , 1.0), if needed\n    N= N * 0.5 + 0.5;\n\n   outColor= N;\n}"};let a=e.inTrigger("render");let n=e.outTrigger("trigger");let r=e.inValue("Strength",4);let o=e.patch.cgl;let i=new CGL.Shader(o,e.name);i.setSource(i.getDefaultVertexShader(),t.tonormal_frag);let l=new CGL.Uniform(i,"t","tex",0);let s=new CGL.Uniform(i,"f","strength",r);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;o.pushShader(i);o.currentTextureEffect.bind();o.setTexture(0,o.currentTextureEffect.getCurrentSourceTexture().tex);o.currentTextureEffect.finish();o.popShader();n.trigger()}};Ops.Gl.TextureEffects.ToNormalMap.prototype=new CABLES.Op;CABLES.OPS["a9aba612-dc72-4108-a6fb-f0292463a186"]={f:Ops.Gl.TextureEffects.ToNormalMap,objName:"Ops.Gl.TextureEffects.ToNormalMap"};Ops.Gl.RenderToTexture=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.patch.cgl;const t=r.inTrigger("render"),a=r.inValueBool("use viewport size",true),n=r.inValueInt("texture width",512),i=r.inValueInt("texture height",512),l=r.inBool("Auto Aspect",false),s=r.inSwitch("filter",["nearest","linear","mipmap"],"linear"),u=r.inSwitch("Wrap",["Clamp","Repeat","Mirror"],"Repeat"),m=r.inSwitch("MSAA",["none","2x","4x","8x"],"none"),c=r.outTrigger("trigger"),d=r.outTexture("texture"),f=r.outTexture("textureDepth"),p=r.inValueBool("HDR"),b=r.inValueBool("Depth",true),v=r.inValueBool("Clear",true);let g=null;let h=true;d.set(CGL.Texture.getEmptyTexture(o));r.setPortGroup("Size",[a,n,i,l]);const x=[0,0,0,0];p.setUiAttribs({title:"Pixelformat Float 32bit"});p.onChange=b.onChange=v.onChange=s.onChange=u.onChange=m.onChange=I;a.onChange=O;t.onTriggered=r.preRender=_;O();function O(){n.setUiAttribs({greyout:a.get()});i.setUiAttribs({greyout:a.get()});l.setUiAttribs({greyout:a.get()})}function I(){h=true}function _(){const e=o.getViewPort();x[0]=e[0];x[1]=e[1];x[2]=e[2];x[3]=e[3];if(!g||h){if(g)g.delete();let a=CGL.Texture.WRAP_REPEAT;if(u.get()=="Clamp")a=CGL.Texture.WRAP_CLAMP_TO_EDGE;else if(u.get()=="Mirror")a=CGL.Texture.WRAP_MIRRORED_REPEAT;let n=CGL.Texture.FILTER_NEAREST;if(s.get()=="nearest")n=CGL.Texture.FILTER_NEAREST;else if(s.get()=="linear")n=CGL.Texture.FILTER_LINEAR;else if(s.get()=="mipmap")n=CGL.Texture.FILTER_MIPMAP;if(p.get()&&s.get()=="mipmap")r.setUiError("fpmipmap","Don't use mipmap and HDR at the same time, many systems do not support this.");else r.setUiError("fpmipmap",null);if(o.glVersion>=2){let e=true;let t=4;if(m.get()=="none"){t=0;e=false}if(m.get()=="2x")t=2;if(m.get()=="4x")t=4;if(m.get()=="8x")t=8;g=new CGL.Framebuffer2(o,8,8,{name:"render2texture "+r.id,isFloatingPointTexture:p.get(),multisampling:e,wrap:a,filter:n,depth:b.get(),multisamplingSamples:t,clear:v.get()})}else{g=new CGL.Framebuffer(o,8,8,{isFloatingPointTexture:p.get(),clear:v.get()});console.log("WEBGL1!!!",g,g.valid)}if(g&&g.valid){f.set(g.getTextureDepth());h=false}else{g=null;h=true}}if(a.get()){n.set(o.getViewPort()[2]);i.set(o.getViewPort()[3])}if(g.getWidth()!=Math.ceil(n.get())||g.getHeight()!=Math.ceil(i.get())){g.setSize(Math.max(1,Math.ceil(n.get())),Math.max(1,Math.ceil(i.get())))}g.renderStart(o);if(l.get())mat4.perspective(o.pMatrix,45,n.get()/i.get(),.1,1e3);c.trigger();g.renderEnd(o);o.setViewPort(x[0],x[1],x[2],x[3]);f.setRef(g.getTextureDepth());d.setRef(g.getTextureColor())}};Ops.Gl.RenderToTexture.prototype=new CABLES.Op;CABLES.OPS["d01fa820-396c-4cb5-9d78-6b14762852af"]={f:Ops.Gl.RenderToTexture,objName:"Ops.Gl.RenderToTexture"};Ops.Gl.ShaderEffects.VertexDisplacementMap_v4=function(){CABLES.Op.apply(this,arguments);const e=this;const t={vertdisplace_body_vert:"\nvec2 MOD_tc=texCoord;\n\n#ifdef MOD_COORD_MESHXY\n    MOD_tc=pos.xy;\n#endif\n#ifdef MOD_COORD_MESHXZ\n    MOD_tc=pos.xz;\n#endif\n\n\n#ifdef MOD_FLIP_Y\n    MOD_tc.y=1.0-MOD_tc.y;\n#endif\n#ifdef MOD_FLIP_X\n    MOD_tc.x=1.0-MOD_tc.x;\n#endif\n#ifdef MOD_FLIP_XY\n    MOD_tc=1.0-MOD_tc;\n#endif\n\nMOD_tc*=MOD_scale;\n\nvec4 MOD_sample=texture( MOD_texture, vec2(MOD_tc.x+MOD_offsetX,MOD_tc.y+MOD_offsetY) );\nvec3 MOD_disp;\n\n#ifdef MOD_INPUT_R\n    MOD_disp=vec3(MOD_sample.r);\n#endif\n#ifdef MOD_INPUT_G\n    MOD_disp=vec3(MOD_sample.g);\n#endif\n#ifdef MOD_INPUT_B\n    MOD_disp=vec3(MOD_sample.b);\n#endif\n#ifdef MOD_INPUT_A\n    MOD_disp=vec3(MOD_sample.a);\n#endif\n#ifdef MOD_INPUT_RGB\n    MOD_disp=MOD_sample.rgb;\n#endif\n#ifdef MOD_INPUT_LUMI\n    MOD_disp=vec3(dot(vec3(0.2126,0.7152,0.0722), MOD_sample.rgb));\n#endif\n\n\n\n#ifdef MOD_HEIGHTMAP_INVERT\n   MOD_disp=1.0-MOD_disp;\n#endif\n// #ifdef MOD_HEIGHTMAP_NORMALIZE\n//   MOD_disp-=0.5;\n//   MOD_disp*=2.0;\n// #endif\n\n\n#ifdef MOD_HEIGHTMAP_NORMALIZE\n    MOD_disp=(MOD_disp-0.5)*2.0;\n    // MOD_disp=(MOD_disp-0.5)*-1.0+0.5;\n#endif\n\n\nfloat MOD_zero=0.0;\n\n#ifdef MOD_MODE_DIV\n    MOD_zero=1.0;\n#endif\n#ifdef MOD_MODE_MUL\n    MOD_zero=1.0;\n#endif\n\n\n\nvec3 MOD_mask=vec3(1.0);\n\n#ifdef MOD_AXIS_X\n    MOD_mask=vec3(1.,0.,0.);\n    MOD_disp*=MOD_mask*MOD_extrude;\n#endif\n#ifdef MOD_AXIS_Y\n    MOD_mask=vec3(0.,1.,0.);\n    MOD_disp*=MOD_mask*MOD_extrude;\n#endif\n#ifdef MOD_AXIS_Z\n    MOD_mask=vec3(0.,0.,1.);\n    MOD_disp*=MOD_mask*MOD_extrude;\n#endif\n#ifdef MOD_AXIS_XY\n    MOD_mask=vec3(1.,1.,0.);\n    MOD_disp*=MOD_mask*MOD_extrude;\n#endif\n#ifdef MOD_AXIS_XYZ\n    MOD_mask=vec3(1.,1.,1.);\n    MOD_disp*=MOD_mask*MOD_extrude;\n#endif\n\n\n// MOD_disp=smoothstep(-1.,1.,MOD_disp*MOD_disp*MOD_disp);\n// MOD_disp=MOD_disp*MOD_disp*MOD_disp;\n\n// #ifdef MOD_FLIP_Y\n//     MOD_mask.y=1.0-MOD_mask.y;\n// #endif\n// #ifdef MOD_FLIP_X\n//     MOD_mask.x=1.0-MOD_mask.x;\n// #endif\n// #ifdef MOD_FLIP_XY\n//     MOD_mask.xy=1.0-MOD_mask.xy;\n// #endif\n\n\n\n#ifdef MOD_MODE_DIV\n    pos.xyz/=MOD_disp*MOD_mask;\n#endif\n\n#ifdef MOD_MODE_MUL\n    pos.xyz*=MOD_disp*MOD_mask;\n#endif\n\n#ifdef MOD_MODE_ADD\n    pos.xyz+=MOD_disp*MOD_mask;\n#endif\n\n#ifdef MOD_MODE_NORMAL\n\n    vec3 MOD_t=norm;\n    #ifdef MOD_SMOOTHSTEP\n        MOD_t=smoothstep(-1.,1.,MOD_t);\n    #endif\n\n    pos.xyz+=MOD_t*MOD_disp*MOD_mask;\n\n#endif\n\n#ifdef MOD_MODE_TANGENT\n    MOD_disp*=-1.0;\n\n    vec3 MOD_t=attrTangent;\n    #ifdef MOD_SMOOTHSTEP\n        MOD_t=smoothstep(-1.,1.,MOD_t);\n    #endif\n\n    pos.xyz+=MOD_t*MOD_disp*MOD_mask;\n\n#endif\n\n#ifdef MOD_MODE_BITANGENT\n    MOD_disp*=-1.0;\n    vec3 MOD_t=attrBiTangent;\n\n    #ifdef MOD_SMOOTHSTEP\n        MOD_t=smoothstep(-1.,1.,MOD_t);\n    #endif\n\n    pos.xyz+=MOD_t*MOD_disp*MOD_mask;\n\n#endif\n\n#ifdef MOD_MODE_VERTCOL\n    vec3 MOD_t=attrVertColor.rgb*vec3(2.0)-vec3(1.0);\n\n    #ifdef MOD_SMOOTHSTEP\n        MOD_t=smoothstep(-1.,1.,MOD_t);\n    #endif\n\n    pos.xyz+=MOD_t*MOD_disp*MOD_mask;\n\n#endif\n\n\n// pos.y*=-1.0;\n    // pos.xy+=vec2(MOD_texVal*MOD_extrude)*normalize(pos.xy);\n\n\nMOD_displHeightMapColor=MOD_disp;\n\n\n#ifdef MOD_CALC_NORMALS\n    norm+=MOD_calcNormal(MOD_texture,MOD_tc);\n#endif",vertdisplace_head_vert:"OUT vec3 MOD_displHeightMapColor;\n\n#ifdef MOD_MODE_VERTCOL\n#ifndef VERTEX_COLORS\nIN vec4 attrVertColor;\n#endif\n#endif\n\n// mat4 rotationX( in float angle ) {\n// \treturn mat4(\t1.0,\t\t0,\t\t\t0,\t\t\t0,\n// \t\t\t \t\t0, \tcos(angle),\t-sin(angle),\t\t0,\n// \t\t\t\t\t0, \tsin(angle),\t cos(angle),\t\t0,\n// \t\t\t\t\t0, \t\t\t0,\t\t\t  0, \t\t1);\n// }\n\n// mat4 rotationY( in float angle ) {\n// \treturn mat4(\tcos(angle),\t\t0,\t\tsin(angle),\t0,\n// \t\t\t \t\t\t\t0,\t\t1.0,\t\t\t 0,\t0,\n// \t\t\t\t\t-sin(angle),\t0,\t\tcos(angle),\t0,\n// \t\t\t\t\t\t\t0, \t\t0,\t\t\t\t0,\t1);\n// }\n\n// mat4 rotationZ( in float angle ) {\n// \treturn mat4(\tcos(angle),\t\t-sin(angle),\t0,\t0,\n// \t\t\t \t\tsin(angle),\t\tcos(angle),\t\t0,\t0,\n// \t\t\t\t\t\t\t0,\t\t\t\t0,\t\t1,\t0,\n// \t\t\t\t\t\t\t0,\t\t\t\t0,\t\t0,\t1);\n// }\n\n\nvec3 MOD_calcNormal(sampler2D tex,vec2 uv)\n{\n    float strength=13.0;\n    // float texelSize=1.0/float(textureSize(tex,0).x); // not on linux intel?!\n    float texelSize=1.0/512.0;\n\n    float tl = abs(texture(tex, uv + texelSize * vec2(-1.0, -1.0)).x);   // top left\n    float  l = abs(texture(tex, uv + texelSize * vec2(-1.0,  0.0)).x);   // left\n    float bl = abs(texture(tex, uv + texelSize * vec2(-1.0,  1.0)).x);   // bottom left\n    float  t = abs(texture(tex, uv + texelSize * vec2( 0.0, -1.0)).x);   // top\n    float  b = abs(texture(tex, uv + texelSize * vec2( 0.0,  1.0)).x);   // bottom\n    float tr = abs(texture(tex, uv + texelSize * vec2( 1.0, -1.0)).x);   // top right\n    float  r = abs(texture(tex, uv + texelSize * vec2( 1.0,  0.0)).x);   // right\n    float br = abs(texture(tex, uv + texelSize * vec2( 1.0,  1.0)).x);   // bottom right\n\n    //     // Compute dx using Sobel:\n    //     //           -1 0 1\n    //     //           -2 0 2\n    //     //           -1 0 1\n    float dX = tr + 2.0*r + br -tl - 2.0*l - bl;\n\n    //     // Compute dy using Sobel:\n    //     //           -1 -2 -1\n    //     //            0  0  0\n    //     //            1  2  1\n    float dY = bl + 2.0*b + br -tl - 2.0*t - tr;\n\n    //     // Build the normalized normal\n\nvec3 N;\n\n#ifdef MOD_NORMALS_Z\n    N = normalize(vec3(dX,dY, 1.0 / strength));\n#endif\n\n#ifdef MOD_NORMALS_Y\n    N = normalize(vec3(dX,1.0/strength,dY));\n#endif\n#ifdef MOD_NORMALS_X\n    N = normalize(vec3(1.0/strength,dX,dY));\n#endif\n// N*=-1.0;\n// N= N * 0.5 + 0.5;\n\n\n   return N;\n}\n"};const a=e.inTrigger("Render"),n=e.inValue("Extrude",.5),r=e.inSwitch("Mode",["Norm","Tang","BiTang","VertCol","*","+","/"],"Norm"),o=e.inSwitch("Axis",["XYZ","XY","X","Y","Z"],"XYZ"),i=e.inSwitch("Coordinates",["Tex Coords","Mesh XY","Mesh XZ"],"Tex Coords"),l=e.inTexture("Texture",null,"texture"),s=e.inSwitch("Channel",["Luminance","R","G","B","A","RGB"],"Luminance"),u=e.inSwitch("Flip",["None","X","Y","XY"],"None"),m=e.inSwitch("Range",["0-1","1-0","Normalized"],"0-1"),c=e.inValueFloat("Offset X"),d=e.inValueFloat("Offset Y"),f=e.inValueFloat("Scale",1),p=e.inValueBool("Calc Normals",false),b=e.inSwitch("Normal Axis",["X","Y","Z"],"Z"),v=e.inValueBool("Discard Zero Values"),g=e.inValueBool("colorize",false),h=e.inValueSlider("Colorize Min",0),x=e.inValueSlider("Colorize Max",1),O=e.outTrigger("trigger");const I=e.patch.cgl;e.setPortGroup("Input",[l,u,s,m,c,d,f]);e.setPortGroup("Colorize",[g,h,x,v]);e.toWorkPortsNeedToBeLinked(l,O,a);a.onTriggered=y;s.onChange=i.onChange=o.onChange=u.onChange=r.onChange=m.onChange=g.onChange=v.onChange=p.onChange=b.onChange=C;const _=t.vertdisplace_head_vert;const T=t.vertdisplace_body_vert;const A="".endl()+"IN vec3 MOD_displHeightMapColor;".endl()+"vec3 MOD_map(vec3 value, float inMin, float inMax, float outMin, float outMax) { return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);}".endl();const S="".endl()+"#ifdef MOD_HEIGHTMAP_COLORIZE".endl()+"   col.rgb*=MOD_map( MOD_displHeightMapColor, 0.0,1.0 , MOD_colorizeMin,MOD_colorizeMax);".endl()+"#endif".endl()+"#ifdef MOD_DISPLACE_REMOVE_ZERO".endl()+"   if(MOD_displHeightMapColor.r==0.0)discard;".endl()+"#endif".endl();const E=new CGL.ShaderModifier(I,e.name);E.addModule({title:e.name,name:"MODULE_VERTEX_POSITION",srcHeadVert:_,srcBodyVert:T});E.addModule({title:e.name,name:"MODULE_COLOR",srcHeadFrag:A,srcBodyFrag:S});E.addUniformVert("t","MOD_texture",0);E.addUniformVert("f","MOD_extrude",n);E.addUniformVert("f","MOD_offsetX",c);E.addUniformVert("f","MOD_offsetY",d);E.addUniformVert("f","MOD_scale",f);E.addUniformFrag("f","MOD_colorizeMin",h);E.addUniformFrag("f","MOD_colorizeMax",x);C();function C(){E.toggleDefine("MOD_HEIGHTMAP_COLORIZE",g.get());E.toggleDefine("MOD_HEIGHTMAP_INVERT",m.get()=="1-0");E.toggleDefine("MOD_HEIGHTMAP_NORMALIZE",m.get()=="Normalized");E.toggleDefine("MOD_DISPLACE_REMOVE_ZERO",v.get());E.toggleDefine("MOD_INPUT_R",s.get()=="R");E.toggleDefine("MOD_INPUT_G",s.get()=="G");E.toggleDefine("MOD_INPUT_B",s.get()=="B");E.toggleDefine("MOD_INPUT_A",s.get()=="A");E.toggleDefine("MOD_INPUT_RGB",s.get()=="RGB");E.toggleDefine("MOD_INPUT_LUMI",s.get()=="Luminance");E.toggleDefine("MOD_FLIP_X",u.get()=="X");E.toggleDefine("MOD_FLIP_Y",u.get()=="Y");E.toggleDefine("MOD_FLIP_XY",u.get()=="XY");E.toggleDefine("MOD_AXIS_X",o.get()=="X");E.toggleDefine("MOD_AXIS_Y",o.get()=="Y");E.toggleDefine("MOD_AXIS_Z",o.get()=="Z");E.toggleDefine("MOD_AXIS_XYZ",o.get()=="XYZ");E.toggleDefine("MOD_AXIS_XY",o.get()=="XY");E.toggleDefine("MOD_MODE_BITANGENT",r.get()=="BiTang");E.toggleDefine("MOD_MODE_TANGENT",r.get()=="Tang");E.toggleDefine("MOD_MODE_NORMAL",r.get()=="Norm");E.toggleDefine("MOD_MODE_VERTCOL",r.get()=="VertCol");E.toggleDefine("MOD_MODE_MUL",r.get()=="*");E.toggleDefine("MOD_MODE_ADD",r.get()=="+");E.toggleDefine("MOD_MODE_DIV",r.get()=="/");E.toggleDefine("MOD_SMOOTHSTEP",0);E.toggleDefine("MOD_COORD_TC",i.get()=="Tex Coords");E.toggleDefine("MOD_COORD_MESHXY",i.get()=="Mesh XY");E.toggleDefine("MOD_COORD_MESHXZ",i.get()=="Mesh XZ");E.toggleDefine("MOD_CALC_NORMALS",p.get());E.toggleDefine("MOD_NORMALS_X",b.get()=="X");E.toggleDefine("MOD_NORMALS_Y",b.get()=="Y");E.toggleDefine("MOD_NORMALS_Z",b.get()=="Z");b.setUiAttribs({greyout:!p.get()})}function y(){E.bind();if(l.get()&&!l.get().deleted)E.pushTexture("MOD_texture",l.get());else E.pushTexture("MOD_texture",CGL.Texture.getEmptyTexture(I));O.trigger();E.unbind()}};Ops.Gl.ShaderEffects.VertexDisplacementMap_v4.prototype=new CABLES.Op;CABLES.OPS["ed36e5ad-457b-4ac6-a929-11b66951cb6c"]={f:Ops.Gl.ShaderEffects.VertexDisplacementMap_v4,objName:"Ops.Gl.ShaderEffects.VertexDisplacementMap_v4"};Ops.Anim.LFO=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inValue("Time"),n=e.inValueSelect("Type",["sine","triangle","ramp up","ramp down","block"],"sine"),r=e.inValue("Phase",0),o=e.inValue("Amplitude",1),i=e.outNumber("Result");let l=0;n.onChange=u;u();const s=Math.PI/2;function u(){if(n.get()=="sine")a.onChange=b;if(n.get()=="ramp up")a.onChange=d;if(n.get()=="ramp down")a.onChange=f;if(n.get()=="block")a.onChange=c;if(n.get()=="triangle")a.onChange=p}function m(){return a.get()+r.get()}function c(){let e=m()+.5;l=e%2;if(l<=1)l=-1;else l=1;l*=o.get();i.set(l)}function d(){let e=m()+1;e*=.5;l=e%1;l-=.5;l*=2;l*=o.get();i.set(l)}function f(){let e=m();l=e%1;l-=.5;l*=-2;l*=o.get();i.set(l)}function p(){let e=m();l=e%2;if(l>1)l=2-l;l-=.5;l*=2;l*=o.get();i.set(l)}function b(){let e=m()*Math.PI-s;l=Math.sin(e);l*=o.get();i.set(l)}};Ops.Anim.LFO.prototype=new CABLES.Op;CABLES.OPS["559bb980-78fb-47a7-a199-16f10808b150"]={f:Ops.Anim.LFO,objName:"Ops.Anim.LFO"};Ops.Gl.ClearColor=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTrigger("render"),n=e.outTrigger("trigger"),r=e.inFloatSlider("r",.1),o=e.inFloatSlider("g",.1),i=e.inFloatSlider("b",.1),l=e.inFloatSlider("a",1);r.setUiAttribs({colorPick:true});const s=e.patch.cgl;a.onTriggered=function(){s.gl.clearColor(r.get(),o.get(),i.get(),l.get());s.gl.clear(s.gl.COLOR_BUFFER_BIT|s.gl.DEPTH_BUFFER_BIT);n.trigger()}};Ops.Gl.ClearColor.prototype=new CABLES.Op;CABLES.OPS["19b441eb-9f63-4f35-ba08-b87841517c4d"]={f:Ops.Gl.ClearColor,objName:"Ops.Gl.ClearColor"};Ops.Gl.GradientTexture=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const y=a.inGradient("Gradient"),N=a.inValueSelect("Direction",["X","Y","Radial"],"X"),M=a.inValueBool("Smoothstep",false),j=a.inBool("Step",false),P=a.inBool("Flip",false),R=a.inBool("sRGB",false),L=a.inBool("Oklab",false),w=a.inValueInt("Size",256),D=a.inSwitch("filter",["nearest","linear","mipmap"],"linear"),U=a.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),n=a.inArray("Gradient Array"),t=a.inTriggerButton("Randomize Colors"),B=a.outTexture("Texture"),k=a.outArray("Colors",null,3),V=a.outArray("Colors Pos",null,1);const G=a.patch.cgl;y.setUiAttribs({editShortcut:true});U.onChange=D.onChange=j.onChange=P.onChange=R.onChange=L.onChange=w.onChange=y.onChange=M.onChange=N.onChange=n.onChange=r;y.set('{"keys" : [{"pos":0,"r":0,"g":0,"b":0},{"pos":1,"r":1,"g":1,"b":1}]}');a.onLoaded=r;t.onTriggered=()=>{const e=o();if(e){e.forEach(e=>{e.r=Math.random();e.g=Math.random();e.b=Math.random()});const t=JSON.stringify({keys:e});y.set(t)}};function F(e,t,a){let n=.4122214708*e+.5363325363*t+.0514459929*a;let r=.2119034982*e+.6806995451*t+.1073969566*a;let o=.0883024619*e+.2817188376*t+.6299787005*a;n=Math.cbrt(n);r=Math.cbrt(r);o=Math.cbrt(o);return[n*+.2104542553+r*+.793617785+o*-.0040720468,n*+1.9779984951+r*-2.428592205+o*+.4505937099,n*+.0259040371+r*+.7827717662+o*-.808675766]}function X(e,t,a){let n=e+t*+.3963377774+a*+.2158037573;let r=e+t*-.1055613458+a*-.0638541728;let o=e+t*-.0894841775+a*-1.291485548;n**=3;r**=3;o**=3;let i=n*+4.0767416621+r*-3.3077115913+o*+.2309699292;let l=n*-1.2684380046+r*+2.6097574011+o*-.3413193965;let s=n*-.0041960863+r*-.7034186147+o*+1.707614701;i=CABLES.clamp(i,0,1);l=CABLES.clamp(l,0,1);s=CABLES.clamp(s,0,1);return[i,l,s]}function z(e,t,a){e/=255;const n=.0031308;let r=12.92*e;let o=1.055*Math.pow(e,.41666)-.055;return(e<n?r:o)*255}function r(){const e=o();if(e)i(e)}function o(){let t=null;a.setUiError("nodata",null);a.setUiError("parse",null);if(Array.isArray(n.get())){t=n.get()}else{let e=null;if(!y.get()||y.get()===""){a.setUiError("nodata","gradient no data");return null}try{e=JSON.parse(y.get())}catch(e){a.setUiError("parse","could not parse gradient data")}if(!e||!e.keys){a.setUiError("nodata","gradient no data");return null}t=e.keys}return t}function i(t){let n=Math.round(w.get());if(n<4)n=4;y.setUiAttribs({editShortcut:true,gradEditSmoothstep:M.get(),gradEditStep:j.get(),gradOklab:L.get()});let e=0;let a=0;if(U.get()=="repeat")e=CGL.Texture.WRAP_REPEAT;else if(U.get()=="mirrored repeat")e=CGL.Texture.WRAP_MIRRORED_REPEAT;else if(U.get()=="clamp to edge")e=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(D.get()=="nearest")a=CGL.Texture.FILTER_NEAREST;else if(D.get()=="linear")a=CGL.Texture.FILTER_LINEAR;else if(D.get()=="mipmap")a=CGL.Texture.FILTER_MIPMAP;const r=new CGL.Texture(G);if(N.get()=="X"||N.get()=="Y"){const l=new Uint8Array(n*4);for(let e=0;e<t.length-1;e++){const s=t[e];const u=t[e+1];for(let a=s.pos*n;a<u.pos*n;a++){let e=CABLES.map(a,s.pos*n,u.pos*n,0,1);if(j.get())e=Math.round(e);if(M.get())e=CABLES.smoothStep(e);a=Math.round(a);let t=a;if(P.get())t=n-a-1;if(L.get()){const m=F(s.r,s.g,s.b);const c=m[0];const d=m[1];const f=m[2];const p=F(u.r,u.g,u.b);const b=p[0];const v=p[1];const g=p[2];const h=e*b+(1-e)*c;const x=e*v+(1-e)*d;const O=e*g+(1-e)*f;const I=X(h,x,O);l[t*4+0]=Math.round(I[0]*255);l[t*4+1]=Math.round(I[1]*255);l[t*4+2]=Math.round(I[2]*255)}else{l[t*4+0]=Math.round((e*u.r+(1-e)*s.r)*255);l[t*4+1]=Math.round((e*u.g+(1-e)*s.g)*255);l[t*4+2]=Math.round((e*u.b+(1-e)*s.b)*255)}if(typeof s.a!=="undefined"&&typeof u.a!=="undefined"){const _=Math.round((e*u.a+(1-e)*s.a)*255);l[t*4+3]=_}else{l[t*4+3]=Math.round(255)}}}if(R.get())for(let e=0;e<l.length;e+=4){l[e+0]=z(l[e+0]);l[e+1]=z(l[e+1]);l[e+2]=z(l[e+2])}if(N.get()=="X")r.initFromData(l,n,1,a,e);if(N.get()=="Y")r.initFromData(l,1,n,a,e)}if(N.get()=="Radial"){const l=new Uint8Array(n*n*4);const T=new CABLES.Anim;const A=new CABLES.Anim;const S=new CABLES.Anim;for(let e=0;e<t.length-1;e++){T.setValue(t[e].pos,t[e].r);A.setValue(t[e].pos,t[e].g);S.setValue(t[e].pos,t[e].b)}for(let a=0;a<n;a++){for(let t=0;t<n;t++){const E=a-(n-1)/2;const C=t-(n-1)/2;let e=Math.sqrt(E*E+C*C)/n*2;if(M.get())e=CABLES.smoothStep(e);l[a*4+t*4*n+0]=T.getValue(e)*255;l[a*4+t*4*n+1]=A.getValue(e)*255;l[a*4+t*4*n+2]=S.getValue(e)*255;l[a*4+t*4*n+3]=Math.round(255)}}if(R.get())for(let e=0;e<l.length;e+=4){l[e+0]=z(l[e+0]);l[e+1]=z(l[e+1]);l[e+2]=z(l[e+2])}r.initFromData(l,n,n,a,e)}const o=[];for(let e=0;e<t.length-1;e++){o.push(t[e].r,t[e].g,t[e].b)}const i=[];for(let e=0;e<t.length-1;e++){i.push(t[e].pos)}k.set(o);V.set(i);B.setRef(r)}};Ops.Gl.GradientTexture.prototype=new CABLES.Op;CABLES.OPS["01380a50-2dbb-4465-ae80-86349b0b717a"]={f:Ops.Gl.GradientTexture,objName:"Ops.Gl.GradientTexture"};Ops.Gl.TextureEffects.ColorMap=function(){CABLES.Op.apply(this,arguments);const e=this;const t={colormap_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D gradient;\nUNI float pos;\nUNI float amount;\nUNI float vmin;\nUNI float vmax;\n\n{{CGL.BLENDMODES}}\n\n\nfloat lumi(vec3 color)\n{\n   return vec3(dot(vec3(0.2126,0.7152,0.0722), color)).r;\n}\n\nvoid main()\n{\n    vec4 base=texture(tex,texCoord);\n\n   base=clamp(base,vmin,vmax);\n\n    #ifdef METH_LUMI\n        vec4 color=texture(gradient,vec2(lumi(base.rgb),pos));\n    #endif\n\n    #ifdef METH_CHANNELS\n        vec4 color=vec4(1.0);\n        color.r=texture(gradient,vec2(base.r,pos)).r;\n        color.g=texture(gradient,vec2(base.g,pos)).g;\n        color.b=texture(gradient,vec2(base.b,pos)).b;\n    #endif\n\n//   outColor= vec4(color);\n   outColor=cgl_blend(base,color,amount);\n\n}\n"};let a=e.inTrigger("render");let n=e.outTrigger("trigger");const r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal");const o=e.inValueSlider("Amount",1);let i=e.inTexture("Gradient");let l=e.inSwitch("Method",["Luminance","Channels"],"Luminance");let s=e.inFloatSlider("Min",0);let u=e.inFloatSlider("Max",1);let m=e.inValueSlider("Position",.5);e.setPortGroup("Vertical Position",[s,u,m]);let c=e.patch.cgl;let d=new CGL.Shader(c,e.name);d.define("METH_LUMI");d.setSource(d.getDefaultVertexShader(),t.colormap_frag);var f=new CGL.Uniform(d,"t","tex",0);var f=new CGL.Uniform(d,"t","gradient",1);let p=new CGL.Uniform(d,"f","pos",m);let b=new CGL.Uniform(d,"f","vmin",s);let v=new CGL.Uniform(d,"f","vmax",u);let g=new CGL.Uniform(d,"f","amount",o);CGL.TextureEffect.setupBlending(e,d,r,o);l.onChange=()=>{d.toggleDefine("METH_LUMI",l.get()=="Luminance");d.toggleDefine("METH_CHANNELS",l.get()=="Channels")};a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;if(!i.get())return;c.pushShader(d);c.currentTextureEffect.bind();c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex);c.setTexture(1,i.get().tex);c.currentTextureEffect.finish();c.popShader();n.trigger()}};Ops.Gl.TextureEffects.ColorMap.prototype=new CABLES.Op;CABLES.OPS["58e302d7-4b84-4077-aa13-4f3cf0885205"]={f:Ops.Gl.TextureEffects.ColorMap,objName:"Ops.Gl.TextureEffects.ColorMap"};Ops.Gl.TextureEffects.FastBlur=function(){CABLES.Op.apply(this,arguments);const e=this;const t={blur_frag:"\nUNI sampler2D tex;\n#ifdef USE_MASK\n    UNI sampler2D texMask;\n#endif\nUNI float amount;\nUNI float pass;\n\nIN vec2 texCoord;\n\nUNI float dirX;\nUNI float dirY;\nUNI float width;\nUNI float height;\n\nIN vec2 coord0;\nIN vec2 coord1;\nIN vec2 coord2;\nIN vec2 coord3;\nIN vec2 coord4;\nIN vec2 coord5;\nIN vec2 coord6;\n\n#ifdef HAS_MASK\n    UNI sampler2D imageMask;\n#endif\n\nvoid main()\n{\n    vec4 color = vec4(0.0);\n\n    #ifdef USE_MASK\n        #ifdef MASK_INVERT\n            if(texture(texMask,texCoord).r<0.5)\n            {\n                outColor= texture(tex, texCoord);\n                return;\n            }\n        #endif\n\n        #ifndef MASK_INVERT\n            if(texture(texMask,texCoord).r>0.5)\n            {\n                outColor= texture(tex, texCoord);\n                return;\n            }\n        #endif\n    #endif\n\n    color += texture(tex, coord0) * 0.06927096443792478;\n    color += texture(tex, coord1) * 0.1383328848652136;\n    color += texture(tex, coord2) * 0.21920904690397863;\n    color += texture(tex, coord3) * 0.14637421;\n    color += texture(tex, coord4) * 0.21920904690397863;\n    color += texture(tex, coord5) * 0.1383328848652136;\n    color += texture(tex, coord6) * 0.06927096443795711;\n\n    color.a=1.0;\n    outColor= color;\n}",blur_vert:"\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\nUNI mat4 modelMatrix;\n\nUNI float pass;\nUNI float dirX;\nUNI float dirY;\nUNI float width;\nUNI float height;\n\nOUT vec2 coord0;\nOUT vec2 coord1;\nOUT vec2 coord2;\nOUT vec2 coord3;\nOUT vec2 coord4;\nOUT vec2 coord5;\nOUT vec2 coord6;\n\n// http://dev.theomader.com/gaussian-kernel-calculator/\n// http://rastergrid.com/blog/2010/09/efficient-gaussian-blur-with-linear-sampling/\n\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    {{MODULE_VERTEX_POSITION}}\n\n    vec2 dir=vec2(dirX,dirY);\n    vec2 res=vec2( (1.) / width , (1.) / height )*dir;\n\n    coord3= attrTexCoord;\n\n    coord0= attrTexCoord + (-3.0368997744118595 * res);\n    coord1= attrTexCoord + (-2.089778445362373 * res);\n    coord2= attrTexCoord + (-1.2004366090034069 * res);\n    coord4= attrTexCoord + (1.2004366090034069 * res);\n    coord5= attrTexCoord + (2.089778445362373* res);\n    coord6= attrTexCoord + (3.0368997744118595 * res);\n\n    #ifdef CLAMP\n        coord0=clamp(coord0,0.0,1.0);\n        coord1=clamp(coord1,0.0,1.0);\n        coord2=clamp(coord2,0.0,1.0);\n        coord3=clamp(coord3,0.0,1.0);\n        coord4=clamp(coord4,0.0,1.0);\n        coord5=clamp(coord5,0.0,1.0);\n        coord6=clamp(coord6,0.0,1.0);\n    #endif\n\n    gl_Position = projMatrix * mvMatrix * pos;\n}\n"};const a=e.inTrigger("render"),n=e.outTrigger("trigger"),r=e.inFloat("amount",3),o=e.inBool("Clamp",false),i=e.inBool("Mask Invert",false),l=e.inTexture("Mask");const s=e.patch.cgl;const u=new CGL.Shader(s,"fastblur");u.setSource(t.blur_vert,t.blur_frag);const m=new CGL.Uniform(u,"t","tex",0),c=new CGL.Uniform(u,"f","dirX",0),d=new CGL.Uniform(u,"f","dirY",0),f=new CGL.Uniform(u,"f","width",0),p=new CGL.Uniform(u,"f","height",0),b=new CGL.Uniform(u,"f","pass",0),v=new CGL.Uniform(u,"f","amount",r.get()),g=new CGL.Uniform(u,"t","texMask",1);r.onChange=()=>{v.setValue(r.get())};const h=e.inDropDown("direction",["both","vertical","horizontal"]);let x=0;h.set("both");h.onChange=()=>{if(h.get()=="both")x=0;if(h.get()=="horizontal")x=1;if(h.get()=="vertical")x=2};o.onChange=()=>{u.toggleDefine("CLAMP",o.get())};i.onChange=l.onChange=()=>{u.toggleDefine("USE_MASK",l.isLinked());u.toggleDefine("MASK_INVERT",i.get())};a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;f.setValue(s.currentTextureEffect.getCurrentSourceTexture().width);p.setValue(s.currentTextureEffect.getCurrentSourceTexture().height);const t=r.get();if(l.get())s.setTexture(1,l.get().tex);for(let e=0;e<t;e++){s.pushShader(u);b.setValue(e/t);if(x===0||x==2){s.currentTextureEffect.bind();s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex);c.setValue(0);d.setValue(1+e*e);s.currentTextureEffect.finish()}if(x===0||x==1){s.currentTextureEffect.bind();s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex);c.setValue(1+e*e);d.setValue(0);s.currentTextureEffect.finish()}s.popShader()}n.trigger()}};Ops.Gl.TextureEffects.FastBlur.prototype=new CABLES.Op;CABLES.OPS["720ca148-dcf7-433b-bb1f-edbfb7433c6c"]={f:Ops.Gl.TextureEffects.FastBlur,objName:"Ops.Gl.TextureEffects.FastBlur"};Ops.Gl.Texture_v2=function(){CABLES.Op.apply(this,arguments);const r=this;const e={};const o=r.inUrl("File",[".jpg",".png",".webp",".jpeg",".avif"]),t=r.inSwitch("Filter",["nearest","linear","mipmap"]),a=r.inValueSelect("Wrap",["repeat","mirrored repeat","clamp to edge"],"clamp to edge"),n=r.inSwitch("Anisotropic",["0","1","2","4","8","16"],"0"),i=r.inSwitch("Data Format",["R","RG","RGB","RGBA"],"RGBA"),l=r.inValueBool("Flip",false),s=r.inValueBool("Pre Multiplied Alpha",false),u=r.inValueBool("Active",true),m=r.inBool("Save Memory",true),c=r.outTexture("Texture"),d=r.outNumber("Width"),f=r.outNumber("Height"),p=r.outNumber("Aspect Ratio"),b=r.outNumber("Loaded",false),v=r.outNumber("Loading",false);const g=r.patch.cgl;r.toWorkPortsNeedToBeLinked(c);r.setPortGroup("Size",[d,f]);let h=null;let x=null;let O=null;let I=CGL.Texture.FILTER_MIPMAP;let _=CGL.Texture.WRAP_REPEAT;let T=0;let A=0;s.setUiAttribs({hidePort:true});s.onChange=o.onChange=i.onChange=l.onChange=E;n.onChange=t.onChange=N;a.onChange=M;t.set("mipmap");a.set("repeat");c.set(CGL.Texture.getEmptyTexture(g));u.onChange=function(){if(u.get()){if(h!=o.get()||!O)E();else c.set(O)}else{c.set(CGL.Texture.getEmptyTexture(g));d.set(CGL.Texture.getEmptyTexture(g).width);f.set(CGL.Texture.getEmptyTexture(g).height);if(O)O.delete();r.setUiAttrib({extendTitle:""});O=null}};const S=function(){const e=CGL.Texture.getTempTexture(g);c.set(e)};function E(e){clearTimeout(A);A=setTimeout(function(){y(e)},30)}function C(){if(i.get()=="R")return CGL.Texture.PFORMATSTR_R8UB;if(i.get()=="RG")return CGL.Texture.PFORMATSTR_RG8UB;if(i.get()=="RGB")return CGL.Texture.PFORMATSTR_RGB8UB;return CGL.Texture.PFORMATSTR_RGBA8UB}function y(e){if(!u.get())return;if(x)x=g.patch.loading.finished(x);x=g.patch.loading.start("textureOp",o.get(),r);let t=r.patch.getFilePath(String(o.get()));if(e)t+="?rnd="+CABLES.uuid();if(String(o.get()).indexOf("data:")==0)t=o.get();let a=false;if(h!=o.get())a=true;h=o.get();if(o.get()&&o.get().length>1){b.set(false);v.set(true);const n=o.get();r.setUiAttrib({extendTitle:CABLES.basename(t)});if(a)r.refreshParams();g.patch.loading.addAssetLoadingTask(()=>{r.setUiError("urlerror",null);CGL.Texture.load(g,t,function(e,t){g.checkFrameStarted("texture inittexture");if(o.get()!=n){g.patch.loading.finished(x);x=null;return}if(O)O.delete();if(e){const a=CGL.Texture.getErrorTexture(g);c.setRef(a);r.setUiError("urlerror",'could not load texture: "'+o.get()+'"',2);g.patch.loading.finished(x);x=null;return}d.set(t.width);f.set(t.height);p.set(t.width/t.height);O=t;c.setRef(O);v.set(false);b.set(true);if(m.get())O.image=null;if(x){g.patch.loading.finished(x);x=null}},{anisotropic:T,wrap:_,flip:l.get(),unpackAlpha:s.get(),pixelFormat:C(),filter:I})})}else{g.patch.loading.finished(x);x=null;S()}}function N(){if(t.get()=="nearest")I=CGL.Texture.FILTER_NEAREST;else if(t.get()=="linear")I=CGL.Texture.FILTER_LINEAR;else if(t.get()=="mipmap")I=CGL.Texture.FILTER_MIPMAP;else if(t.get()=="Anisotropic")I=CGL.Texture.FILTER_ANISOTROPIC;n.setUiAttribs({greyout:I!=CGL.Texture.FILTER_MIPMAP});T=parseFloat(n.get());E()}function M(){if(a.get()=="repeat")_=CGL.Texture.WRAP_REPEAT;if(a.get()=="mirrored repeat")_=CGL.Texture.WRAP_MIRRORED_REPEAT;if(a.get()=="clamp to edge")_=CGL.Texture.WRAP_CLAMP_TO_EDGE;E()}r.onFileChanged=function(e){if(o.get()&&o.get().indexOf(e)>-1){c.set(CGL.Texture.getEmptyTexture(r.patch.cgl));c.set(CGL.Texture.getTempTexture(g));y(true)}}};Ops.Gl.Texture_v2.prototype=new CABLES.Op;CABLES.OPS["790f3702-9833-464e-8e37-6f0f813f7e16"]={f:Ops.Gl.Texture_v2,objName:"Ops.Gl.Texture_v2"};Ops.Gl.Meshes.Circle_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTrigger("render"),M=e.inValue("radius",.5),j=e.inValueSlider("innerRadius",0),P=e.inValueInt("segments",40),R=e.inValueSlider("percent",1),L=e.inValue("steps",0),w=e.inValueBool("invertSteps",false),D=e.inSwitch("mapping",["flat","round"]),U=e.inValueBool("Spline",false),n=e.inValueBool("Draw",true),r=e.outTrigger("trigger"),B=e.outObject("geometry",null,"geometry");e.setPortGroup("Size",[M,j]);e.setPortGroup("Display",[R,L,w]);e.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);n.setUiAttribs({title:"Render mesh"});D.set("flat");D.onChange=P.onChange=M.onChange=j.onChange=R.onChange=L.onChange=w.onChange=U.onChange=c;B.ignoreValueSerialize=true;const o=e.patch.cgl;let k=new CGL.Geometry("circle");let V=null;const i=-1;let l=0;let s=null;let G=true;a.onTriggered=u;e.preRender=()=>{u()};a.onLinkChanged=function(){if(!a.isLinked())B.set(null);else B.setRef(k)};function u(){if(G)m();if(!CGL.TextureEffect.checkOpNotInTextureEffect(e))return;s=e.patch.cg.getShader();if(!s)return;l=s.glPrimitive;if(U.get())s.glPrimitive=o.gl.LINE_STRIP;if(n.get())V.render(s);r.trigger();s.glPrimitive=l}function m(){const a=Math.max(3,Math.floor(P.get()));k.clear();const t=[];const n=[];const r=[];const o=[];const i=[];let l=0,s=0;let u=0,m=0;let c=0,d=0;let f=0,p=0;let b=0,v=0;let g=0,h=0;let x=0,O=0;let I=0,_=0;const T=Math.max(0,R.get());const A=[];if(U.get()){let e=0;let t=0;const S=[];for(l=0;l<=a*T;l++){s=360/a*l*CGL.DEG2RAD;I=Math.cos(s)*M.get();_=Math.sin(s)*M.get();O=.5;if(l>0){A.push(e);A.push(t);A.push(0);x=1-(l-1)/a;S.push(x,O)}A.push(I);A.push(_);A.push(0);e=I;t=_}k.setPointVertices(A)}else if(j.get()<=0){for(l=0;l<=a*T;l++){s=360/a*l*CGL.DEG2RAD;I=Math.cos(s)*M.get();_=Math.sin(s)*M.get();if(D.get()=="flat"){x=(Math.cos(s)+1)/2;O=1-(Math.sin(s)+1)/2;g=.5;h=.5}else if(D.get()=="round"){x=1-l/a;O=0;g=x;h=1}t.push([0,0,0],[u,m,0],[I,_,0]);n.push(g,h,c,d,x,O);r.push(0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0);i.push(0,-1,0,0,-1,0,0,-1,0);c=x;d=O;u=I;m=_}k=CGL.Geometry.buildFromFaces(t,"circle");k.vertexNormals=r;k.tangents=o;k.biTangents=i;k.texCoords=n}else{let e=0;const E=a*T;const C=0;for(l=0;l<=E;l++){e++;s=360/a*l*CGL.DEG2RAD;I=Math.cos(s)*M.get();_=Math.sin(s)*M.get();const y=Math.cos(s)*j.get()*M.get();const N=Math.sin(s)*j.get()*M.get();if(D.get()=="round"){x=1-l/a;O=0;g=x;h=1}if(L.get()===0||e%parseInt(L.get(),10)===0&&!w.get()||e%parseInt(L.get(),10)!==0&&w.get()){t.push([I,_,0],[u,m,0],[y,N,0]);t.push([y,N,0],[u,m,0],[f,p,0]);n.push(x,0,c,0,g,1,x,1,c,0,b,1);r.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0);i.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1)}b=g;v=h;c=x;d=O;u=I;m=_;f=y;p=N}k=CGL.Geometry.buildFromFaces(t,"circle");k.vertexNormals=r;k.tangents=o;k.biTangents=i;if(D.get()=="flat")k.mapTexCoords2d();else k.texCoords=n}B.setRef(k);if(k.vertices.length==0)return;if(V)V.dispose();V=null;V=e.patch.cg.createMesh(k);G=false}function c(){G=true}e.onDelete=function(){if(V)V.dispose()}};Ops.Gl.Meshes.Circle_v2.prototype=new CABLES.Op;CABLES.OPS["641eaae4-37cc-4e80-b8db-4be283ed5573"]={f:Ops.Gl.Meshes.Circle_v2,objName:"Ops.Gl.Meshes.Circle_v2"};Ops.Cables.LoadingStatus_v2=function(){CABLES.Op.apply(this,arguments);const n=this;const e={};const t=n.inTrigger("exe"),r=n.inValueBool("PreRender Ops"),o=n.inBool("Play Timeline",true),i=n.outTrigger("Next"),l=n.outBoolNum("Finished Initial Loading",false),s=n.outBoolNum("Loading"),u=n.outNumber("Progress"),m=n.outArray("Jobs"),c=n.outTrigger("Trigger Loading Finished ");const d=n.patch.cgl;const f=n.patch;let p=false;const a=[];let b=true;document.body.classList.add("cables-loading");let v=d.patch.loading.start("loadingStatusInit","loadingStatusInit",n);t.onTriggered=()=>{const e=n.patch.loading.getListJobs();u.set(f.loading.getProgress());let t=e.length===0;const a=!t;if(a){m.set(n.patch.loading.getListJobs())}if(a){if(b){if(r.get())n.patch.preRenderOps();n.patch.timer.setTime(0);if(o.get()){n.patch.timer.play()}else{n.patch.timer.pause()}}b=false;document.body.classList.remove("cables-loading");document.body.classList.add("cables-loaded")}else{p=true;m.set(n.patch.loading.getListJobs());if(f.loading.getProgress()<1){n.patch.timer.setTime(0);n.patch.timer.pause()}}l.set(p);if(s.get()&&t)c.trigger();s.set(a);n.setUiAttribs({loading:a});i.trigger();if(v){d.patch.loading.finished(v);v=null}}};Ops.Cables.LoadingStatus_v2.prototype=new CABLES.Op;CABLES.OPS["e62f7f4c-7436-437e-8451-6bc3c28545f7"]={f:Ops.Cables.LoadingStatus_v2,objName:"Ops.Cables.LoadingStatus_v2"};Ops.Net.WebSocket.WebSocket_v2=function(){CABLES.Op.apply(this,arguments);const a=this;const e={};const t=a.inString("URL"),n=a.outObject("Connection",null,"Websocket"),r=a.outObject("Result"),o=a.outBoolNum("Connected"),i=a.outBoolNum("Valid JSON"),l=a.outTrigger("Received Data"),s=a.outString("Raw Data");let u=null;let m=null;let c="";t.onChange=p;m=setTimeout(f,2e3);t.set();let d=false;function f(){if(!o.get()&&!d){a.log("reconnect websocket...");p()}m=setTimeout(f,2e3)}a.onDelete=function(){if(o.get())u.close();d=false;clearTimeout(m)};function p(){a.setUiError("connection",null);a.setUiError("jsonvalid",null);if(o.get()&&c==t.get())return;if(!t.get()||t.get()===""){a.log("websocket: invalid url ");o.set(false);return}window.WebSocket=window.WebSocket||window.MozWebSocket;if(!window.WebSocket)a.logError("Sorry, but your browser doesn't support WebSockets.");try{d=true;if(u!==null)u.close();u=new WebSocket(t.get())}catch(e){a.log("could not connect to",t.get());d=false;a.log(e)}if(u){u.onerror=function(e){d=false;a.log("ws error");o.set(false);n.set(null);a.setUiError("connection","Error connecting to websocket server",2)};u.onclose=function(e){d=false;a.log("ws close");o.set(false);n.set(null)};u.onopen=function(e){d=false;o.set(true);c=t.get();n.set(u)};u.onmessage=function(t){a.setUiError("jsonvalid",null);s.set(t.data);try{const e=JSON.parse(t.data);r.set(null);r.set(e);i.set(true)}catch(e){a.log(e);a.log("This doesn't look like a valid JSON: ",t.data);a.setUiError("jsonvalid","Received message was not valid JSON",0);i.set(false)}l.trigger()}}}};Ops.Net.WebSocket.WebSocket_v2.prototype=new CABLES.Op;CABLES.OPS["e747dc72-8214-41ca-9aae-9041f20dd6ac"]={f:Ops.Net.WebSocket.WebSocket_v2,objName:"Ops.Net.WebSocket.WebSocket_v2"};Ops.Json.ObjectGetNumber_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inObject("Data"),n=e.inString("Key"),r=e.outNumber("Result"),o=e.outBoolNum("Found");r.ignoreValueSerialize=true;a.ignoreValueSerialize=true;a.onChange=i;n.onChange=function(){if(!n.isLinked())e.setUiAttrib({extendTitle:n.get()});i()};function i(){const e=a.get();if(e){const t=e[n.get()];r.set(parseFloat(t));if(t===undefined)o.set(0);else o.set(1)}else{r.set(0);o.set(0)}}};Ops.Json.ObjectGetNumber_v2.prototype=new CABLES.Op;CABLES.OPS["a7335e79-046e-40da-9e9c-db779b0a5e53"]={f:Ops.Json.ObjectGetNumber_v2,objName:"Ops.Json.ObjectGetNumber_v2"};Ops.Vars.VarGetTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.outTexture("Value");e.varName=e.inValueSelect("Variable",[],"",true);new CABLES.VarGetOpWrapper(e,"object",e.varName,a)};Ops.Vars.VarGetTexture_v2.prototype=new CABLES.Op;CABLES.OPS["5f8ce5fc-9787-45c9-9a83-0eebd2c6de15"]={f:Ops.Vars.VarGetTexture_v2,objName:"Ops.Vars.VarGetTexture_v2"};Ops.Gl.TextureEffects.BrightnessContrast=function(){CABLES.Op.apply(this,arguments);const e=this;const t={brightness_contrast_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float amountbright;\n\nvoid main()\n{\n    vec4 col=vec4(1.0,0.0,0.0,1.0);\n    col=texture(tex,texCoord);\n\n    // apply contrast\n    col.rgb = ((col.rgb - 0.5) * max(amount*2.0, 0.0))+0.5;\n\n    // apply brightness\n    col.rgb *= amountbright*2.0;\n\n    outColor = col;\n}"};const a=e.inTrigger("render"),n=e.inValueSlider("contrast",.5),r=e.inValueSlider("brightness",.5),o=e.outTrigger("trigger");const i=e.patch.cgl;const l=new CGL.Shader(i,"brightnesscontrast");l.setSource(l.getDefaultVertexShader(),t.brightness_contrast_frag);const s=new CGL.Uniform(l,"t","tex",0);const u=new CGL.Uniform(l,"f","amount",n);const m=new CGL.Uniform(l,"f","amountbright",r);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;if(!i.currentTextureEffect.getCurrentSourceTexture())return;if(!CGL.TextureEffect.checkOpInEffect(e))return;i.pushShader(l);i.currentTextureEffect.bind();i.setTexture(0,i.currentTextureEffect.getCurrentSourceTexture().tex);i.currentTextureEffect.finish();i.popShader();o.trigger()}};Ops.Gl.TextureEffects.BrightnessContrast.prototype=new CABLES.Op;CABLES.OPS["54b89199-c594-4dff-bc48-82d6c7a55e8a"]={f:Ops.Gl.TextureEffects.BrightnessContrast,objName:"Ops.Gl.TextureEffects.BrightnessContrast"};Ops.Gl.TextureEffects.Plasma_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={plasma_frag:"#define PI 3.1415926535897932384626433832795\n\nIN vec2 texCoord;\n\nUNI sampler2D tex;\nUNI vec2 size;\nUNI vec2 pos;\nUNI float mul;\nUNI float amount;\nUNI float time;\nUNI float aspect;\n\n#ifdef HAS_TEX_OFFSETMAP\n    UNI sampler2D texOffsetZ;\n    UNI float offMul;\n#endif\n\n#ifdef HAS_TEX_MASK\n    UNI sampler2D texMask;\n#endif\n\n\n{{CGL.BLENDMODES3}}\n\nvoid main()\n{\n    float v = 0.0;\n\n    vec2 s=size;\n    #ifdef FIXASPECT\n        s.y=size.x/aspect;\n    #endif\n\n    vec2 c = texCoord * s - s/2.0;\n\n    c+=pos;\n\n    vec3 offset;\n    #ifdef HAS_TEX_OFFSETMAP\n        vec4 offMap=texture(texOffsetZ,texCoord);\n\n        #ifdef OFFSET_X_R\n            offset.x=offMap.r;\n        #endif\n        #ifdef OFFSET_X_G\n            offset.x=offMap.g;\n        #endif\n        #ifdef OFFSET_X_B\n            offset.x=offMap.b;\n        #endif\n\n        #ifdef OFFSET_Y_R\n            offset.y=offMap.r;\n        #endif\n        #ifdef OFFSET_Y_G\n            offset.y=offMap.g;\n        #endif\n        #ifdef OFFSET_Y_B\n            offset.y=offMap.b;\n        #endif\n\n        #ifdef OFFSET_Z_R\n            offset.z=offMap.r;\n        #endif\n        #ifdef OFFSET_Z_G\n            offset.z=offMap.g;\n        #endif\n        #ifdef OFFSET_Z_B\n            offset.z=offMap.b;\n        #endif\n        offset*=offMul;\n    #endif\n\n    c+=offset.xy;\n    float t=time+offset.z;\n\n    v += sin((c.x+t));\n    v += sin((c.y+t)/2.0);\n    v += sin((c.x+c.y+t)/2.0);\n    c += size/2.0 * vec2(sin(t/3.0), cos(t/2.0));\n\n    v += sin(sqrt(c.x*c.x+c.y*c.y+1.0)+t);\n    v = v/2.0;\n\n    vec3 newColor = vec3(sin(PI*v*mul/4.0), sin(PI*v*mul), cos(PI*v*mul))*.5 + .5;\n    vec4 base=texture(tex,texCoord);\n\n    #ifndef GREY\n       vec4 col=vec4( _blend(base.rgb,newColor) ,1.0);\n    #endif\n    #ifdef GREY\n       vec4 col=vec4( _blend(base.rgb,vec3(newColor.g)) ,1.0);\n    #endif\n\n    float str=1.0;\n    #ifdef HAS_TEX_MASK\n        str=texture(texMask,texCoord).r;\n    #endif\n\n    outColor=cgl_blendPixel(base,col,amount*str);\n}\n\n"};const a=e.inTrigger("render"),n=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=CGL.TextureEffect.AddBlendAlphaMask(e),o=e.inValueSlider("Amount",1),i=e.inValue("Width",20),l=e.inValue("Height",20),s=e.inBool("Aspect",true),u=e.inValue("Mul",1),m=e.inValue("X",0),c=e.inValue("Y",0),d=e.inValue("Time",1),f=e.inValueBool("Greyscale",true),p=e.inTexture("Offset"),b=e.inFloat("Offset Multiply",1),v=e.inSwitch("Offset X",["None","R","G","B"],"None"),g=e.inSwitch("Offset Y",["None","R","G","B"],"None"),h=e.inSwitch("Offset Time",["None","R","G","B"],"R"),x=e.inTexture("Mask"),O=e.outTrigger("trigger");e.setPortGroup("Offset Map",[p,h,g,v,b]);const I=e.patch.cgl;const _=new CGL.Shader(I,e.name);_.setSource(_.getDefaultVertexShader(),t.plasma_frag);CGL.TextureEffect.setupBlending(e,_,n,o,r);const T=new CGL.Uniform(_,"2f","pos",m,c),A=new CGL.Uniform(_,"2f","size",i,l),S=new CGL.Uniform(_,"f","time",d),E=new CGL.Uniform(_,"f","mul",u),C=new CGL.Uniform(_,"f","aspect",1),y=new CGL.Uniform(_,"f","offMul",b),N=new CGL.Uniform(_,"t","tex",0),M=new CGL.Uniform(_,"t","texOffsetZ",1),j=new CGL.Uniform(_,"t","texMask",2),P=new CGL.Uniform(_,"f","amount",o);v.onChange=s.onChange=g.onChange=h.onChange=x.onChange=f.onChange=p.onLinkChanged=R;R();function R(){_.toggleDefine("GREY",f.get());_.toggleDefine("HAS_TEX_OFFSETMAP",p.isLinked());_.toggleDefine("HAS_TEX_MASK",x.isLinked());_.toggleDefine("OFFSET_X_R",v.get()=="R");_.toggleDefine("OFFSET_X_G",v.get()=="G");_.toggleDefine("OFFSET_X_B",v.get()=="B");_.toggleDefine("OFFSET_Y_R",g.get()=="R");_.toggleDefine("OFFSET_Y_G",g.get()=="G");_.toggleDefine("OFFSET_Y_B",g.get()=="B");_.toggleDefine("OFFSET_Z_R",h.get()=="R");_.toggleDefine("OFFSET_Z_G",h.get()=="G");_.toggleDefine("OFFSET_Z_B",h.get()=="B");v.setUiAttribs({greyout:!p.isLinked()});g.setUiAttribs({greyout:!p.isLinked()});h.setUiAttribs({greyout:!p.isLinked()});b.setUiAttribs({greyout:!p.isLinked()});l.setUiAttribs({greyout:s.get()});_.toggleDefine("FIXASPECT",s.get())}a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e,3))return;I.pushShader(_);I.currentTextureEffect.bind();if(s.get())C.setValue(I.currentTextureEffect.aspectRatio);else C.setValue(1);I.setTexture(0,I.currentTextureEffect.getCurrentSourceTexture().tex);if(p.get())I.setTexture(1,p.get().tex);if(x.get())I.setTexture(2,x.get().tex);I.currentTextureEffect.finish();I.popShader();O.trigger()}};Ops.Gl.TextureEffects.Plasma_v2.prototype=new CABLES.Op;CABLES.OPS["89b3bf34-a9a8-4dcf-a304-9dee597fcf48"]={f:Ops.Gl.TextureEffects.Plasma_v2,objName:"Ops.Gl.TextureEffects.Plasma_v2"};Ops.Gl.TextureEffects.Levels=function(){CABLES.Op.apply(this,arguments);const e=this;const t={levels_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float inMin;\nUNI float inMax;\nUNI float midPoint;\nUNI float outMax;\nUNI float outMin;\n\nvoid main()\n{\n    vec3 base=texture(tex,texCoord).rgb;\n    vec3 inputRange = min(max(base - vec3(inMin), vec3(0.0)) / (vec3(inMax) - vec3(inMin)), vec3(outMax));\n\n    inputRange = pow(inputRange, vec3(1.0 / (1.5 - midPoint)));\n\n    outColor.a=1.0;\n    outColor.rgb= mix(vec3(outMin), vec3(1.0), inputRange);\n}"};let a=e.inTrigger("Render");let n=e.inValueSlider("In Min",0);let r=e.inValueSlider("Midpoint",.5);let o=e.inValueSlider("In Max",1);let i=e.inValueSlider("Out Min",0);let l=e.inValueSlider("Out Max",1);let s=e.addOutPort(new CABLES.Port(e,"Next",CABLES.OP_PORT_TYPE_FUNCTION));let u=e.patch.cgl;let m=new CGL.Shader(u,e.name);let c=new CGL.Uniform(m,"f","inMin",n);let d=new CGL.Uniform(m,"f","midPoint",r);let f=new CGL.Uniform(m,"f","inMax",o);let p=new CGL.Uniform(m,"f","outMin",i);let b=new CGL.Uniform(m,"f","outMax",l);m.setSource(m.getDefaultVertexShader(),t.levels_frag);let v=new CGL.Uniform(m,"t","tex",0);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;u.pushShader(m);u.currentTextureEffect.bind();u.setTexture(0,u.currentTextureEffect.getCurrentSourceTexture().tex);u.currentTextureEffect.finish();u.popShader();s.trigger()}};Ops.Gl.TextureEffects.Levels.prototype=new CABLES.Op;CABLES.OPS["42ad6bbe-df17-48c7-89dd-bd7022113897"]={f:Ops.Gl.TextureEffects.Levels,objName:"Ops.Gl.TextureEffects.Levels"};Ops.Gl.TextureEffects.LUTMap=function(){CABLES.Op.apply(this,arguments);const e=this;const t={lut_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D texLut;\nUNI float amount;\n\nvoid main()\n{\n    vec4 textureColor = texture(tex, texCoord);\n    float blueColor = textureColor.b * 63.0;\n    \n    vec2 quad1;\n    quad1.y = floor(floor(blueColor) / 8.0);\n    quad1.x = floor(blueColor) - (quad1.y * 8.0);\n    \n    vec2 quad2;\n    quad2.y = floor(ceil(blueColor) / 8.0);\n    quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n    \n    highp vec2 texPos1;\n    texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\n    texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g);\n    \n    highp vec2 texPos2;\n    texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.r);\n    texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * textureColor.g);\n    \n    vec4 newColor1 = texture(texLut, texPos1);\n    vec4 newColor2 = texture(texLut, texPos2);\n    \n    vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n    outColor= mix(textureColor,vec4(newColor.rgb, textureColor.w),amount);\n}\n"};let a=e.inTrigger("render");let n=e.outTrigger("trigger");let r=e.inTexture("LUT Image");let o=e.inValueSlider("Amount",1);let i=e.patch.cgl;let l=new CGL.Shader(i,e.name);l.setSource(l.getDefaultVertexShader(),t.lut_frag);let s=new CGL.Uniform(l,"t","tex",0);let u=new CGL.Uniform(l,"t","texLut",1);let m=new CGL.Uniform(l,"f","amount",o);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e))return;if(!r.get())return;i.pushShader(l);i.currentTextureEffect.bind();i.setTexture(0,i.currentTextureEffect.getCurrentSourceTexture().tex);i.setTexture(1,r.get().tex);i.currentTextureEffect.finish();i.popShader();n.trigger()}};Ops.Gl.TextureEffects.LUTMap.prototype=new CABLES.Op;CABLES.OPS["baba13d7-1cc2-4ba8-b66d-05425b0e5a75"]={f:Ops.Gl.TextureEffects.LUTMap,objName:"Ops.Gl.TextureEffects.LUTMap"};Ops.Gl.TextureEffects.GammaCorrection_v2=function(){CABLES.Op.apply(this,arguments);const e=this;const t={gamma_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float multiplyAmount;\nUNI float gammaAmount;\n\n{{CGL.BLENDMODES}}\n\nvoid main()\n{\n    vec4 base4=texture(tex,texCoord);\n    vec3 color = base4.rgb * multiplyAmount;\n\n    outColor= vec4(\n            mix(\n                color,\n                vec3(pow(color,vec3(1.0 / gammaAmount))\n            ),amount),\n            base4.a);\n}"};const a=e.inTrigger("render"),n=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),r=e.inValueSlider("Amount",1),o=e.inValue("Multiply texture",1),i=e.inValue("Gamma correction",2.2),l=e.outTrigger("trigger");const s=e.patch.cgl;const u=new CGL.Shader(s,e.name);u.setSource(u.getDefaultVertexShader(),t.gamma_frag);const m=new CGL.Uniform(u,"t","tex",0);const c=new CGL.Uniform(u,"f","amount",r);const d=new CGL.Uniform(u,"f","multiplyAmount",o);const f=new CGL.Uniform(u,"f","gammaAmount",i);CGL.TextureEffect.setupBlending(e,u,n,r);a.onTriggered=function(){if(!CGL.TextureEffect.checkOpInEffect(e,3))return;s.pushShader(u);s.currentTextureEffect.bind();s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex);s.currentTextureEffect.finish();s.popShader();l.trigger()}};Ops.Gl.TextureEffects.GammaCorrection_v2.prototype=new CABLES.Op;CABLES.OPS["18da81c9-bcae-4446-ac58-d3ba31808013"]={f:Ops.Gl.TextureEffects.GammaCorrection_v2,objName:"Ops.Gl.TextureEffects.GammaCorrection_v2"};Ops.Json.ObjectKeys=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inObject("Object"),n=e.outNumber("Num Keys"),r=e.outArray("Keys");a.onChange=function(){let e=a.get();if(!e){n.set(0);r.set([]);return}let t=Object.keys(e);n.set(t.length);r.set(t)}};Ops.Json.ObjectKeys.prototype=new CABLES.Op;CABLES.OPS["83b4d148-8cb3-4a45-8824-957eeaf02e22"]={f:Ops.Json.ObjectKeys,objName:"Ops.Json.ObjectKeys"};Ops.Json.ObjectValues=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inObject("Object"),n=e.outArray("Values"),r=e.outNumber("Num values");a.onChange=()=>{const e=a.get();if(!e){r.set(0);n.set([]);return}const t=Object.values(e);r.set(t.length);n.set(t)}};Ops.Json.ObjectValues.prototype=new CABLES.Op;CABLES.OPS["32ff73f5-7947-42b0-83fa-e079af7beb5c"]={f:Ops.Json.ObjectValues,objName:"Ops.Json.ObjectValues"};Ops.Array.ArrayTrigger=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inTriggerButton("Exec"),n=e.inArray("Array"),r=e.outTrigger("Trigger out"),o=e.outArray("Result");a.onTriggered=function(){const e=n.get();if(!e)o.set(null);o.set(n.get());r.trigger()}};Ops.Array.ArrayTrigger.prototype=new CABLES.Op;CABLES.OPS["c1d7a502-5d91-4528-9833-3bf27a546d25"]={f:Ops.Array.ArrayTrigger,objName:"Ops.Array.ArrayTrigger"};Ops.Array.ArrayChangedTrigger=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inArray("Array"),n=e.outTrigger("Changed Trigger"),r=e.outArray("New Array");a.onChange=function(){r.setRef(a.get());n.trigger()}};Ops.Array.ArrayChangedTrigger.prototype=new CABLES.Op;CABLES.OPS["bb55860d-a186-4e39-9542-8d21185e7e12"]={f:Ops.Array.ArrayChangedTrigger,objName:"Ops.Array.ArrayChangedTrigger"};Ops.User.paramuno.ArrayToChannel=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};let a=e.inArray("In");let n=e.outValue("Result1"),r=e.outValue("Result2"),o=e.outValue("Result3"),i=e.outValue("Result4"),l=e.outValue("Result5"),s=e.outValue("Result6"),u=e.outValue("Result7"),m=e.outValue("Result8"),c=e.outValue("Result9"),d=e.outValue("Result10"),f=e.outValue("Result11"),p=e.outValue("Result12"),b=e.outValue("Result13"),v=e.outValue("Result14"),g=e.outValue("Result15"),h=e.outValue("Result16"),x=e.outValue("Result17"),O=e.outValue("Result18"),I=e.outValue("Result19");a.onChange=function(){const e=a.get();if(!e)return;n.set(e[1]);r.set(e[2]);o.set(e[3]);i.set(e[4]);l.set(e[5]);s.set(e[6]);u.set(e[7]);m.set(e[8]);c.set(e[9]);d.set(e[10]);f.set(e[11]);p.set(e[12]);b.set(e[13]);v.set(e[14]);g.set(e[15]);h.set(e[16]);x.set(e[17]);O.set(e[18]);I.set(e[19])}};Ops.User.paramuno.ArrayToChannel.prototype=new CABLES.Op;CABLES.OPS["a33ecb7a-2ad1-46e7-9dcb-f949498a2e6e"]={f:Ops.User.paramuno.ArrayToChannel,objName:"Ops.User.paramuno.ArrayToChannel"};Ops.User.paramuno.ArrayPreviousStore=function(){CABLES.Op.apply(this,arguments);const e=this;const t={};const a=e.inArray("Array"),n=e.outArray("Result");let r=[];a.onChange=()=>{n.setRef(r);r=a.get()}};Ops.User.paramuno.ArrayPreviousStore.prototype=new CABLES.Op;CABLES.OPS["0d060162-fe92-41e1-bb5d-271e932c903b"]={f:Ops.User.paramuno.ArrayPreviousStore,objName:"Ops.User.paramuno.ArrayPreviousStore"};window.addEventListener("load",function(e){CABLES.jsLoaded=new Event("CABLES.jsLoaded");document.dispatchEvent(CABLES.jsLoaded)});(()=>{"use strict";CGL.ShaderModifier=class{constructor(e,t,a){this._cgl=e,this._name=t,this._origShaders={},this._uniforms=[],this._structUniforms=[],this._definesToggled={},this._defines={},this._mods=[],this._textures=[],this._boundShader=null,this._changedDefines=!0,this._changedUniforms=!0,this._modulesChanged=!1,this.needsTexturePush=!1,this._lastShader=null,this._attributes=[],1==this._cgl.glVersion&&(this._cgl.enableExtension("OES_texture_float"),this._cgl.enableExtension("OES_texture_float_linear"),this._cgl.enableExtension("OES_texture_half_float"),this._cgl.enableExtension("OES_texture_half_float_linear"))}bind(t,a){const n=t||this._cgl.getShader();if(!n)return;this._boundShader=this._origShaders[n.id];let r=!1;if(this._boundShader&&this._lastShader!=this._boundShader.shader&&(this._boundShader.shader.hasModule(this._mods[0].id)||(r=!0)),(r||!this._boundShader||n.lastCompile!=this._boundShader.lastCompile||this._modulesChanged||n._needsRecompile)&&(this._boundShader&&this._boundShader.shader.dispose(),n._needsRecompile&&n.compile(),this._boundShader=this._origShaders[n.id]={lastCompile:n.lastCompile,orig:n,shader:n.copy()},this._addModulesToShader(this._boundShader.shader),this._updateDefinesShader(this._boundShader.shader),this._updateUniformsShader(this._boundShader.shader)),this._boundShader.wireframe=n.wireframe,this._changedDefines&&this._updateDefines(),this._changedUniforms&&this._updateUniforms(),!1!==a&&this._cgl.pushShader(this._boundShader.shader),this._boundShader.shader.copyUniformValues(this._boundShader.orig),this.needsTexturePush){for(let e=0;e<this._textures.length;e+=1){const a=this._textures[e][0],n=this._textures[e][1],r=this._textures[e][2];if(this._getUniform(a)){const t=this.getPrefixedName(a),o=this._boundShader.shader.getUniform(t);o&&this._boundShader.shader.pushTexture(o,n,r)}}this.needsTexturePush=!1,this._textures.length=0}return this._modulesChanged=!1,this._boundShader.shader.fromMod=this,this.onBind&&this.onBind(this._boundShader.shader),this._boundShader.shader}unbind(e){this._boundShader&&!1!==e&&this._cgl.popShader(),this._boundShader=null}_addModulesToShader(t){let a;this._mods.length>1&&(a=this._mods[0]);for(let e=0;e<this._mods.length;e++)t.addModule(this._mods[e],a)}_removeModulesFromShader(e){for(const t in this._origShaders)this._origShaders[t].shader.removeModule(e)}addModule(e){this._mods.push(e),this._modulesChanged=!0}removeModule(t){const a=[];let n=!1;for(let e=0;e<this._mods.length;e++)this._mods[e].title==t&&(n=!0,this._removeModulesFromShader(this._mods[e]),a.push(e));for(let e=a.length-1;e>=0;e-=1)this._mods.splice(a[e],1);this._modulesChanged=!0}_updateUniformsShader(n){for(let e=0;e<this._uniforms.length;e++){const r=this._uniforms[e],t=this.getPrefixedName(r.name);if(!n.hasUniform(t)&&!r.structName){let e=null;"both"===r.shaderType?(e=n.addUniformBoth(r.type,t,r.v1,r.v2,r.v3,r.v4),e.comment="mod: "+this._name):"frag"===r.shaderType?(e=n.addUniformFrag(r.type,t,r.v1,r.v2,r.v3,r.v4),e.comment="mod: "+this._name):"vert"===r.shaderType&&(e=n.addUniformVert(r.type,t,r.v1,r.v2,r.v3,r.v4),e.comment="mod: "+this._name)}}for(let a=0;a<this._structUniforms.length;a+=1){const r=this._structUniforms[a];let e=r.uniformName,t=r.structName;const o=r.members;e=this.getPrefixedName(r.uniformName),t=this.getPrefixedName(r.structName),"frag"===r.shaderType&&n.addUniformStructFrag(t,e,o),"vert"===r.shaderType&&n.addUniformStructVert(t,e,o),"both"===r.shaderType&&n.addUniformStructBoth(t,e,o)}}_updateUniforms(){for(const e in this._origShaders)this._updateUniformsShader(this._origShaders[e].shader);this._changedUniforms=!1}_setUniformValue(e,t,a){const n=e.getUniform(t);n&&n.setValue(a)}setUniformValue(e,t){if(!this._getUniform(e))return;const a=this.getPrefixedName(e);for(const e in this._origShaders)this._setUniformValue(this._origShaders[e].shader,a,t)}hasUniform(e){return this._getUniform(e)}_getUniform(t){for(let e=0;e<this._uniforms.length;e++){if(this._uniforms[e].name==t)return this._uniforms[e];if(this._uniforms[e].structName&&this._uniforms[e].propertyName==t)return this._uniforms[e]}return!1}_getStructUniform(t){for(let e=0;e<this._structUniforms.length;e+=1)if(this._structUniforms[e].uniformName===t)return this._structUniforms[e];return null}_isStructUniform(t){for(let e=0;e<this._uniforms.length;e++){if(this._uniforms[e].name==t)return!1;if(this._uniforms[e].structName&&this._uniforms[e].propertyName==t)return!0}return!1}addUniform(t,a,n,r,o,i,l,s,u,m){if(!this._getUniform(a)){let e="both";m&&(e=m),this._uniforms.push({type:t,name:a,v1:n,v2:r,v3:o,v4:i,structUniformName:l,structName:s,propertyName:u,shaderType:e}),this._changedUniforms=!0}}addUniformFrag(e,t,a,n,r,o){this.addUniform(e,t,a,n,r,o,null,null,null,"frag"),this._changedUniforms=!0}addUniformVert(e,t,a,n,r,o){this.addUniform(e,t,a,n,r,o,null,null,null,"vert"),this._changedUniforms=!0}addUniformBoth(e,t,a,n,r,o){this.addUniform(e,t,a,n,r,o,null,null,null,"both"),this._changedUniforms=!0}addUniformStruct(t,a,n,r){for(let e=0;e<n.length;e+=1){const o=n[e];"2i"!==o.type&&"i"!==o.type&&"3i"!==o.type||"both"!==r||console.error("Adding an integer struct member to both shaders can potentially error. Please use different structs for each shader. Error occured in struct:",t," with member:",o.name," of type:",o.type,"."),this._getUniform(a+"."+o.name)||this.addUniform(o.type,a+"."+o.name,o.v1,o.v2,o.v3,o.v4,a,t,o.name,r)}this._getStructUniform(a)||this._structUniforms.push({structName:t,uniformName:a,members:n,shaderType:r})}addUniformStructVert(e,t,a){this.addUniformStruct(e,t,a,"vert")}addUniformStructFrag(e,t,a){this.addUniformStruct(e,t,a,"frag")}addUniformStructBoth(e,t,a){this.addUniformStruct(e,t,a,"both")}addAttribute(t){for(let e=0;e<this._attributes.length;e++)if(this._attributes[e].name==t.name&&this._attributes[e].nameFrag==t.nameFrag)return;this._attributes.push(t)}pushTexture(e,t,a){if(!t)throw new Error("no texture given to texturestack");this._textures.push([e,t,a]),this.needsTexturePush=!0}_removeUniformFromShader(e,t){t.hasUniform(e)&&t.removeUniform(e)}removeUniform(t){if(this._getUniform(t)){for(let e=this._uniforms.length-1;e>=0;e-=1){const a=t;if(this._uniforms[e].name==t&&!this._uniforms[e].structName){for(const t in this._origShaders)this._removeUniformFromShader(this.getPrefixedName(a),this._origShaders[t].shader);this._uniforms.splice(e,1)}}this._changedUniforms=!0}}removeUniformStruct(t){if(this._getStructUniform(t)){for(let e=this._structUniforms.length-1;e>=0;e-=1){const a=this._structUniforms[e];if(a.uniformName===t){for(const t in this._origShaders)for(let e=0;e<a.members.length;e+=1){const n=a.members[e];this._removeUniformFromShader(this.getPrefixedName(n.name),this._origShaders[t].shader)}this._structUniforms.splice(e,1)}}this._changedUniforms=!0}}getPrefixedName(e){const t=this._mods[0].group;if(void 0!==t)return 0==e.indexOf("MOD_")&&(e="mod"+t+"_"+(e=e.substr("MOD_".length))),e}_updateDefinesShader(e){for(const t in this._defines){const a=this.getPrefixedName(t);null!==this._defines[t]&&void 0!==this._defines[t]?e.define(a,this._defines[t]):e.removeDefine(a)}for(const t in this._definesToggled){const a=this.getPrefixedName(t);e.toggleDefine(a,this._definesToggled[t])}}_updateDefines(){for(const e in this._origShaders)this._updateDefinesShader(this._origShaders[e].shader);this._changedDefines=!1}define(e,t){void 0===t&&(t=!0),this._defines[e]=t,this._changedDefines=!0}removeDefine(e){this._defines[e]=null,this._changedDefines=!0}hasDefine(e){return null!==this._defines[e]&&void 0!==this._defines[e]}toggleDefine(e,t){this._changedDefines=!0,this._definesToggled[e]=t}currentShader(){return this._boundShader?this._boundShader.shader:null}dispose(){}},((this.CGL=this.CGL||{}).COREMODULES=this.CGL.COREMODULES||{}).Shadermodifier={}.Shadermodifier})();(()=>{"use strict";function e(e,t){return this.type=t.type||"point",this.color=t.color||[1,1,1],this.specular=t.specular||[0,0,0],this.position=t.position||null,this.intensity=t.intensity||1,this.radius=t.radius||1,this.falloff=t.falloff||1,this.spotExponent=t.spotExponent||1,this.cosConeAngleInner=t.cosConeAngleInner||0,this.cosConeAngle=t.cosConeAngle||0,this.conePointAt=t.conePointAt||[0,0,0],this.castShadow=t.castShadow||!1,this.nearFar=t.nearFar||[0,0],this.normalOffset=t.normalOffset||0,this.shadowBias=t.shadowBias||0,this.shadowStrength=t.shadowStrength||0,this.lightMatrix=null,this.shadowMap=null,this.shadowMapDepth=null,this.shadowCubeMap=null,this._cgl=e,this.state={isUpdating:!1},this._framebuffer=null,this._shaderShadowMap={shader:null,uniforms:{lightPosition:null,nearFar:null},matrices:{modelMatrix:mat4.create(),viewMatrix:mat4.create(),projMatrix:mat4.create(),biasMatrix:mat4.fromValues(.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1)},vectors:{lookAt:vec3.create(),camPos:vec3.create(),up:vec3.fromValues(0,1,0)}},this._effectBlur=null,this._shaderBlur={shader:null,uniforms:{XY:null}},this._cubemap=null,this}e.prototype.getModifiableParameters=function(){return["color","specular","position","intensity","radius","falloff","spotExponent","cosConeAngleInner","cosConeAngle","conePointAt"]},e.prototype.createProjectionMatrix=e.prototype.updateProjectionMatrix=function(e,t,a,n){"spot"===this.type?mat4.perspective(this._shaderShadowMap.matrices.projMatrix,-2*CGL.DEG2RAD*n,1,t,a):"directional"===this.type?mat4.ortho(this._shaderShadowMap.matrices.projMatrix,-1*e,e,-1*e,e,t,a):"point"===this.type&&(mat4.perspective(this._shaderShadowMap.matrices.projMatrix,90*CGL.DEG2RAD,1,t,a),this.nearFar=[t,a])},e.prototype.hasFramebuffer=function(){return!!this._framebuffer},e.prototype.hasShadowMapShader=function(){return!!this._shaderShadowMap.shader},e.prototype.hasBlurShader=function(){return!!this._shaderBlur.shader},e.prototype.hasBlurEffect=function(){return!!this._effectBlur},e.prototype.getShadowMap=function(){return"point"===this.type?null:this._framebuffer.getTextureColor()},e.prototype.getShadowMapDepth=function(){return"point"===this.type?null:this._framebuffer.getTextureDepth()},e.prototype.createFramebuffer=function(e,t,a){this.state.isUpdating=!0;const n=e||512,r=t||512;if("point"===this.type)return this.hasCubemap()?this._cubemap.setSize(n,r):this._cubemap=new CGL.CubemapFramebuffer(this._cgl,n,r,{name:"point light shadowmap"}),this._cubemap.setCamPos(this.position),this._cubemap.setMatrices(this._shaderShadowMap.matrices.modelMatrix,this._shaderShadowMap.matrices.viewMatrix,this._shaderShadowMap.matrices.projMatrix),void(this.state.isUpdating=!1);this.hasFramebuffer()&&this._framebuffer.delete(),a&&a.filter&&(a.isFloatingPointTexture=a.filter!==CGL.Texture.FILTER_MIPMAP),1==this._cgl.glVersion?this._framebuffer=new CGL.Framebuffer(this._cgl,n,r,{isFloatingPointTexture:!0,filter:CGL.Texture.FILTER_LINEAR,wrap:CGL.Texture.WRAP_CLAMP_TO_EDGE,...a}):this._framebuffer=new CGL.Framebuffer2(this._cgl,n,r,{isFloatingPointTexture:!0,filter:CGL.Texture.FILTER_LINEAR,wrap:CGL.Texture.WRAP_CLAMP_TO_EDGE,...a}),this.state.isUpdating=!1},e.prototype.hasCubemap=function(){return!!this._cubemap},e.prototype.setFramebufferSize=function(e){this.hasFramebuffer()&&this._framebuffer.setSize(e,e)},e.prototype.createShadowMapShader=function(e,t){if(this.hasShadowMapShader())return;this.state.isUpdating=!0,this._shaderShadowMap.shader=new CGL.Shader(this._cgl,"shadowPass"+this.type.charAt(0).toUpperCase()+this.type.slice(1)),this._shaderShadowMap.shader.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);const a=e||this.getShadowPassVertexShader(),n=t||this.getShadowPassFragmentShader();this._shaderShadowMap.shader.setSource(a,n),this._shaderShadowMap.shader.offScreenPass=!0,"point"===this.type&&(this._shaderShadowMap.uniforms.lightPosition=new CGL.Uniform(this._shaderShadowMap.shader,"3f","inLightPosition",vec3.create()),this._shaderShadowMap.uniforms.nearFar=new CGL.Uniform(this._shaderShadowMap.shader,"2f","inNearFar",vec2.create())),1==this._cgl.glVersion&&(this._cgl.enableExtension("OES_texture_float"),this._cgl.enableExtension("OES_texture_float_linear"),this._cgl.enableExtension("OES_texture_half_float"),this._cgl.enableExtension("OES_texture_half_float_linear"),this._shaderShadowMap.shader.enableExtension("GL_OES_standard_derivatives"),this._shaderShadowMap.shader.enableExtension("GL_OES_texture_float"),this._shaderShadowMap.shader.enableExtension("GL_OES_texture_float_linear"),this._shaderShadowMap.shader.enableExtension("GL_OES_texture_half_float"),this._shaderShadowMap.shader.enableExtension("GL_OES_texture_half_float_linear")),this.state.isUpdating=!1},e.prototype.createBlurEffect=function(e){"point"!==this.type&&(this.state.isUpdating=!0,this.hasBlurEffect()&&this._effectBlur.delete(),this._effectBlur=new CGL.TextureEffect(this._cgl,{isFloatingPointTexture:!0,filter:CGL.Texture.FILTER_LINEAR,wrap:CGL.Texture.WRAP_CLAMP_TO_EDGE,...e}),this.state.isUpdating=!1)},e.prototype.createBlurShader=function(e,t){if(this.hasBlurShader())return;if("point"===this.type)return;this.state.isUpdating=!0;const a=e||this.getBlurPassVertexShader(),n=t||this.getBlurPassFragmentShader();this._shaderBlur.shader=new CGL.Shader(this._cgl,"blurPass"+this.type.charAt(0).toUpperCase()+this.type.slice(1)),this._shaderBlur.shader.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]),this._shaderBlur.shader.setSource(a,n),this._shaderBlur.uniforms.XY=new CGL.Uniform(this._shaderBlur.shader,"2f","inXY",vec2.create()),this._shaderBlur.shader.offScreenPass=!0,this.state.isUpdating=!1},e.prototype.renderPasses=function(e,t,a){this.state.isUpdating||this._cgl.frameStore.shadowPass||(this._cgl.pushCullFace(!0),this._cgl.pushCullFaceFacing(this._cgl.gl.FRONT),this._cgl.gl.enable(this._cgl.gl.POLYGON_OFFSET_FILL),this._cgl.gl.polygonOffset(e,e),this._cgl.frameStore.renderOffscreen=!0,this._cgl.frameStore.shadowPass=!0,this._cgl.pushBlend(!1),this._cgl.gl.colorMask(!0,!0,"point"===this.type,"point"===this.type),this.renderShadowPass(a),this._cgl.gl.cullFace(this._cgl.gl.BACK),this._cgl.gl.disable(this._cgl.gl.CULL_FACE),this._cgl.gl.disable(this._cgl.gl.POLYGON_OFFSET_FILL),"point"!==this.type&&this.renderBlurPass(t),this._cgl.gl.colorMask(!0,!0,!0,!0),this._cgl.popBlend(),this._cgl.popCullFaceFacing(),this._cgl.popCullFace(),this._cgl.frameStore.shadowPass=!1,this._cgl.frameStore.renderOffscreen=!1,"point"!==this.type?(this.shadowMap=this._framebuffer.getTextureColor(),this.shadowMapDepth=this._framebuffer.getTextureDepth()):(this.shadowMap=null,this.shadowMapDepth=null))},e.prototype.renderShadowPass=function(t){if(!this.state.isUpdating){if("point"===this.type){this._shaderShadowMap.uniforms.nearFar.setValue(this.nearFar),this._shaderShadowMap.uniforms.lightPosition.setValue(this.position),this._cubemap.setCamPos(this.position),this._cubemap.setMatrices(this._shaderShadowMap.matrices.modelMatrix,this._shaderShadowMap.matrices.viewMatrix,this._shaderShadowMap.matrices.projMatrix),this._cgl.pushShader(this._shaderShadowMap.shader),this._cubemap.renderStart();for(let e=0;e<6;e+=1)this._cubemap.renderStartCubemapFace(e),t&&t(),this._cubemap.renderEndCubemapFace();return this._cubemap.renderEnd(),this._cgl.popShader(),void(this.shadowCubeMap=this._cubemap.getTextureColor())}this._cgl.pushShader(this._shaderShadowMap.shader),this._cgl.pushModelMatrix(),this._cgl.pushViewMatrix(),this._cgl.pushPMatrix(),this._framebuffer.renderStart(this._cgl),mat4.copy(this._cgl.mMatrix,this._shaderShadowMap.matrices.modelMatrix),vec3.set(this._shaderShadowMap.vectors.camPos,this.position[0],this.position[1],this.position[2]),"spot"===this.type&&vec3.set(this._shaderShadowMap.vectors.lookAt,this.conePointAt[0],this.conePointAt[1],this.conePointAt[2]),mat4.lookAt(this._cgl.vMatrix,this._shaderShadowMap.vectors.camPos,this._shaderShadowMap.vectors.lookAt,this._shaderShadowMap.vectors.up),mat4.copy(this._cgl.pMatrix,this._shaderShadowMap.matrices.projMatrix),this.lightMatrix||(this.lightMatrix=mat4.create()),mat4.mul(this.lightMatrix,this._cgl.pMatrix,this._cgl.vMatrix),mat4.mul(this.lightMatrix,this._cgl.mMatrix,this.lightMatrix),mat4.mul(this.lightMatrix,this._shaderShadowMap.matrices.biasMatrix,this.lightMatrix),this._cgl.gl.clearColor(1,1,1,1),this._cgl.gl.clear(this._cgl.gl.DEPTH_BUFFER_BIT|this._cgl.gl.COLOR_BUFFER_BIT),t&&t(),this._framebuffer.renderEnd(this._cgl),this._cgl.popPMatrix(),this._cgl.popModelMatrix(),this._cgl.popViewMatrix(),this._cgl.popShader()}},e.prototype.renderBlurPass=function(e){this.state.isUpdating||(this._cgl.pushShader(this._shaderBlur.shader),this._effectBlur.setSourceTexture(this._framebuffer.getTextureColor()),this._effectBlur.startEffect(),this._effectBlur.bind(),this._cgl.setTexture(0,this._effectBlur.getCurrentSourceTexture().tex),this._shaderBlur.uniforms.XY.setValue([e,0]),this._effectBlur.finish(),this._effectBlur.bind(),this._cgl.setTexture(0,this._effectBlur.getCurrentSourceTexture().tex),this._shaderBlur.uniforms.XY.setValue([0,e]),this._effectBlur.finish(),this._effectBlur.endEffect(),this._cgl.popShader())},e.prototype.getShadowPassVertexShader=function(){return`\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN float attrVertIndex;\nIN vec3 attrTangent;\nIN vec3 attrBiTangent;\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\n\nOUT vec2 texCoord;\nOUT vec3 norm;\n\n{{MODULES_HEAD}}\n\n${"point"===this.type?"OUT vec3 modelPos;":""}\nvoid main() {\n    texCoord=attrTexCoord;\n    texCoord.y = 1. - texCoord.y;\n    norm=attrVertNormal;\n    vec4 pos = vec4(vPosition, 1.0);\n    mat4 mMatrix=modelMatrix;\n    vec3 tangent = attrTangent;\n    vec3 bitangent = attrBiTangent;\n\n    {{MODULE_VERTEX_POSITION}}\n\n    mat4 mvMatrix=viewMatrix * mMatrix;\n    vec4 vPos = projMatrix * mvMatrix * pos;\n    ${"point"===this.type?"modelPos = (mMatrix * pos).xyz;":""}\n    gl_Position = vPos;\n}\n`},e.prototype.getShadowPassFragmentShader=function(){return`\n   {{MODULES_HEAD}}\n   ${"point"===this.type?"IN vec3 modelPos;":""}\n   ${"point"===this.type?"UNI vec3 inLightPosition;":""}\n   ${"point"===this.type?"UNI vec2 inNearFar;":""}\n\n    IN vec2 texCoord;\n\n    void main() {\n        {{MODULE_BEGIN_FRAG}}\n        vec4 col = vec4(1.);\n\n\n        outColor = vec4(1.);\n\n        {{MODULE_COLOR}}\n\n        ${"point"===this.type?"vec3 fromLightToFrag = (modelPos - inLightPosition);":""}\n\n\n        ${"point"===this.type?"float depth = (length(fromLightToFrag) - inNearFar.x) / (inNearFar.y - inNearFar.x);":"float depth = gl_FragCoord.z;"}\n\n        float dx = dFdx(depth); // for biasing depth-per-pixel\n        float dy = dFdy(depth); // for biasing depth-per-pixel\n\n        float clampedDerivative = clamp(dot(dx, dx) + dot(dy, dy), 0., 1.);\n        float moment2 = dot(depth, depth) + 0.25 * clampedDerivative;\n\n        outColor.x = depth;\n        outColor.y = moment2;\n        outColor.z = depth;\n    }\n`},e.prototype.getBlurPassVertexShader=function(){return"point"===this.type?"":"\n\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\n\nOUT vec2 texCoord;\nOUT vec2 coord0;\nOUT vec2 coord1;\nOUT vec2 coord2;\nOUT vec2 coord3;\nOUT vec2 coord4;\nOUT vec2 coord5;\nOUT vec2 coord6;\n\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\nUNI mat4 modelMatrix;\n\nUNI vec2 inXY;\n\nvoid main() {\n    texCoord=attrTexCoord;\n\n    vec4 pos = vec4(vPosition,  1.0);\n\n    {{MODULE_VERTEX_POSITION}}\n\n    coord3 = attrTexCoord;\n\n\n    coord0 = attrTexCoord + (-3.0368997744118595 * inXY);\n    coord0 = clamp(coord0, 0., 1.);\n    coord1 = attrTexCoord + (-2.089778445362373 * inXY);\n    coord1 = clamp(coord1, 0., 1.);\n    coord2 = attrTexCoord + (-1.2004366090034069 * inXY);\n    coord2 = clamp(coord2, 0., 1.);\n    coord4 = attrTexCoord + (1.2004366090034069 * inXY);\n    coord4 = clamp(coord4, 0., 1.);\n    coord5 = attrTexCoord + (2.089778445362373* inXY);\n    coord5 = clamp(coord5, 0., 1.);\n    coord6 = attrTexCoord + (3.0368997744118595 * inXY);\n    coord6 = clamp(coord6, 0., 1.);\n\n    gl_Position = projMatrix * mvMatrix * pos;\n}\n    "},e.prototype.getBlurPassFragmentShader=function(){return"point"===this.type?"":"\nUNI sampler2D tex;\n\nIN vec2 coord0;\nIN vec2 coord1;\nIN vec2 coord2;\nIN vec2 coord3;\nIN vec2 coord4;\nIN vec2 coord5;\nIN vec2 coord6;\n\nvoid main() {\n\n    vec4 color = vec4(0.0);\n\n\n    color.xyz += texture(tex, coord0).xyz * 0.06927096443792478;  // 1/64\n    color.xyz += texture(tex, coord1).xyz * 0.1383328848652136;   // 6/64\n    color.xyz += texture(tex, coord2).xyz * 0.21920904690397863;  // 15/64\n    color.xyz += texture(tex, coord3).xyz * 0.14637421;           // 20/64\n    color.xyz += texture(tex, coord4).xyz * 0.21920904690397863;  // 15/64\n    color.xyz += texture(tex, coord5).xyz * 0.1383328848652136;   // 6/64\n    color.xyz += texture(tex, coord6).xyz * 0.06927096443795711;  // 1/64\n\n    color.a = 1.;\n\n    outColor = color;\n}\n    "},CGL.Light=e,((this.CGL=this.CGL||{}).COREMODULES=this.CGL.COREMODULES||{}).Light={}.Light})();(()=>{"use strict";const e={float32Concat:function(e,t){e instanceof Float32Array||(e=new Float32Array(e)),t instanceof Float32Array||(t=new Float32Array(t));const a=new Float32Array(e.length+t.length);return a.set(e),a.set(t,e.length),a}};Math.randomSeed=1,Math.seededRandom=function(e,t){return 0===Math.randomSeed&&(Math.randomSeed=999*Math.random()),e=e||1,t=t||0,Math.randomSeed=(9301*Math.randomSeed+49297)%233280,t+Math.randomSeed/233280*(e-t)},e.arrayWriteToEnd=function(t,e){for(let e=1;e<t.length;e++)t[e-1]=t[e];t[t.length-1]=e},e.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},String.prototype.endl=function(){return this+"\n"},String.prototype.startsWith=function(e){return 0===this.indexOf(e)},String.prototype.endsWith=String.prototype.endsWith||function(e){return this.match(e+"$")==e},window.performance=window.performance||{offset:Date.now(),now:function(){return Date.now()-this.offset}};class a{constructor(e){this._logs=[],this.initiator=e}stack(e){console.info("["+this.initiator+"] ",e),console.log((new Error).stack)}groupCollapsed(e){console.groupCollapsed("["+this.initiator+"] "+e)}table(e){console.table(e)}groupEnd(){console.groupEnd()}error(e){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"error",arguments)}info(e){console.error("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"info",arguments)}warn(e){console.warn("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"warn",arguments)}verbose(){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"verbose",arguments)}log(e){(CABLES.UI&&CABLES.UI.logFilter.shouldPrint(this.initiator,...arguments)||!CABLES.logSilent)&&console.log("["+this.initiator+"]",...arguments),window.gui&&window.gui.emitEvent("coreLogEvent",this.initiator,"log",arguments)}userInteraction(e){}}const m=function(e,t={}){if(!e)throw new Error("no cgl");this._log=new a("cgl_texture"),this._cgl=e,this.pixelFormat=t.pixelFormat||m.PFORMATSTR_RGBA8UB,this.tex=this._cgl.gl.createTexture(),this.id=CABLES.uuid(),this.width=0,this.height=0,this.loading=!1,this.flip=!0,this.flipped=!1,this.shadowMap=!1,this.deleted=!1,this.image=null,this.anisotropic=0,this.filter=m.FILTER_NEAREST,this.wrap=m.WRAP_CLAMP_TO_EDGE,this.texTarget=this._cgl.gl.TEXTURE_2D,t&&t.type&&(this.texTarget=t.type),this.textureType=m.TYPE_DEFAULT,this.unpackAlpha=!0,this._fromData=!0,this.name="unknown",this._glDataType=-1,this._glInternalFormat=-1,this._glDataFormat=-1,t?(this.name=t.name||this.name,t.isDepthTexture&&(this.textureType=m.TYPE_DEPTH),!0===t.isFloatingPointTexture&&(this.textureType=m.TYPE_FLOAT),"textureType"in t&&(this.textureType=t.textureType),"filter"in t&&(this.filter=t.filter),"wrap"in t&&(this.wrap=t.wrap),"unpackAlpha"in t&&(this.unpackAlpha=t.unpackAlpha),"flip"in t&&(this.flip=t.flip),"shadowMap"in t&&(this.shadowMap=t.shadowMap),"anisotropic"in t&&(this.anisotropic=t.anisotropic)):t={},!t.pixelFormat&&t.isFloatingPointTexture&&(this.pixelFormat=m.PFORMATSTR_RGBA32F),this.textureType==m.TYPE_DEPTH&&(this.pixelFormat=m.PFORMATSTR_DEPTH),t.width||(t.width=8),t.height||(t.height=8),this._cgl.profileData.profileTextureNew++,this.setFormat(m.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this._cgl.profileData.addHeavyEvent("texture created",this.name,t.width+"x"+t.height),this.setSize(t.width,t.height),this.getInfoOneLine()};m.prototype.isFloatingPoint=function(){m.isPixelFormatFloat(this.pixelFormat)},m.prototype.compareSettings=function(e){return!!e&&e.width==this.width&&e.height==this.height&&e.filter==this.filter&&e.wrap==this.wrap&&e.textureType==this.textureType&&e.unpackAlpha==this.unpackAlpha&&e.anisotropic==this.anisotropic&&e.shadowMap==this.shadowMap&&e.texTarget==this.texTarget&&e.flip==this.flip},m.prototype.clone=function(){const e=new m(this._cgl,{name:this.name,filter:this.filter,wrap:this.wrap,textureType:this.textureType,pixelFormat:this.pixelFormat,unpackAlpha:this.unpackAlpha,flip:this.flip,width:this.width,height:this.height});return this._cgl.profileData.addHeavyEvent("texture created",this.name,this.width+"x"+this.height),this.compareSettings(e)||(this._log.error("Cloned texture settings do not compare!"),this._log.error(this),this._log.error(e)),e},m.prototype.setFormat=function(e){this.pixelFormat=e.pixelFormat,this._glDataFormat=e.glDataFormat,this._glInternalFormat=e.glInternalFormat,this._glDataType=e.glDataType},m.setUpGlPixelFormat=function(e,t){const a={};t||(console.log("no pixelformatstr!"),console.log((new Error).stack),t=m.PFORMATSTR_RGBA8UB),a.pixelFormatBase=t,e.glUseHalfFloatTex&&(t==m.PFORMATSTR_RGBA32F&&(t=m.PFORMATSTR_RGBA16F),t==m.PFORMATSTR_RG32F&&(t=m.PFORMATSTR_RG16F),t==m.PFORMATSTR_R32F&&(t=m.PFORMATSTR_R16F)),a.pixelFormat=t,a.glDataType=e.gl.UNSIGNED_BYTE,a.glInternalFormat=e.gl.RGBA8,a.glDataFormat=e.gl.RGBA;let n=e.gl.FLOAT;if(1==e.glVersion&&(a.glInternalFormat=e.gl.RGBA,t==m.PFORMATSTR_RGBA16F||t==m.PFORMATSTR_RG16F||t==m.PFORMATSTR_R16F)){const t=e.enableExtension("OES_texture_half_float");if(!t)throw new Error("no half float texture extension");n=t.HALF_FLOAT_OES}return t==m.PFORMATSTR_RGBA8UB||(t==m.PFORMATSTR_RGB565?(a.glInternalFormat=e.gl.RGB565,a.glDataFormat=e.gl.RGB):t==m.PFORMATSTR_R8UB?(a.glInternalFormat=e.gl.R8,a.glDataFormat=e.gl.RED):t==m.PFORMATSTR_RG8UB?(a.glInternalFormat=e.gl.RG8,a.glDataFormat=e.gl.RG):t==m.PFORMATSTR_RGB8UB?(a.glInternalFormat=e.gl.RGB8,a.glDataFormat=e.gl.RGB):t==m.PFORMATSTR_R32F?(a.glInternalFormat=e.gl.R32F,a.glDataFormat=e.gl.RED,a.glDataType=n):t==m.PFORMATSTR_R16F?(a.glInternalFormat=e.gl.R16F,a.glDataType=n,a.glDataFormat=e.gl.RED):t==m.PFORMATSTR_RG16F?(a.glInternalFormat=e.gl.RG16F,a.glDataType=n,a.glDataFormat=e.gl.RG):t==m.PFORMATSTR_RGBA16F?(1==e.glVersion?a.glInternalFormat=e.gl.RGBA:a.glInternalFormat=e.gl.RGBA16F,a.glDataType=n):t==m.PFORMATSTR_R11FG11FB10F?(a.glInternalFormat=e.gl.R11F_G11F_B10F,a.glDataType=n,a.glDataFormat=e.gl.RGB):t==m.PFORMATSTR_RGBA32F?(1==e.glVersion?a.glInternalFormat=e.gl.RGBA:a.glInternalFormat=e.gl.RGBA32F,a.glDataType=n):t==m.PFORMATSTR_DEPTH?1==e.glVersion?(a.glInternalFormat=e.gl.DEPTH_COMPONENT,a.glDataType=e.gl.UNSIGNED_SHORT,a.glDataFormat=e.gl.DEPTH_COMPONENT):(a.glInternalFormat=e.gl.DEPTH_COMPONENT32F,a.glDataType=e.gl.FLOAT,a.glDataFormat=e.gl.DEPTH_COMPONENT):console.log("unknown pixelformat ",t)),(t.indexOf("32bit")||t==m.PFORMATSTR_R11FG11FB10F)&&(2==e.glVersion&&e.enableExtension("EXT_color_buffer_float"),2==e.glVersion&&e.enableExtension("EXT_float_blend"),e.enableExtension("OES_texture_float_linear")),t.indexOf("16bit")&&(e.enableExtension("EXT_color_buffer_half_float"),e.enableExtension("OES_texture_float_linear")),a.glDataType&&a.glInternalFormat&&a.glDataFormat||console.log("pixelformat wrong ?!",t,a.glDataType,a.glInternalFormat,a.glDataFormat,this),a},m.prototype.setSize=function(e,t){this._cgl.aborted||((e!=e||e<=0||!e)&&(e=8),(t!=t||t<=0||!t)&&(t=8),(e>this._cgl.maxTexSize||t>this._cgl.maxTexSize)&&this._log.error("texture size too big! "+e+"x"+t+" / max: "+this._cgl.maxTexSize),e=Math.min(e,this._cgl.maxTexSize),t=Math.min(t,this._cgl.maxTexSize),e=Math.floor(e),t=Math.floor(t),(this.width!=e||this.height!=t)&&(this.width=e,this.height=t,this.deleted=!1,this.setFormat(m.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this.shortInfoString=this.getInfoOneLine(),this._cgl.gl.bindTexture(this.texTarget,this.tex),this._cgl.profileData.profileTextureResize++,this._cgl.gl.texImage2D(this.texTarget,0,this._glInternalFormat,e,t,0,this._glDataFormat,this._glDataType,null),this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null)))},m.prototype.initFromData=function(e,t,a,n,r){if(this.filter=n,this.wrap=r,null==n&&(this.filter=m.FILTER_LINEAR),null==r&&(this.wrap=m.WRAP_CLAMP_TO_EDGE),this.width=t,this.height=a,this._fromData=!0,this.deleted=!1,this.height>this._cgl.maxTexSize||this.width>this._cgl.maxTexSize){const e=CGL.Texture.getTempTexture(this._cgl);return this.width=e.width,this.height=e.height,this.tex=e.tex,void this._log.error("[cgl_texture] texture size to big!!!",this.width,this.height,this._cgl.maxTexSize)}this.flip&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,this.flip),this._cgl.gl.bindTexture(this.texTarget,this.tex),this.setFormat(m.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this._cgl.gl.texImage2D(this.texTarget,0,this._glInternalFormat,t,a,0,this._glDataFormat,this._glDataType,e),this._setFilter(),this.updateMipMap(),this.flip&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,!1),this._cgl.gl.bindTexture(this.texTarget,null)},m.prototype.updateMipMap=function(){2!=this._cgl.glVersion&&!this.isPowerOfTwo()||this.filter!=m.FILTER_MIPMAP||(this._cgl.gl.generateMipmap(this.texTarget),this._cgl.profileData.profileGenMipMap++)},m.prototype.initTexture=function(e,t){if(this._cgl.printError("before initTexture"),this._cgl.checkFrameStarted("texture inittexture"),this._fromData=!1,this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),e.width&&(this.width=e.width),e.height&&(this.height=e.height),t&&(this.filter=t),e.height>this._cgl.maxTexSize||e.width>this._cgl.maxTexSize){const t=CGL.Texture.getTempTexture(this._cgl);return this.width=t.width,this.height=t.height,this.tex=t.tex,void this._log.error("[cgl_texture] texture size to big!!!",e.width,e.height,this._cgl.maxTexSize)}this._cgl.gl.bindTexture(this.texTarget,this.tex),this.deleted=!1,this.flipped=!this.flip,this.flipped&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,this.flipped),this.setFormat(m.setUpGlPixelFormat(this._cgl,this.pixelFormat)),this._cgl.gl.texImage2D(this.texTarget,0,this._glInternalFormat,this._glDataFormat,this._glDataType,e),this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null),this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.flipped&&this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL,!1),this.getInfoOneLine(),this._cgl.printError("initTexture")},m.prototype.delete=function(){this.loading||(this.deleted=!0,this.width=0,this.height=0,this._cgl.profileData.profileTextureDelete++,this._cgl.gl.deleteTexture(this.tex),this.image=null,this.tex=null)},m.prototype.isPowerOfTwo=function(){return m.isPowerOfTwo(this.width)&&m.isPowerOfTwo(this.height)},m.prototype.printInfo=function(){console.log(this.getInfo())},m.prototype.getInfoReadable=function(){const t=this.getInfo();let a="";t.name=t.name.substr(0,t.name.indexOf("?rnd="));for(const e in t)a+="* "+e+":  **"+t[e]+"**\n";return a},m.prototype.getInfoOneLine=function(){let e=this.width+"x"+this.height;return e+=" ",e+=this.pixelFormat,this.filter===CGL.Texture.FILTER_NEAREST&&(e+=" nearest"),this.filter===CGL.Texture.FILTER_LINEAR&&(e+=" linear"),this.filter===CGL.Texture.FILTER_MIPMAP&&(e+=" mipmap"),this.wrap===CGL.Texture.WRAP_CLAMP_TO_EDGE&&(e+=" clamp"),this.wrap===CGL.Texture.WRAP_REPEAT&&(e+=" repeat"),this.wrap===CGL.Texture.WRAP_MIRRORED_REPEAT&&(e+=" repeatmir"),this.shortInfoString=e,e},m.prototype.getInfoOneLineShort=function(){let e=this.width+"x"+this.height;return e+=" ",e+=this.pixelFormat,this.shortInfoString=e,e},m.prototype.getInfo=function(){return m.getTexInfo(this)},m.prototype._setFilter=function(){if(this._cgl.printError("before _setFilter"),this._fromData||this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),this.shadowMap&&(this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D,this._cgl.gl.TEXTURE_COMPARE_MODE,this._cgl.gl.COMPARE_REF_TO_TEXTURE),this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D,this._cgl.gl.TEXTURE_COMPARE_FUNC,this._cgl.gl.LEQUAL)),this.textureType==m.TYPE_FLOAT&&this.filter==m.FILTER_MIPMAP&&(this.filter=m.FILTER_LINEAR,this._log.stack("texture: HDR and mipmap filtering at the same time is not possible")),1!=this._cgl.glVersion||this.isPowerOfTwo()){if(this.wrap==m.WRAP_CLAMP_TO_EDGE?(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE)):this.wrap==m.WRAP_REPEAT?(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.REPEAT)):this.wrap==m.WRAP_MIRRORED_REPEAT&&(this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.MIRRORED_REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.MIRRORED_REPEAT)),this.filter==m.FILTER_NEAREST)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST);else if(this.filter==m.FILTER_LINEAR)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR);else{if(this.filter!=m.FILTER_MIPMAP)throw this._log.log("unknown texture filter!",this.filter),new Error("unknown texture filter!"+this.filter);this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR_MIPMAP_LINEAR)}if(this.anisotropic){const t=this._cgl.enableExtension("EXT_texture_filter_anisotropic");if(t){const e=this._cgl.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this._cgl.gl.texParameterf(this._cgl.gl.TEXTURE_2D,t.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e,this.anisotropic))}}}else this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE),this.filter=m.FILTER_NEAREST,this.wrap=m.WRAP_CLAMP_TO_EDGE;this.getInfoOneLine(),this._cgl.printError("_setFilter")},m.load=function(t,a,n,e){if(!a)return n({error:!0});let r=null;t.patch.loading.existByName(a)||(r=t.patch.loading.start("texture",a));const o=new m(t);return o.name=a,t.patch.isEditorMode()&&gui.jobs().start({id:"loadtexture"+r,title:"loading texture "+CABLES.basename(a)}),o.image=new Image,o.image.crossOrigin="anonymous",o.loading=!0,e&&e.hasOwnProperty("filter")&&(o.filter=e.filter),e&&e.hasOwnProperty("flip")&&(o.flip=e.flip),e&&e.hasOwnProperty("wrap")&&(o.wrap=e.wrap),e&&e.hasOwnProperty("anisotropic")&&(o.anisotropic=e.anisotropic),e&&e.hasOwnProperty("unpackAlpha")&&(o.unpackAlpha=e.unpackAlpha),e&&e.hasOwnProperty("pixelFormat")&&(o.pixelFormat=e.pixelFormat),o.image.onabort=o.image.onerror=e=>{console.warn("[cgl.texture.load] error loading texture",a,e),o.loading=!1,r&&t.patch.loading.finished(r),n&&n({error:!0},o),t.patch.isEditorMode()&&gui.jobs().finish("loadtexture"+r)},o.image.onload=function(e){t.addNextFrameOnceCallback(()=>{o.initTexture(o.image),r&&t.patch.loading.finished(r),o.loading=!1,t.patch.isEditorMode()&&gui.jobs().finish("loadtexture"+r),n&&n(null,o)})},o.image.src=a,o},m.getTempTexture=function(e){return e||console.error("[getTempTexture] no cgl!"),e.tempTexture||(e.tempTexture=m.getTemporaryTexture(e,256,m.FILTER_LINEAR,m.REPEAT)),e.tempTexture},m.getErrorTexture=function(e){return e||console.error("[getTempTexture] no cgl!"),e.errorTexture||(e.errorTexture=m.getTemporaryTexture(e,256,m.FILTER_LINEAR,m.REPEAT,1,.2,.2)),e.errorTexture},m.getEmptyTexture=function(e,t){if(t)return m.getEmptyTextureFloat(e);if(e||console.error("[getEmptyTexture] no cgl!"),e.tempTextureEmpty)return e.tempTextureEmpty;e.tempTextureEmpty=new m(e,{name:"emptyTexture"});const a=new Uint8Array(256).fill(0);for(let e=0;e<256;e+=4)a[e+3]=0;return e.tempTextureEmpty.initFromData(a,8,8,m.FILTER_NEAREST,m.WRAP_REPEAT),e.tempTextureEmpty},m.getEmptyTextureFloat=function(e){if(e||console.error("[getEmptyTextureFloat] no cgl!"),e.tempTextureEmptyFloat)return e.tempTextureEmptyFloat;e.tempTextureEmptyFloat=new m(e,{name:"emptyTexture",isFloatingPointTexture:!0});const t=new Float32Array(256).fill(1);for(let e=0;e<256;e+=4)t[e+3]=0;return e.tempTextureEmptyFloat.initFromData(t,8,8,m.FILTER_NEAREST,m.WRAP_REPEAT),e.tempTextureEmptyFloat},m.getRandomTexture=function(e){if(e||console.error("[getRandomTexture] no cgl!"),e.randomTexture)return e.randomTexture;const t=new Uint8Array(262144);for(let e=0;e<65536;e++)t[4*e+0]=255*Math.random(),t[4*e+1]=255*Math.random(),t[4*e+2]=255*Math.random(),t[4*e+3]=255;return e.randomTexture=new m(e),e.randomTexture.initFromData(t,256,256,m.FILTER_NEAREST,m.WRAP_REPEAT),e.randomTexture},m.getRandomFloatTexture=function(e){if(e||console.error("[getRandomTexture] no cgl!"),e.getRandomFloatTexture)return e.getRandomFloatTexture;const t=new Float32Array(262144);for(let e=0;e<65536;e++)t[4*e+0]=2*(Math.random()-.5),t[4*e+1]=2*(Math.random()-.5),t[4*e+2]=2*(Math.random()-.5),t[4*e+3]=1;return e.getRandomFloatTexture=new m(e,{isFloatingPointTexture:!0}),e.getRandomFloatTexture.initFromData(t,256,256,m.FILTER_NEAREST,m.WRAP_REPEAT),e.getRandomFloatTexture},m.getBlackTexture=function(e){if(e||this._log.error("[getBlackTexture] no cgl!"),e.blackTexture)return e.blackTexture;const t=new Uint8Array(256);for(let e=0;e<64;e++)t[4*e+0]=t[4*e+1]=t[4*e+2]=0,t[4*e+3]=255;return e.blackTexture=new m(e),e.blackTexture.initFromData(t,8,8,m.FILTER_NEAREST,m.WRAP_REPEAT),e.blackTexture},m.getEmptyCubemapTexture=function(t){const a=[t.gl.TEXTURE_CUBE_MAP_POSITIVE_X,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,t.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,t.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z],n=t.gl.createTexture(),r=t.gl.TEXTURE_CUBE_MAP,e=m.FILTER_NEAREST,o=m.WRAP_CLAMP_TO_EDGE;t.profileData.profileTextureNew++,t.gl.bindTexture(r,n),t.profileData.profileTextureResize++;for(let e=0;e<6;e+=1){const n=new Uint8Array(256);t.gl.texImage2D(a[e],0,t.gl.RGBA,8,8,0,t.gl.RGBA,t.gl.UNSIGNED_BYTE,n),t.gl.texParameteri(r,t.gl.TEXTURE_MAG_FILTER,t.gl.NEAREST),t.gl.texParameteri(r,t.gl.TEXTURE_MIN_FILTER,t.gl.NEAREST),t.gl.texParameteri(r,t.gl.TEXTURE_WRAP_S,t.gl.CLAMP_TO_EDGE),t.gl.texParameteri(r,t.gl.TEXTURE_WRAP_T,t.gl.CLAMP_TO_EDGE)}return t.gl.bindTexture(r,null),{id:CABLES.uuid(),tex:n,cubemap:n,width:8,height:8,filter:e,wrap:o,unpackAlpha:!0,flip:!0,_fromData:!0,name:"emptyCubemapTexture",anisotropic:0}},m.getTempGradientTexture=function(e){if(e||console.error("[getTempGradientTexture] no cgl!"),e.tempTextureGradient)return e.tempTextureGradient;const t=new m(e),a=256,n=new Uint8Array(262144);for(let t=0;t<a;t++)for(let e=0;e<a;e++)n[4*(e+t*a)+0]=n[4*(e+t*a)+1]=n[4*(e+t*a)+2]=255-t,n[4*(e+t*a)+3]=255;return t.initFromData(n,a,a,m.FILTER_NEAREST,m.WRAP_REPEAT),e.tempTextureGradient=t,t},m.getTemporaryTexture=function(e,a,t,n,r,o,i){void 0===r&&(r=1),void 0===o&&(o=1),void 0===i&&(i=1);const l=new m(e),s=[];for(let t=0;t<a;t++)for(let e=0;e<a;e++)(e+t)%64<32?(s.push((200+t/a*25+e/a*25)*r),s.push((200+t/a*25+e/a*25)*o),s.push((200+t/a*25+e/a*25)*i)):(s.push((40+t/a*25+e/a*25)*r),s.push((40+t/a*25+e/a*25)*o),s.push((40+t/a*25+e/a*25)*i)),s.push(255);const u=new Uint8Array(s);return l.initFromData(u,a,a,t,n),l},m.createFromImage=function(e,t,a){const n=new m(e,a=a||{});return n.flip=!1,n.image=t,n.width=t.width,n.height=t.height,a.hasOwnProperty("wrap")&&(n.wrap=a.wrap),n.initTexture(t,a.filter),n},m.fromImage=function(e,t,a,n){console.error("deprecated texture from image...");const r=new m(e);return r.flip=!1,a&&(r.filter=a),n&&(r.wrap=n),r.image=t,r.initTexture(t),r},m.isPowerOfTwo=function(e){return 1==e||2==e||4==e||8==e||16==e||32==e||64==e||128==e||256==e||512==e||1024==e||2048==e||4096==e||8192==e||16384==e},m.getTexInfo=function(e){const t={};t.name=e.name,t["power of two"]=e.isPowerOfTwo(),t.size=e.width+" x "+e.height;let a=e.texTarget;return e.texTarget==e._cgl.gl.TEXTURE_2D&&(a="TEXTURE_2D"),t.target=a,t.unpackAlpha=e.unpackAlpha,e.cubemap&&(t.cubemap=!0),e.textureType==m.TYPE_FLOAT&&(t.textureType="TYPE_FLOAT"),e.textureType==m.TYPE_HALF_FLOAT?t.textureType="TYPE_HALF_FLOAT":e.textureType==m.TYPE_DEPTH?t.textureType="TYPE_DEPTH":e.textureType==m.TYPE_DEFAULT?t.textureType="TYPE_DEFAULT":t.textureType="UNKNOWN "+this.textureType,e.wrap==m.WRAP_CLAMP_TO_EDGE?t.wrap="CLAMP_TO_EDGE":e.wrap==m.WRAP_REPEAT?t.wrap="WRAP_REPEAT":e.wrap==m.WRAP_MIRRORED_REPEAT?t.wrap="WRAP_MIRRORED_REPEAT":t.wrap="UNKNOWN",e.filter==m.FILTER_NEAREST?t.filter="FILTER_NEAREST":e.filter==m.FILTER_LINEAR?t.filter="FILTER_LINEAR":e.filter==m.FILTER_MIPMAP?t.filter="FILTER_MIPMAP":t.filter="UNKNOWN",t.pixelFormat=e.pixelFormat||"unknown",t},m.FILTER_NEAREST=0,m.FILTER_LINEAR=1,m.FILTER_MIPMAP=2,m.WRAP_REPEAT=0,m.WRAP_MIRRORED_REPEAT=1,m.WRAP_CLAMP_TO_EDGE=2,m.TYPE_DEFAULT=0,m.TYPE_DEPTH=1,m.TYPE_FLOAT=2,m.PFORMATSTR_RGB565="RGB 5/6/5bit ubyte",m.PFORMATSTR_R8UB="R 8bit ubyte",m.PFORMATSTR_RG8UB="RG 8bit ubyte",m.PFORMATSTR_RGB8UB="RGB 8bit ubyte",m.PFORMATSTR_RGBA8UB="RGBA 8bit ubyte",m.PFORMATSTR_R11FG11FB10F="RGB 11/11/10bit float",m.PFORMATSTR_R16F="R 16bit float",m.PFORMATSTR_RG16F="RG 16bit float",m.PFORMATSTR_RGB16F="RGB 16bit float",m.PFORMATSTR_RGBA16F="RGBA 16bit float",m.PFORMATSTR_R32F="R 32bit float",m.PFORMATSTR_RGBA32F="RGBA 32bit float",m.PFORMATSTR_DEPTH="DEPTH",m.PIXELFORMATS=[m.PFORMATSTR_RGB565,m.PFORMATSTR_R8UB,m.PFORMATSTR_RG8UB,m.PFORMATSTR_RGB8UB,m.PFORMATSTR_RGBA8UB,m.PFORMATSTR_R11FG11FB10F,m.PFORMATSTR_R16F,m.PFORMATSTR_RG16F,m.PFORMATSTR_RGBA16F,m.PFORMATSTR_R32F,m.PFORMATSTR_RGBA32F],m.isPixelFormatFloat=e=>(e||"").indexOf("float")>-1,m.isPixelFormatHalfFloat=e=>(e||"").indexOf("float")>-1&&(e||"").indexOf("16bit")>-1;class r{constructor(e,t){this.id=CABLES.uuid(),this.name=t.name||"unknown cubemap texture",this._cgl=e,this.textureType=m.TYPE_DEFAULT,this._options=t,this._cubemapFaces=[this._cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_X,this._cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,this._cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,this._cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,this._cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,this._cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z],this.cubemap=this.tex=this._cgl.gl.createTexture(),this.texTarget=this._cgl.gl.TEXTURE_CUBE_MAP,this.width=8,this.height=8,this.filter=t.filter||CGL.Texture.FILTER_NEAREST,this.wrap=t.wrap||CGL.Texture.WRAP_CLAMP_TO_EDGE,this.unpackAlpha=t.unpackAlpha||!0,this.flip=t.flip||!0,t.hasOwnProperty("pixelFormat")||(t.isFloatingPointTexture?t.pixelFormat=m.PFORMATSTR_RGBA32F:t.pixelFormat=m.PFORMATSTR_RGBA8UB),this.pixelFormat=t.pixelFormat,this._cgl.profileData.profileTextureNew++,this.setSize(t.width,t.height)}getInfo(){return{pixelFormat:this.pixelFormat}}setSize(e,t){this.delete(),this.cubemap=this.tex=this._cgl.gl.createTexture(),this._cgl.checkFrameStarted("cubemap corelib setsize"),(e!=e||e<=0||!e)&&(e=8),(t!=t||t<=0||!t)&&(t=8),(e>this._cgl.maxTexSize||t>this._cgl.maxTexSize)&&console.error("texture size too big! "+e+"x"+t+" / max: "+this._cgl.maxTexSize),e=Math.min(e,this._cgl.maxTexSize),t=Math.min(t,this._cgl.maxTexSize),e=Math.floor(e),t=Math.floor(t),this.width=e,this.height=t,this._cgl.gl.bindTexture(this.texTarget,this.tex),this._cgl.profileData.profileTextureResize++;const a=m.setUpGlPixelFormat(this._cgl,this._options.pixelFormat);this.pixelFormat=a.pixelFormat,CGL.Texture.isPixelFormatHalfFloat(a.pixelFormat)?(this._cgl.enableExtension("EXT_color_buffer_half_float"),this._cgl.enableExtension("OES_texture_float_linear")||(this.filter=m.FILTER_NEAREST)):CGL.Texture.isPixelFormatFloat(a.pixelFormat)&&(this._cgl.enableExtension("OES_texture_float_linear")||(console.log("no linear pixelformat,using nearest"),this.filter=m.FILTER_NEAREST));for(let e=0;e<6;e++)this._cgl.gl.texImage2D(this._cubemapFaces[e],0,a.glInternalFormat,this.width,this.height,0,a.glDataFormat,a.glDataType,null);this._setFilter(),this.updateMipMap(),this._cgl.gl.bindTexture(this.texTarget,null)}_setFilter(){if(this._cgl.checkFrameStarted("cubemap corelib"),this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.unpackAlpha),CGL.Texture.isPixelFormatFloat(this.pixelFormat)&&this.filter==CGL.Texture.FILTER_MIPMAP&&(console.log("texture: HDR and mipmap filtering at the same time is not possible"),this.filter=CGL.Texture.FILTER_LINEAR),1!=this._cgl.glVersion||m.isPowerOfTwo()){if(this.wrap==CGL.Texture.WRAP_CLAMP_TO_EDGE)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE);else if(this.wrap==CGL.Texture.WRAP_REPEAT)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.REPEAT);else{if(this.wrap!=CGL.Texture.WRAP_MIRRORED_REPEAT)throw new Error("[CubemapTexture] unknown texture filter!"+this.filter);this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.MIRRORED_REPEAT),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.MIRRORED_REPEAT)}if(this.filter==CGL.Texture.FILTER_NEAREST)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST);else if(this.filter==CGL.Texture.FILTER_LINEAR)this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR);else{if(this.filter!=CGL.Texture.FILTER_MIPMAP)throw new Error("[CubemapTexture] unknown texture filter!"+this.filter);this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.LINEAR),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.LINEAR_MIPMAP_LINEAR)}}else this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MAG_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_MIN_FILTER,this._cgl.gl.NEAREST),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_S,this._cgl.gl.CLAMP_TO_EDGE),this._cgl.gl.texParameteri(this.texTarget,this._cgl.gl.TEXTURE_WRAP_T,this._cgl.gl.CLAMP_TO_EDGE),this.filter=CGL.Texture.FILTER_NEAREST,this.wrap=CGL.Texture.WRAP_CLAMP_TO_EDGE}updateMipMap(){this.filter==CGL.Texture.FILTER_MIPMAP&&(this._cgl.gl.bindTexture(this.texTarget,this.tex),this._cgl.gl.generateMipmap(this.texTarget),this._cgl.profileData.profileGenMipMap++)}delete(){this._cgl.gl.deleteTexture(this.tex)}}CGL.CubemapFramebuffer=class{constructor(e,t,a,n){this._cgl=e,this.width=t||8,this.height=a||8,this._cubemapProperties=[{face:this._cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_X,lookAt:vec3.fromValues(1,0,0),up:vec3.fromValues(0,-1,0)},{face:this._cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,lookAt:vec3.fromValues(-1,0,0),up:vec3.fromValues(0,-1,0)},{face:this._cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,lookAt:vec3.fromValues(0,1,0),up:vec3.fromValues(0,0,1)},{face:this._cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,lookAt:vec3.fromValues(0,-1,0),up:vec3.fromValues(0,0,-1)},{face:this._cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,lookAt:vec3.fromValues(0,0,1),up:vec3.fromValues(0,-1,0)},{face:this._cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,lookAt:vec3.fromValues(0,0,-1),up:vec3.fromValues(0,-1,0)}],this._lookAtTemp=vec3.fromValues(0,0,0),this.camPos=vec3.fromValues(0,0,0),this._modelMatrix=mat4.create(),this._viewMatrix=mat4.create(),this._projectionMatrix=mat4.perspective(mat4.create(),90*CGL.DEG2RAD,1,.1,1e3),this._depthRenderbuffer=null,this._framebuffer=null,this._depthbuffer=null,this._textureDepth=null,this._options=n||{},this.name=this._options.name||"unknown cubemapframebuffer",this._options.hasOwnProperty("numRenderBuffers")||(this._options.numRenderBuffers=1),this._options.hasOwnProperty("depth")||(this._options.depth=!0),this._options.hasOwnProperty("clear")||(this._options.clear=!0),this._options.hasOwnProperty("multisampling")||(this._options.multisampling=!1,this._options.multisamplingSamples=0),this._options.multisamplingSamples&&(this._cgl.glSlowRenderer&&(this._options.multisamplingSamples=0),this._cgl.gl.MAX_SAMPLES?this._options.multisamplingSamples=Math.min(this._cgl.gl.getParameter(this._cgl.gl.MAX_SAMPLES),this._options.multisamplingSamples):this._options.multisamplingSamples=0),this._options.hasOwnProperty("filter")||(this._options.filter=CGL.Texture.FILTER_LINEAR),this._options.hasOwnProperty("wrap")||(this._options.wrap=CGL.Texture.WRAP_CLAMP_TO_EDGE),this._cgl.checkFrameStarted("cubemap framebuffer"),this.texture=new r(this._cgl,{width:this.width,height:this.height,isFloatingPointTexture:n.isFloatingPointTexture,filter:this._options.filter,wrap:this._options.wrap,name:this.name+" cubemaptexture"}),this.initializeRenderbuffers(),this.setSize(this.width,this.height)}initializeRenderbuffers(){this._framebuffer=this._cgl.gl.createFramebuffer(),this._depthbuffer=this._cgl.gl.createRenderbuffer(),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._framebuffer),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._depthbuffer),this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.DEPTH_COMPONENT16,this.width,this.height),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthbuffer),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null)}getWidth(){return this.width}getHeight(){return this.height}getGlFrameBuffer(){return this._framebuffer}getDepthRenderBuffer(){return this._depthRenderbuffer}getTextureColor(){return this.texture}getTextureDepth(){return this._textureDepth}dispose(){this.texture&&(this.texture=this.texture.delete()),this._framebuffer&&this._cgl.gl.deleteFramebuffer(this._framebuffer),this._depthRenderbuffer&&this._cgl.gl.deleteRenderbuffer(this._depthbuffer)}delete(){this.dispose()}setSize(e,t){this._cgl.printError("before cubemap setsize"),this.width=Math.floor(e),this.height=Math.floor(t),this.width=Math.min(this.width,this._cgl.maxTexSize),this.height=Math.min(this.height,this._cgl.maxTexSize),this._cgl.profileData.profileFrameBuffercreate++,this._framebuffer=this._cgl.gl.createFramebuffer(),this._depthbuffer=this._cgl.gl.createRenderbuffer(),this.texture.setSize(this.width,this.height),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._framebuffer),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._depthbuffer),this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.DEPTH_COMPONENT16,this.width,this.height),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthbuffer),this._cgl.gl.isFramebuffer(this._framebuffer)||console.error("invalid framebuffer...");const a=this._cgl.gl.checkFramebufferStatus(this._cgl.gl.FRAMEBUFFER);this.checkErrorsByStatus(a),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_CUBE_MAP,null),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,null),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,null),this._cgl.printError("cubemap setsize")}checkErrorsByStatus(e){switch(e){case this._cgl.gl.FRAMEBUFFER_COMPLETE:break;case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw console.error("FRAMEBUFFER_INCOMPLETE_ATTACHMENT...",this.width,this.height,this.texture.tex,this._depthBuffer),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw console.error("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw console.error("FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");case this._cgl.gl.FRAMEBUFFER_UNSUPPORTED:throw console.error("FRAMEBUFFER_UNSUPPORTED"),new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");case 36059:console.error("Incomplete: FRAMEBUFFER_INCOMPLETE_DRAW_BUFFER from ext. Or Safari/iOS undefined behaviour.");break;default:throw console.error("incomplete framebuffer",e),console.log(this),new Error("Incomplete framebuffer: "+e)}}setFilter(e){this.texture.filter=e,this.texture.setSize(this.width,this.height)}setCamPos(e){this.camPos=e||this.camPos}setMatrices(e,t,a){this._modelMatrix=e||this._modelMatrix,this._viewMatrix=t||this._viewMatrix,this._projectionMatrix=a||this._projectionMatrix}renderStart(){this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_CUBE_MAP,this.texture.tex),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._framebuffer),this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER,this._depthbuffer),this._cgl.gl.viewport(0,0,this.width,this.height),this._cgl.pushGlFrameBuffer(this._framebuffer),this._cgl.pushFrameBuffer(this)}renderStartCubemapFace(e){this._cgl.pushModelMatrix(),this._cgl.pushViewMatrix(),this._cgl.pushPMatrix(),this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.COLOR_ATTACHMENT0,this._cubemapProperties[e].face,this.texture.tex,0),this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.gl.DEPTH_ATTACHMENT,this._cgl.gl.RENDERBUFFER,this._depthbuffer),this._options.clear&&(this._cgl.gl.clearColor(0,0,0,1),this._cgl.gl.clear(this._cgl.gl.COLOR_BUFFER_BIT|this._cgl.gl.DEPTH_BUFFER_BIT)),this.setMatricesCubemapFace(e)}setMatricesCubemapFace(e){mat4.copy(this._cgl.mMatrix,this._modelMatrix),vec3.add(this._lookAtTemp,this.camPos,this._cubemapProperties[e].lookAt),mat4.lookAt(this._cgl.vMatrix,this.camPos,this._lookAtTemp,this._cubemapProperties[e].up),mat4.copy(this._cgl.pMatrix,this._projectionMatrix)}renderEndCubemapFace(){this._cgl.popPMatrix(),this._cgl.popModelMatrix(),this._cgl.popViewMatrix()}renderEnd(){this._cgl.profileData.profileFramebuffer++,1!==this._cgl.glVersion&&this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER,this._framebuffer),this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER,this._cgl.popGlFrameBuffer()),this._cgl.popFrameBuffer(),this._cgl.resetViewPort(),this.updateMipMap()}updateMipMap(){this.texture&&(this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_CUBE_MAP,this.texture.tex),this.texture.updateMipMap(),this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_CUBE_MAP,null))}},((this.CGL=this.CGL||{}).COREMODULES=this.CGL.COREMODULES||{}).Cubemapframebuffer={}.Cubemapframebuffer})();(()=>{"use strict";const i=0,l=2,s=2,u=3,m=5;CABLES.VarSetOpWrapper=class{constructor(t,e,a,n,r,o){this._valuePort=a,this._varNamePort=n,this._op=t,this._type=e,this._typeId=-1,this._triggerPort=r,this._nextPort=o,this._btnCreate=t.inTriggerButton("Create new variable"),this._btnCreate.setUiAttribs({hidePort:!0}),this._btnCreate.onTriggered=this._createVar.bind(this),this._helper=t.inUiTriggerButtons("",["Rename"]),this._helper.setUiAttribs({hidePort:!0}),this._helper.onTriggered=e=>{"Rename"==e&&CABLES.CMD.PATCH.renameVariable(t.varName.get())},this._op.setPortGroup("Variable",[this._helper,this._varNamePort,this._btnCreate]),this._op.on("uiParamPanel",this._updateVarNamesDropdown.bind(this)),this._op.patch.addEventListener("variablesChanged",this._updateName.bind(this)),this._op.patch.addEventListener("variableRename",this._renameVar.bind(this)),this._varNamePort.onChange=this._updateName.bind(this),this._isTexture="texture"===this._valuePort.uiAttribs.objType,this._valuePort.changeAlways=!0,this._triggerPort?this._triggerPort.onTriggered=()=>{this._setVarValue(!0)}:this._valuePort.onChange=this._setVarValue.bind(this),this._op.init=()=>{this._updateName(),this._triggerPort||this._setVarValue(),this._updateErrorUi()},this._typeId="array"==e?u:"object"==e?l:"string"==e?m:"texture"==e?s:i}_updateErrorUi(){CABLES.UI&&(this._varNamePort.get()?this._op.hasUiErrors&&this._op.setUiError("novarname",null):this._op.setUiError("novarname","no variable selected"))}_updateName(){const e=this._varNamePort.get();this._op.setTitle("var set "),this._op.setUiAttrib({extendTitle:"#"+e}),this._updateErrorUi();const t=this._op.patch.getVar(e);t&&!t.type&&(t.type=this._type),this._op.patch.hasVar(e)||0==e||this._triggerPort||this._setVarValue(),!this._op.patch.hasVar(e)&&0!=e&&this._triggerPort&&("string"==this._type||"number"==this._type?this._op.patch.setVarValue(e,""):this._op.patch.setVarValue(e,null)),this._op.isCurrentUiOp()&&(this._updateVarNamesDropdown(),this._op.refreshParams()),this._updateDisplay(),this._op.patch.emitEvent("opVariableNameChanged",this._op,this._varNamePort.get())}_createVar(){CABLES.CMD.PATCH.createVariable(this._op,this._type,()=>{this._updateName()})}_updateDisplay(){this._valuePort.setUiAttribs({greyout:!this._varNamePort.get()})}_updateVarNamesDropdown(){if(CABLES.UI&&CABLES.UI.loaded&&CABLES.UI.loaded){const t=[],a=this._op.patch.getVars();for(const e in a)a[e].type==this._type&&"0"!=e&&t.push(e);this._varNamePort.uiAttribs.values=t}}_renameVar(e,t){e==this._varNamePort.get()&&(this._varNamePort.set(t),this._updateName())}_setVarValue(e){const t=this._varNamePort.get();if(!t)return;const a=this._valuePort.get();this._typeId==i||this._typeId==m?this._op.patch.setVarValue(t,a):this._typeId==u?(this._arr=[],CABLES.copyArray(a,this._arr),this._op.patch.setVarValue(t,this._arr)):(this._typeId==l&&(this._isTexture?this._op.patch.setVarValue(t,CGL.Texture.getEmptyTexture(this._op.patch.cgl)):this._op.patch.setVarValue(t,null),a&&a.tex&&a._cgl&&!this._isTexture?this._op.setUiError("texobj","Dont use object variables for textures, use varSetTexture"):this._op.setUiError("texobj",null)),this._op.patch.setVarValue(t,a)),e&&this._nextPort&&this._nextPort.trigger()}},CABLES.VarGetOpWrapper=class{constructor(e,t,a,n){this._op=e,this._type=t,this._varnamePort=a,this._variable=null,this._valueOutPort=n,this._listenerId=null,this._op.on("uiParamPanel",this._updateVarNamesDropdown.bind(this)),this._op.on("uiErrorChange",this._updateTitle.bind(this)),this._op.patch.on("variableRename",this._renameVar.bind(this)),this._op.patch.on("variableDeleted",e=>{this._op.isCurrentUiOp()&&this._op.refreshParams()}),this._varnamePort.onChange=this._changeVar.bind(this),this._op.patch.addEventListener("variablesChanged",this._init.bind(this)),this._op.onDelete=()=>{this._variable&&this._listenerId&&this._variable.off(this._listenerId)},this._op.init=()=>{this._init()}}get variable(){return this._variable}_changeVar(){this._variable&&this._listenerId&&this._variable.off(this._listenerId),this._init()}_renameVar(e,t){e==this._varnamePort.get()&&(this._varnamePort.set(t),this._updateVarNamesDropdown(),this._updateTitle(),this._listenerId=this._variable.on("change",this._setValueOut.bind(this)))}_updateVarNamesDropdown(){if(CABLES.UI&&CABLES.UI.loaded){const t=[],a=this._op.patch.getVars();for(const e in a)a[e].type==this._type&&"0"!=e&&t.push(e);this._op.varName.uiAttribs.values=t}}_setValueOut(e){this._valueOutPort&&this._valueOutPort.set(e)}_updateTitle(){this._variable?(this._op.setUiError("unknownvar",null),this._op.setTitle("var get "),this._op.setUiAttrib({extendTitle:"#"+this._varnamePort.get()}),this._valueOutPort&&this._valueOutPort.set(this._variable.getValue())):(this._op.setUiError("unknownvar","unknown variable! - there is no setVariable with this name ("+this._varnamePort.get()+")"),this._op.setUiAttrib({extendTitle:"#invalid"}),this._valueOutPort&&this._valueOutPort.set(0))}_init(){this._updateVarNamesDropdown(),this._variable&&this._listenerId&&this._variable.off(this._listenerId),this._variable=this._op.patch.getVar(this._op.varName.get()),this._variable&&(this._listenerId=this._variable.on("change",this._setValueOut.bind(this))),this._updateTitle(),this._op.patch.emitEvent("opVariableNameChanged",this._op,this._varnamePort.get())}},((this.CABLES=this.CABLES||{}).COREMODULES=this.CABLES.COREMODULES||{}).Vargetset={}.Cables})();